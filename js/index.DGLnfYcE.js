import{r as ae,o as t,c as ve,d as Ke,h as rt,u as Qe,a as fe,L as qe,e as Ne,b as s,f as e,g as z,w as F,i as Y,t as c,F as H,j as N,k as L,l as me,m as Je,n as Me,p as it,q as Re,s as Xe,P as ze,v as ge,x as ne,y as ie,z as Se,A as ft,B as o,T as be,C as R,D as te,E as We,G as ee,H as dt,I as ke,J as pt,K as Ae,M as Ie,N as De,O as pe,Q as Le,R as _e,S as he,U as Ve,V as Ee,W as Fe,X as nt,Y as vt,Z as gt,_ as bt,$ as He,a0 as yt,a1 as $t,a2 as ht}from"./vendor-j_hXVjUg-chunk.js";(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))x(_);new MutationObserver(_=>{for(const D of _)if(D.type==="childList")for(const P of D.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&x(P)}).observe(document,{childList:!0,subtree:!0});function k(_){const D={};return _.integrity&&(D.integrity=_.integrity),_.referrerPolicy&&(D.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?D.credentials="include":_.crossOrigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function x(_){if(_.ep)return;_.ep=!0;const D=k(_);fetch(_.href,D)}})();const wt={__name:"App",setup(n){return(v,k)=>{const x=ae("router-view");return t(),ve(x)}}},_t=Ke({id:"alert",state:()=>({alert:null}),actions:{success(n){this.alert={message:n,type:"alert-success"}},error(n){this.alert={message:n,type:"alert-danger"}},clear(){this.alert=null}}});function Ze(){const n=B=>{var $;let A=B,i=A.response,T="";if(!A.response)return B.message;if(i.status===500){if(typeof i.data=="string")return i.data;if(i.data.content)return i.data.content;if(i.data.detail)return i.data.detail}if(i.status===401){const W=`${window.location.pathname}${window.location.search}`;T=`You are not authorized or your session timed out. Please click <a href='${`/accounts/login/?returnUrl=${encodeURIComponent(W)}`}'>here</a> to login.`}else if(i.status===400){let W=A.response.data.errors;T=A.response.data.title||A.response.data,W&&(T+="<ul>");for(let X in W){let m=W[X];for(let y in W[X]){let K=m[y];T+=`<li>${K}</li>`}}W&&(T+="</ul>"),T||(T=A.message),T&&T.content&&(T=T.content)}else i.status===404?T=(($=i==null?void 0:i.data)==null?void 0:$.title)||(i==null?void 0:i.data)||"Record not found.":typeof i.data=="string"&&(T=A.message,T===""&&(T=`Error <b>Http ${i.status}</b>.<br/>Please contact the System Administrator.`));return T},v=B=>JSON.parse(JSON.stringify(B)),k=B=>{if(typeof B!="number")return B;var A=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2});return A.format(B)},x=(B,A,i)=>{const $={value:A,expiry:new Date().getTime()+i};debugger;localStorage.setItem(B,JSON.stringify($))},_=B=>{debugger;const A=localStorage.getItem(B);if(!A)return null;const i=JSON.parse(A);return new Date().getTime()>i.expiry?(localStorage.removeItem(B),null):i.value},D="pageSelectedTabStorageKey";return{getErrorMessageAsHtml:n,clone:v,toCurrency:k,moment:rt,localStorageSetWithExpiry:x,localStorageGetWithExpiry:_,setPageTab:(B,A)=>{var i=localStorage.getItem(D);i?i=JSON.parse(i):i={},i[B]=A,localStorage.setItem(D,JSON.stringify(i))},getPageTab:B=>{var A=localStorage.getItem(D);return A?A=JSON.parse(A):A={},A[B]},createHlsStream:(B,A,i)=>{var T=new Hls({autoStartLoad:i??!0});return T.on(Hls.Events.MEDIA_ATTACHED,function(){}),T.on(Hls.Events.MANIFEST_PARSED,function($,W){console.log("manifest loaded, found "+W.levels.length+" quality level")}),T.on(Hls.Events.ERROR,function($,W){if(W.fatal)switch(W.type){case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),T.recoverMediaError();break;case Hls.ErrorTypes.NETWORK_ERROR:console.error("fatal network error encountered",W);break;default:T.destroy();break}}),T.loadSource(A),T.attachMedia(B),T},isValidTime:B=>/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/.test(B),generateReturnUrl:()=>{const B=Qe();let A=B.path;return B.query.returnUrl&&(A=B.query.returnUrl),A=`?returnUrl=${encodeURIComponent(A)}`,A},getValidFeedbackCss:B=>B?"is-valid":"is-invalid"}}const kt=Ze(),ut=JSON.parse(localStorage.getItem("user"))||{},St=kt.moment.utc(ut.exp*1e3),Tt=St.isAfter()?ut:null,$e=Ke({id:"auth",state:()=>({user:Tt,returnUrl:null}),actions:{async login(n){try{this.user=n,localStorage.setItem("user",JSON.stringify(n))}catch(v){debugger;alert(v)}},logout(){this.user=null,localStorage.removeItem("user"),ot.push("/accounts/login")},logoutWithRedirect(){this.user=null,localStorage.removeItem("user")}}}),It="vue-3-pinia-registration-login-example-users";JSON.parse(localStorage.getItem(It));const Mt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://sonyfastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AUTH_POST_LOGOUT_URI:"https://lively-bay-00480981e.5.azurestaticapps.net/",VITE_AUTH_REDIRECT_URI:"window.location.origin + '/accounts/loginRedirect'"},Ye=Mt,Ge=Ke("msal",()=>{const n=fe({auth:{clientId:Ye.VITE_AUTH_CLIENT_ID,authority:Ye.VITE_AUTH_AUTHORITY_URL,postLogoutUri:Ye.VITE_AUTH_POST_LOGOUT_URI},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1,secureCookies:!1},system:{loggerOptions:{logLevel:qe.Verbose,loggerCallback:(x,_,D)=>{if(!D)switch(x){case qe.Error:console.error(_);return;case qe.Info:console.info(_);return;case qe.Verbose:console.debug(_);return;case qe.Warning:console.warn(_);return}},piiLoggingEnabled:!1}}}),v=fe("");return{msalConfig:n,accessToken:v,setAccessToken:x=>{v.value=x}}}),et={$on:(...n)=>Ne.on(...n),$once:(...n)=>Ne.once(...n),$off:(...n)=>Ne.off(...n),$emit:(...n)=>Ne.emit(...n)};function xt(){const n=(D,P,Q,j)=>{et.$emit("toast-message",{title:D,message:P,type:Q,options:j})};return{success:(D,P,Q={})=>{n(D,P,"success",Q)},warning:(D,P,Q={})=>{n(D,P,"warning",Q)},info:(D,P,Q={})=>{n(D,P,"info",Q)},error:(D,P,Q={})=>{n(D,P,"danger",Q)}}}const xe=(n,v)=>{const k=n.__vccOpts||n;for(const[x,_]of v)k[x]=_;return k},Ct={data(){return{notifications:[],messages:[]}},async created(){const n=this;n.$bus.$on("event:notification-received",()=>{n.getUnreadNotifications()}),n.$bus.$on("event:notification-marked-as-read",v=>{n.notifications.some(x=>x.notificationId===v)&&n.getUnreadNotifications()}),n.$bus.$on("event:notification-removed",v=>{n.notifications.some(x=>x.notificationId===v)&&n.getUnreadNotifications()}),n.$bus.$on("event:chat-marked-as-read",n.onChatMarkedAsRead),n.$bus.$on("event:chat-message-received",n.onChatMessageReceived)},async mounted(){const n=this,v=n.$refs.notifications,k=n.$refs.messages;v&&v.offsetParent,k&&k.offsetParent&&await n.getUnreadChats()},methods:{async logout(){const n=this;try{await n.$util.axios.post("/api/accounts/logout").then(v=>{const k="/";n.$toast.warning("Logout","You have logged out of the system.",{timeOut:5e3,async onClose(){n.$util.href(k)}})})}catch(v){n.$util.handleError(v)}},async onChatMarkedAsRead(n){let v=this,k=v.messages.find(x=>x.chatId===n);if(k){let x=v.messages.indexOf(k);v.messages.splice(x,1)}},async onChatMessageReceived(n){let v=this,k=v.messages.find(_=>_.chatId===n.chatId);if(k)k.lastMessageText=n.content;else{var x={chatId:n.chatId,isRead:!1,lastDateSent:n.dateSent,lastMessageText:n.content,senderFirstLastName:`${n.sender.firstName} ${n.sender.lastName}`,senderInitials:n.sender.initials,senderProfilePicture32:n.sender.profilePicture32,urlPicture:v.$util.getProfilePictureUrl(n.sender.profilePicture32,n.sender.initials)};v.messages.push(x)}},async getUnreadNotifications(){const n=this;try{await n.$util.axios.get("api/accounts/unread-notifications").then(v=>{n.notifications=v.data})}catch(v){n.$util.handleError(v)}},async getUnreadChats(){const n=this;try{await n.$util.axios.get("api/accounts/unread-chats").then(v=>{n.messages=v.data;for(let k in n.messages){let x=n.messages[k];n.$set(x,"urlPicture",n.$util.getProfilePictureUrl(x.senderProfilePicture32,x.senderInitials))}})}catch(v){n.$util.handleError(v)}},viewNotification(n){this.$bus.$emit("event:open-notification",n)},viewChat(n){this.$bus.$emit("event:open-chat",n)},showHiddenElements(){let v=this.$el.getElementsByClassName("initialHidden");for(let k=0;k<v.length;k++)v[k].classList.remove("invisible")}}},Vt={mixins:[Ct],props:{uid:String,appName:{type:String,required:!0,default:"SCH2"},urlProfilePicture:String,menus:Array},components:{},data(){const v=$e().user;return{user:v,username:v?v.nameFull:"Guest"}},async mounted(){},methods:{isActive(n){return window.location.href.indexOf(n)>-1},async openModalSearchUser747(n){this.$refs.refModalSearchUser747.open(n)}}},Pt={class:"sticky-top navbar navbar-expand-sm navbar-dark bg-primary bg-gradient shadow-sm py-2","aria-label":"Offcanvas navbar large"},Ot={class:"container-md"},At={class:"navbar-collapse collapse",id:"navbarSideCollapse"},Lt={class:"navbar-nav"},Ut={class:"nav-item dropdown"},Ht={class:"dropdown-menu","aria-labelledby":"dropdown01"},Dt={class:"nav-item dropdown"},Et={class:"dropdown-menu","aria-labelledby":"dropdown01"},qt={class:"navbar-nav ms-auto"},Bt={class:"nav-item dropdown"},Nt={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Rt={class:"d-inline d-sm-none d-md-inline"},Ft={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},zt={class:"text-capitalize"};function Gt(n,v,k,x,_,D){const P=ae("router-link");return t(),s("nav",Pt,[e("div",Ot,[z(P,{class:"navbar-brand",to:"/member"},{default:F(()=>[Y(c(k.appName),1)]),_:1}),v[14]||(v[14]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSideCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",At,[e("ul",Lt,[e("li",Ut,[v[3]||(v[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Social")])],-1)),e("ul",Ht,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/announcements"},{default:F(()=>v[0]||(v[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),Y(" Announcements ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/posts"},{default:F(()=>v[1]||(v[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),Y(" Posts ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/yellow-pages"},{default:F(()=>v[2]||(v[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),Y(" Yellow Pages ")])),_:1})])])]),e("li",Dt,[v[5]||(v[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Home Owners")])],-1)),e("ul",Et,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:F(()=>v[4]||(v[4]=[Y(" Property Monthly Dues ")])),_:1})])])])]),e("ul",qt,[e("li",Bt,[e("a",Nt,[e("span",null,[v[6]||(v[6]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Rt,c(_.username),1)])]),e("ul",Ft,[v[9]||(v[9]=e("li",null,[e("h6",{class:"dropdown-header"},"Settings")],-1)),v[10]||(v[10]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Profile ")],-1)),v[11]||(v[11]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Theme ")],-1)),v[12]||(v[12]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),_.user&&_.user.roles.length>1?(t(!0),s(H,{key:0},N(_.user.roles,Q=>(t(),s("li",null,[z(P,{to:`/${Q.toLowerCase()}`,class:"dropdown-item"},{default:F(()=>[e("span",zt,c(Q),1)]),_:2},1032,["to"])]))),256)):L("",!0),e("li",null,[z(P,{to:"/",class:"dropdown-item"},{default:F(()=>v[7]||(v[7]=[Y(" Main ")])),_:1})]),v[13]||(v[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[z(P,{to:"/account/logout",class:"dropdown-item"},{default:F(()=>v[8]||(v[8]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Y("Logout ")])),_:1})])])])])])])])}const jt=xe(Vt,[["render",Gt]]),Yt={props:{appName:{type:String,required:!1}},data(){return{busy:!1,enums:{orderStatuses:[{id:1,name:"Requested"},{id:2,name:"Placed"},{id:3,name:"Accepted"},{id:4,name:"Processed"},{id:5,name:"Delivered"},{id:6,name:"Completed"},{id:7,name:"Cancelled"}],promotionType:[{id:1,name:"Discounts"},{id:2,name:"Shipping"}],promotionProductApplicability:[{id:1,name:"All Products"},{id:2,name:"Specific Products"}],promotionOfferType:[{id:1,name:"No Code"},{id:2,name:"Generic Code"}],shipmentType:[{id:1,name:"Pickup"},{id:2,name:"Delivery"}]}}},async created(){},mounted(){this.showHiddenElements()},methods:{scrollIntoView(){const n=document.getElementById("top");n&&n.scrollIntoView({behavior:"smooth"})},showHiddenElements(){let n=this;if(!n.$el.getElementsByClassName)return;let v=n.$el.getElementsByClassName("initialHidden");for(let k=0;k<v.length;k++){let x=v[k];x.classList.remove("invisible"),x.classList.remove("d-none")}},close(){const n=this,v=document.referrer.toLowerCase();v&&v.includes("/account/login")?n.$router.go(-2):n.$router.go(-1)},toggle(n){const v=this;v.toggles[n]=!v.toggles[n],localStorage.setItem(v.togglesKey,JSON.stringify(v.toggles))}}},Wt={mixins:[Yt],props:{uid:String},data(){return{copyright:`2020-${new Date().getFullYear()} HOAMS - UbePages`}},computed:{},async created(){},async mounted(){},methods:{isActive(n){return window.location.href.indexOf(n)>-1}}},Kt={class:"footer sticky-bottom"},Qt={class:"d-none d-sm-block navbar navbar-dark bg-primary bg-gradient py-1"},Jt={class:"container-md"},Xt={class:"navbar-text small p-0"},Zt={class:"d-block d-sm-none navbar navbar-expand navbar-dark bg-primary bg-gradient py-1"},es={class:"container-md"},ts={class:"navbar-nav nav-fill w-100"},ss={class:"nav-item dropup"},os={class:"dropdown-menu","aria-labelledby":"dropdown01"},as={class:"nav-item dropup"},ls={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"};function ns(n,v,k,x,_,D){const P=ae("router-link");return t(),s("footer",Kt,[e("div",Qt,[e("div",Jt,[e("span",Xt,"©"+c(_.copyright),1)])]),e("nav",Zt,[e("div",es,[e("ul",ts,[e("li",ss,[v[3]||(v[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group"})])],-1)),e("ul",os,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/announcements"},{default:F(()=>v[0]||(v[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),Y(" Announcements ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/posts"},{default:F(()=>v[1]||(v[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),Y(" Posts ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/yellow-pages"},{default:F(()=>v[2]||(v[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),Y(" Yellow Pages ")])),_:1})])])]),e("li",as,[v[5]||(v[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user"})])],-1)),e("ul",ls,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:F(()=>v[4]||(v[4]=[Y(" Property Monthly Dues ")])),_:1})])])])])])])])}const rs=xe(Wt,[["render",ns]]),is={name:"AdminLayout",components:{TopNav:jt,BottomNav:rs},inject:["$config"],mounted(){const v=this.$config;document.title=`Account - ${v.appName}`}},ds={class:"d-flex flex-column vh-100"};function us(n,v,k,x,_,D){const P=ae("Toasts"),Q=ae("router-view");return t(),s("div",ds,[z(P),z(Q,{class:"flex-grow-1 mb-2"})])}const cs=xe(is,[["render",us]]),ms={__name:"index",setup(n){return $e().user,me(()=>{}),(k,x)=>(t(),s("div",null,x[0]||(x[0]=[Je('<div class="mt-2 pb-2 shadow-sm"><div class="container-md"><div class="row align-items-center"><div class="col-md-auto"><h1><i class="fas fa-fw fa-dashboard me-1"></i>Dashboard </h1></div><div class="col-md"></div></div></div></div><div class="mt-2 container-md"> Dashboard contents here </div>',2)])))}},fs={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://sonyfastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AUTH_POST_LOGOUT_URI:"https://lively-bay-00480981e.5.azurestaticapps.net/",VITE_AUTH_REDIRECT_URI:"window.location.origin + '/accounts/loginRedirect'"},ps=fs;function vs(){Me("$config");const n=ps.VITE_API_URL,v=it.create({baseURL:n});return Re.configure({template:'<div class="bar pt-1 bg-light" role="bar"><div class="peg1"></div></div><div class="spinner" role="spinner"><div class="fas fa-fw fa-spin fa-arrows-rotate text-white"></div></div>'}),v.interceptors.request.use(k=>{Re.start();const{user:x}=$e();return x&&x.token&&(k.headers?(k.headers.Authorization||(k.headers.Authorization=`Bearer ${x.token}`),k.headers["Access-Control-Allow-Origin"]||(k.headers["Access-Control-Allow-Origin"]="*")):k.headers={Authorization:`Bearer ${x.token}`,"Access-Control-Allow-Origin":"*"}),k}),v.interceptors.response.use(k=>(Re.done(),k),k=>{throw Re.done(),k}),v}function ye(n){if(!n.appTitle)throw Error("App Title is required.");if(!n.pageTitle)throw Error("Page Title is required.");const v=Qe(),k=Xe(),x=vs(),_=Ze(),D=xt(),Q=$e().user,j=()=>Q&&Q.roles&&Q.roles.includes("System"),S=()=>Q&&Q.roles&&Q.roles.includes("administrator"),G=()=>Q&&Q.roles&&Q.roles.includes("employee"),le=()=>Q&&Q.roles&&Q.roles.includes("Member"),B=async()=>{const K=document.referrer.toLowerCase();K&&K.includes("/accounts/login")?await k.go(-2):await k.go(-1)},A=K=>{var p;const f=v.path,M=(p=v.query)==null?void 0:p.returnUrl;M&&!(f.startsWith(M)||M.startsWith(f))?k.push(M):k.push(K)},i=n.appTitle,T=n.pageTitle,$=fe(!1),W=fe(new Map),X=fe(""),m=fe(""),y=fe("");return{appTitle:i,pageTitle:T,busy:$,validations:W,infoMessage:X,warningMessage:m,errorMessage:y,router:k,route:v,axios:x,utils:_,toasts:D,close:B,closeWithReturnUrl:A,generateReturnUrl:_.generateReturnUrl,security:{userId:Q?Q.userId:"",isSystem:j(),isAdministrator:S(),isEmployee:G(),isMember:le()}}}const gs={class:"h-100 d-flex align-items-center justify-content-center"},bs={class:"form-signin w-100 m-auto"},ys={class:"h3 mb-3 fw-normal"},$s={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},hs=["innerHTML"],ws={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},_s=["disabled"],ks={key:0,class:"fas fa-fw fa-hourglass-start fa-spin me-2"},Ss={__name:"login",props:{urlReturn:{type:String,required:!1}},setup(n){Me("$config");const v=$e(),k=Ge(),x=new ze(k.msalConfig),_=ge({username:"",password:""}),D={username:{required:ne.withMessage("Username is required.",ie),$autoDirty:!0,$lazy:!0},password:{required:ne.withMessage("Password is required.",ie),$autoDirty:!0,$lazy:!0}},P=Se(D,_),{appTitle:Q,pageTitle:j,busy:S,isDirty:G,validations:le,infoMessage:B,warningMessage:A,errorMessage:i,router:T,route:$,axios:W,utils:X,toasts:m,close:y,security:K}=ye({appTitle:"Arcadian-FAST",pageTitle:"Sign On"}),f={redirectUri:window.location.origin+"/accounts/loginRedirect"};me(async()=>{S.value=!0,await x.initialize();let b=null;if(await x.handleRedirectPromise().then(r=>{const d=x.getAllAccounts();d.length>0&&(b=d[0])}).catch(r=>{debugger}),!b){S.value=!1;return}try{const r={loginHint:b==null?void 0:b.username,redirectUri:window.location.origin+"/accounts/loginRedirect"},d=await x.ssoSilent(r);if(d){await m.success("SSO","Session created, redirecting to home page.",{onClose:async()=>{await p(d.account)}});return}}catch(r){if(r.errorCode=="login_required")try{const d=await x.loginPopup(f);if(d){await m.success("SSO","Login popup successful, redirecting to home page.",{onClose:async()=>{await p(d.account)}});return}}catch{m.warning("SSO","Login failed. Please enable third-party cookies or remove popup blocker, then retry.")}else m.warning("SSO Active Session Check","There was an issue while checking for active session, please signin.")}S.value=!1});const M=async()=>{var b={account:x.getActiveAccount(),scopes:[]};await x.acquireTokenSilent(b).then(r=>{const l=r.account.idToken,a=ft(l);a.token=r.accessToken,console.log(r),a.roles||(a.roles=[]),a.userId=a.sub,v.login(a);var U=$.query.returnUrl;U?T.push(decodeURIComponent(U)):a.roles.length===1?T.push(`/${a.roles[0].toLowerCase()}`):T.push("/")}).catch(r=>{m.warning("Error while requesting access token",r),console.error(`error during acquireTokenSilent: ${r}`)})},p=async b=>{x.setActiveAccount(b),await M()},u=async()=>{S.value=!0;const b=x.getAllAccounts();if(b.length===0)try{await x.loginRedirect(f);return}catch(d){JSON.stringify(d);debugger}const r=b[0];await p(r)};return(b,r)=>(t(),ve(be,null,{default:F(()=>[e("div",gs,[e("main",bs,[e("div",null,[e("h1",ys,c(o(Q)),1),e("div",null,[o(i)?(t(),s("div",$s,[r[1]||(r[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(i)},null,8,hs)])):L("",!0),o(P).$error?(t(),s("div",ws,[r[2]||(r[2]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(P).$errors,d=>(t(),s("li",{key:d.$uid},c(d.$message),1))),128))])])):L("",!0)]),e("button",{onClick:r[0]||(r[0]=d=>u()),disabled:o(S),class:"btn btn-primary w-100 py-2"},[o(S)?(t(),s("span",ks)):L("",!0),r[3]||(r[3]=Y("Single Sign On "))],8,_s)])])])]),_:1}))}},Ts=xe(Ss,[["__scopeId","data-v-db016491"]]),Is={__name:"loginRedirect",setup(n){$e();const v=Ge(),k=new ze(v.msalConfig);return me(async()=>{await k.initialize(),await k.handleRedirectPromise().then(x=>{}).catch(x=>{debugger})}),(x,_)=>(t(),ve(be,null,{default:F(()=>_[0]||(_[0]=[e("div",{class:"d-flex flex-column justify-content-center align-items-middle"},[e("div",{class:"mx-auto"},[e("div",{class:"alert text-bg-success shadow"},[e("span",{class:"fas fa-fw fa-hourglass-end fa-spin me-2"}),Y("SSO successful, redirecting to login page. ")])])],-1)])),_:1}))}},Ms={class:"h-100 d-flex align-items-center justify-content-center"},xs={__name:"logout",setup(n){const v=$e();return v.user,me(async()=>{v.logoutWithRedirect()}),(k,x)=>(t(),s("div",Ms,x[0]||(x[0]=[e("div",{class:"card"},[e("div",{class:"card-header"}," Sign-Out "),e("div",{class:"card-body"},[Y(" You have logged out from HOA MS."),e("br"),Y(" Click "),e("a",{href:"/",class:"d-inline"},"here"),Y(" to go back to home page. ")])],-1)])))}},Cs={class:"h-100 d-flex align-items-center justify-content-center"},Vs={class:"card m-3"},Ps={class:"card-header"},Os={class:"card-body"},As={class:"m-2"},Ls={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Us=["innerHTML"],Hs={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Ds={class:"row row-cols-1 row-cols-sm-3"},Es={class:"col-sm"},qs={class:"form-group"},Bs={key:0,class:"d-block invalid-feedback"},Ns={class:"col-sm"},Rs={class:"form-group"},Fs={key:0,class:"d-block invalid-feedback"},zs={class:"col-sm"},Gs={class:"form-group"},js={key:0,class:"d-block invalid-feedback"},Ys={class:"row row-cols-1 row-cols-sm-3"},Ws={class:"col"},Ks={class:"form-group"},Qs={key:0,class:"d-block invalid-feedback"},Js={class:"col"},Xs={class:"form-group"},Zs={key:0,class:"d-block invalid-feedback"},eo={class:"row row-cols-1 row-cols-sm-3"},to={class:"col-sm"},so={class:"form-group"},oo={key:0,class:"d-block invalid-feedback"},ao={class:"col-sm"},lo={class:"form-group"},no={key:0,class:"d-block invalid-feedback"},ro={class:"mt-2 row row-cols-1 row-cols-sm-3 g-2"},io={class:"col"},uo=["disabled"],co={class:"col"},mo={class:"col"},fo={__name:"register",props:{urlReturn:{type:String,required:!1}},setup(n){const v=ge({firstName:"",middleName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),k=(K,f)=>K===f.password,x={firstName:{required:ne.withMessage("First name is required.",ie),$autoDirty:!0,$lazy:!0},middleName:{required:ne.withMessage("Middle name is required.",ie),$autoDirty:!0,$lazy:!0},lastName:{required:ne.withMessage("Last name is required.",ie),$autoDirty:!0,$lazy:!0},phoneNumber:{required:ne.withMessage("Phone number is required.",ie),$autoDirty:!0,$lazy:!0},email:{required:ne.withMessage("Email is required.",ie),$autoDirty:!0,$lazy:!0},password:{required:ne.withMessage("Password is required.",ie),$autoDirty:!0,$lazy:!0},confirmPassword:{required:ne.withMessage("Confirm password is required.",ie),confirmSamePassword:ne.withMessage("Password and confirm passwrod are different.",k),$autoDirty:!0,$lazy:!0}},_=Se(x,v),{appTitle:D,pageTitle:P,busy:Q,isDirty:j,validations:S,infoMessage:G,warningMessage:le,errorMessage:B,router:A,axios:i,utils:T,toasts:$,close:W,security:X}=ye({appTitle:"HOA MS",pageTitle:"Register User"}),m=Me("$config");me(()=>{});const y=async()=>{const K=v;if(Q.value)return;if(!await _.value.$validate()){window.scrollTo(0,0);return}B.value=null;try{Q.value=!0;const M=T.clone(K);M.tenantid=m.tenantId;debugger;await i({method:"post",url:"/api/v1/accounts/register",data:M}).then(p=>{$.success("Register","Registration was successfull.",{onClose:async()=>{await A.push("/accounts/login")}})})}catch(M){B.value=T.getErrorMessageAsHtml(M),window.scrollTo(0,0)}finally{Q.value=!1}};return(K,f)=>{const M=ae("router-link");return t(),ve(be,null,{default:F(()=>[e("div",Cs,[e("div",Vs,[e("h4",Ps,c(o(P)),1),e("div",Os,[e("div",As,[o(B)?(t(),s("div",Ls,[f[8]||(f[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(B)},null,8,Us)])):L("",!0),o(_).$error?(t(),s("div",Hs,[f[9]||(f[9]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(_).$errors,p=>(t(),s("li",{key:p.$uid},c(p.$message),1))),128))])])):L("",!0)]),e("div",Ds,[e("div",Es,[e("div",qs,[f[10]||(f[10]=e("label",null,"First Name",-1)),R(e("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>v.firstName=p),type:"text",class:"form-control"},null,512),[[te,v.firstName]]),o(_).firstName.$error?(t(),s("div",Bs,[(t(!0),s(H,null,N(o(_).firstName.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])]),e("div",Ns,[e("div",Rs,[f[11]||(f[11]=e("label",null,"Middle Name",-1)),R(e("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>v.middleName=p),type:"text",class:"form-control"},null,512),[[te,v.middleName]]),o(_).middleName.$error?(t(),s("div",Fs,[(t(!0),s(H,null,N(o(_).middleName.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])]),e("div",zs,[e("div",Gs,[f[12]||(f[12]=e("label",null,"Last Name",-1)),R(e("input",{"onUpdate:modelValue":f[2]||(f[2]=p=>v.lastName=p),type:"text",class:"form-control"},null,512),[[te,v.lastName]]),o(_).lastName.$error?(t(),s("div",js,[(t(!0),s(H,null,N(o(_).lastName.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])])]),e("div",Ys,[e("div",Ws,[e("div",Ks,[f[13]||(f[13]=e("label",null,"Phone Number",-1)),R(e("input",{"onUpdate:modelValue":f[3]||(f[3]=p=>v.phoneNumber=p),type:"tel",class:"form-control"},null,512),[[te,v.phoneNumber]]),o(_).phoneNumber.$error?(t(),s("div",Qs,[(t(!0),s(H,null,N(o(_).phoneNumber.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])]),e("div",Js,[e("div",Xs,[f[14]||(f[14]=e("label",null,"Email",-1)),R(e("input",{"onUpdate:modelValue":f[4]||(f[4]=p=>v.email=p),type:"email",class:"form-control"},null,512),[[te,v.email]]),o(_).email.$error?(t(),s("div",Zs,[(t(!0),s(H,null,N(o(_).email.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])])]),e("div",eo,[e("div",to,[e("div",so,[f[15]||(f[15]=e("label",null,"Password",-1)),R(e("input",{"onUpdate:modelValue":f[5]||(f[5]=p=>v.password=p),type:"password",class:"form-control"},null,512),[[te,v.password]]),o(_).password.$error?(t(),s("div",oo,[(t(!0),s(H,null,N(o(_).password.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])]),e("div",ao,[e("div",lo,[f[16]||(f[16]=e("label",null,"Confirm Password",-1)),R(e("input",{"onUpdate:modelValue":f[6]||(f[6]=p=>v.confirmPassword=p),type:"password",class:"form-control"},null,512),[[te,v.confirmPassword]]),o(_).confirmPassword.$error?(t(),s("div",no,[(t(!0),s(H,null,N(o(_).confirmPassword.$errors,p=>(t(),s("div",{key:p.$uid},c(p.$message),1))),128))])):L("",!0)])])]),e("div",ro,[e("div",io,[e("button",{disabled:o(_).$dirty&&o(_).$invalid,onClick:f[7]||(f[7]=p=>y()),class:"btn btn-primary w-100"},f[17]||(f[17]=[e("span",{class:"fas fa-fw fa-save me-1"},null,-1),Y("Register ")]),8,uo)]),e("div",co,[z(M,{to:"/",class:"btn btn-outline-primary w-100"},{default:F(()=>f[18]||(f[18]=[Y("Home")])),_:1})]),e("div",mo,[z(M,{to:"/accounts/login",class:"btn btn-outline-primary w-100"},{default:F(()=>f[19]||(f[19]=[Y("Login")])),_:1})])])])])])]),_:1})}}},po={path:"/accounts",component:cs,props:!1,meta:{},children:[{path:"",component:ms},{path:"login",component:Ts},{path:"loginRedirect",component:Is},{path:"logout",component:xs},{path:"register",component:fo}]};function tt(){const n=Xe(),v=j=>window.location.href.indexOf(j)>-1,k=j=>localStorage.getItem("data-bs-theme")||j,x=j=>{document.documentElement.setAttribute("data-bs-theme",j),localStorage.setItem("data-bs-theme",j)},_=async()=>await it.get("https://bootswatch.com/api/5.json").then(j=>j.data),D=j=>{const S=document.querySelector("link[href*='https://cdn.jsdelivr.net/npm/bootswatch']");S&&j?(S.setAttribute("href",j),localStorage.setItem("bootswatch-theme",j)):alert("cannot query css link")},P=j=>{Q(),n.push(j)},Q=()=>{if(screen.width<576){const S=document.getElementById("navbarCollapse");if(S){const G=We.getInstance(S);G&&G.hide()}}};return{isActive:v,getCurrentBsTheme:k,changeBsTheme:x,getBootswatch:_,changeTheme:D,navigate:P,collapseNavbar:Q}}const vo={class:"sticky-top navbar navbar-expand-sm bg-primary","data-bs-theme":"dark"},go={class:"container-md"},bo={class:"navbar-collapse collapse",id:"navbarCollapse"},yo={class:"navbar-nav"},$o={class:"nav-item"},ho={class:"nav-item dropdown"},wo={class:"dropdown-menu","aria-labelledby":"dropdown01"},_o={class:"nav-item"},ko={class:"nav-item dropdown"},So={class:"dropdown-menu","aria-labelledby":"dropdown01"},To={class:"navbar-nav ms-auto"},Io={class:"nav-item dropdown"},Mo={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},xo=["onClick"],Co={class:"nav-item dropdown"},Vo={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Po={class:"d-sm-none d-xl-inline"},Oo={key:0},Ao={key:1},Lo={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Uo={key:0},Ho={key:1},Do={__name:"topNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(n){const v=Ge(),{isActive:k,getCurrentBsTheme:x,changeBsTheme:_,getBootswatch:D,changeTheme:P,navigate:Q,collapseNavbar:j}=tt(),S=$e(),G=S.user,le=ge({user:G,username:G?G.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});me(async()=>{const T=le;T.bootswatch=await D();const $=x(T.bsTheme);debugger;$&&(T.bsTheme=$,_(T.bsTheme));const W=localStorage.getItem("bootswatch-theme");W&&(T.currentTheme=W,P(W))});const B=T=>{P(T),le.currentTheme=T,j()},A=T=>{_(T),le.bsTheme=T,j()},i=async()=>{S.logoutWithRedirect();const T=new ze(v.msalConfig);await T.initialize();const $={mainWindowRedirectUri:"/"};await T.logoutPopup($)};return(T,$)=>{const W=ae("router-link");return t(),ve(be,null,{default:F(()=>[e("nav",vo,[e("div",go,[z(W,{class:"navbar-brand",to:"/administrator"},{default:F(()=>[Y(c(n.appName),1)]),_:1}),$[18]||($[18]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",bo,[e("ul",yo,[e("li",$o,[z(W,{to:"/videos",onClick:o(j),class:"nav-link"},{default:F(()=>$[3]||($[3]=[e("span",{class:"fas fa-fw fa-video me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Videos ",-1)])),_:1},8,["onClick"])]),e("li",ho,[$[6]||($[6]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-warehouse me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Sources ")],-1)),e("ul",wo,[e("li",null,[z(W,{to:"/source-groups",onClick:o(j),class:"dropdown-item"},{default:F(()=>$[4]||($[4]=[Y(" Groups ")])),_:1},8,["onClick"])]),e("li",null,[z(W,{to:"/source-locations",onClick:o(j),class:"dropdown-item"},{default:F(()=>$[5]||($[5]=[Y(" Locations ")])),_:1},8,["onClick"])])])]),e("li",_o,[z(W,{to:"/vod-sources",onClick:o(j),class:"nav-link"},{default:F(()=>$[7]||($[7]=[e("span",{class:"fas fa-fw fa-tags me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Video on Demand (VOD) ",-1)])),_:1},8,["onClick"])]),e("li",ko,[$[10]||($[10]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-microphone-lines me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Channel Assembly ")],-1)),e("ul",So,[e("li",null,[z(W,{to:"/program-templates",onClick:o(j),class:"dropdown-item"},{default:F(()=>$[8]||($[8]=[Y(" Program Templates ")])),_:1},8,["onClick"])]),e("li",null,[z(W,{to:"/channels",onClick:o(j),class:"dropdown-item"},{default:F(()=>$[9]||($[9]=[Y(" Channels ")])),_:1},8,["onClick"])])])])]),e("ul",To,[e("li",Io,[$[14]||($[14]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-wand-sparkles me-1"}),e("span",{class:"d-sm-none d-xl-inline"},"Themes")],-1)),e("ul",Mo,[e("li",null,[le.bsTheme==="dark"?(t(),s("button",{key:0,onClick:$[0]||($[0]=X=>A("light")),class:"dropdown-item"},$[11]||($[11]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Dark Mode ")]))):(t(),s("button",{key:1,onClick:$[1]||($[1]=X=>A("dark")),class:"dropdown-item"},$[12]||($[12]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Light Mode ")])))]),$[13]||($[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),(t(!0),s(H,null,N(le.bootswatch.themes,X=>(t(),s("li",null,[e("button",{onClick:m=>B(X.cssCdn),class:ee(["dropdown-item",{active:le.currentTheme===X.cssCdn}])},c(X.name),11,xo)]))),256))])]),e("li",Co,[e("a",Vo,[e("span",null,[$[15]||($[15]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Po,[o(G)?(t(),s("span",Oo,c(o(G).name),1)):(t(),s("span",Ao," Guest "))])])]),e("ul",Lo,[o(G)?(t(),s("li",Uo,[e("button",{onClick:$[2]||($[2]=X=>i()),class:"dropdown-item"},$[16]||($[16]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Y("Logout ")]))])):(t(),s("li",Ho,[z(W,{to:"/accounts/login",class:"dropdown-item"},{default:F(()=>$[17]||($[17]=[e("span",{class:"fas fa-fw fa-sign-in me-1"},null,-1),Y("Login ")])),_:1})]))])])])])])])]),_:1})}}},Eo={id:"sideNav",class:"collapse collapse-horizontal show",style:{"max-width":"200px"}},qo={class:"d-flex flex-column bg-dark min-vh-100 overflow-y-auto"},Bo={class:"navbar bg-primary bg-gradient shadow-sm","data-bs-theme":"dark"},No={class:"navbar-brand me-0 mb-1 px-2"},Ro={class:"d-none d-md-inline"},Fo={class:"nav nav-pills flex-column px-1 mt-2",role:"tablist"},zo={class:"nav-item"},Go={id:"sources",class:"list-group collapse"},jo={class:"nav-item"},Yo={id:"assets",class:"list-group collapse"},Wo={class:"nav-item"},Ko={id:"assembly",class:"list-group collapse"},Qo={class:"nav nav-pills flex-column mt-auto px-1 mb-5",role:"tablist"},Jo={class:"nav-item"},Xo={id:"themes",class:"list-group collapse"},Zo={class:"list-group-item border-bottom"},ea=["onClick"],ta={class:"nav-item"},sa={href:"#",class:"nav-link dropdown-toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#user","aria-expanded":"false","aria-controls":"user"},oa={class:"d-flex flex-row"},aa={class:"d-none d-md-inline d-block text-wrap"},la={id:"user",class:"list-group collapse"},na={class:"list-group-item border-bottom"},ra={key:0,class:"fas fa-fw fa-angle-double-left"},ia={key:1,class:"fas fa-fw fa-angle-double-right"},da={__name:"sideNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(n){const v=Ge(),k=Qe(),x=Xe(),_=$e(),D=_.user,{isActive:P,getCurrentBsTheme:Q,changeBsTheme:j,getBootswatch:S,changeTheme:G,navigate:le,collapseNavbar:B}=tt(),A=ge({user:D,username:D?D.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});me(async()=>{const p=A;p.bootswatch=await S();const u=Q(p.bsTheme);u&&(p.bsTheme=u,j(p.bsTheme));const b=localStorage.getItem("bootswatch-theme");b&&(p.currentTheme=b,G(b)),X();const r=document.getElementById("sideNav");r&&(W.value?r.classList.add("show"):r.classList.remove("show"))});const i=p=>{G(p),A.currentTheme=p,M("themes")},T=p=>{j(p),A.bsTheme=p,M("themes")},$=async()=>{_.logoutWithRedirect();const p=new ze(v.msalConfig);await p.initialize();const u={mainWindowRedirectUri:window.location.origin};try{await p.logoutRedirect(u)}catch(b){JSON.parse(JSON.stringify(b));debugger}},W=fe(!0),X=()=>{const p=localStorage.getItem("show-sideNav")||"true";W.value=p==="true"},m=()=>{localStorage.setItem("show-sideNav",W.value),We.getInstance("#sideNav").toggle()},y=()=>{W.value=!W.value,m()},K=(p,u)=>{var b=Array.isArray(p);const r=k;if(b){var d=p.find(a=>r.path.startsWith(a));return d?u||"active":""}var l=k.path.startsWith(p);return l?u||"active":""},f=async(p,u)=>{M(u),await x.push(p)},M=p=>{const u=We.getInstance(`#${p}`);u&&u.hide()};return(p,u)=>{const b=ae("router-link");return t(),s("div",null,[e("div",Eo,[e("div",qo,[e("nav",Bo,[z(b,{to:"/",class:"text-decoration-none w-100 text-center"},{default:F(()=>[e("h1",No,[u[9]||(u[9]=e("span",{class:"fas fa-fw fa-home d-inline d-md-none"},null,-1)),e("span",Ro,c(n.appName),1)])]),_:1})]),e("ul",Fo,[e("li",zo,[e("a",{href:"#",class:ee([K("/source-","text-bg-secondary"),"nav-link dropdown-toggle collapsed"]),"data-bs-toggle":"collapse","data-bs-target":"#sources","aria-expanded":"false","aria-controls":"sources"},u[10]||(u[10]=[e("span",{class:"fas fa-fw fa-boxes-packing"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Sources",-1)]),2),e("ul",Go,[e("li",{class:ee([K("/source-groups"),"list-group-item"])},[e("button",{onClick:u[0]||(u[0]=r=>f("/source-groups","sources")),class:"dropdown-item",role:"button"},u[11]||(u[11]=[e("span",{class:"fas fa-fw fa-warehouse"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Groups",-1)]))],2),e("li",{class:ee([K("/source-locations"),"list-group-item"])},[e("button",{onClick:u[1]||(u[1]=r=>f("/source-locations","sources")),class:"dropdown-item",role:"button"},u[12]||(u[12]=[e("span",{class:"fas fa-fw fa-building"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Locations",-1)]))],2)])]),e("li",jo,[e("a",{href:"#",class:ee([[K("/videos","text-bg-secondary"),K("/vod-sources","text-bg-secondary")],"nav-link dropdown-toggle collapsed"]),"data-bs-toggle":"collapse","data-bs-target":"#assets","aria-expanded":"false","aria-controls":"sources"},u[13]||(u[13]=[e("span",{class:"fas fa-fw fa-photo-video"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Assets",-1)]),2),e("ul",Yo,[e("li",{class:ee([K("/videos"),"list-group-item"])},[e("button",{onClick:u[2]||(u[2]=r=>f("/videos","assets")),class:"dropdown-item",role:"button"},u[14]||(u[14]=[e("span",{class:"fas fa-fw fa-video"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Videos",-1)]))],2),e("li",{class:ee([K("/vod-sources"),"list-group-item"])},[e("button",{onClick:u[3]||(u[3]=r=>f("/vod-sources","assets")),class:"dropdown-item",role:"button"},u[15]||(u[15]=[e("span",{class:"fas fa-fw fa-tags"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"VOD",-1)]))],2)])]),e("li",Wo,[e("a",{href:"#",class:ee([[K("/program-templates","text-bg-secondary"),K("/channels","text-bg-secondary")],"nav-link dropdown-toggle collapsed"]),"data-bs-toggle":"collapse","data-bs-target":"#assembly","aria-expanded":"false","aria-controls":"sources"},u[16]||(u[16]=[e("span",{class:"fas fa-fw fa-industry"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Assembly",-1)]),2),e("ul",Ko,[e("li",{class:ee([K("/program-templates"),"list-group-item"])},[e("button",{onClick:u[4]||(u[4]=r=>f("/program-templates","assembly")),class:"dropdown-item",role:"button"},u[17]||(u[17]=[e("span",{class:"fas fa-fw fa-file-video"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Program Templates",-1)]))],2),e("li",{class:ee([K("/channels"),"list-group-item"])},[e("button",{onClick:u[5]||(u[5]=r=>f("/channels","assembly")),class:"dropdown-item",role:"button"},u[18]||(u[18]=[e("span",{class:"fas fa-fw fa-tv"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Channels",-1)]))],2)])])]),e("ul",Qo,[e("li",Jo,[u[21]||(u[21]=e("a",{href:"#",class:"nav-link dropdown-toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#themes","aria-expanded":"false","aria-controls":"themes"},[e("span",{class:"fas fa-fw fa-wand-sparkles"}),e("span",{class:"d-none d-md-inline ms-1"},"Themes")],-1)),e("ul",Xo,[e("li",Zo,[A.bsTheme==="dark"?(t(),s("button",{key:0,onClick:u[6]||(u[6]=r=>T("light")),class:"dropdown-item"},u[19]||(u[19]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Dark Mode ")]))):(t(),s("button",{key:1,onClick:u[7]||(u[7]=r=>T("dark")),class:"dropdown-item"},u[20]||(u[20]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Light Mode ")])))]),(t(!0),s(H,null,N(A.bootswatch.themes,r=>(t(),s("li",{class:ee([{active:A.currentTheme===r.cssCdn},"list-group-item"])},[e("button",{onClick:d=>i(r.cssCdn),class:"dropdown-item"},c(r.name),9,ea)],2))),256))])]),e("li",ta,[e("a",sa,[e("div",oa,[u[22]||(u[22]=e("div",{class:"fas fa-fw fa-user-cog me-1"},null,-1)),e("div",aa,c(o(D).name),1)])]),e("ul",la,[e("li",na,[e("button",{onClick:u[8]||(u[8]=r=>$()),class:"dropdown-item"},u[23]||(u[23]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Y("Logout ")]))])])])])])]),e("button",{id:"sideNavToggler",onClick:y,"data-bs-target":"#sideNav","data-bs-toggle":"collapse",class:ee([[W.value?"btn-primary":"btn-outline-primary"],"btn btn-sm fixed-bottom z-3 p-0 ms-1 mb-1"]),style:{width:"2rem",height:"2rem"}},[W.value?(t(),s("span",ra)):(t(),s("span",ia))],2)])}}},ua={class:"footer sticky-bottom"},ca={class:"d-sm-block navbar navbar-dark bg-dark bg-gradient1 py-1"},ma={class:"container-md"},fa={class:"navbar-text small p-0"},pa={__name:"bottomNav",props:{appName:{type:String,default:"SCH2"}},setup(n){tt();const v=Me("$config"),x=$e().user;let D=new Date().getFullYear();const P=ge({user:x,username:x?x.nameFull:"Guest",copyright:`2020-${D} ${v.appName}`});return me(async()=>{}),(Q,j)=>(t(),s("footer",ua,[e("div",ca,[e("div",ma,[e("span",fa,"©"+c(P.copyright),1)])])]))}},va={props:{showProgress:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},maxMessages:{type:Number,default:5},timeOut:{type:Number,default:3e3},closeable:{type:Boolean,default:!0}},data(){return{messages:[],count:0}},created(){et.$on("toast-message",this.handleMessageEvent)},methods:{handleMessageEvent(n){n.message&&this.addMessage(n.title,n.message,n.type,n.options)},async addMessage(n,v,k,x={}){var _={id:this.count++,title:n,message:v,type:k,showProgress:this.showProgress,timeOut:this.timeOut,closeable:this.closeable,rtl:this.rtl,progress:0,paused:!1,animationFrame:null};_=Object.assign({},_,x),this.messages.unshift(_),this.messages.length>this.maxMessages&&this.messages.splice(this.maxMessages),_.timeOut>0&&await this.startTimeout(_)},async startTimeout(n,v=0){const k=this,x=performance.now(),_=async()=>{n.animationFrame=requestAnimationFrame(async D=>{const P=D+v-x;if(!k.exists(n)||n.paused){cancelAnimationFrame(n.animationFrame);return}else if(P<n.timeOut){const Q=P/n.timeOut;n.progress=Q,await _()}else{n.progress=1,cancelAnimationFrame(n.animationFrame),k.remove(n);return}})};await _()},pauseProgress(n){n.timeOut<=0||(n.paused=!0)},async resumeProgress(n){n.timeOut<=0||(n.paused=!1,await this.startTimeout(n,n.timeOut*n.progress))},getCurrentProgress(n){return Math.round(n.progress*100)===100?100:n.progress*100},getIconClass(n){const v=n.type;let k="";switch(v){case"success":k="fas fa-fw fa-circle-check";break;case"info":k="fas fa-fw fa-circle-info";break;case"warning":k="fas fa-fw fa-circle-exclamation";break;case"danger":k="fas fa-fw fa-triangle-exclamation";break}let x=k;return n.rtl?"icon-right "+x:"icon-left "+x},async remove(n){const v=this.messages.findIndex(k=>k.id===n.id);this.messages.splice(v,1),typeof n.onClose=="function"&&await n.onClose()},exists(n){return this.messages.findIndex(k=>k.id===n.id)!==-1}}},ga={"aria-live":"polite","aria-atomic":"true",class:"position-static"},ba=["onMouseover","onMouseout"],ya={class:"me-auto text-white"},$a=["onClick"],ha={class:"toast-body"},wa=["innerHTML"],_a={key:0,class:"progress m-1",style:{height:"4px"}};function ka(n,v,k,x,_,D){return t(),ve(be,null,{default:F(()=>[e("div",ga,[z(ke,{class:"toast-container top-0 end-0 p-3",name:"toast",tag:"div",appear:""},{default:F(()=>[(t(!0),s(H,null,N(_.messages,P=>(t(),s("div",{key:P.id,class:ee(["toast show mb-2 ms-auto",`border-${P.type}`]),role:"alert","aria-live":"assertive","aria-atomic":"true",onMouseover:Q=>D.pauseProgress(P),onMouseout:Q=>D.resumeProgress(P)},[e("div",{class:ee(["toast-header",`bg-${P.type}`])},[e("strong",ya,[e("i",{class:ee([D.getIconClass(P),"me-1"])},null,2),Y(c(P.title),1)]),P.closeable?(t(),s("button",{key:0,type:"button",class:"mr-2 mb-1 btn-close","data-dismiss":"toast","aria-label":"Close",onClick:Q=>D.remove(P)},v[0]||(v[0]=[e("span",{"aria-hidden":"true"},null,-1)]),8,$a)):L("",!0)],2),e("div",ha,[e("div",{innerHTML:P.message},null,8,wa)]),P.timeOut>0&&P.showProgress?(t(),s("div",_a,[e("div",{class:ee(`bg-${P.type}`),style:dt({width:D.getCurrentProgress(P)+"%"})},null,6)])):L("",!0)],42,ba))),128))]),_:1})])]),_:1})}const Sa=xe(va,[["render",ka],["__scopeId","data-v-5272bd9a"]]),Ta={name:"AdminLayout",components:{TopNav:Do,SideNav:da,BottomNav:pa},inject:["$config"],mounted(){this.$config,document.title="Administrator"}},Ia={class:"d-flex flex-row flex-nowrap vh-100"};function Ma(n,v,k,x,_,D){const P=ae("Toasts"),Q=ae("SideNav"),j=ae("router-view"),S=ae("DialogsWrapper");return t(),s("div",Ia,[z(P),z(Q),z(j,{class:"d-flex flex-column w-100 h-100"}),z(S)])}const xa=xe(Ta,[["render",Ma]]),Ca={class:"mt-2 container overflow-y-auto"},Va={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Pa=["innerHTML"],Oa={class:"row gx-xxl-0 mb-2"},Aa={class:"col-xxl-5"},La={class:""},Ua=["id"],Ha={key:1,class:"card card-header bg-warning-subtle mb-2"},Da={class:"col-xxl-7 overflow-x-auto mt-xxl-0"},Ea={class:"p-2"},qa={class:"d-flex flex-row justify-content-between"},Ba=["src"],Na={class:"badge bg-info"},Ra={class:"overflow-x-auto"},Fa={class:"d-flex flex-row"},za={class:"me-2 px-2 border-end border-secondary",style:{width:"10rem"}},Ga={class:"text-center"},ja=["src"],Ya=["data-bs-title"],Wa={class:"border-bottom text-end mt-1"},Ka={class:"text-nowrap"},Qa={key:0,class:"badge bg-warning mb-1"},Ja={class:""},Xa={class:"badge bg-info me-1"},Za={__name:"Index",props:{urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,isDirty:_,validations:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,generateReturnUrl:i,security:T}=ye({appTitle:"ARC AIO",pageTitle:"Dashboard"});Me("$config"),$e().user;const W=ge({item:null});fe("805630ed-f288-4f2f-83a4-6c71312f6970"),fe(),me(async()=>{await y(),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(p=>new pt(p))}),Ae(()=>{W.item.forEach(M=>{M.hls&&(M.hls.stopLoad(),M.hls.destroy())})});const X=async()=>{const M=W;if(!x.value)try{x.value=!0;const p="/api/v1/epg/";M.item=[],await G.get(p).then(u=>{M.item=u.data}),M.item.forEach(u=>{K(u)})}catch(p){j.value=le.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{x.value=!1}},m=async()=>{if(confirm("Are you sure you want to Reset All Data?"))try{await G.get("/api/v1/channels/reset/").then(u=>{B.success("Reset All Data","Reset data was successful.")})}catch(p){j.value=le.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{x.value=!1}},y=async()=>{await X()},K=M=>{if(M.manifestUrl&&Hls.isSupported()){f(M);var p=document.getElementById(`video-${M.id}`);if(!p)return;M.hls&&(M.hsl.stopLoad(),M.hls.destroy());let u=M.manifestUrl;M.hls=le.createHlsStream(p,u);return}},f=M=>{M.outputs&&M.outputs.forEach(u=>{if(u.hls){debugger;u.hls.detachMedia(),u.hls.destroy(),delete u.hls}u.playbackConfigurations.forEach(b=>{if(b.hls){debugger;b.hls.detachMedia(),b.hls.destroy(),delete b.hls}})})};return(M,p)=>{const u=ae("PageHeader"),b=ae("router-link");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(u,{"page-icon":"fas fa-fw fa-dashboard",pageTitle:o(k)},{default:F(()=>[e("div",null,[e("button",{onClick:p[0]||(p[0]=r=>m()),class:"ms-2 btn btn-danger"},p[2]||(p[2]=[e("span",{class:"fas fa-fw fa-recycle me-1"},null,-1),Y("Reset All Data ")])),e("button",{onClick:p[1]||(p[1]=r=>y()),class:"ms-2 btn btn-secondary"},p[3]||(p[3]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)]))])]),_:1},8,["pageTitle"]),e("div",Ca,[o(j)?(t(),s("div",Va,[p[4]||(p[4]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:JSON.stringify(o(j))},null,8,Pa)])):L("",!0),(t(!0),s(H,null,N(W.item,r=>(t(),s("div",null,[e("div",Oa,[e("div",Aa,[e("div",La,[r.manifestUrl?(t(),s("video",{key:0,id:`video-${r.id}`,controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-scale align-middle"},null,8,Ua)):(t(),s("div",Ha," Channel not yet published "))])]),e("div",Da,[e("div",Ea,[e("div",qa,[e("div",null,[e("h4",null,[e("img",{src:r.logo,class:"img-fluid me-2",style:{height:"3rem"}},null,8,Ba),z(b,{to:`${n.urlViewChannel}/${r.id}/${o(i)()}`},{default:F(()=>[Y(c(r.title),1)]),_:2},1032,["to"])])]),e("div",null,[e("span",Na,c(r.playbackMode),1)])]),e("div",Ra,[e("div",Fa,[(t(!0),s(H,null,N(r.programs,d=>(t(),s("div",za,[e("div",Ga,[e("img",{src:d.image,class:"img-fluid border",style:{height:"64px"}},null,8,ja)]),e("div",{class:"text-truncate border-bottom","data-bs-toggle":"tooltip","data-bs-placement":"bottom","data-bs-title":d.title},c(d.title),9,Ya),r.playbackMode==="LINEAR"?(t(),s(H,{key:0},[e("div",Wa,[e("div",null,[e("small",Ka,c(o(le).moment(d.since).format("lll")),1)]),e("div",null,[e("small",null,c(o(le).moment(d.till).format("lll")),1)])]),o(le).moment().isAfter(d.since)&&o(le).moment().isBefore(d.till)?(t(),s("span",Qa,"Now Playing")):L("",!0)],64)):L("",!0),e("div",Ja,[(t(!0),s(H,null,N(d.genres,l=>(t(),s("span",Xa,c(l),1))),256))])]))),256))])])])])])]))),256))])])]),_:1})}}};function Ue(n){if(!n.cacheKey)throw Error("Cache Key required.");if(!n.baseUrl)throw Error("Base Url required.");const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,closeWithReturnUrl:B,generateReturnUrl:A,security:i}=ye({appTitle:n.appTitle,pageTitle:n.pageTitle}),T=JSON.parse(JSON.stringify(n.filter));T.pageIndex=T.pageIndex||1,T.pageSize=T.pageSize||5,T.sortField=T.sortField||"",T.sortOrder=T.sortOrder||1,T.updateUrl=T.updateUrl||!1,T.items=T.items||[],T.query=T.query||{},T.query.criteria=T.query.criteria||"";const $=fe(T),W=()=>{var r;if(x.value){console.log("Paginated search is currently busy.");return}const p=JSON.parse(localStorage.getItem(n.cacheKey))||{},u=new URLSearchParams(window.location.search),b=$.value;b.query.criteria=u.get("c")||p.criteria||b.query.criteria||"",b.pageIndex=parseInt(u.get("p"),10)||p.pageIndex||b.pageIndex||1,b.pageSize=parseInt(u.get("s"),10)||p.pageSize||b.pageSize||5,b.sortField=u.get("sf")||p.sortField||b.sortField||"",b.sortOrder=parseInt(u.get("so"),10)||p.sortOrder||b.sortOrder||1,b.visible=p.visible||b.visible,(r=n.initializeFilter)==null||r.call(n,$,n.cacheKey)},X=()=>{if(n.getQuery)return n.getQuery($.value);{const p=$.value;return["?c=",encodeURIComponent(p.query.criteria),"&p=",p.pageIndex,"&s=",p.pageSize,"&sf=",p.sortField,"&so=",p.sortOrder].join("")}},m=()=>{if(n.saveQuery)n.saveQuery($.value,n.cacheKey);else{const p=$.value;localStorage.setItem(n.cacheKey,JSON.stringify({criteria:p.query.criteria,pageIndex:p.pageIndex,pageSize:p.pageSize,sortField:p.sortField,sortOrder:p.sortOrder,visible:p.visible}))}};return{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,closeWithReturnUrl:B,generateReturnUrl:A,security:i,filter:$,initializeFilter:W,getQuery:X,saveQuery:m,search:async p=>{var b;let u=$.value;if(x.value){console.log("Paginated search is currently busy.");return}p>0&&(u.pageIndex=p);try{x.value=!0,P.value="";const r=X();u.selected=null,await j(`${n.baseUrl}/${r}`).then(async d=>{var a;Array.isArray(d.data)?u.items=d.data:u=Object.assign(u,d.data);let l=location.pathname;l.endsWith("/")?l+=r:l+="/"+r,u.updateUrl&&window.history.replaceState(r,`${v}-search`,l),u.items.forEach(U=>{U.expand=!1}),m(),(a=n.successAction)==null||a.call(n,$.value)})}catch(r){if(localStorage.removeItem(n.cacheKey),n.failAction)n.failAction(r);else{const d=S.getErrorMessageAsHtml(r);P.value=d,G.error("Error Occured",d)}}finally{x.value=!1,(b=n.finalAction)==null||b.call(n)}},getRowNumber:p=>{const u=$.value;return(u.pageIndex-1)*u.pageSize+(p+1)},setSelected:p=>{const u=$.value;u.selected&&p&&u.selected===p?u.selected=null:(u.selected&&(u.selected.expand=!1),u.selected=p,u.selected.expand=!0)},isSelected:p=>{const u=$.value;return p===null||u.selected===null?!1:p===u.selected}}}const el=["disabled"],tl={class:"row row-cols-1 row-cols-sm-3"},sl={class:"col"},ol={class:"form-floating mb-2"},al={key:0,class:"d-block invalid-feedback"},ll={class:"col"},nl={class:"form-floating"},rl={class:"col"},il={class:"form-floating"},dl={class:"col"},ul={class:"form-floating mb-2"},cl={class:"row row-cols-1 row-cols-sm-2"},ml={class:"col-sm-8"},fl={class:"ps-2"},pl={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border"},vl={class:"col"},gl={class:"form-check"},bl=["onUpdate:modelValue","id"],yl=["for"],$l={class:"col-sm-4"},hl={class:"border p-2"},wl={class:"form-check"},_l=["onUpdate:modelValue","id"],kl=["for"],Sl={class:"table-responsive mt-2"},Tl={class:"text-end"},Il={class:"table table-sm mb-0 mt-2"},Ml={class:"align-middle"},xl={class:"text-center"},Cl=["onUpdate:modelValue"],Vl=["onUpdate:modelValue"],Pl=["onUpdate:modelValue"],Ol={class:"text-start"},Al=["onClick"],Ll={__name:"add",props:{urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Video"}),A=n,i=ge({lookups:{genres:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}]},durationTime:"00:00:00",item:{title:"Video # ",description:null,durationInMillis:12e4,dateReleased:S.moment().format("YYYY-MM-DD"),formats:[]}}),T={item:{title:{title:ne.withMessage("Title is required.",ie),$autoDirty:!0,$lazy:!0},durationInMillis:{title:ne.withMessage("Duration is required.",ie),$autoDirty:!0,$lazy:!0},dateReleased:{title:ne.withMessage("Date Released is required.",ie),$autoDirty:!0,$lazy:!0}}},$=Se(T,i),W=Ie(()=>{const f=S.moment;if(i.durationTime&&i.durationTime!=="00:00:00"&&S.isValidTime(i.durationTime)){const M=f().startOf("day"),p=M.format("YYYY-MM-DD ")+i.durationTime,b=f(p).subtract(M);return i.item.durationInMillis=b.valueOf(),i.item.durationInMillis}return 0});me(async()=>{await m()});const X=async()=>{const f=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const p=S.clone(f.item);p.durationInMillis=W.value;const u=S.moment(f.item.dateReleased).utc(!0).format();p.dateReleased=u;const b=i.lookups.genres.filter(d=>d.selected).map(d=>d.id);p.genres=b;const r=i.lookups.categories.filter(d=>d.selected).map(d=>d.id);p.categories=r;debugger;await j.post("/api/v1/videos/",p).then(d=>{G.success("Add Video","Video added",{onClose:async()=>{const l=`${A.urlView}/${d.data}`;await Q.push(l)}})})}catch(p){P.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{x.value=!1}},m=async()=>{try{await j.get("/api/v1/lookups/video-genres/").then(f=>{const p=f.data.filter(u=>u.id!==0);i.lookups.genres=p})}catch(f){P.value=S.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},y=()=>{const f={format:"HLS",serverUrl:"https://media-tailor-output.s3.us-west-2.amazonaws.com",path:"/ads/10seconds/10seconds.m3u8"};i.item.formats.push(f)},K=f=>{i.item.formats.splice(f,1)};return(f,M)=>{const p=ae("router-link"),u=ae("PageHeader"),b=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(u,{"page-icon":"fas fa-fw fa-video",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:M[0]||(M[0]=r=>X()),class:"btn btn-primary"},M[6]||(M[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,el),z(p,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:F(()=>M[7]||(M[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(b,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[e("div",null,[e("div",tl,[e("div",sl,[e("div",ol,[R(e("input",{"onUpdate:modelValue":M[1]||(M[1]=r=>i.item.title=r),id:"name",class:ee([o(S).getValidFeedbackCss(i.item.title),"form-control"]),placeholder:"Title"},null,2),[[te,i.item.title]]),M[8]||(M[8]=e("label",{for:"title",class:""},"Title",-1)),o($).item.title.$error?(t(),s("div",al,[(t(!0),s(H,null,N(o($).item.title.$errors,r=>(t(),s("div",{key:r.$uid},c(r.$message),1))),128))])):L("",!0)])]),e("div",ll,[e("div",nl,[R(e("input",{"onUpdate:modelValue":M[2]||(M[2]=r=>i.item.dateReleased=r),type:"date",step:"1",id:"dateReleased",class:ee([o(S).getValidFeedbackCss(i.item.dateReleased),"form-control"])},null,2),[[te,i.item.dateReleased]]),M[9]||(M[9]=e("label",{for:"dateReleased",class:""},"Date Released",-1))])]),e("div",rl,[e("div",il,[R(e("input",{"onUpdate:modelValue":M[3]||(M[3]=r=>i.durationTime=r),type:"time",step:"1",id:"durationTime",class:ee([o(S).getValidFeedbackCss(i.item.durationTime),"form-control"])},null,2),[[te,i.durationTime]]),M[10]||(M[10]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",dl,[e("div",ul,[R(e("textarea",{"onUpdate:modelValue":M[4]||(M[4]=r=>i.item.description=r),id:"name",class:ee([o(S).getValidFeedbackCss(i.item.description),"form-control"]),placeholder:"Description",style:{height:"5rem"}},null,2),[[te,i.item.description]]),M[11]||(M[11]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",cl,[e("div",ml,[M[12]||(M[12]=e("b",null,"Genres",-1)),e("div",fl,[e("div",pl,[(t(!0),s(H,null,N(i.lookups.genres,r=>(t(),s("div",vl,[e("div",gl,[R(e("input",{"onUpdate:modelValue":d=>r.selected=d,class:"form-check-input",type:"checkbox",id:r.name},null,8,bl),[[De,r.selected]]),e("label",{class:"form-check-label",for:r.name},c(r.name),9,yl)])]))),256))])])]),e("div",$l,[M[13]||(M[13]=e("b",null,"Categories",-1)),e("div",hl,[(t(!0),s(H,null,N(i.lookups.categories,r=>(t(),s("div",wl,[R(e("input",{"onUpdate:modelValue":d=>r.selected=d,class:"form-check-input",type:"checkbox",id:r.name},null,8,_l),[[De,r.selected]]),e("label",{class:"form-check-label",for:r.name},c(r.name),9,kl)]))),256))])])]),e("div",Sl,[e("div",Tl,[e("button",{onClick:M[5]||(M[5]=r=>y()),class:"btn btn-outline-primary btn-sm"},M[14]||(M[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",Il,[M[17]||(M[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(H,null,N(i.item.formats,(r,d)=>(t(),s("tr",Ml,[e("td",xl,c(d+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":l=>r.format=l,class:"form-control"},M[15]||(M[15]=[e("option",{value:"HLS"},"HLS",-1),e("option",{value:"HLS"},"DASH",-1)]),8,Cl),[[pe,r.format]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":l=>r.serverUrl=l,type:"text",class:"form-control"},null,8,Vl),[[te,r.serverUrl]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":l=>r.path=l,type:"text",class:"form-control"},null,8,Pl),[[te,r.path]])]),e("td",Ol,[e("button",{onClick:l=>K(d),class:"btn btn-outline-warning btn-sm"},M[16]||(M[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Al)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Ul=["disabled"],Hl={class:"row row-cols-1 row-cols-sm-3"},Dl={class:"col"},El={class:"form-floating mb-2"},ql={key:0,class:"d-block invalid-feedback"},Bl={class:"col"},Nl={class:"form-floating"},Rl={class:"col"},Fl={class:"form-floating"},zl={class:"col"},Gl={class:"form-floating mb-2"},jl={class:"row row-cols-1 row-cols-sm-2"},Yl={class:"col-sm-8"},Wl={class:"ps-2"},Kl={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border"},Ql={class:"col"},Jl={class:"form-check"},Xl=["onUpdate:modelValue","id"],Zl=["for"],en={class:"col-sm-4"},tn={class:"border p-2"},sn={class:"form-check"},on=["onUpdate:modelValue","id"],an=["for"],ln={class:"table-responsive mt-2"},nn={class:"text-end"},rn={class:"table table-sm mb-0 mt-2 border1"},dn={class:"align-middle"},un={class:"text-center"},cn=["onUpdate:modelValue"],mn=["value"],fn=["onUpdate:modelValue"],pn=["onUpdate:modelValue"],vn={class:"text-end"},gn=["onClick"],bn={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Edit Video"}),A=n,i=ge({lookups:{genres:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}],formats:[]},durationTime:"00:00:00",item:{title:null,description:null,rawBaseUrl:null,rawPath:null,hlsBaseUrl:null,hlsPath:null,durationInMillis:null,formats:[]}}),T={item:{title:{title:ne.withMessage("title is required.",ie),$autoDirty:!0,$lazy:!0},durationInMillis:{title:ne.withMessage("durationInMillis is required.",ie),$autoDirty:!0,$lazy:!0},dateReleased:{title:ne.withMessage("Date Released is required.",ie),$autoDirty:!0,$lazy:!0}}},$=Se(T,i),W=Ie(()=>{const p=S.moment;if(i.durationTime&&i.durationTime!=="00:00:00"&&S.isValidTime(i.durationTime)){const u=p().startOf("day"),b=u.format("YYYY-MM-DD ")+i.durationTime,d=p(b).subtract(u);return i.item.durationInMillis=d.valueOf(),i.item.durationInMillis}return 0});me(async()=>{await m(),await y(),await X()});const X=async()=>{try{await j.get(`/api/v1/videos/${A.id}/`).then(p=>{i.item=p.data;const u=S.moment(i.item.dateReleased).format("YYYY-MM-DD");i.item.dateReleased=u;const b=i.lookups.genres,r=i.item.genres.map(a=>a.genre);b.forEach(a=>{a.selected=r.includes(a.id)});const d=i.lookups.categories,l=i.item.categories.map(a=>a.category);d.forEach(a=>{a.selected=l.includes(a.id)})})}catch(p){P.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}},m=async()=>{try{await j.get("/api/v1/lookups/video-genres/").then(p=>{const b=p.data.filter(r=>r.id!==0);i.lookups.genres=b})}catch(p){P.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}},y=async()=>{try{await j.get("/api/v1/lookups/video-formats/").then(p=>{const b=p.data.filter(r=>r.id!==0);i.lookups.formats=b})}catch(p){P.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}},K=async()=>{const p=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const b=S.clone(p.item);b.durationInMillis=W.value;const r=S.moment(p.item.dateReleased).utc(!0).format();b.dateReleased=r;const d=i.lookups.genres.filter(a=>a.selected).map(a=>a.id);b.genres=d;const l=i.lookups.categories.filter(a=>a.selected).map(a=>a.id);b.categories=l;debugger;await j.put("/api/v1/videos/",b).then(a=>{G.success("Edit Video","Video edited.",{onClose:async()=>{const U=`${A.urlView}/${A.id}`;await Q.push(U)}})})}catch(b){P.value=S.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{x.value=!1}},f=()=>{const p={format:"HLS",serverUrl:"https://media-tailor-input.s3.us-west-2.amazonaws.com",path:"/sony-poc/vod-1/bbb_2mins.m3u8"};i.item.formats.push(p)},M=p=>{i.item.formats.splice(p,1)};return(p,u)=>{const b=ae("router-link"),r=ae("PageHeader"),d=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(r,{"page-icon":"fas fa-fw fa-video",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:u[0]||(u[0]=l=>K()),class:"btn btn-primary"},u[6]||(u[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Ul),e("button",{onClick:X,class:"btn btn-secondary ms-2"},u[7]||(u[7]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(b,{to:`${n.urlView}/${n.id}`,class:"btn btn-secondary ms-2"},{default:F(()=>u[8]||(u[8]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(d,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[e("div",null,[e("div",Hl,[e("div",Dl,[e("div",El,[R(e("input",{"onUpdate:modelValue":u[1]||(u[1]=l=>i.item.title=l),id:"name",class:ee([o(S).getValidFeedbackCss(i.item.title),"form-control"]),placeholder:"Title"},null,2),[[te,i.item.title]]),u[9]||(u[9]=e("label",{for:"title",class:""},"Title",-1)),o($).item.title.$error?(t(),s("div",ql,[(t(!0),s(H,null,N(o($).item.title.$errors,l=>(t(),s("div",{key:l.$uid},c(l.$message),1))),128))])):L("",!0)])]),e("div",Bl,[e("div",Nl,[R(e("input",{"onUpdate:modelValue":u[2]||(u[2]=l=>i.item.dateReleased=l),type:"date",step:"1",id:"dateReleased",class:ee([o(S).getValidFeedbackCss(i.item.dateReleased),"form-control"])},null,2),[[te,i.item.dateReleased]]),u[10]||(u[10]=e("label",{for:"dateReleased",class:""},"Duration Time",-1))])]),e("div",Rl,[e("div",Fl,[R(e("input",{"onUpdate:modelValue":u[3]||(u[3]=l=>i.durationTime=l),type:"time",step:"1",id:"durationTime",class:ee([o(S).getValidFeedbackCss(i.item.ddurationTime),"form-control"])},null,2),[[te,i.durationTime]]),u[11]||(u[11]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",zl,[e("div",Gl,[R(e("textarea",{"onUpdate:modelValue":u[4]||(u[4]=l=>i.item.description=l),id:"name",class:"form-control is-valid",placeholder:"Description",style:{height:"5rem"}},null,512),[[te,i.item.description]]),u[12]||(u[12]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",jl,[e("div",Yl,[u[13]||(u[13]=e("b",null,"Genres",-1)),e("div",Wl,[e("div",Kl,[(t(!0),s(H,null,N(i.lookups.genres,l=>(t(),s("div",Ql,[e("div",Jl,[R(e("input",{"onUpdate:modelValue":a=>l.selected=a,class:"form-check-input",type:"checkbox",id:l.name},null,8,Xl),[[De,l.selected]]),e("label",{class:"form-check-label",for:l.name},c(l.name),9,Zl)])]))),256))])])]),e("div",en,[u[14]||(u[14]=e("b",null,"Categories",-1)),e("div",tn,[(t(!0),s(H,null,N(i.lookups.categories,l=>(t(),s("div",sn,[R(e("input",{"onUpdate:modelValue":a=>l.selected=a,class:"form-check-input",type:"checkbox",id:l.name},null,8,on),[[De,l.selected]]),e("label",{class:"form-check-label",for:l.name},c(l.name),9,an)]))),256))])])]),e("div",ln,[e("div",nn,[e("button",{onClick:u[5]||(u[5]=l=>f()),class:"btn btn-outline-primary btn-sm"},u[15]||(u[15]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",rn,[u[17]||(u[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(H,null,N(i.item.formats,(l,a)=>(t(),s("tr",dn,[e("td",un,c(a+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":U=>l.format=U,class:"form-control"},[(t(!0),s(H,null,N(i.lookups.formats,U=>(t(),s("option",{value:U.id},c(U.name),9,mn))),256))],8,cn),[[pe,l.format]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":U=>l.serverUrl=U,type:"text",class:"form-control"},null,8,fn),[[te,l.serverUrl]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":U=>l.path=U,type:"text",class:"form-control"},null,8,pn),[[te,l.path]])]),e("td",vn,[e("button",{onClick:U=>M(a),class:"btn btn-outline-warning btn-sm"},u[16]||(u[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,gn)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},yn={class:"ms-2"},$n={class:"input-group"},hn=["value"],wn={class:"ms-1"},_n={class:"input-group"},kn={class:"ms-1"},Sn={class:"input-group"},Tn={class:"table-responsive border shadow-sm"},In={class:"table table-hover mb-0"},Mn=["textContent"],xn={class:"d-flex flex-column flex-md-row justify-content-start"},Cn={class:"mt-1"},Vn=["src"],Pn={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},On={class:"ms-md-2"},An={key:0},Ln={class:"badge bg-primary me-1"},Un={key:1},Hn={class:"badge bg-info me-1"},Dn={class:"text-center"},En={class:"text-end"},qn=["onClick"],Bn={key:0,class:"fas fa-fw fa-chevron-circle-up"},Nn={key:1,class:"fas fa-fw fa-chevron-circle-down"},Rn={key:0},Fn={colspan:"999"},zn={class:""},Gn={class:"d-flex flex-column flex-md-row justify-content-start"},jn={class:"col mb-2"},Yn={class:"col col-lg-auto mx-lg-5 px-lg-5 mb-2"},Wn={class:"col col-lg-auto mb-2"},Kn={key:0},Qn={class:"badge bg-secondary me-1"},Jn="/api/v1/videos/search",Xn={__name:"index",props:{urlAdd:{type:String,default:"/videos/add"},urlView:{type:String,default:"/videos/view"}},setup(n){Me("$config");const k=$e().user,{appTitle:x,pageTitle:_,busy:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,security:i,filter:T,initializeFilter:$,getQuery:W,saveQuery:X,search:m,getRowNumber:y,setSelected:K,isSelected:f}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Videos",cacheKey:`${k==null?void 0:k.userId}/videos/search`,baseUrl:Jn,filter:{updateUrl:!0,lookups:{genres:[]},query:{genre:0,category:0}},initializeFilter:(p,u)=>{const b=p.value,r=new URLSearchParams(window.location.search),d=JSON.parse(localStorage.getItem(u))||{};b.query.genre=r.get("genre")||d.genre||b.query.genre||0,b.query.category=r.get("category")||d.category||b.query.category||0},getQuery:p=>["?c=",encodeURIComponent(p.query.criteria),"&p=",p.pageIndex,"&s=",p.pageSize,"&sf=",p.sortField,"&so=",p.sortOrder,"&genre=",p.query.genre,"&category=",p.query.category].join(""),saveQuery:(p,u)=>{localStorage.setItem(u,JSON.stringify({criteria:p.query.criteria,pageIndex:p.pageIndex,pageSize:p.pageSize,sortField:p.sortField,sortOrder:p.sortOrder,visible:p.visible,genre:p.query.genre,category:p.query.category}))}});me(async()=>{$(),await M(),await m()});const M=async()=>{try{await G.get("/api/v1/lookups/video-genres/").then(p=>{const u=p.data;T.value.lookups.genres=u})}catch(p){j.value=le.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}};return(p,u)=>{const b=ae("router-link"),r=ae("PageHeader"),d=ae("m-pagination"),l=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(r,{"page-icon":"fas fa-fw fa-video",pageTitle:o(_)},{default:F(()=>[z(b,{to:n.urlAdd,class:"btn btn-primary"},{default:F(()=>u[5]||(u[5]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",yn,[e("div",$n,[u[6]||(u[6]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),R(e("select",{"onUpdate:modelValue":u[0]||(u[0]=a=>o(T).query.genre=a),class:"form-select"},[(t(!0),s(H,null,N(o(T).lookups.genres,a=>(t(),s("option",{value:a.id},c(a.name),9,hn))),256))],512),[[pe,o(T).query.genre]])])]),e("div",wn,[e("div",_n,[u[8]||(u[8]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),R(e("select",{"onUpdate:modelValue":u[1]||(u[1]=a=>o(T).query.category=a),class:"form-select"},u[7]||(u[7]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[pe,o(T).query.category]])])]),e("div",kn,[e("div",Sn,[R(e("input",{"onUpdate:modelValue":u[2]||(u[2]=a=>o(T).query.criteria=a),onKeyup:u[3]||(u[3]=Le(a=>o(m)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[te,o(T).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:u[4]||(u[4]=a=>o(m)(1))},u[9]||(u[9]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(l,{errorMessage:o(j)},{default:F(()=>[e("div",Tn,[e("table",In,[u[14]||(u[14]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title"),e("th",{class:"text-center"},"Duration"),e("th")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o(T).items,(a,U)=>(t(),s(H,{key:a.videoId},[e("tr",null,[e("td",{textContent:c(o(y)(U)),class:"text-center"},null,8,Mn),e("td",null,[e("div",xn,[e("div",null,[a.thumbnails.length>0?(t(!0),s(H,{key:0},N(a.thumbnails,I=>(t(),s("div",Cn,[e("img",{src:I.url,class:"img-fuild border",width:"128"},null,8,Vn)]))),256)):(t(),s("img",Pn))]),e("div",On,[z(b,{to:`${n.urlView}/${a.videoId}`,class:"d-inline-block text-wrap link-offset-2"},{default:F(()=>[Y(c(a.title),1)]),_:2},1032,["to"]),e("div",null,[a.categories.length>0?(t(),s("div",An,[(t(!0),s(H,null,N(a.categories,I=>(t(),s("span",Ln,c(I.categoryName),1))),256))])):L("",!0),a.genres.length>0?(t(),s("div",Un,[(t(!0),s(H,null,N(a.genres,I=>(t(),s("span",Hn,c(I.genreName),1))),256))])):L("",!0)])])])]),e("td",Dn,c(o(le).moment.utc(a.durationInMillis).format("HH:mm:ss")),1),e("td",En,[e("button",{onClick:I=>a.expand=!a.expand,class:ee([[a.expand?"btn-primary":"btn-outline-primary"],"btn btn-sm"])},[a.expand?(t(),s("span",Bn)):(t(),s("span",Nn))],10,qn)])]),a.expand?(t(),s("tr",Rn,[u[13]||(u[13]=e("td",null,null,-1)),e("td",Fn,[e("div",zn,[e("div",Gn,[e("div",jn,[u[10]||(u[10]=e("label",{class:"form-label"},"Description",-1)),e("div",null,c(a.description),1)]),e("div",Yn,[u[11]||(u[11]=e("label",{class:"form-label"},"Date Released",-1)),e("div",null,c(o(rt).utc(a.dateReleased).format("l")),1)]),e("div",Wn,[u[12]||(u[12]=e("label",{class:"form-label"},"Formats",-1)),a.formats.length>0?(t(),s("div",Kn,[(t(!0),s(H,null,N(a.formats,I=>(t(),s("span",Qn,c(I.formatName),1))),256))])):L("",!0)])])])])])):L("",!0)],64))),128))]),_:1},512),[[_e,o(T).items.length>0]])])]),z(d,{filter:o(T),search:o(m),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Zn={key:0},er={class:"nav nav-tabs",id:"myTab",role:"tablist"},tr={class:"nav-item",role:"presentation"},sr={class:"nav-item",role:"presentation"},or={class:"nav-item",role:"presentation"},ar={class:"nav-item",role:"presentation"},lr={class:"tab-content",id:"myTabContent"},nr={class:""},rr={class:"row row-cols-1 row-cols-sm-2"},ir={class:"col"},dr=["id"],ur={class:"col"},cr={class:"col"},mr={class:"form-floating mb-2"},fr={class:"row row-cols-1 row-cols-sm-2"},pr={class:"col"},vr={class:"form-floating mb-2"},gr={class:"col"},br={class:"form-floating mb-2"},yr={class:"col"},$r={class:"form-floating mb-2"},hr={class:"mt-1"},wr={class:"badge bg-info me-1"},_r={class:"badge bg-primary me-1"},kr={class:""},Sr={class:"table-responsive border"},Tr={class:"table table-hover mb-0"},Ir={class:"table-group-divider"},Mr={class:"align-middle"},xr={class:"text-center"},Cr={class:""},Vr={class:"text-end"},Pr={class:"table-responsive border mt-2"},Or={class:"table table-hover mb-0 caption-top"},Ar={class:""},Lr={class:"table-responsive"},Ur={class:"table table-hover mb-0 caption-top"},Hr={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/videos"},urlEdit:{type:String,default:"/videos/edit"},urlAddVodSource:{type:String,default:"/vod-sources/add"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(n){const v=n,{appTitle:k,pageTitle:x,busy:_,isDirty:D,validations:P,infoMessage:Q,warningMessage:j,errorMessage:S,router:G,axios:le,utils:B,toasts:A,close:i,closeWithReturnUrl:T,generateReturnUrl:$,security:W}=ye({appTitle:"Arcadian-FAST",pageTitle:"View Video"});Me("$config");const X=$e();X.user;const m=ge({user:X.user,item:null,hls:null}),y=fe();me(async()=>{await p(),y.value=B.getPageTab("video")||"information-tab"}),Ae(()=>{m.hls&&(m.hls.stopLoad(),m.hls.destroy())});const K=d=>{B.setPageTab("video",d),y.value=d},f=d=>d!==y.value?"":"active",M=d=>d!==y.value?"":"show active",p=async()=>{const d=m;if(!_.value)try{_.value=!0,S.value="",m.item=null;const l=`/api/v1/videos/${v.id}/`;await le.get(l).then(a=>{d.item=a.data,d.item.duration=B.moment.utc(d.item.durationInMillis).format("HH:mm:ss"),d.item.dateReleased=B.moment.utc(d.item.dateReleased).format("ll")}),b()}catch(l){S.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{_.value=!1}},u=async()=>{await p()},b=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?"),m.hls&&m.hls.destroy();const l=`video-${m.item.videoId}`;var d=document.getElementById(l);const a=m.item.formats.find(I=>I.formatName==="HLS"),U=a.serverUrl+a.path;m.hls=B.createHlsStream(d,U,!1),m.hls.startLoad(-1)}},r=async()=>{if(!_.value)try{_.value=!0,S.value="";const d=`/api/v1/videos/${v.id}/get-blank-frames/`;await le.post(d).then(l=>{}),_.value=!1,await u()}catch(d){S.value=B.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{_.value=!1}};return(d,l)=>{const a=ae("router-link"),U=ae("PageHeader"),I=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(U,{"page-icon":"fas fa-fw fa-video",pageTitle:o(x)},{default:F(()=>[z(a,{to:`${n.urlEdit}/${n.id}`,class:"btn btn-primary ms-1"},{default:F(()=>l[11]||(l[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:l[0]||(l[0]=g=>u()),class:"ms-2 btn btn-secondary"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:l[1]||(l[1]=g=>o(T)(v.urlMain)),class:"btn btn-secondary ms-1"},l[13]||(l[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(I,{errorMessage:o(S)},{default:F(()=>[m.item?(t(),s("div",Zn,[e("div",null,[e("ul",er,[e("li",tr,[e("button",{onClick:l[2]||(l[2]=g=>K("information-tab")),class:ee([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",sr,[e("button",{onClick:l[3]||(l[3]=g=>K("formats-tab")),class:ee([f("formats-tab"),"nav-link"]),id:"formats-tab","data-bs-toggle":"tab","data-bs-target":"#formats",type:"button",role:"tab","aria-controls":"formats","aria-selected":"false"}," Formats ",2)]),e("li",or,[e("button",{onClick:l[4]||(l[4]=g=>K("blankFrames-tab")),class:ee([f("blankFrames-tab"),"nav-link"]),id:"blankFrames-tab","data-bs-toggle":"tab","data-bs-target":"#blankFrames",type:"button",role:"tab","aria-controls":"blankFrames","aria-selected":"false"}," Blank Frames ",2)]),e("li",ar,[e("button",{onClick:l[5]||(l[5]=g=>K("vodSources-tab")),class:ee([f("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)])]),e("div",lr,[e("div",{class:ee([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",nr,[e("div",rr,[e("div",ir,[e("video",{id:`video-${m.item.videoId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,dr)]),e("div",ur,[e("div",cr,[e("div",mr,[R(e("input",{"onUpdate:modelValue":l[6]||(l[6]=g=>m.item.title=g),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[te,m.item.title]]),l[14]||(l[14]=e("label",{for:"title"},"Title",-1))])]),e("div",fr,[e("div",pr,[e("div",vr,[R(e("input",{"onUpdate:modelValue":l[7]||(l[7]=g=>m.item.dateReleased=g),type:"text",class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},null,512),[[te,m.item.dateReleased]]),l[15]||(l[15]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",gr,[e("div",br,[R(e("input",{"onUpdate:modelValue":l[8]||(l[8]=g=>m.item.duration=g),type:"text",class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},null,512),[[te,m.item.duration]]),l[16]||(l[16]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",yr,[e("div",$r,[R(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=g=>m.item.description=g),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[te,m.item.description]]),l[17]||(l[17]=e("label",{for:"description"},"Description",-1))])]),e("div",hr,[(t(!0),s(H,null,N(m.item.genres,g=>(t(),s("span",wr,c(g.genreName),1))),256)),(t(!0),s(H,null,N(m.item.categories,g=>(t(),s("span",_r,c(g.categoryName),1))),256))])])])])],2),e("div",{class:ee([M("formats-tab"),"tab-pane fade"]),id:"formats",role:"tabpanel","aria-labelledby":"formats-tab"},[e("div",kr,[e("div",Sr,[e("table",Tr,[l[18]||(l[18]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",Ir,[(t(!0),s(H,null,N(m.item.formats,(g,q)=>(t(),s("tr",Mr,[e("td",xr,c(q+1),1),e("td",null,c(g.formatName),1),e("td",null,c(g.serverUrl),1),e("td",null,c(g.path),1)]))),256))])])])])],2),e("div",{class:ee([M("blankFrames-tab"),"tab-pane fade"]),id:"blankFrames",role:"tabpanel","aria-labelledby":"blankFrames-tab"},[e("div",Cr,[e("div",null,[e("div",Vr,[e("button",{onClick:l[10]||(l[10]=g=>r()),class:"btn btn-outline-primary btn-sm"},l[19]||(l[19]=[e("span",{class:"fas fa-fw fa-gear me-1"},null,-1),Y("Process ")]))]),e("div",Pr,[e("table",Or,[l[20]||(l[20]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Start"),e("th",null,"End"),e("th",null,"Duration")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.blankFrames,(g,q)=>(t(),s("tr",{key:g.videoBlankFrameId},[e("td",null,c(q+1),1),e("td",null,c(o(B).moment.utc(g.startInMillis).format("HH:mm:ss")),1),e("td",null,c(o(B).moment.utc(g.endInMillis).format("HH:mm:ss")),1),e("td",null,c(o(B).moment.utc(g.durationInMillis).format("HH:mm:ss")),1)]))),128))]),_:1},512),[[_e,m.item.blankFrames.length>0]])])])])])],2),e("div",{class:ee([M("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",Ar,[e("div",Lr,[e("table",Ur,[l[21]||(l[21]=e("caption",null,"VOD Sources",-1)),l[22]||(l[22]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.vodSources,(g,q)=>(t(),s("tr",{key:g.vodSourceId},[e("td",null,c(q+1),1),e("td",null,[z(a,{to:`${v.urlViewVodSource}/${encodeURIComponent(g.vodSourceId)}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(g.name),1)]),_:2},1032,["to"])])]))),128))]),_:1},512),[[_e,m.item.vodSources.length>0]])])])])],2)])])])):L("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Dr=["disabled"],Er={class:"form-floating mb-2"},qr={key:0,class:"d-block invalid-feedback"},Br={__name:"add",props:{urlView:{type:String,default:"/source-groups/view"},urlMain:{type:String,default:"/source-groups"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Source Group"}),A=n,i=ge({lookups:{},item:{name:null}}),T={item:{name:{required:ne.withMessage("name is required.",ie),$autoDirty:!0,$lazy:!0}}},$=Se(T,i);me(async()=>{});const W=async()=>{const X=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const y=S.clone(X.item);await j.post("/api/v1/sourcegroups/",y).then(K=>{G.success("Add Source Group","Source group added.",{onClose:async()=>{const f=`${A.urlView}/${K.data}`;await Q.push(f)}})})}catch(y){P.value=S.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{x.value=!1}};return(X,m)=>{const y=ae("router-link"),K=ae("PageHeader"),f=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(K,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:m[0]||(m[0]=M=>W()),class:"btn btn-primary"},m[2]||(m[2]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Dr),z(y,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:F(()=>m[3]||(m[3]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(f,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[e("div",null,[e("div",Er,[R(e("input",{"onUpdate:modelValue":m[1]||(m[1]=M=>i.item.name=M),type:"text",class:ee([o(S).getValidFeedbackCss(i.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[te,i.item.name]]),m[4]||(m[4]=e("label",{for:"name"},"Name",-1)),o($).item.name.$error?(t(),s("div",qr,[(t(!0),s(H,null,N(o($).item.name.$errors,M=>(t(),s("div",{key:M.$uid},c(M.$message),1))),128))])):L("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Nr={key:0,class:"d-flex justify-content-end"},Rr=["disabled"],Fr={key:0},zr={class:"row row-cols-1 row-cols-sm-2"},Gr={class:"col"},jr={class:"form-floating mb-2"},Yr={key:0,class:"d-block invalid-feedback"},Wr={class:"col"},Kr={class:"form-floating mb-2"},Qr={key:0,class:"d-block invalid-feedback"},Jr={class:"row row-cols-sm-2"},Xr={class:"col"},Zr={class:"form-floating mb-2"},ei={class:"form-floating mb-2"},ti={key:0,class:"d-block invalid-feedback"},si={class:"form-floating mb-2"},oi={key:0,class:"d-block invalid-feedback"},ai={class:"col"},li={class:"form-floating mb-2"},st={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,required:!0}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"ARC CMS",pageTitle:"Edit Movie"}),A=n,i=ge({editorElementId:"editor",htmlContent:"",item:null}),T={item:{title:{required:ne.withMessage("Title is required.",ie),$autoDirty:!0,$lazy:!0},eidr:{required:ne.withMessage("eidr is required.",ie),$autoDirty:!0,$lazy:!0},eidrPrefix:{required:ne.withMessage("eidrPrefix is required.",ie),$autoDirty:!0,$lazy:!0}},htmlContent:{required:ne.withMessage("Content is required.",ie),$autoDirty:!0,$lazy:!0}},$=Se(T,i);me(async()=>{await m()});const W=()=>{const K=i;var f=document.getElementById(K.editorElementId);f.innerHTML=K.htmlContent},X=K=>{const f=i;f.htmlContent=K.target.innerHTML;var M=document.getElementById(f.editorElementId);M.value=f.htmlContent},m=async()=>{const K=i;if(!x.value)try{x.value=!0,i.item=null,await j.get(`/api/v1/movies/${A.id}`).then(f=>{K.item=f.data,K.htmlContent=K.item.description}),W()}catch(f){P.value=S.getErrorMessageAsHtml(f)}finally{x.value=!1}},y=async()=>{const K=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const M=S.clone(K.item);M.description=K.htmlContent,await j.put("/api/v1/movies",M).then(p=>{G.success("Edit Movie","Movie edited",{onClose:async()=>{const u=`${A.urlView}/${A.id}`;await Q.push(u)}})})}catch(M){P.value=S.getErrorMessageAsHtml(M),window.scrollTo(0,0)}finally{x.value=!1}};return(K,f)=>{const M=ae("router-link"),p=ae("PageHeader"),u=ae("PageBody");return t(),s("div",null,[z(p,{"page-icon":"fas fa-fw fa-film",pageTitle:o(k),"header-break":"row row-cols-2 row-cols-sm-2"},{default:F(()=>[i.item?(t(),s("div",Nr,[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:f[0]||(f[0]=b=>y()),class:"btn btn-primary"},f[7]||(f[7]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Rr),e("button",{onClick:m,class:"ms-2 btn btn-secondary"},f[8]||(f[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(M,{to:`${A.urlView}/${A.id}`,class:"ms-1 btn btn-secondary"},{default:F(()=>f[9]||(f[9]=[e("i",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])])):L("",!0)]),_:1},8,["pageTitle"]),z(u,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[i.item?(t(),s("div",Fr,[e("div",zr,[e("div",Gr,[e("div",jr,[R(e("input",{"onUpdate:modelValue":f[1]||(f[1]=b=>i.item.eidrPrefix=b),type:"text",class:"form-control",id:"eidrPrefix",placeholder:"Eidr Prefix"},null,512),[[te,i.item.eidrPrefix]]),f[10]||(f[10]=e("label",{for:"title"},"Eidr Prefix",-1)),o($).item.eidrPrefix.$error?(t(),s("div",Yr,[(t(!0),s(H,null,N(o($).item.eidrPrefix.$errors,b=>(t(),s("div",{key:b.$uid},c(b.$message),1))),128))])):L("",!0)])]),e("div",Wr,[e("div",Kr,[R(e("input",{"onUpdate:modelValue":f[2]||(f[2]=b=>i.item.eidr=b),type:"text",class:"form-control",id:"eidr",placeholder:"Eidr"},null,512),[[te,i.item.eidr]]),f[11]||(f[11]=e("label",{for:"title"},"Eidr",-1)),o($).item.eidr.$error?(t(),s("div",Qr,[(t(!0),s(H,null,N(o($).item.eidr.$errors,b=>(t(),s("div",{key:b.$uid},c(b.$message),1))),128))])):L("",!0)])])]),e("div",Jr,[e("div",Xr,[e("div",Zr,[R(e("input",{"onUpdate:modelValue":f[3]||(f[3]=b=>i.item.releaseYear=b),type:"number",class:"form-control",id:"releaseYear",placeholder:"Release Year"},null,512),[[te,i.item.releaseYear]]),f[12]||(f[12]=e("label",{for:"title"},"Release Year",-1))])]),e("div",null,[e("div",ei,[R(e("input",{"onUpdate:modelValue":f[4]||(f[4]=b=>i.item.title=b),type:"text",class:"form-control",id:"title",placeholder:"Title"},null,512),[[te,i.item.title]]),f[13]||(f[13]=e("label",{for:"title"},"Title",-1)),o($).item.title.$error?(t(),s("div",ti,[(t(!0),s(H,null,N(o($).item.title.$errors,b=>(t(),s("div",{key:b.$uid},c(b.$message),1))),128))])):L("",!0)])])]),e("div",null,[e("div",si,[e("div",{id:"editor",name:"editor",contenteditable:"true",role:"textbox",class:"form-control",spellcheck:"true",style:{"min-height":"100px",height:"auto",overflow:"auto","user-select":"text","white-space":"pre-wrap","word-break":"break-word"},onInput:f[5]||(f[5]=b=>X(b))},null,32),f[14]||(f[14]=e("label",{for:"editor"},"Content",-1)),o($).htmlContent.$error?(t(),s("div",oi,[(t(!0),s(H,null,N(o($).htmlContent.$errors,b=>(t(),s("div",{key:b.$uid},c(b.$message),1))),128))])):L("",!0)])]),e("div",ai,[e("div",li,[R(e("textarea",{"onUpdate:modelValue":f[6]||(f[6]=b=>i.item.metadata=b),rows:"4",class:"form-control",id:"metadata",placeholder:"Metadata",style:{height:"125px"}},null,512),[[te,i.item.metadata]]),f[15]||(f[15]=e("label",{for:"title"},"Metadata",-1))])])])):L("",!0)]),_:1},8,["errorMessage","vuelidate"])])}}},ni={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function ri(n,v,k,x,_,D){const P=ae("Page");return t(),ve(P,{id:k.id,urlView:k.urlView},null,8,["id","urlView"])}const ii=xe(ni,[["render",ri]]),di={class:"ms-2"},ui={class:"input-group"},ci={class:"table-responsive border shadow-sm"},mi={class:"table table-hover mb-0"},fi=["textContent"],pi={key:0,class:"fas fa-fw fa-check-circle text-success"},vi={class:"text-center"},gi={class:"text-center"},bi="/api/v1/sourcegroups/search",yi={__name:"index",props:{urlAdd:{type:String,default:"/source-groups/add"},urlView:{type:String,default:"/source-groups/view"}},setup(n){Me("$config");const k=$e().user,{appTitle:x,pageTitle:_,busy:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,security:i,filter:T,initializeFilter:$,getQuery:W,saveQuery:X,search:m,getRowNumber:y,setSelected:K,isSelected:f}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Source Groups",cacheKey:`${k==null?void 0:k.userId}/source-groups/search`,baseUrl:bi,filter:{updateUrl:!0}});return me(async()=>{$(),await m()}),(M,p)=>{const u=ae("router-link"),b=ae("PageHeader"),r=ae("m-pagination"),d=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(b,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(_)},{default:F(()=>[z(u,{to:n.urlAdd,class:"btn btn-primary"},{default:F(()=>p[3]||(p[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",di,[e("div",ui,[R(e("input",{"onUpdate:modelValue":p[0]||(p[0]=l=>o(T).query.criteria=l),onKeyup:p[1]||(p[1]=Le(l=>o(m)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria..."},null,544),[[te,o(T).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:p[2]||(p[2]=l=>o(m)(1))},p[4]||(p[4]=[e("span",{class:"fas fa-fw fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(d,{errorMessage:o(j)},{default:F(()=>[e("div",ci,[e("table",mi,[p[5]||(p[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"# of Channel Outputs"),e("th",{class:"text-center"},"# of Package Configurations")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o(T).items,(l,a)=>(t(),s("tr",{key:l.sourceGroupId},[e("td",{textContent:c(o(y)(a)),class:"text-center"},null,8,fi),e("td",null,[z(u,{to:`${n.urlView}/${l.sourceGroupId}`,class:"d-inline-block text-truncate link-offset-2"},{default:F(()=>[l.arn?(t(),s("span",pi)):L("",!0),Y(" "+c(l.name),1)]),_:2},1032,["to"])]),e("td",vi,c(l.channelOutputs),1),e("td",gi,c(l.packageConfigurations),1)]))),128))]),_:1},512),[[_e,o(T).items.length>0]])])]),z(r,{filter:o(T),search:o(m),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},$i={key:0},hi={class:"nav nav-tabs",id:"myTab",role:"tablist"},wi={class:"nav-item",role:"presentation"},_i={class:"nav-item",role:"presentation"},ki={class:"nav-item",role:"presentation"},Si={class:"tab-content",id:"myTabContent"},Ti={class:""},Ii={class:"form-floating mb-2"},Mi={class:""},xi={class:"table-responsive border"},Ci={class:"table table-hover mb-0"},Vi={class:""},Pi={class:"table-responsive border"},Oi={class:"table table-hover mb-0"},Ai={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-groups"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const v=n,{appTitle:k,pageTitle:x,busy:_,isDirty:D,validations:P,infoMessage:Q,warningMessage:j,errorMessage:S,router:G,axios:le,utils:B,toasts:A,close:i,closeWithReturnUrl:T,generateReturnUrl:$,security:W}=ye({appTitle:"Arcadian-FAST",pageTitle:"View Source Group"});Me("$config");const X=$e();X.user;const m=ge({user:X.user,item:null}),y=fe();me(async()=>{await p(),y.value=B.getPageTab("sourceGroup")||"information-tab"});const K=r=>{B.setPageTab("sourceGroup",r),y.value=r},f=r=>r!==y.value?"":"active",M=r=>r!==y.value?"":"show active",p=async()=>{const r=m;if(!_.value)try{_.value=!0,S.value="",m.item=null;const d=`/api/v1/sourcegroups/${v.id}/`;await le.get(d).then(l=>{r.item=l.data})}catch(d){S.value=B.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{_.value=!1}},u=async()=>{if(!_.value)try{_.value=!0,S.value="";const r=`/api/v1/sourcegroups/${v.id}/`;await le.delete(r).then(d=>{A.success("Delete Source Group","Source group was deleted.",{onClose:async()=>{const l=`${v.urlMain}/`;await G.push(l)}})})}catch(r){S.value=B.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{_.value=!1}},b=async()=>{await p()};return(r,d)=>{const l=ae("PageHeader"),a=ae("router-link"),U=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(l,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(x)},{default:F(()=>[e("button",{onClick:d[0]||(d[0]=I=>u()),class:"ms-1 btn btn-warning"},d[7]||(d[7]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)])),e("button",{onClick:d[1]||(d[1]=I=>b()),class:"ms-2 btn btn-secondary"},d[8]||(d[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:d[2]||(d[2]=I=>o(T)(v.urlMain)),class:"btn btn-secondary ms-1"},d[9]||(d[9]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(U,{errorMessage:o(S)},{default:F(()=>[m.item?(t(),s("div",$i,[e("div",null,[e("ul",hi,[e("li",wi,[e("button",{onClick:d[3]||(d[3]=I=>K("information-tab")),class:ee([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",_i,[e("button",{onClick:d[4]||(d[4]=I=>K("channelOutputs-tab")),class:ee([f("channelOutputs-tab"),"nav-link"]),id:"channelOutputs-tab","data-bs-toggle":"tab","data-bs-target":"#channelOutputs",type:"button",role:"tab","aria-controls":"channelOutputs","aria-selected":"false"}," Channel Outputs ",2)]),e("li",ki,[e("button",{onClick:d[5]||(d[5]=I=>K("packageConfigurations-tab")),class:ee([f("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)])]),e("div",Si,[e("div",{class:ee([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Ti,[e("div",Ii,[R(e("input",{"onUpdate:modelValue":d[6]||(d[6]=I=>m.item.name=I),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[te,m.item.name]]),d[10]||(d[10]=e("label",{for:"name"},"Name",-1))])])],2),e("div",{class:ee([M("channelOutputs-tab"),"tab-pane fade"]),id:"channelOutputs",role:"tabpanel","aria-labelledby":"channelOutputs-tab"},[e("div",Mi,[e("div",xi,[e("table",Ci,[d[11]||(d[11]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Output Type")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.channelOutputs,(I,g)=>(t(),s("tr",{key:I.channelOutputId},[e("td",null,c(g+1),1),e("td",null,[z(a,{to:`${n.urlViewChannel}/${I.channelId}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(I.manifestName),1)]),_:2},1032,["to"])]),e("td",null,c(I.outputType),1)]))),128))]),_:1},512),[[_e,m.item.channelOutputs.length>0]])])])])],2),e("div",{class:ee([M("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",Vi,[e("div",Pi,[e("table",Oi,[d[12]||(d[12]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"VOD Source"),e("th",null,"Path"),e("th",null,"Type")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.packageConfigurations,(I,g)=>(t(),s("tr",{key:I.packageConfigurationId},[e("td",null,c(g+1),1),e("td",null,[z(a,{to:`${n.urlViewVodSource}/${I.vodSourceId}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(I.vodSource.name),1)]),_:2},1032,["to"])]),e("td",null,c(I.path),1),e("td",null,c(I.type),1)]))),128))]),_:1},512),[[_e,m.item.packageConfigurations.length>0]])])])])],2)])])])):L("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Li=["disabled"],Ui={class:"form-floating mb-2"},Hi={key:0,class:"d-block invalid-feedback"},Di={class:"form-floating mb-2"},Ei={key:0,class:"d-block invalid-feedback"},qi={__name:"add",props:{urlView:{type:String,default:"/source-locations/view"},urlMain:{type:String,default:"/source-locations"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Source Location"}),A=n,i=ge({lookups:{},item:{name:null,httpConfigurationBaseUrl:null}}),T={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},httpConfigurationBaseUrl:{required:ne.withMessage("HTTP Configuration Base Url is required.",ie),$autoDirty:!0,$lazy:!0}}},$=Se(T,i);me(async()=>{});const W=async()=>{const X=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const y=S.clone(X.item);await j.post("/api/v1/sourcelocations/",y).then(K=>{G.success("Add Source Location","Source location added.",{onClose:async()=>{const f=`${A.urlView}/${K.data}`;await Q.push(f)}})})}catch(y){P.value=S.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{x.value=!1}};return(X,m)=>{const y=ae("router-link"),K=ae("PageHeader"),f=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(K,{"page-icon":"fas fa-fw fa-building",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:m[0]||(m[0]=M=>W()),class:"btn btn-primary"},m[3]||(m[3]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Li),z(y,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:F(()=>m[4]||(m[4]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(f,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[e("div",null,[e("div",Ui,[R(e("input",{"onUpdate:modelValue":m[1]||(m[1]=M=>i.item.name=M),type:"text",class:ee([o(S).getValidFeedbackCss(i.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[te,i.item.name]]),m[5]||(m[5]=e("label",{for:"name"},"Name",-1)),o($).item.name.$error?(t(),s("div",Hi,[(t(!0),s(H,null,N(o($).item.name.$errors,M=>(t(),s("div",{key:M.$uid},c(M.$message),1))),128))])):L("",!0)]),e("div",Di,[R(e("textarea",{"onUpdate:modelValue":m[2]||(m[2]=M=>i.item.httpConfigurationBaseUrl=M),type:"text",class:ee([o(S).getValidFeedbackCss(i.item.httpConfigurationBaseUrl),"form-control"]),id:"httpConfigurationBaseUrl",placeholder:"HTTP Configuration Base Url",style:{height:"8rem"}},null,2),[[te,i.item.httpConfigurationBaseUrl]]),m[6]||(m[6]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1)),o($).item.httpConfigurationBaseUrl.$error?(t(),s("div",Ei,[(t(!0),s(H,null,N(o($).item.httpConfigurationBaseUrl.$errors,M=>(t(),s("div",{key:M.$uid},c(M.$message),1))),128))])):L("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Bi={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function Ni(n,v,k,x,_,D){const P=ae("Page");return t(),ve(P,{id:k.id,urlView:k.urlView},null,8,["id","urlView"])}const Ri=xe(Bi,[["render",Ni]]),Fi={class:"ms-1"},zi={class:"input-group"},Gi={class:"table-responsive border shadow-sm"},ji={class:"table table-hover mb-0"},Yi={class:"text-center"},Wi=["textContent"],Ki={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Qi={class:"text-center"},Ji=["onUpdate:modelValue"],Xi="/api/v1/sourcelocations/search",Zi={__name:"index",props:{urlAdd:{type:String,default:"/source-locations/add"},urlView:{type:String,default:"/source-locations/view"}},setup(n){Me("$config");const k=$e().user,{appTitle:x,pageTitle:_,busy:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,security:i,filter:T,initializeFilter:$,getQuery:W,saveQuery:X,search:m,getRowNumber:y,setSelected:K,isSelected:f}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Source Locations",cacheKey:`${k==null?void 0:k.userId}/source-locations/search`,baseUrl:Xi,filter:{updateUrl:!0}}),M=Ie(()=>{const b=T.value;return b&&b.items?b.items.filter(l=>l.selected):null});me(async()=>{$(),await m()});const p=async()=>{if(!(M.length<=0||!confirm("The selected Source Location(s) will be submitted to AWS MediaTailer. Are you sure you want to publish the selected Source Location(s)?"))&&!D.value){j.value=null;try{D.value=!0;const d={sourceLocationIds:M.value.map(l=>l.sourceLocationId)};await G.post("/api/v1/sourceLocations/publish/",d).then(l=>{B.success("Publish Source Location(s)","Source Location(s) was published.",{async onClose(){}})}),D.value=!1,await m()}catch(r){j.value=le.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{D.value=!1}}},u=async()=>{if(!(M.length<=0||!confirm("The selected Source Location(s) will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected Source Location(s)?"))&&!D.value){j.value=null;try{D.value=!0;const d={sourceLocationIds:M.value.map(l=>l.sourceLocationId)};await G.post("/api/v1/sourceLocations/unpublish/",d).then(l=>{B.success("Unpublish Source Location(s)","Source Location(s) was inpublished.",{async onClose(){}})}),D.value=!1,await m()}catch(r){j.value=le.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{D.value=!1}}};return(b,r)=>{const d=ae("router-link"),l=ae("PageHeader"),a=ae("m-pagination"),U=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(l,{"page-icon":"fas fa-fw fa-building",pageTitle:o(_)},{default:F(()=>[z(d,{to:n.urlAdd,class:"btn btn-primary ms-2"},{default:F(()=>r[3]||(r[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Fi,[e("div",zi,[R(e("input",{"onUpdate:modelValue":r[0]||(r[0]=I=>o(T).query.criteria=I),onKeyup:r[1]||(r[1]=Le(I=>o(m)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[te,o(T).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:r[2]||(r[2]=I=>o(m)(1))},r[4]||(r[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(U,{errorMessage:o(j)},{default:F(()=>[e("div",Gi,[e("table",ji,[e("thead",null,[e("tr",null,[r[7]||(r[7]=e("td",{class:"text-center"},"#",-1)),r[8]||(r[8]=e("th",null,"Name",-1)),r[9]||(r[9]=e("th",null,"HTTP Configuration Base Url",-1)),e("td",Yi,[M.value.length?(t(),s(H,{key:0},[e("button",{onClick:p,class:"btn btn-primary btn-sm"},r[5]||(r[5]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:u,class:"btn btn-warning btn-sm ms-1"},r[6]||(r[6]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):L("",!0)])])]),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o(T).items,(I,g)=>(t(),s("tr",{key:I.sourceLocationId},[e("td",{textContent:c(o(y)(g)),class:"text-center"},null,8,Wi),e("td",null,[z(d,{to:`${n.urlView}/${I.sourceLocationId}`,class:"d-inline-block text-truncate link-offset-2"},{default:F(()=>[I.arn?(t(),s("i",Ki)):L("",!0),e("span",null,c(I.name),1)]),_:2},1032,["to"])]),e("td",null,c(I.httpConfigurationBaseUrl),1),e("td",Qi,[R(e("input",{"onUpdate:modelValue":q=>I.selected=q,type:"checkbox",class:"form-check-input"},null,8,Ji),[[De,I.selected]])])]))),128))]),_:1},512),[[_e,o(T).items.length>0]])])]),z(a,{filter:o(T),search:o(m),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},ed={key:0},td={class:"nav nav-tabs",id:"myTab",role:"tablist"},sd={class:"nav-item",role:"presentation"},od={class:"nav-item",role:"presentation"},ad={class:"nav-item",role:"presentation"},ld={class:"tab-content",id:"myTabContent"},nd={class:""},rd={class:"col"},id={class:"form-floating mb-2"},dd={class:"col"},ud={class:"form-floating mb-2"},cd={class:""},md={class:"table-responsive border"},fd={class:"table table-hover mb-0"},pd={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},vd={class:""},gd={class:"table-responsive border"},bd={class:"table table-hover mb-0"},yd={key:0,class:"fas fa-fw fa-check-circle text-success"},$d={class:"badge bg-info"},hd={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-locations"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const v=n,{appTitle:k,pageTitle:x,busy:_,isDirty:D,validations:P,infoMessage:Q,warningMessage:j,errorMessage:S,router:G,axios:le,utils:B,toasts:A,close:i,closeWithReturnUrl:T,generateReturnUrl:$,security:W}=ye({appTitle:"Arcadian-FAST",pageTitle:"View Source Location"});Me("$config");const X=$e();X.user;const m=ge({user:X.user,item:null}),y=fe();me(async()=>{await p(),y.value=B.getPageTab("sourceLocation")||"information-tab"});const K=d=>{B.setPageTab("sourceLocation",d),y.value=d},f=d=>d!==y.value?"":"active",M=d=>d!==y.value?"":"show active",p=async()=>{const d=m;if(!_.value)try{_.value=!0,S.value="",m.item=null;const l=`/api/v1/sourcelocations/${v.id}/`;await le.get(l).then(a=>{d.item=a.data})}catch(l){S.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{_.value=!1}},u=async()=>{await p()},b=async()=>{if(confirm("Source Location will be submitted to AWS MediaTailer. Are you sure you want to publish the Source Location?")&&!_.value){S.value=null;try{_.value=!0;const l={sourceLocationIds:[v.id]};await le.post("/api/v1/sourcelocations/publish/",l).then(a=>{A.success("Publish Source Location","Source Location was published.",{async onClose(){}})}),_.value=!1,await u()}catch(l){S.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{_.value=!1}}},r=async()=>{if(confirm("Source Location will be removed to AWS MediaTailer. Are you sure you want to remove the Source Location?")&&!_.value){S.value=null;try{_.value=!0;const l={sourceLocationIds:[v.id]};await le.post("/api/v1/sourcelocations/unpublish/",l).then(a=>{A.warning("Remove Source Location","Source Location was removed.",{async onClose(){}})}),_.value=!1,await u()}catch(l){S.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{_.value=!1}}};return(d,l)=>{const a=ae("PageHeader"),U=ae("router-link"),I=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(a,{"page-icon":"fas fa-fw fa-building",pageTitle:o(x)},{default:F(()=>[m.item?(t(),s(H,{key:0},[m.item.arn?(t(),s("button",{key:0,onClick:l[0]||(l[0]=g=>r()),class:"ms-1 btn btn-warning"},l[9]||(l[9]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:l[1]||(l[1]=g=>b()),class:"ms-1 btn btn-primary"},l[10]||(l[10]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):L("",!0),e("button",{onClick:l[2]||(l[2]=g=>u()),class:"ms-2 btn btn-secondary"},l[11]||(l[11]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:l[3]||(l[3]=g=>o(T)(v.urlMain)),class:"btn btn-secondary ms-1"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(I,{errorMessage:o(S)},{default:F(()=>[m.item?(t(),s("div",ed,[e("div",null,[e("ul",td,[e("li",sd,[e("button",{onClick:l[4]||(l[4]=g=>K("information-tab")),class:ee([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",od,[e("button",{onClick:l[5]||(l[5]=g=>K("vodSources-tab")),class:ee([f("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)]),e("li",ad,[e("button",{onClick:l[6]||(l[6]=g=>K("programs-tab")),class:ee([f("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",ld,[e("div",{class:ee([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",nd,[e("div",rd,[e("div",id,[R(e("input",{"onUpdate:modelValue":l[7]||(l[7]=g=>m.item.name=g),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[te,m.item.name]]),l[13]||(l[13]=e("label",{for:"name"},"Name",-1))])]),e("div",dd,[e("div",ud,[R(e("input",{"onUpdate:modelValue":l[8]||(l[8]=g=>m.item.httpConfigurationBaseUrl=g),type:"text",class:"form-control-plaintext",id:"httpConfigurationBaseUrl",readonly:""},null,512),[[te,m.item.httpConfigurationBaseUrl]]),l[14]||(l[14]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1))])])])],2),e("div",{class:ee([M("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",cd,[e("div",md,[e("table",fd,[l[15]||(l[15]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Video")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.vodSources,(g,q)=>(t(),s("tr",{key:g.vodSourceId},[e("td",null,c(q+1),1),e("td",null,[g.arn?(t(),s("span",pd)):L("",!0),z(U,{to:`${v.urlViewVodSource}/${encodeURIComponent(g.vodSourceId)}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(g.name),1)]),_:2},1032,["to"])]),e("td",null,[z(U,{to:`${v.urlViewVideo}/${encodeURIComponent(g.video.videoId)}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(g.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",null,c(o(B).moment.utc(g.video.durationInMillis).format("HH:mm:ss")),1)])])]))),128))]),_:1},512),[[_e,m.item.vodSources.length>0]])])])])],2),e("div",{class:ee([M("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",vd,[e("div",gd,[e("table",bd,[l[17]||(l[17]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Channel"),e("th",null,"Name"),e("th",null,"Date Scheduled Start")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.programs,(g,q)=>(t(),s("tr",{key:g.programId},[e("td",null,c(q+1),1),e("td",null,[z(U,{to:`${v.urlViewChannel}/${encodeURIComponent(g.channel.channelId)}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(g.channel.name),1)]),_:2},1032,["to"])]),e("td",null,[g.arn?(t(),s("span",yd)):L("",!0),Y(" "+c(g.name)+" ",1),e("div",null," Start: "+c(o(B).moment.utc(g.startOffsetMillis).format("HH:mm:ss")),1),e("div",null," End: "+c(o(B).moment.utc(g.endOffsetMillis).format("HH:mm:ss")),1)]),e("td",null,[Y(c(o(B).moment(g.dateScheduledStart).calendar())+" ",1),e("div",null,[e("span",$d,c(o(B).moment(g.dateScheduledStart).fromNow()),1)])]),l[16]||(l[16]=e("td",null,null,-1))]))),128))]),_:1},512),[[_e,m.item.programs.length>0]])])])])],2)])])])):L("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},wd=["id"],_d={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},kd={class:"modal-content"},Sd={class:"modal-header py-2"},Td={class:"modal-title"},Id={class:"modal-body p-0"},Md={class:"row row-cols-1 row-cols-sm-3 g-2 g-md-3"},xd={class:"col"},Cd={class:"form-floating mb-2"},Vd=["value"],Pd={class:"col"},Od={class:"form-floating mb-2"},Ad=["value"],Ld={class:"col"},Ud={class:"input-group mb-2"},Hd={class:"form-floating"},Dd={class:"row g-2 g-md-3"},Ed={class:"col-md-4"},qd={class:"card h-100"},Bd={key:0,class:"mt-2"},Nd={class:"col"},Rd={class:"form-floating mb-2"},Fd={class:"col ms-2 my-2"},zd={class:"badge bg-info me-1"},Gd={class:"badge bg-primary me-1"},jd={class:"row row-cols-1 row-cols-sm-2"},Yd={class:"col"},Wd={class:"form-floating mb-2"},Kd={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Qd={class:"col"},Jd={class:"form-floating mb-2"},Xd={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Zd={class:"col"},eu={class:"form-floating mb-2"},tu={class:"form-control-plaintext",id:"description",placeholder:"Description"},su={class:"table-responsive card shadow-sm"},ou={class:"table table-sm table-hover mb-0 overflow-auto"},au=["textContent"],lu={class:"d-flex flex-row justify-content-start"},nu=["src"],ru={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},iu={class:"ms-2"},du=["onClick"],uu={key:0,class:"fas fa-fw fa-check-circle text-primary"},cu={class:"badge text-bg-info"},mu={class:"modal-footer py-2"},fu=["disabled"],pu="/api/v1/videos/search",ct={__name:"_selectVideo",props:{sourceLocationId:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const _=$e().user,{appTitle:D,pageTitle:P,busy:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,security:T,filter:$,initializeFilter:W,getQuery:X,saveQuery:m,search:y,getRowNumber:K,setSelected:f,isSelected:M}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Select Video",cacheKey:`${_==null?void 0:_.userId}/videos/select`,baseUrl:pu,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null}},initializeFilter:(O,h)=>{const E=O.value,Z=new URLSearchParams(window.location.search),V=JSON.parse(localStorage.getItem(h))||{};E.query.genreId=Z.get("genre")||V.genreId||E.query.genreId||0,E.query.categoryId=Z.get("category")||V.categoryId||E.query.categoryId||0},getQuery:O=>["?c=",encodeURIComponent(O.query.criteria),"&p=",O.pageIndex,"&s=",O.pageSize,"&sf=",O.sortField,"&so=",O.sortOrder,"&genre=",O.query.genreId,"&category=",O.query.categoryId,"&sourceLocationId=",O.query.sourceLocationId].join(""),saveQuery:(O,h)=>{localStorage.setItem(h,JSON.stringify({criteria:O.query.criteria,pageIndex:O.pageIndex,pageSize:O.pageSize,sortField:O.sortField,sortOrder:O.sortOrder,visible:O.visible,genreId:O.query.genreId,category:O.query.categoryId}))},successAction:O=>{O.items.length===1&&g(O.items[0])}}),p=k,u=n,b=fe("modalSelectVideo"),r=ge({video:null,hls:null});me(async()=>{W(),await d(),await l(),await y(1)}),Ae(()=>{r.hls&&(r.hls.stopLoad(),r.hls.destroy())});const d=async()=>{await U(),await I()},l=async()=>{$.value.query.sourceLocationId=u.sourceLocationId,G.value="";var O=document.getElementById(b.value),h=he.getOrCreateInstance(O);h.show()},a=async O=>{var h=document.getElementById(b.value),E=he.getOrCreateInstance(h);E.hide(),r.hls&&(r.hls.stopLoad(),r.hls.destroy()),p(O?"confirm":"cancel",O?r.video:null)},U=async O=>{try{const E=await B.get("/api/v1/lookups/video-categories/").then(Z=>Z.data);$.value.lookups.categories=E}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},I=async O=>{try{const E=await B.get("/api/v1/lookups/video-genres/").then(Z=>Z.data);$.value.lookups.genres=E}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},g=O=>{r.video=O,q()},q=()=>{if(Hls.isSupported()){r.hls&&(r.hls.stopLoad(),r.hls.destroy());var O=document.getElementById("video-select-preview");const E=r.video.formats.find(V=>V.formatName==="HLS"),Z=E.serverUrl+E.path;r.hls=A.createHlsStream(O,Z)}};return v({open:l,close:a}),(O,h)=>{const E=ae("m-pagination"),Z=ae("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:b.value,tabindex:"-1","aria-hidden":"true"},[e("div",_d,[e("div",kd,[e("div",Sd,[e("h5",Td,[h[9]||(h[9]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Y(c(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:h[0]||(h[0]=V=>a(!1)),"aria-label":"Close"})]),e("div",Id,[z(Z,{errorMessage:o(G)},{default:F(()=>[e("div",Md,[e("div",xd,[e("div",Cd,[R(e("select",{"onUpdate:modelValue":h[1]||(h[1]=V=>o($).query.categoryId=V),class:"form-select",id:"category"},[(t(!0),s(H,null,N(o($).lookups.categories,V=>(t(),s("option",{value:V.id},c(V.name),9,Vd))),256))],512),[[pe,o($).query.categoryId]]),h[10]||(h[10]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",Pd,[e("div",Od,[R(e("select",{"onUpdate:modelValue":h[2]||(h[2]=V=>o($).query.genreId=V),class:"form-select",id:"genre"},[(t(!0),s(H,null,N(o($).lookups.genres,V=>(t(),s("option",{value:V.id},c(V.name),9,Ad))),256))],512),[[pe,o($).query.genreId]]),h[11]||(h[11]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",Ld,[e("div",Ud,[e("div",Hd,[R(e("input",{"onUpdate:modelValue":h[3]||(h[3]=V=>o($).query.criteria=V),onKeyup:h[4]||(h[4]=Le(V=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[te,o($).query.criteria]]),h[12]||(h[12]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:h[5]||(h[5]=V=>o(y)(1))},h[13]||(h[13]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",Dd,[R(e("div",Ed,[e("div",qd,[h[18]||(h[18]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"},null,-1)),r.video?(t(),s("div",Bd,[e("div",Nd,[e("div",Rd,[R(e("input",{"onUpdate:modelValue":h[6]||(h[6]=V=>r.video.title=V),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[te,r.video.title]]),h[14]||(h[14]=e("label",{for:"title"},"Title",-1))])]),e("div",Fd,[e("div",null,[(t(!0),s(H,null,N(r.video.genres,V=>(t(),s("span",zd,c(V.genreName),1))),256)),(t(!0),s(H,null,N(r.video.categories,V=>(t(),s("span",Gd,c(V.categoryName),1))),256))])]),e("div",jd,[e("div",Yd,[e("div",Wd,[e("div",Kd,c(o(A).moment(r.video.dateReleased).calendar()),1),h[15]||(h[15]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Qd,[e("div",Jd,[e("div",Xd,c(o(A).moment.utc(r.video.durationInMillis).format("HH:mm:ss")),1),h[16]||(h[16]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Zd,[e("div",eu,[e("div",tu,c(r.video.description),1),h[17]||(h[17]=e("label",{for:"description"},"Description",-1))])])])):L("",!0)])],512),[[_e,r.video]]),e("div",{class:ee([[r.video?"col-md-8":"col-md-12"],""])},[e("div",su,[e("table",ou,[h[19]||(h[19]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o($).items,(V,re)=>(t(),s("tr",{key:V.videoId},[e("td",{textContent:c(o(K)(re)),class:"text-center"},null,8,au),e("td",null,[e("div",lu,[e("div",null,[V.thumbnails.length>0?(t(!0),s(H,{key:0},N(V.thumbnails,(J,oe)=>(t(),s("div",{class:ee([oe>0?"mt-1":""])},[e("img",{src:J.url,class:"img-fuild border",width:"128"},null,8,nu)],2))),256)):(t(),s("img",ru))]),e("div",iu,[e("a",{onClick:J=>g(V),class:"text-wrap link-offset-2",role:"button"},[r.video===V?(t(),s("span",uu)):L("",!0),Y(c(V.title),1)],8,du),e("div",null,[e("span",cu,c(o(A).moment.utc(V.durationInMillis).format("HH:mm:ss")),1)])])])])]))),128))]),_:1},512),[[_e,o($).items.length>0]])])]),z(E,{filter:o($),search:o(y),showPerPage:!0},null,8,["filter","search"])],2)])]),_:1},8,["errorMessage"])]),e("div",mu,[e("button",{onClick:h[7]||(h[7]=V=>a(!0)),class:"btn btn-primary btn-sm",type:"button",disabled:!r.video},h[20]||(h[20]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)]),8,fu),e("button",{onClick:h[8]||(h[8]=V=>a(!1)),class:"btn btn-secondary btn-sm ms-1"},h[21]||(h[21]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,wd)}}},vu=["disabled"],gu={class:"col"},bu={class:"form-floating mb-2"},yu={key:0,class:"d-block invalid-feedback"},$u={class:"row row-cols-1 row-cols-sm-2"},hu={class:"col"},wu={class:"form-floating mb-2"},_u=["value"],ku={key:0,class:"d-block invalid-feedback"},Su={class:"col"},Tu={class:"input-group mb-2"},Iu={class:"form-floating"},Mu={key:0},xu={class:"d-flex flex-row justify-content-start align-items-center"},Cu={key:0,class:"d-inline invalid-feedback"},Vu={class:"table-responsive border mt-1"},Pu={class:"table table-sm mb-0 caption-top"},Ou={class:"align-middle"},Au=["onUpdate:modelValue"],Lu=["value"],Uu=["onUpdate:modelValue"],Hu=["value"],Du=["onClick"],Eu={__name:"add",props:{videoId:{type:String},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,route:j,axios:S,utils:G,toasts:le,close:B,closeWithReturnUrl:A,security:i}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source"}),T=n,$=ge({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),W=(l,a,U)=>l.length>0,X={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},videoId:{required:ne.withMessage("Video is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("Source Locaton is required.",ie),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:ne.withMessage("PackageConfigurations is required.",W),$each:ne.forEach({path:{required:ne.withMessage("Path is required.",ie)},sourceGroupId:{required:ne.withMessage("Source Group is required.",ie)}}),$autoDirty:!0,$lazy:!0}}},m=Se(X,$);me(async()=>{if(await y(),await K(),j.query.videoId)debugger});const y=async()=>{try{await S.get("/api/v1/sourcegroups/lookup/").then(a=>{$.lookups.sourceGroups=a.data})}catch(l){P.value=G.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},K=async()=>{try{if(await S.get("/api/v1/sourcelocations/lookup/").then(a=>{$.lookups.sourceLocations=a.data}),$.lookups.sourceLocations.length===1){const a=$.lookups.sourceLocations[0];$.selected.sourceLocation=a,await f()}}catch(l){P.value=G.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},f=async()=>{const l=$.selected.sourceLocation;$.item.sourceLocationId=l.id},M=async()=>{$.item.videoId=$.selected.video.videoId,await p($.item.videoId)},p=async l=>{try{const a=`/api/v1/videos/${l}/formats`;await S.get(a).then(U=>{$.selected.video.formats=U.data})}catch(a){P.value=G.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},u=async()=>{const l=$;if(x.value)return;if(!await m.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const U=G.clone(l.item),I=l.item.packageConfigurations.filter(g=>g.selectedFormat&&g.sourceGroupId);I.forEach(g=>{const q=g.selectedFormat;g.path=q.path,g.format=q.format,delete g.selectedFormat}),U.packageConfigurations=I,delete U.video,await S.post("/api/v1/vodSources/",U).then(g=>{debugger;le.success("Add VOD Source","VOD source added",{onClose:async()=>{const q=`${T.urlView}/${g.data}`;await Q.push(q)}})})}catch(U){P.value=G.getErrorMessageAsHtml(U),window.scrollTo(0,0)}finally{x.value=!1}},b=()=>{const l={sourceGroupId:null,selectedFormat:null},a=$.selected.video;if(a){const U=a.formats.find(I=>I.formatName==="HLS");l.path=`${U.serverUrl}${U.path}`}$.item.packageConfigurations.push(l)},r=l=>{$.item.packageConfigurations.splice(l,1)},d=async()=>{const l=Ve(ct,{sourceLocationId:$.selected.sourceLocation.id},{chore:!0,keepInitial:!1}),{data:a,isCanceled:U}=await l.reveal();l.closeAll(),!U&&a&&($.selected.video=a,await M())};return(l,a)=>{const U=ae("PageHeader"),I=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(U,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o(m).$dirty&&o(m).$invalid,onClick:a[0]||(a[0]=g=>u()),class:"btn btn-primary"},a[6]||(a[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,vu),e("button",{onClick:a[1]||(a[1]=g=>o(A)(T.urlMain)),class:"btn btn-secondary ms-1"},a[7]||(a[7]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(I,{errorMessage:o(P),vuelidate:o(m)},{default:F(()=>[e("div",null,[e("div",gu,[e("div",bu,[R(e("input",{"onUpdate:modelValue":a[2]||(a[2]=g=>$.item.name=g),id:"name",class:ee([o(G).getValidFeedbackCss($.item.name),"form-control"]),placeholder:"Name"},null,2),[[te,$.item.name]]),a[8]||(a[8]=e("label",{for:"name",class:""},"Name",-1)),o(m).item.name.$error?(t(),s("div",yu,[(t(!0),s(H,null,N(o(m).item.name.$errors,g=>(t(),s("div",{key:g.$uid},c(g.$message),1))),128))])):L("",!0)])]),e("div",$u,[e("div",hu,[e("div",wu,[R(e("select",{"onUpdate:modelValue":a[3]||(a[3]=g=>$.selected.sourceLocation=g),onChange:a[4]||(a[4]=g=>f()),class:ee([o(G).getValidFeedbackCss($.selected.sourceLocation),"form-select"]),id:"sourceLocationId"},[(t(!0),s(H,null,N($.lookups.sourceLocations,g=>(t(),s("option",{value:g},c(g.name),9,_u))),256))],34),[[pe,$.selected.sourceLocation]]),a[9]||(a[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(m).item.sourceLocationId.$error?(t(),s("div",ku,[(t(!0),s(H,null,N(o(m).item.sourceLocationId.$errors,g=>(t(),s("div",{key:g.$uid},c(g.$message),1))),128))])):L("",!0)])]),e("div",Su,[e("div",Tu,[e("div",Iu,[e("div",{id:"video",class:ee([o(G).getValidFeedbackCss($.selected.video),"form-control"]),placeholder:"Title"},[$.selected.video?(t(),s(H,{key:0},[Y(c(o(G).moment.utc($.selected.video.durationInMillis).format("HH:mm:ss"))+" - "+c($.selected.video.title),1)],64)):L("",!0)],2),a[10]||(a[10]=e("label",{for:"video",class:""},"Video",-1))]),$.selected.sourceLocation?(t(),s("button",{key:0,onClick:a[5]||(a[5]=g=>d()),class:"btn btn-primary",type:"button"},a[11]||(a[11]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):L("",!0)])])]),$.item.videoId?(t(),s("div",Mu,[e("div",xu,[e("fieldset",null,[e("legend",null,[a[13]||(a[13]=Y(" Package Configurations ")),o(m).item.packageConfigurations.$error?(t(),s("span",Cu,a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):L("",!0)])]),e("div",{class:"ms-2"},[e("button",{onClick:b,class:"btn btn-outline-primary btn-sm"},a[14]||(a[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",Vu,[e("table",Pu,[a[16]||(a[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Type"),e("th",null,"Source Group"),e("th")])],-1)),e("tbody",Ou,[(t(!0),s(H,null,N($.item.packageConfigurations,(g,q)=>(t(),s("tr",null,[e("td",null,c(q+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":O=>g.selectedFormat=O,class:ee([o(G).getValidFeedbackCss(g.selectedFormat),"form-select"]),id:"videoId"},[(t(!0),s(H,null,N($.selected.video.formats,O=>(t(),s("option",{value:O},c(O.path),9,Lu))),256))],10,Au),[[pe,g.selectedFormat]]),o(m).item.packageConfigurations.$each.$response?(t(!0),s(H,{key:0},N(o(m).item.packageConfigurations.$each.$response.$errors[q].path,O=>(t(),s("div",{key:O,class:"d-block invalid-feedback"},c(O.$message),1))),128)):L("",!0)]),e("td",null,[g.selectedFormat?(t(),s(H,{key:0},[Y(c(g.selectedFormat.formatName),1)],64)):L("",!0)]),e("td",null,[e("div",null,[R(e("select",{"onUpdate:modelValue":O=>g.sourceGroupId=O,class:ee([o(G).getValidFeedbackCss(g.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(H,null,N($.lookups.sourceGroups,O=>(t(),s("option",{value:O.id},c(O.name),9,Hu))),256))],10,Uu),[[pe,g.sourceGroupId]]),o(m).item.packageConfigurations.$each.$response?(t(!0),s(H,{key:0},N(o(m).item.packageConfigurations.$each.$response.$errors[q].path,O=>(t(),s("div",{key:O,class:"d-block invalid-feedback"},c(O.$message),1))),128)):L("",!0)])]),e("td",null,[e("button",{onClick:O=>r(q),class:"btn btn-outline-warning btn-sm"},a[15]||(a[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Du)])]))),256))])])])])):L("",!0)])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},qu=["disabled"],Bu={key:0},Nu={class:"col"},Ru={class:"form-floating mb-2"},Fu={key:0,class:"d-block invalid-feedback"},zu={class:"row row-cols-1 row-cols-sm-2"},Gu={class:"col"},ju={class:"form-floating mb-2"},Yu=["value"],Wu={key:0,class:"d-block invalid-feedback"},Ku={class:"col"},Qu={class:"col"},Ju=["disabled"],Xu={class:"form-floating"},Zu={id:"video",class:"form-control",placeholder:"Title"},ec={key:0},tc={class:"d-flex flex-row justify-content-between mt-3"},sc={key:0,class:"d-inline invalid-feedback"},oc={class:"table-responsive border mt-1"},ac={class:"table table-sm mb-0"},lc={class:"align-middle"},nc=["onUpdate:modelValue"],rc=["value"],ic=["onUpdate:modelValue"],dc=["value"],uc={class:"text-end"},cc=["onClick"],mc={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Edit VOD Source"}),A=n,i=ge({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),T=(l,a,U)=>l.length>0,$={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},videoId:{required:ne.withMessage("Video is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("Source Locaton is required.",ie),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:ne.withMessage("PackageConfigurations is required.",T),$each:ne.forEach({path:{required:ne.withMessage("Path is required.",ie)},sourceGroupId:{required:ne.withMessage("Source Group is required.",ie)}})}}},W=Se($,i);me(async()=>{await X(),await K(),await f()});const X=async()=>{await m(),await y()},m=async()=>{const l=i;if(!x.value)try{x.value=!0,P.value="",i.item=null;const a=`/api/v1/vodsources/${A.id}/`;await j.get(a).then(U=>{l.item=U.data;const I=l.item,g=S.moment.utc(l.item.video.durationInMillis).format("HH:mm:ss");I.video.duration=g})}catch(a){P.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{x.value=!1}},y=async()=>{const l=i;if(!x.value)try{x.value=!0,P.value="";const a=`/api/v1/videos/${l.item.videoId}/`;await j.get(a).then(U=>{l.selected.video=U.data})}catch(a){P.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{x.value=!1}},K=async()=>{try{await j.get("/api/v1/sourcegroups/lookup/").then(a=>{i.lookups.sourceGroups=a.data})}catch(l){P.value=S.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},f=async()=>{try{if(await j.get("/api/v1/sourcelocations/lookup/").then(a=>{i.lookups.sourceLocations=a.data}),i.lookups.sourceLocations.length>0){const a=i.lookups.sourceLocations.find(U=>U.id===i.item.sourceLocationId);i.selected.sourceLocation=a}}catch(l){P.value=S.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},M=async()=>{i.item.videoId=i.selected.video.videoId,i.item.packageConfigurations=[],await p(i.item.videoId)},p=async l=>{try{const a=`/api/v1/videos/${l}/formats`;await j.get(a).then(U=>{i.selected.video.formats=U.data;debugger})}catch(a){P.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},u=async()=>{const l=i;if(x.value)return;if(!await W.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const U=S.clone(l.item);delete U.video,delete U.programs,delete U.sourceLocation,await j.put("/api/v1/vodsources/",U).then(I=>{G.success("Edit VOD Source","VOD source edited.",{onClose:async()=>{const g=`${A.urlView}/${A.id}`;await Q.push(g)}})})}catch(U){P.value=S.getErrorMessageAsHtml(U),window.scrollTo(0,0)}finally{x.value=!1}},b=()=>{debugger;const l={path:"",sourceGroupId:null,type:"HLS"},a=i.selected.video;if(a){const U=a.formats.find(I=>I.formatName==="HLS");l.path=`${U.path}`}i.item.packageConfigurations.push(l)},r=l=>{i.item.packageConfigurations.splice(l,1)},d=async()=>{const l=Ve(ct,{sourceLocationId:i.selected.sourceLocation.id},{chore:!0,keepInitial:!1}),{data:a,isCanceled:U}=await l.reveal();l.close(),!U&&a&&(i.selected.video=a,await M())};return(l,a)=>{const U=ae("router-link"),I=ae("PageHeader"),g=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(I,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o(W).$dirty&&o(W).$invalid,onClick:a[0]||(a[0]=q=>u()),class:"btn btn-primary"},a[5]||(a[5]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,qu),e("button",{onClick:a[1]||(a[1]=q=>X()),class:"btn btn-secondary ms-2"},a[6]||(a[6]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(U,{to:`${n.urlView}/${n.id}`,class:"btn btn-secondary ms-1"},{default:F(()=>a[7]||(a[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(g,{errorMessage:o(P),vuelidate:o(W)},{default:F(()=>[i.item?(t(),s("div",Bu,[e("div",Nu,[e("div",Ru,[R(e("input",{"onUpdate:modelValue":a[2]||(a[2]=q=>i.item.name=q),id:"name",class:"form-control",placeholder:"Name"},null,512),[[te,i.item.name]]),a[8]||(a[8]=e("label",{for:"name",class:""},"Name",-1)),o(W).item.name.$error?(t(),s("div",Fu,[(t(!0),s(H,null,N(o(W).item.name.$errors,q=>(t(),s("div",{key:q.$uid},c(q.$message),1))),128))])):L("",!0)])]),e("div",zu,[e("div",Gu,[e("div",ju,[R(e("select",{"onUpdate:modelValue":a[3]||(a[3]=q=>i.selected.sourceLocation=q),class:"form-select",id:"sourceLocationId"},[(t(!0),s(H,null,N(i.lookups.sourceLocations,q=>(t(),s("option",{value:q},c(q.name),9,Yu))),256))],512),[[pe,i.selected.sourceLocation]]),a[9]||(a[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(W).item.sourceLocationId.$error?(t(),s("div",Wu,[(t(!0),s(H,null,N(o(W).item.sourceLocationId.$errors,q=>(t(),s("div",{key:q.$uid},c(q.$message),1))),128))])):L("",!0)])]),e("div",Ku,[e("div",Qu,[e("div",{class:"input-group mb-2",disabled:i.item.packageConfigurations.length>0},[e("div",Xu,[e("div",Zu,[i.selected.video?(t(),s(H,{key:0},[Y(c(i.selected.video.title),1)],64)):L("",!0)]),a[10]||(a[10]=e("label",{for:"video",class:""},"Video",-1))]),e("button",{onClick:a[4]||(a[4]=q=>d()),class:"btn btn-primary",type:"button"},a[11]||(a[11]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))],8,Ju)])])]),i.item.videoId?(t(),s("div",ec,[e("div",tc,[e("div",null,[e("h5",null,[a[13]||(a[13]=Y(" Package Configurations ")),o(W).item.packageConfigurations.$error?(t(),s("span",sc,a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):L("",!0)])]),e("button",{onClick:b,class:"btn btn-outline-primary btn-sm"},a[14]||(a[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",oc,[e("table",ac,[a[16]||(a[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),e("tbody",lc,[(t(!0),s(H,null,N(i.item.packageConfigurations,(q,O)=>(t(),s("tr",null,[e("td",null,c(O+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":h=>q.selectedFormat=h,class:ee([o(S).getValidFeedbackCss(q.selectedFormat),"form-select"]),id:"videoId"},[(t(!0),s(H,null,N(i.selected.video.formats,h=>(t(),s("option",{value:h},c(h.path),9,rc))),256))],10,nc),[[pe,q.selectedFormat]]),o(W).item.packageConfigurations.$each.$response?(t(!0),s(H,{key:0},N(o(W).item.packageConfigurations.$each.$response.$errors[O].path,h=>(t(),s("div",{key:h,class:"d-block invalid-feedback"},c(h.$message),1))),128)):L("",!0)]),e("td",null,[e("div",null,[R(e("select",{"onUpdate:modelValue":h=>q.sourceGroupId=h,class:"form-select",id:"sourceGroupId"},[(t(!0),s(H,null,N(i.lookups.sourceGroups,h=>(t(),s("option",{value:h.id},c(h.name),9,dc))),256))],8,ic),[[pe,q.sourceGroupId]]),o(W).item.packageConfigurations.$each.$response?(t(!0),s(H,{key:0},N(o(W).item.packageConfigurations.$each.$response.$errors[O].path,h=>(t(),s("div",{key:h,class:"d-block invalid-feedback"},c(h.$message),1))),128)):L("",!0)])]),e("td",null,[q.selectedFormat?(t(),s(H,{key:0},[Y(c(q.selectedFormat.formatName),1)],64)):L("",!0)]),e("td",uc,[e("button",{onClick:h=>r(O),class:"btn btn-outline-warning btn-sm"},a[15]||(a[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,cc)])]))),256))])])])])):L("",!0)])):L("",!0)]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},fc={class:"ms-2"},pc={class:"input-group"},vc=["value"],gc={class:"ms-1"},bc={class:"input-group"},yc=["value"],$c={class:"ms-1"},hc={class:"input-group"},wc={class:"ms-1"},_c={class:"input-group"},kc={class:"table-responsive border shadow-sm"},Sc={class:"table table-hover mb-0"},Tc={class:"text-center"},Ic=["textContent"],Mc={class:"d-flex flex-column flex-md-row justify-content-start"},xc={class:""},Cc=["src"],Vc={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Pc={class:"ms-md-2"},Oc={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Ac={class:"badge bg-primary me-1"},Lc={key:0},Uc={class:"badge bg-info me-1"},Hc={class:"d-flex flex-row justify-content-start"},Dc={class:"ms-2"},Ec={class:"small"},qc={class:"badge bg-secondary me-1"},Bc={class:"text-center"},Nc=["onUpdate:modelValue"],Rc="/api/v1/vodsources/search",Fc={__name:"index",props:{urlAdd:{type:String,default:"/vod-sources/add"},urlView:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"}},setup(n){Me("$config");const k=$e().user,{appTitle:x,pageTitle:_,busy:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,closeWithReturnUrl:i,generateReturnUrl:T,security:$,filter:W,initializeFilter:X,getQuery:m,saveQuery:y,search:K,getRowNumber:f,setSelected:M,isSelected:p}=Ue({appTitle:"Arcadian-FAST",pageTitle:"VOD Sources",cacheKey:`${k==null?void 0:k.userId}/vod-sources/search`,baseUrl:Rc,filter:{updateUrl:!0,lookups:{sourceLocations:[],genres:[]},query:{type:0,sourceLocationId:""}},initializeFilter:(U,I)=>{const g=U.value,q=new URLSearchParams(window.location.search),O=JSON.parse(localStorage.getItem(I))||{};g.query.category=q.get("category")||O.category||g.query.category||0,g.query.genre=q.get("genre")||O.genre||g.query.genre||0,g.query.sourceLocationId=q.get("slid")||O.sourceLocationId||g.query.sourceLocationId||""},getQuery:U=>["?c=",encodeURIComponent(U.query.criteria),"&p=",U.pageIndex,"&s=",U.pageSize,"&sf=",U.sortField,"&so=",U.sortOrder,"&category=",U.query.category,"&genre=",U.query.genre,"&slid=",U.query.sourceLocationId].join(""),saveQuery:(U,I)=>{localStorage.setItem(I,JSON.stringify({criteria:U.query.criteria,pageIndex:U.pageIndex,pageSize:U.pageSize,sortField:U.sortField,sortOrder:U.sortOrder,visible:U.visible,category:U.query.category,genre:U.query.genre,sourceLocationId:U.query.sourceLocationId}))}}),u=Ie(()=>{const U=W.value;return U&&U.items?U.items.filter(q=>q.selected):[]});me(async()=>{X(),await l(),await a(),await K()});const b=async()=>{if(!(u.length<=0||!confirm("The selected VODs will be submitted to AWS MediaTailer. Are you sure you want to publish the selected VODs?"))&&!D.value){j.value=null;try{D.value=!0;const g={vodSourceIds:u.value.map(q=>q.vodSourceId)};await G.post("/api/v1/vodsources/publish/",g).then(q=>{B.success("Publish VODs","VODs was published.",{async onClose(){}})}),D.value=!1,await K()}catch(I){j.value=le.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{D.value=!1}}},r=async()=>{if(!(u.length<=0||!confirm("The selected VODs will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected VODs?"))&&!D.value){j.value=null;try{D.value=!0;const g={vodSourceIds:u.value.map(q=>q.vodSourceId)};await G.post("/api/v1/vodsources/unpublish/",g).then(q=>{B.success("Unpublish VODs","VODs was inpublished.",{async onClose(){}})}),D.value=!1,await K()}catch(I){j.value=le.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{D.value=!1}}},d=()=>{const U=W.value.items;if(U.length<1)return;const I=!U[0].selected;W.value.items.forEach(g=>{g.selected=I})},l=async()=>{try{await G.get("/api/v1/sourcelocations/lookup/").then(I=>{W.value.lookups.sourceLocations=I.data})}catch(U){j.value=le.getErrorMessageAsHtml(U),window.scrollTo(0,0)}finally{}},a=async()=>{try{await G.get("/api/v1/lookups/video-genres/").then(U=>{const I=U.data;W.value.lookups.genres=I})}catch(U){j.value=le.getErrorMessageAsHtml(U),window.scrollTo(0,0)}finally{}};return fe(!1),(U,I)=>{const g=ae("router-link"),q=ae("PageHeader"),O=ae("m-pagination"),h=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(q,{"page-icon":"fas fa-fw fa-tags",pageTitle:o(_)},{default:F(()=>[z(g,{to:n.urlAdd,class:"btn btn-primary"},{default:F(()=>I[6]||(I[6]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",fc,[e("div",pc,[I[8]||(I[8]=e("span",{class:"input-group-text fw-bold"},"Source",-1)),R(e("select",{"onUpdate:modelValue":I[0]||(I[0]=E=>o(W).query.sourceLocationId=E),class:"form-select"},[I[7]||(I[7]=e("option",{value:""},"All",-1)),(t(!0),s(H,null,N(o(W).lookups.sourceLocations,E=>(t(),s("option",{value:E.id},c(E.name),9,vc))),256))],512),[[pe,o(W).query.sourceLocationId]])])]),e("div",gc,[e("div",bc,[I[9]||(I[9]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),R(e("select",{"onUpdate:modelValue":I[1]||(I[1]=E=>o(W).query.genre=E),class:"form-select"},[(t(!0),s(H,null,N(o(W).lookups.genres,E=>(t(),s("option",{value:E.id},c(E.name),9,yc))),256))],512),[[pe,o(W).query.genre]])])]),e("div",$c,[e("div",hc,[I[11]||(I[11]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),R(e("select",{"onUpdate:modelValue":I[2]||(I[2]=E=>o(W).query.category=E),class:"form-select"},I[10]||(I[10]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[pe,o(W).query.category]])])]),e("div",wc,[e("div",_c,[R(e("input",{"onUpdate:modelValue":I[3]||(I[3]=E=>o(W).query.criteria=E),onKeyup:I[4]||(I[4]=Le(E=>o(K)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[te,o(W).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:I[5]||(I[5]=E=>o(K)(1))},I[12]||(I[12]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(h,{errorMessage:o(j)},{default:F(()=>[e("div",kc,[e("table",Sc,[e("thead",null,[e("tr",null,[I[16]||(I[16]=e("td",{class:"text-center"},"#",-1)),I[17]||(I[17]=e("th",null,"Name",-1)),I[18]||(I[18]=e("th",null,"Video Title",-1)),e("th",Tc,[u.value.length?(t(),s(H,{key:0},[e("button",{onClick:b,class:"btn btn-sm btn-primary"},I[13]||(I[13]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:r,class:"btn btn-sm btn-warning ms-1"},I[14]||(I[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):L("",!0),e("button",{onClick:d,class:"btn btn-sm btn-outline-primary ms-2"},I[15]||(I[15]=[e("span",{class:"fas fa-fw fa-check-double"},null,-1)]))])])]),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o(W).items,(E,Z)=>(t(),s("tr",{key:E.vodSourceId},[e("td",{textContent:c(o(f)(Z)),class:"text-center"},null,8,Ic),e("td",null,[e("div",Mc,[e("div",null,[E.video.thumbnails.length>0?(t(!0),s(H,{key:0},N(E.video.thumbnails,V=>(t(),s("div",xc,[e("img",{src:V.url,class:"img-fuild border",width:"128"},null,8,Cc)]))),256)):(t(),s("img",Vc))]),e("div",Pc,[z(g,{to:`${n.urlView}/${E.vodSourceId}`,class:"d-inline-block text-wrap link-offset-2"},{default:F(()=>[E.arn?(t(),s("span",Oc)):L("",!0),Y(c(E.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(H,null,N(E.video.categories,V=>(t(),s("div",null,[e("span",Ac,c(V.categoryName),1)]))),256)),E.video.genres.length>0?(t(),s("div",Lc,[(t(!0),s(H,null,N(E.video.genres,V=>(t(),s("span",Uc,c(V.genreName),1))),256))])):L("",!0)])])])]),e("td",null,[e("div",Hc,[e("div",Dc,[z(g,{to:`${n.urlViewVideo}/${encodeURIComponent(E.video.videoId)}/${o(T)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(E.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",Ec,c(o(le).moment.utc(E.video.durationInMillis).format("HH:mm:ss")),1)]),E.video.formats.length>0?(t(!0),s(H,{key:0},N(E.video.formats,V=>(t(),s("span",qc,c(V.formatName),1))),256)):L("",!0)])])]),e("td",Bc,[R(e("input",{"onUpdate:modelValue":V=>E.selected=V,type:"checkbox",class:"form-check-input"},null,8,Nc),[[De,E.selected]])])]))),128))]),_:1},512),[[_e,o(W).items.length>0]])])]),z(O,{filter:o(W),search:o(K),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},zc=["id"],Gc={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},jc={class:"modal-content"},Yc={class:"modal-header"},Wc={class:"modal-title"},Kc={class:"modal-body"},Qc={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Jc=["innerHTML"],Xc={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Zc={class:"container"},em={class:"col"},tm={class:"form-floating mb-2"},sm=["value"],om={key:0,class:"d-block invalid-feedback"},am={class:"col"},lm={class:"form-floating mb-2"},nm={key:0,class:"d-block invalid-feedback"},rm={class:"col"},im={class:"form-floating mb-2"},dm=["value"],um={key:0,class:"d-block invalid-feedback"},cm={class:"modal-footer"},mm=["disabled"],fm={__name:"_addPackageConfiguration",emits:["refresh"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source Package Configuration"}),W=k;fe();const X=fe("modalAddChannelOutput"),m=ge({lookups:{sourceGroups:[],formats:[]},item:{sourceGroupId:null,vodSourceId:null,path:null,type:null}}),y={item:{sourceGroupId:{required:ne.withMessage("Source Group is required.",ie),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ne.withMessage("VOD Source is required.",ie),$autoDirty:!0,$lazy:!0},path:{required:ne.withMessage("Path is required.",ie),$autoDirty:!0,$lazy:!0},type:{required:ne.withMessage("Type is required.",ie),$autoDirty:!0,$lazy:!0}}},K=Se(y,m);me(async()=>{K.value.$reset()});const f=async()=>{await M()},M=async()=>{try{await B.get("/api/v1/sourceGroups/lookup/").then(l=>{m.lookups.sourceGroups=l.data,m.lookups.sourceGroups.length===1&&(m.item.sourceGroupId=m.lookups.sourceGroups[0].id)})}catch(d){G.value=A.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}},p=async d=>{try{const l=`/api/v1/videos/${d}/formats/`;await B.get(l).then(a=>{m.lookups.formats=a.data})}catch(l){G.value=A.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},u=async(d,l)=>{const a=m;Q.value.clear(),G.value="",a.lookups={sourceGroups:[],formats:[]},a.item={sourceGroupId:null,vodSourceId:d,path:null,type:null},await f(),await p(l),K.value.$reset();var U=document.getElementById(X.value),I=he.getOrCreateInstance(U);I.show()},b=async()=>{var d=document.getElementById(X.value),l=he.getOrCreateInstance(d);l.hide(),W("refresh")},r=async()=>{const d=m;if(D.value)return;const l=await K.value.$validate();debugger;if(!l){window.scrollTo(0,0);return}try{D.value=!0,G.value="";const a=d.item;await B.post("/api/v1/vodSources/package-configurations/",a).then(U=>{i.success("Add VOD Source Package Configuration","VOD Source package configuration added.")}),await b()}catch(a){G.value=A.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{D.value=!1}};return v({open:u,close:b}),(d,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:X.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",Gc,[e("div",jc,[e("div",Yc,[e("h5",Wc,[l[5]||(l[5]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=a=>b()),"aria-label":"Close"})]),e("div",Kc,[o(G)?(t(),s("div",Qc,[l[6]||(l[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Jc)])):L("",!0),o(Q).size>0?(t(),s("div",Xc,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),a=>(t(),s("li",null,c(a),1))),256))])])):L("",!0),e("div",Zc,[e("div",em,[e("div",tm,[R(e("select",{"onUpdate:modelValue":l[1]||(l[1]=a=>m.item.sourceGroupId=a),class:ee([o(A).getValidFeedbackCss(m.item.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(H,null,N(m.lookups.sourceGroups,a=>(t(),s("option",{value:a.id},c(a.name),9,sm))),256))],2),[[pe,m.item.sourceGroupId]]),l[8]||(l[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(K).item.sourceGroupId.$error?(t(),s("div",om,[(t(!0),s(H,null,N(o(K).item.sourceGroupId.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",am,[e("div",lm,[R(e("select",{"onUpdate:modelValue":l[2]||(l[2]=a=>m.item.type=a),class:ee([o(A).getValidFeedbackCss(m.item.type),"form-select"]),id:"type"},l[9]||(l[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),2),[[pe,m.item.type]]),l[10]||(l[10]=e("label",{for:"type",class:""},"Type",-1)),o(K).item.type.$error?(t(),s("div",nm,[(t(!0),s(H,null,N(o(K).item.type.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",rm,[e("div",im,[R(e("select",{"onUpdate:modelValue":l[3]||(l[3]=a=>m.item.path=a),class:ee([o(A).getValidFeedbackCss(m.item.path),"form-control"]),id:"path"},[(t(!0),s(H,null,N(m.lookups.formats,a=>(t(),s("option",{value:a.path},c(a.path),9,dm))),256))],2),[[pe,m.item.path]]),l[11]||(l[11]=e("label",{for:"path",class:""},"Path",-1)),o(K).item.path.$error?(t(),s("div",um,[(t(!0),s(H,null,N(o(K).item.path.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])])])]),e("div",cm,[e("button",{disabled:o(K).$dirty&&o(K).$invalid,onClick:l[4]||(l[4]=a=>r()),class:"btn btn-primary",type:"button"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,mm),l[13]||(l[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,zc))}},pm=["id"],vm={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},gm={class:"modal-content"},bm={class:"modal-header"},ym={class:"modal-title"},$m={class:"modal-body"},hm={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},wm=["innerHTML"],_m={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},km={class:"container"},Sm={class:"col"},Tm={class:"form-floating mb-2"},Im={class:"col"},Mm={class:"form-floating mb-2"},xm={key:0,class:"d-block invalid-feedback"},Cm={class:"col"},Vm={class:"form-floating mb-2"},Pm={key:0,class:"d-block invalid-feedback"},Om={class:"col"},Am={class:"form-floating mb-2"},Lm={key:0,class:"d-block invalid-feedback"},Um={class:"modal-footer"},Hm=["disabled"],Dm={__name:"_addPlaybackConfiguration",emits:["refresh"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Vod Source Playback Configuration"}),W=k,X=fe(),m=fe("modalAddPlaybackConfiguration"),y=ge({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),K={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:ne.withMessage("adDecisionServerUrl is required.",ie),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:ne.withMessage("videoContentSourceUrl is required.",ie),$autoDirty:!0,$lazy:!0}}},f=Se(K,y);me(async()=>{f.value.$reset()});const M=async(b,r)=>{X.value=b;const d=y;Q.value.clear(),G.value="";const l=r,a=l.lastIndexOf("/"),U=l.substring(0,a),I="ad_campaign_"+l.substring(a+1).replace(".","_");d.item={name:I,originalVideoContentSourceUrl:r,videoContentSourceUrl:U,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},f.value.$reset();var g=document.getElementById(m.value),q=he.getOrCreateInstance(g);q.show()},p=async()=>{var b=document.getElementById(m.value),r=he.getOrCreateInstance(b);r.hide(),W("refresh")},u=async()=>{const b=y;if(D.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{D.value=!0,G.value="";const d=b.item;d.vodSourceId=X.value,await B.post("/api/v1/playbackconfigurations/vodsource",d).then(l=>{i.success("Add Vod Source Playback Configuration","Vod Source playback configuration added.",{async onClose(){}})}),await p()}catch(d){G.value=A.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{D.value=!1}};return v({open:M,close:p}),(b,r)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",vm,[e("div",gm,[e("div",bm,[e("h5",ym,[r[6]||(r[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:r[0]||(r[0]=d=>p()),"aria-label":"Close"})]),e("div",$m,[o(G)?(t(),s("div",hm,[r[7]||(r[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,wm)])):L("",!0),o(Q).size>0?(t(),s("div",_m,[r[8]||(r[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),d=>(t(),s("li",null,c(d),1))),256))])])):L("",!0),e("div",km,[e("div",Sm,[e("div",Tm,[R(e("input",{"onUpdate:modelValue":r[1]||(r[1]=d=>y.item.originalVideoContentSourceUrl=d),id:"originalVideoContentSourceUrl",class:"form-control",placeholder:"originalVideoContentSourceUrl",disabled:""},null,512),[[te,y.item.originalVideoContentSourceUrl]]),r[9]||(r[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",Im,[e("div",Mm,[R(e("input",{"onUpdate:modelValue":r[2]||(r[2]=d=>y.item.name=d),id:"name",class:"form-control",placeholder:"Name"},null,512),[[te,y.item.name]]),r[10]||(r[10]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",xm,[(t(!0),s(H,null,N(o(f).item.name.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):L("",!0)])]),e("div",Cm,[e("div",Vm,[R(e("input",{"onUpdate:modelValue":r[3]||(r[3]=d=>y.item.videoContentSourceUrl=d),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[te,y.item.videoContentSourceUrl]]),r[11]||(r[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),r[12]||(r[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(f).item.videoContentSourceUrl.$error?(t(),s("div",Pm,[(t(!0),s(H,null,N(o(f).item.videoContentSourceUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):L("",!0)])]),e("div",Om,[e("div",Am,[R(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=d=>y.item.adDecisionServerUrl=d),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[te,y.item.adDecisionServerUrl]]),r[13]||(r[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(f).item.adDecisionServerUrl.$error?(t(),s("div",Lm,[(t(!0),s(H,null,N(o(f).item.adDecisionServerUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):L("",!0)])])])]),e("div",Um,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:r[5]||(r[5]=d=>u()),class:"btn btn-primary",type:"button"},r[14]||(r[14]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Hm),r[15]||(r[15]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,pm))}},Em={key:0},qm={class:"nav nav-tabs",id:"myTab",role:"tablist"},Bm={class:"nav-item",role:"presentation"},Nm={class:"nav-item",role:"presentation"},Rm={class:"nav-item",role:"presentation"},Fm={class:"nav-item",role:"presentation"},zm={class:"nav-item",role:"presentation"},Gm={class:"tab-content",id:"myTabContent"},jm={class:""},Ym={class:"row row-cols-1 row-cols-sm-2"},Wm={class:"col"},Km=["id"],Qm={class:"col"},Jm={class:"col"},Xm={class:"form-floating mb-2"},Zm={class:"mt-2"},ef={class:"row row-cols-sm-2"},tf={class:"col"},sf={class:"form-floating mb-2"},of={class:"form-control-plaintext"},af={class:"col"},lf={class:"form-floating mb-2"},nf={class:"mt-2"},rf={class:"badge bg-info me-1"},df={class:"badge bg-primary me-1"},uf={class:"badge bg-info me-1"},cf={class:"table-responsive border mt-2"},mf={class:"table table-hover mb-0"},ff={class:"table-group-divider"},pf={class:"align-middle"},vf={class:"text-center"},gf={class:"text-truncate text-wrap"},bf={class:"text-truncate text-wrap"},yf={class:""},$f={class:"mt-2 text-end"},hf={class:"table-responsive border mt-2"},wf={class:"table table-hover mb-0 caption-top"},_f={class:"text-end"},kf=["onClick"],Sf={class:""},Tf={class:"mt-1"},If=["id"],Mf={class:"text-end"},xf={__name:"view",props:{id:{type:String,required:!0},urlEdit:{type:String,default:"/vod-sources/edit"},urlMain:{type:String,default:"/vod-sources"},urlViewVideo:{type:String,default:"/videos/view"}},setup(n){const v=n,{appTitle:k,pageTitle:x,busy:_,isDirty:D,validations:P,infoMessage:Q,warningMessage:j,errorMessage:S,router:G,axios:le,utils:B,toasts:A,close:i,closeWithReturnUrl:T,generateReturnUrl:$,security:W}=ye({appTitle:"Arcadian-FAST",pageTitle:"View VOD Source"});Me("$config");const X=$e();X.user;const m=ge({user:X.user,item:null,hls:null}),y=fe();fe(null);const K=fe();me(async()=>{await u();const I=B.getPageTab("vodSource")||"information-tab";f(I)}),Ae(()=>{m.hls&&(m.hls.stopLoad(),m.hls.destroy())});const f=I=>{B.setPageTab("vodSource",I),y.value=I},M=I=>I!==y.value?"":"active",p=I=>I!==y.value?"":"show active",u=async()=>{const I=m;if(!_.value)try{_.value=!0,S.value="",m.item=null;const g=`/api/v1/vodsources/${v.id}/`;await le.get(g).then(q=>{I.item=q.data;const O=I.item,h=B.moment.utc(I.item.video.durationInMillis).format("HH:mm:ss");O.video.duration=h}),U()}catch(g){S.value=B.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{_.value=!1}},b=async()=>{await u()},r=()=>{K.value.open(m.item.vodSourceId,m.item.videoId)},d=async()=>{if(confirm("VOD will be submitted to AWS MediaTailer. Are you sure you want to publish the VOD?")&&!_.value){S.value=null;try{_.value=!0;const g={vodSourceIds:[v.id]};await le.post("/api/v1/vodsources/publish/",g).then(q=>{A.success("Publish VOD","VOD was published.",{async onClose(){}})}),_.value=!1,await b()}catch(g){S.value=B.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{_.value=!1}}},l=async()=>{if(confirm("VOD will be removed to AWS MediaTailer. Are you sure you want to remove the VOD?")&&!_.value){S.value=null;try{_.value=!0;const g={vodSourceIds:[v.id]};await le.post("/api/v1/vodsources/unpublish/",g).then(q=>{A.warning("Remove VOD","VOD was removed.",{async onClose(){}})}),_.value=!1,await b()}catch(g){S.value=B.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{_.value=!1}}},a=async I=>{if(confirm("Are you sure you want to remove the VOD Package configuration?")&&!_.value){S.value=null;try{_.value=!0,await le.delete(`/api/v1/vodSources/package-configurations/${I}/`).then(q=>{A.warning("Remove VOD Source Package Configuration","VOD Source package configuration was removed.")}),_.value=!1,await b()}catch(q){S.value=B.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{_.value=!1}}},U=()=>{if(Hls.isSupported()){m.hls&&(m.hls.stopLoad(),m.hls.destroy());const I=`video-${m.item.vodSourceId}`,g=document.getElementById(I),q=m.item.video.formats.find(h=>h.formatName==="HLS"),O=`${q.serverUrl}${q.path}`;m.hls=B.createHlsStream(g,O)}};return(I,g)=>{const q=ae("router-link"),O=ae("PageHeader"),h=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(O,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(x)},{default:F(()=>[m.item?(t(),s(H,{key:0},[m.item.arn?(t(),s("button",{key:0,onClick:g[0]||(g[0]=E=>l()),class:"ms-1 btn btn-warning"},g[14]||(g[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:g[1]||(g[1]=E=>d()),class:"ms-1 btn btn-primary"},g[15]||(g[15]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):L("",!0),z(q,{to:`${n.urlEdit}/${n.id}`,class:"ms-2 btn btn-primary"},{default:F(()=>g[16]||(g[16]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:g[2]||(g[2]=E=>b()),class:"ms-2 btn btn-secondary"},g[17]||(g[17]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:g[3]||(g[3]=E=>o(T)(v.urlMain)),class:"btn btn-secondary ms-1"},g[18]||(g[18]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(h,{errorMessage:o(S)},{default:F(()=>[m.item?(t(),s("div",Em,[e("div",null,[e("ul",qm,[e("li",Bm,[e("button",{onClick:g[4]||(g[4]=E=>f("information-tab")),class:ee([M("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Nm,[e("button",{onClick:g[5]||(g[5]=E=>f("packageConfigurations-tab")),class:ee([M("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)]),e("li",Rm,[e("button",{onClick:g[6]||(g[6]=E=>f("channels-tab")),class:ee([M("channels-tab"),"nav-link"]),id:"channels-tab","data-bs-toggle":"tab","data-bs-target":"#channels",type:"button",role:"tab","aria-controls":"channels","aria-selected":"false"},g[19]||(g[19]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Y("Channels ")]),2)]),e("li",Fm,[e("button",{onClick:g[7]||(g[7]=E=>f("programs-tab")),class:ee([M("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},g[20]||(g[20]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Y("Programs ")]),2)]),e("li",zm,[e("button",{onClick:g[8]||(g[8]=E=>f("programTemplates-tab")),class:ee([M("programTemplates-tab"),"nav-link"]),id:"programTemplates-tab","data-bs-toggle":"tab","data-bs-target":"#programTemplates",type:"button",role:"tab","aria-controls":"programTemplates","aria-selected":"false"},g[21]||(g[21]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Y("Program Templates ")]),2)])]),e("div",Gm,[e("div",{class:ee([p("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",jm,[e("div",Ym,[e("div",Wm,[e("video",{id:`video-${m.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,Km)]),e("div",Qm,[e("div",Jm,[e("div",Xm,[R(e("input",{"onUpdate:modelValue":g[9]||(g[9]=E=>m.item.name=E),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[te,m.item.name]]),g[22]||(g[22]=e("label",{for:"name"},"Name",-1))])]),e("div",Zm,[g[26]||(g[26]=e("b",null," Video Information ",-1)),e("div",null,[e("div",ef,[e("div",tf,[e("div",sf,[e("div",of,[z(q,{to:`${n.urlViewVideo}/${m.item.video.videoId}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(m.item.video.title),1)]),_:1},8,["to"])]),g[23]||(g[23]=e("label",{for:"title"},"Title",-1))])]),e("div",af,[e("div",lf,[R(e("input",{"onUpdate:modelValue":g[10]||(g[10]=E=>m.item.video.duration=E),type:"text",class:"form-control-plaintext",id:"duration",readonly:""},null,512),[[te,m.item.video.duration]]),g[24]||(g[24]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",nf,[(t(!0),s(H,null,N(m.item.video.genres,E=>(t(),s("span",rf,c(E.genreName),1))),256)),(t(!0),s(H,null,N(m.item.video.categories,E=>(t(),s("span",df,c(E.categoryName),1))),256)),(t(!0),s(H,null,N(m.item.video.categories,E=>(t(),s("span",uf,c(E.categoryName),1))),256))]),e("div",cf,[e("table",mf,[g[25]||(g[25]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",ff,[(t(!0),s(H,null,N(m.item.video.formats,(E,Z)=>(t(),s("tr",pf,[e("td",vf,c(Z+1),1),e("td",null,c(E.formatName),1),e("td",null,[e("div",gf,c(E.serverUrl),1)]),e("td",null,[e("div",bf,c(E.path),1)])]))),256))])])])])])])])])],2),e("div",{class:ee([p("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",yf,[e("div",$f,[e("button",{onClick:g[11]||(g[11]=E=>r()),class:"btn btn-outline-primary btn-sm"},g[27]||(g[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",hf,[e("table",wf,[g[29]||(g[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.packageConfigurations,(E,Z)=>(t(),s("tr",{key:E.packageConfigurationId,class:"align-middle"},[e("td",null,c(Z+1),1),e("td",null,c(E.path),1),e("td",null,c(E.sourceGroup.name),1),e("td",null,c(E.type),1),e("td",_f,[e("button",{onClick:V=>a(E.packageConfigurationId),class:"btn btn-outline-warning btn-sm"},g[28]||(g[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,kf)])]))),128))]),_:1},512),[[_e,m.item.packageConfigurations.length>0]])])])])],2),e("div",{class:ee([p("viewStream-tab"),"tab-pane fade"]),id:"viewStream",role:"tabpanel","aria-labelledby":"viewStream-tab"},[e("div",Sf,[e("div",Tf,[e("video",{id:`video-${m.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,If),e("div",Mf,[e("button",{onClick:g[12]||(g[12]=E=>m.hls.startLoad(-1)),class:"btn btn-outline-info btn-sm"},g[30]||(g[30]=[e("span",{class:"fas fa-fw fa-cloud-download"},null,-1)]))])])])],2),e("div",{class:ee([p("channels-tab"),"tab-pane fade"]),id:"channels",role:"tabpanel","aria-labelledby":"channels-tab"},g[31]||(g[31]=[e("div",{class:""}," TODO: List of Channels using this as filler slate ",-1)]),2),e("div",{class:ee([p("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},g[32]||(g[32]=[e("div",{class:""}," TODO: List of Programs using this as VOD source ",-1)]),2),e("div",{class:ee([p("programTemplates-tab"),"tab-pane fade"]),id:"programTemplates",role:"tabpanel","aria-labelledby":"programTemplates-tab"},g[33]||(g[33]=[e("div",{class:""}," TODO: List of Program Templates using this as VOD source ",-1)]),2)])])])):L("",!0)]),_:1},8,["errorMessage"]),z(fm,{ref_key:"modalAddPackageConfiguration",ref:K,onRefresh:b},null,512),z(Dm,{ref:"modalAddPlaybackConfiguration",onRefresh:g[13]||(g[13]=E=>b())},null,512)])]),_:1})}}},Cf=["id"],Vf={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Pf={class:"modal-content"},Of={class:"modal-header py-2"},Af={class:"modal-title"},Lf={class:"modal-body p-0"},Uf={class:"row row-cols-1 row-cols-sm-3 g-2 g-md-3"},Hf={class:"col"},Df={class:"form-floating mb-2"},Ef=["disabled"],qf=["value","disabled"],Bf={class:"col"},Nf={class:"form-floating mb-2"},Rf=["value"],Ff={class:"col"},zf={class:"input-group mb-2"},Gf={class:"form-floating"},jf={class:"row g-2 g-md-3"},Yf={class:"col-md-4"},Wf={class:"card h-100"},Kf={key:0,class:"mt-2"},Qf={class:"col"},Jf={class:"form-floating mb-2"},Xf={class:"col ms-2 my-2"},Zf={class:"badge bg-info me-1"},ep={class:"badge bg-primary me-1"},tp={class:"row row-cols-1 row-cols-sm-2"},sp={class:"col"},op={class:"form-floating mb-2"},ap={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},lp={class:"col d-block"},np={class:"form-floating mb-2"},rp={class:"form-control-plaintext",id:"duration",placeholder:"Duration"},ip={class:"col"},dp={class:"form-floating mb-2"},up={class:"table-responsive card shadow-sm"},cp={class:"table table-sm table-hover mb-0 overflow-auto"},mp=["textContent"],fp={class:"d-flex flex-row justify-content-start"},pp={class:"mt-1"},vp=["src"],gp={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},bp={class:"ms-2"},yp=["onClick"],$p={key:0,class:"fas fa-fw fa-check-circle text-primary"},hp={class:"badge text-bg-info"},wp={class:"modal-footer py-2"},_p=["disabled"],kp="/api/v1/vodSources/search",Be={__name:"_selectVodSource",props:{sourceLocationId:{type:String,required:!0},genreId:{type:String},categoryId:{type:String},durationInMillis:{type:String},withArn:{type:String}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const _=$e().user,{appTitle:D,pageTitle:P,busy:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,security:T,filter:$,initializeFilter:W,getQuery:X,saveQuery:m,search:y,getRowNumber:K,setSelected:f,isSelected:M}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Select VOD Source",cacheKey:`${_==null?void 0:_.userId}/vodsources/select`,baseUrl:kp,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null,durationInMillis:0}},initializeFilter:(O,h)=>{O.value,new URLSearchParams(window.location.search),JSON.parse(localStorage.getItem(h)),O.value.query.sourceLocationId=u.sourceLocationId||null,O.value.query.genreId=u.genreId||0,O.value.query.categoryId=u.categoryId||0,O.value.query.durationInMillis=u.durationInMillis||0,O.value.query.withArn=u.withArn||!1},getQuery:O=>["?c=",encodeURIComponent(O.query.criteria),"&p=",O.pageIndex,"&s=",O.pageSize,"&sf=",O.sortField,"&so=",O.sortOrder,"&slid=",O.query.sourceLocationId,"&genre=",O.query.genreId,"&category=",O.query.categoryId,"&durationInMillis=",O.query.durationInMillis,"&withArn=true"].join(""),saveQuery:(O,h)=>{localStorage.setItem(h,JSON.stringify({criteria:O.query.criteria,pageIndex:O.pageIndex,pageSize:O.pageSize,sortField:O.sortField,sortOrder:O.sortOrder,visible:O.visible}))},successAction:O=>{O.items.length===1&&g(O.items[0])}}),p=k,u=n,b=fe("modalSelectVodSource"),r=ge({vodSource:null,hls:null});me(async()=>{W(),await d(),await l()}),Ae(()=>{r.hls&&(r.hls.stopLoad(),r.hls.destroy())});const d=async()=>{await U(),await I()},l=async()=>{G.value="",await y();var O=document.getElementById(b.value),h=he.getOrCreateInstance(O);h.show()},a=async O=>{var h=document.getElementById(b.value),E=he.getOrCreateInstance(h);E.hide(),r.hls&&(r.hls.stopLoad(),r.hls.destroy()),p(O?"confirm":"cancel",O?r.vodSource:null)},U=async O=>{try{const E=await B.get("/api/v1/lookups/video-categories/").then(Z=>Z.data);$.value.lookups.categories=E}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},I=async O=>{try{const E=await B.get("/api/v1/lookups/video-genres/").then(Z=>Z.data);$.value.lookups.genres=E}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},g=O=>{r.vodSource=O,q()},q=()=>{if(Hls.isSupported()){r.hls&&(r.hls.stopLoad(),r.hls.destroy());var O=document.getElementById("video-select-preview");const E=r.vodSource.video.formats.find(V=>V.formatName==="HLS"),Z=E.serverUrl+E.path;r.hls=A.createHlsStream(O,Z)}};return v({open:l,close:a}),(O,h)=>{const E=ae("m-pagination"),Z=ae("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:b.value,tabindex:"-1","aria-hidden":"true"},[e("div",Vf,[e("div",Pf,[e("div",Of,[e("h5",Af,[h[10]||(h[10]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:h[0]||(h[0]=V=>a(!1)),"aria-label":"Close"})]),e("div",Lf,[z(Z,{errorMessage:o(G)},{default:F(()=>[e("div",Uf,[e("div",Hf,[e("div",Df,[R(e("select",{"onUpdate:modelValue":h[1]||(h[1]=V=>o($).query.categoryId=V),class:"form-select form-control-plaintext",id:"category",disabled:u.categoryId>0},[(t(!0),s(H,null,N(o($).lookups.categories,V=>(t(),s("option",{value:V.id,disabled:u.categoryId>0},c(V.name),9,qf))),256))],8,Ef),[[pe,o($).query.categoryId]]),h[11]||(h[11]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",Bf,[e("div",Nf,[R(e("select",{"onUpdate:modelValue":h[2]||(h[2]=V=>o($).query.genreId=V),class:"form-select",id:"genre"},[(t(!0),s(H,null,N(o($).lookups.genres,V=>(t(),s("option",{value:V.id},c(V.name),9,Rf))),256))],512),[[pe,o($).query.genreId]]),h[12]||(h[12]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",Ff,[e("div",zf,[e("div",Gf,[R(e("input",{"onUpdate:modelValue":h[3]||(h[3]=V=>o($).query.criteria=V),onKeyup:h[4]||(h[4]=Le(V=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[te,o($).query.criteria]]),h[13]||(h[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:h[5]||(h[5]=V=>o(y)(1))},h[14]||(h[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",jf,[R(e("div",Yf,[e("div",Wf,[h[19]||(h[19]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),r.vodSource?(t(),s("div",Kf,[e("div",Qf,[e("div",Jf,[R(e("input",{"onUpdate:modelValue":h[6]||(h[6]=V=>r.vodSource.video.title=V),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[te,r.vodSource.video.title]]),h[15]||(h[15]=e("label",{for:"title"},"Title",-1))])]),e("div",Xf,[e("div",null,[(t(!0),s(H,null,N(r.vodSource.video.genres,V=>(t(),s("span",Zf,c(V.genreName),1))),256)),(t(!0),s(H,null,N(r.vodSource.video.categories,V=>(t(),s("span",ep,c(V.categoryName),1))),256))])]),e("div",tp,[e("div",sp,[e("div",op,[e("div",ap,c(o(A).moment(r.vodSource.video.dateReleased).calendar()),1),h[16]||(h[16]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",lp,[e("div",np,[e("div",rp,c(o(A).moment.utc(r.vodSource.video.durationInMillis).format("HH:mm:ss")),1),h[17]||(h[17]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",ip,[e("div",dp,[R(e("textarea",{"onUpdate:modelValue":h[7]||(h[7]=V=>r.vodSource.video.description=V),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"11rem"}},null,512),[[te,r.vodSource.video.description]]),h[18]||(h[18]=e("label",{for:"description"},"Description",-1))])])])):L("",!0)])],512),[[_e,r.vodSource]]),e("div",{class:ee([r.vodSource?"col-md-8":"col-md-12"])},[e("div",up,[e("table",cp,[h[20]||(h[20]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o($).items,(V,re)=>(t(),s("tr",{key:V.videoId},[e("td",{textContent:c(o(K)(re)),class:"text-center"},null,8,mp),e("td",null,[e("div",fp,[e("div",null,[V.video.thumbnails.length>0?(t(!0),s(H,{key:0},N(V.video.thumbnails,J=>(t(),s("div",pp,[e("img",{src:J.url,class:"img-fuild border",width:"128"},null,8,vp)]))),256)):(t(),s("img",gp))]),e("div",bp,[e("a",{onClick:J=>g(V),class:"text-wrap link-offset-2",role:"button"},[r.vodSource===V?(t(),s("span",$p)):L("",!0),Y(c(V.name),1)],8,yp),e("div",null,[e("span",hp,c(o(A).moment.utc(V.video.durationInMillis).format("HH:mm:ss")),1)])])])])]))),128))]),_:1},512),[[_e,o($).items.length>0]])])]),z(E,{filter:o($),search:o(y),showPerPage:!0},null,8,["filter","search"])],2)])]),_:1},8,["errorMessage"])]),e("div",wp,[e("button",{onClick:h[8]||(h[8]=V=>a(!0)),class:"btn btn-primary btn-sm",type:"button",disabled:!r.vodSource},h[21]||(h[21]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)]),8,_p),e("button",{onClick:h[9]||(h[9]=V=>a(!1)),class:"btn btn-secondary btn-sm ms-1"},h[22]||(h[22]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Cf)}}},Sp=["disabled"],Tp={class:"container1"},Ip={class:"row"},Mp={class:"col-12 col-lg-5"},xp={class:"col"},Cp={class:"form-floating mb-2"},Vp=["value"],Pp={key:0,class:"d-block invalid-feedback"},Op={class:"col"},Ap={class:"input-group mb-2"},Lp={class:"form-floating"},Up={class:"col-12 col-lg-7"},Hp={class:"col"},Dp={class:"form-floating mb-2"},Ep={key:0,class:"d-block invalid-feedback"},qp={class:"row row-cols-1 row-cols-sm-3 mt-2"},Bp={class:"col"},Np={class:"form-floating mb-2"},Rp={key:0},Fp={key:1},zp={key:2},Gp={key:3,class:"d-block invalid-feedback"},jp={class:"col"},Yp={class:"form-floating mb-2"},Wp={key:0},Kp={key:1},Qp={key:2,class:"d-block invalid-feedback"},Jp={class:"col"},Xp={class:"form-floating mb-2"},Zp={key:0,class:"mt-3"},ev={class:"table-responsive border mt-1"},tv={class:"table table-sm mb-0 align-middle"},sv={class:"table-group-divider"},ov={class:"text-center"},av=["onUpdate:modelValue","onChange"],lv={key:0},nv=["onUpdate:modelValue","onChange"],rv={key:0},iv={key:1},dv={class:"text-start"},uv={class:"d-flex flex-row justify-content-end align-items-baseline"},cv=["onClick"],mv=["onClick"],fv={class:"col mt-2"},pv={class:"row row-cols-1 row-cols-sm-2"},vv={class:"col"},gv={class:"form-floating mb-2"},bv={class:"col"},yv={class:"form-floating mb-2"},$v={__name:"add",props:{urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Program Template"}),A=n,i=ge({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{vodSource:null},startOffsetTime:null,endOffsetTime:null,item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},hls:null}),T={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("sourceLocationId is required.",ie),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ne.withMessage("vodSourceId is required.",ie),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ne.withMessage("startOffsetMillis is required.",ie),minValue:Ee(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ne.withMessage("endOffsetMillis is required.",ie),minValue:Ee(0),$autoDirty:!0,$lazy:!0}}},$=Se(T,i),W=Ie(()=>{const Z=S.moment;if(i.startOffsetTime&&i.startOffsetTime!=="00:00:00"&&S.isValidTime(i.startOffsetTime)){const V=Z().startOf("day"),re=V.format("YYYY-MM-DD ")+i.startOffsetTime,oe=Z(re).subtract(V);return i.item.startOffsetMillis=oe.valueOf(),i.item.startOffsetMillis}return 0}),X=Ie(()=>{const Z=S.moment;if(i.endOffsetTime&&i.endOffsetTime!=="00:00:00"&&S.isValidTime(i.endOffsetTime)){const V=Z().startOf("day"),re=V.format("YYYY-MM-DD ")+i.endOffsetTime,oe=Z(re).subtract(V);return i.item.endOffsetMillis=oe.valueOf(),i.item.endOffsetMillis}return 0}),m=Ie(()=>i.item.endOffsetMillis-i.item.startOffsetMillis),y=Ie(()=>S.moment.utc(m.value).format("HH:mm:ss")),K=Ie(()=>{const Z=i.item.adBreaks;return Z&&Z.length>0?Z.reduce((re,J,oe)=>re+J.durationInMillis,0):0}),f=Ie(()=>{const Z=m.value+K.value;return S.moment.utc(Z).format("HH:mm:ss")}),M=Ie(()=>S.moment.utc(K.value).format("HH:mm:ss"));me(async()=>{await p()}),Ae(()=>{i.hls&&(i.hls.stopLoad(),i.hls.destroy())});const p=async()=>{await u(),await l()},u=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(V=>{i.lookups.sourceLocations=V.data,i.lookups.sourceLocations.length===1&&(i.item.sourceLocationId=i.lookups.sourceLocations[0].id)}),i.item.sourceLocationId&&await b(i.item.sourceLocationId)}catch(Z){P.value=S.getErrorMessageAsHtml(Z),window.scrollTo(0,0)}finally{}},b=async Z=>{try{const V=`/api/v1/vodSources/lookup/source-location/${Z}/?category=3`;await j.get(V).then(re=>{i.lookups.vodSources=re.data}),i.selected.vodSource=null,r()}catch(V){P.value=S.getErrorMessageAsHtml(V),window.scrollTo(0,0)}finally{}},r=async()=>{const Z=i.selected.vodSource;Z?(i.item.vodSourceId=Z.id,i.endOffsetTime=S.moment.utc(Z.durationInMillis).format("HH:mm:ss"),await d(Z.vodSourceId),O()):(i.selected.vodSource=null,i.item.vodSourceId=null,i.startOffsetTime=null,i.endOffsetTime=null,i.hls&&(i.hls.stopLoad(),i.hls.destroy()))},d=async Z=>{try{let V=`/api/v1/vodSources/${Z}/blank-frames`;const re=await j.get(V).then(J=>J.data);i.item.adBreaks=[],re&&re.length>0&&(i.item.adBreaks=re.map(J=>{const oe=(J.endInMillis-J.startInMillis)/2+J.startInMillis;return{offsetTime:S.moment.utc(oe).format("HH:mm:ss"),offsetMillis:oe,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch{}finally{}},l=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(V=>{i.lookups.adBreakSourceLocations=V.data})}catch(Z){P.value=S.getErrorMessageAsHtml(Z),window.scrollTo(0,0)}finally{}},a=()=>{const Z={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};i.item.adBreaks.push(Z)},U=Z=>{i.item.adBreaks.splice(Z,1)},I=Z=>{const V=S.moment,re=V().startOf("day"),J=re.format("YYYY-MM-DD ")+Z.offsetTime,C=V(J).subtract(re);Z.offsetMillis=C.valueOf()},g=Z=>{const V=S.moment,re=V().startOf("day"),J=re.format("YYYY-MM-DD ")+Z.durationTime,C=V(J).subtract(re);Z.durationInMillis=C.valueOf()},q=async()=>{const Z=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const re=S.clone(Z.item),J=re.adBreaks.filter(oe=>oe.durationInMillis>0).map(oe=>({offsetMillis:oe.offsetMillis,durationInMillis:oe.durationInMillis,vodSourceId:oe.vodSource?oe.vodSource.vodSourceId:null}));re.adBreaks=J,await j.post("/api/v1/programtemplates/",re).then(oe=>{G.success("Add Program Template","Program template added.",{onClose:async()=>{const C=`${A.urlView}/${oe.data}`;await Q.push(C)}})})}catch(re){P.value=S.getErrorMessageAsHtml(re),window.scrollTo(0,0)}finally{x.value=!1}},O=()=>{if(Hls.isSupported()){i.hls&&(i.hls.stopLoad(),i.hls.destroy());var Z=document.getElementById("video-add-program-template");const re=i.selected.vodSource.video.formats.find(oe=>oe.formatName==="HLS"),J=re.serverUrl+re.path;i.hls=S.createHlsStream(Z,J)}},h=async()=>{const Z=Ve(Be,{sourceLocationId:i.item.sourceLocationId,genreId:0,categoryId:3,withArn:!0},{chore:!0,keepInitial:!1}),{data:V,isCanceled:re}=await Z.reveal();if(Z.closeAll(),!re&&V){const J=V;i.selected.vodSource=J,i.item.vodSourceId=J.vodSourceId,i.startOffsetTime="00:00:00",i.endOffsetTime=S.moment.utc(J.video.durationInMillis).format("HH:mm:ss"),await d(J.vodSourceId),O()}},E=async Z=>{const V=Ve(Be,{sourceLocationId:null,genreId:0,categoryId:1,durationInMillis:Z.durationInMillis,withArn:!0},{chore:!0,keepInitial:!1}),{data:re,isCanceled:J}=await V.reveal();V.closeAll(),!J&&re&&(Z.vodSource=re)};return(Z,V)=>{const re=ae("router-link"),J=ae("PageHeader"),oe=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(J,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:V[0]||(V[0]=C=>q()),class:"btn btn-primary"},V[9]||(V[9]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Sp),z(re,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:F(()=>V[10]||(V[10]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(oe,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[e("div",null,[e("div",Tp,[e("div",Ip,[e("div",Mp,[e("div",xp,[e("div",Cp,[R(e("select",{"onUpdate:modelValue":V[1]||(V[1]=C=>i.item.sourceLocationId=C),onChange:V[2]||(V[2]=C=>b(i.item.sourceLocationId)),class:ee([o(S).getValidFeedbackCss(i.item.sourceLocationId),"form-select"]),id:"sourceLocationId"},[(t(!0),s(H,null,N(i.lookups.sourceLocations,C=>(t(),s("option",{value:C.id},c(C.name),9,Vp))),256))],34),[[pe,i.item.sourceLocationId]]),V[11]||(V[11]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o($).item.sourceLocationId.$error?(t(),s("div",Pp,[(t(!0),s(H,null,N(o($).item.sourceLocationId.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),e("div",Op,[e("div",Ap,[e("div",Lp,[e("div",{id:"selectedVodSource",class:ee([o(S).getValidFeedbackCss(i.selected.vodSource),"form-control"]),placeholder:"Title"},[i.selected.vodSource?(t(),s(H,{key:0},[Y(" ["+c(o(S).moment.utc(i.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+c(i.selected.vodSource.name),1)],64)):L("",!0)],2),V[12]||(V[12]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),i.item.sourceLocationId?(t(),s("button",{key:0,onClick:h,class:"btn btn-primary",type:"button"},V[13]||(V[13]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):L("",!0)])]),V[14]||(V[14]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program-template",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Up,[e("div",Hp,[e("div",Dp,[R(e("input",{"onUpdate:modelValue":V[3]||(V[3]=C=>i.item.name=C),id:"name",class:ee([o(S).getValidFeedbackCss(i.item.name),"form-control"]),placeholder:"Name"},null,2),[[te,i.item.name]]),V[15]||(V[15]=e("label",{for:"name",class:""},"Name",-1)),o($).item.name.$error?(t(),s("div",Ep,[(t(!0),s(H,null,N(o($).item.name.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),e("div",qp,[e("div",Bp,[e("div",null,[e("div",Np,[R(e("input",{"onUpdate:modelValue":V[4]||(V[4]=C=>i.startOffsetTime=C),type:"time",step:"1",id:"startOffsetTime",class:ee([o(S).getValidFeedbackCss(i.startOffsetTime),"form-control"])},null,2),[[te,i.startOffsetTime]]),V[16]||(V[16]=e("label",{for:"startOffsetTime",class:""}," Start OffSet Time ",-1))]),W.value>0&&W.value<3e4?(t(),s("div",Rp,V[17]||(V[17]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):L("",!0),W.value>X.value&&X.value>0?(t(),s("div",Fp,V[18]||(V[18]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):L("",!0),i.selected.vodSource&&W.value>=i.selected.vodSource.durationInMillis?(t(),s("div",zp,V[19]||(V[19]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):L("",!0),o($).item.startOffsetMillis.$error?(t(),s("div",Gp,[(t(!0),s(H,null,N(o($).item.startOffsetMillis.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),e("div",jp,[e("div",null,[e("div",Yp,[R(e("input",{"onUpdate:modelValue":V[5]||(V[5]=C=>i.endOffsetTime=C),type:"time",step:"1",id:"endOffsetTime",class:ee([o(S).getValidFeedbackCss(i.endOffsetTime),"form-control"])},null,2),[[te,i.endOffsetTime]]),V[20]||(V[20]=e("label",{for:"endOffsetTime",class:""}," End OffSet Time ",-1))]),X.value>0&&X.value<3e4?(t(),s("div",Wp,V[21]||(V[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):L("",!0),i.selected.vodSource&&X.value>i.selected.vodSource.durationInMillis?(t(),s("div",Kp,V[22]||(V[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):L("",!0),o($).item.endOffsetMillis.$error?(t(),s("div",Qp,[(t(!0),s(H,null,N(o($).item.endOffsetMillis.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),e("div",Jp,[e("div",Xp,[R(e("input",{"onUpdate:modelValue":V[6]||(V[6]=C=>y.value=C),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[te,y.value]]),V[23]||(V[23]=e("label",{for:"durationTime"},"Clip",-1))])])]),i.item.vodSourceId?(t(),s("div",Zp,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[V[25]||(V[25]=e("div",{class:"fw-bold small"}," Ad Break ",-1)),e("div",null,[e("button",{onClick:a,class:"btn btn-outline-primary btn-sm"},V[24]||(V[24]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",ev,[e("table",tv,[V[29]||(V[29]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",sv,[(t(!0),s(H,null,N(i.item.adBreaks,(C,ue)=>(t(),s("tr",null,[e("td",ov,c(ue+1),1),e("td",null,[R(e("input",{"onUpdate:modelValue":se=>C.offsetTime=se,onChange:se=>I(C),type:"time",step:"1",class:ee([o(S).getValidFeedbackCss(C.offsetTime),"form-control"])},null,42,av),[[te,C.offsetTime]]),C.offsetMillis>=i.selected.vodSource.durationInMillis?(t(),s("div",lv,V[26]||(V[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):L("",!0)]),e("td",null,[R(e("input",{"onUpdate:modelValue":se=>C.durationTime=se,onChange:se=>g(C),type:"time",step:"1",class:ee([o(S).getValidFeedbackCss(C.durationTime),"form-control"])},null,42,nv),[[te,C.durationTime]])]),e("td",null,[C.vodSource?(t(),s("span",rv,c(C.vodSource.name),1)):L("",!0),C.durationInMillis<=0?(t(),s("span",iv," Specify the Ad Break Duration Time to configure the VOD to assign ")):L("",!0)]),e("td",dv,[e("div",uv,[C.durationInMillis>0?(t(),s("button",{key:0,onClick:se=>E(C),class:"btn btn-outline-info btn-sm"},V[27]||(V[27]=[e("span",{class:"fas fa-fw fa-cog"},null,-1)]),8,cv)):L("",!0),e("button",{onClick:se=>U(ue),class:"btn btn-outline-warning btn-sm ms-2"},V[28]||(V[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,mv)])])]))),256))])]),V[30]||(V[30]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),Y(" Vod source can also be defined during creation of Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):L("",!0),e("div",fv,[V[33]||(V[33]=e("div",{class:"fw-bold small"}," Duration ",-1)),e("div",pv,[e("div",vv,[e("div",gv,[R(e("input",{"onUpdate:modelValue":V[7]||(V[7]=C=>M.value=C),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[te,M.value]]),V[31]||(V[31]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",bv,[e("div",yv,[R(e("input",{"onUpdate:modelValue":V[8]||(V[8]=C=>f.value=C),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[te,f.value]]),V[32]||(V[32]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},hv=["disabled"],wv={class:"container1"},_v={class:"row"},kv={class:"col-12 col-lg-5"},Sv={class:"col"},Tv={class:"form-floating mb-2"},Iv=["value"],Mv={key:0,class:"d-block invalid-feedback"},xv={class:"col"},Cv={class:"form-floating"},Vv={id:"selectedVodSource",class:"form-control",placeholder:"Title"},Pv={class:"col-12 col-lg-7"},Ov={class:"col"},Av={class:"form-floating mb-2"},Lv={key:0,class:"d-block invalid-feedback"},Uv={class:"row row-cols- row-cols-sm-3"},Hv={class:"col"},Dv={class:"form-floating mb-2"},Ev={key:0},qv={key:1},Bv={key:2},Nv={key:3,class:"d-block invalid-feedback"},Rv={class:"col"},Fv={class:"form-floating"},zv={key:0},Gv={key:1},jv={key:2,class:"d-block invalid-feedback"},Yv={class:"col"},Wv={class:"form-floating mb-2"},Kv={key:0,class:"mt-2"},Qv={class:"table-responsive border mt-1"},Jv={class:"table table-sm mb-0 align-middle"},Xv={class:"table-group-divider"},Zv=["onUpdate:modelValue","onChange"],eg={key:0},tg=["onUpdate:modelValue","onChange"],sg={key:0},og=["onClick"],ag={key:1},lg={class:"text-start"},ng={class:"d-flex flex-row justify-content-end align-items-baseline"},rg=["onClick"],ig=["onClick"],dg={class:"col mt-2"},ug={class:"row row-cols-1 row-cols-sm-2"},cg={class:"col"},mg={class:"form-floating mb-2"},fg={class:"col"},pg={class:"form-floating mb-2"},vg={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,closeWithReturnUrl:B,security:A}=ye({appTitle:"Arcadian-FAST",pageTitle:"Edit Program Template"}),i=n,T=ge({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{sourceLocation:null,vodSource:null},startOffsetTime:"00:00:00",endOffsetTime:"00:00:00",item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),$=fe(!0),W={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("sourceLocationId is required.",ie),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ne.withMessage("vodSourceId is required.",ie),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ne.withMessage("startOffsetMillis is required.",ie),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ne.withMessage("endOffsetMillis is required.",ie),$autoDirty:!0,$lazy:!0}}},X=Se(W,T),m=Ie(()=>{if(T.startOffsetTime&&T.startOffsetTime!=="00:00:00"&&S.isValidTime(T.startOffsetTime)){const oe=S.moment,C=oe().startOf("day"),se=oe(T.startOffsetTime,"hh:mm:ss").diff(C);return T.item.startOffsetMillis=se.valueOf(),T.item.startOffsetMillis}return 0}),y=Ie(()=>{if(T.endOffsetTime&&T.endOffsetTime!=="00:00:00"&&S.isValidTime(T.endOffsetTime)){const oe=S.moment,C=oe().startOf("day"),se=oe(T.endOffsetTime,"hh:mm:ss").diff(C);return T.item.endOffsetMillis=se.valueOf(),T.item.endOffsetMillis}return 0}),K=Ie(()=>T.item.endOffsetMillis-T.item.startOffsetMillis),f=Ie(()=>S.moment.utc(K.value).format("HH:mm:ss")),M=Ie(()=>{const oe=T.item.adBreaks;return oe&&oe.length>0?oe.reduce((ue,se,w)=>ue+se.durationInMillis,0):0}),p=Ie(()=>{const oe=K.value+M.value;return S.moment.utc(oe).format("HH:mm:ss")}),u=Ie(()=>S.moment.utc(M.value).format("HH:mm:ss"));me(async()=>{await b()});const b=async()=>{$.value=!0,await r(),await d(),await l()},r=async()=>{try{const oe=`/api/v1/programtemplates/${i.id}/`;await j.get(oe).then(C=>{T.item=C.data}),T.startOffsetTime=S.moment.utc(T.item.startOffsetMillis).format("HH:mm:ss"),T.endOffsetTime=S.moment.utc(T.item.endOffsetMillis).format("HH:mm:ss"),T.item.adBreaks.forEach(C=>{C.offsetTime=S.moment.utc(C.offsetMillis).format("HH:mm:ss"),C.durationTime=S.moment.utc(C.durationInMillis).format("HH:mm:ss")})}catch(oe){P.value=S.getErrorMessageAsHtml(oe),window.scrollTo(0,0)}finally{}},d=async()=>{try{const oe=`/api/v1/vodSources/${T.item.vodSourceId}/`;await j.get(oe).then(C=>{T.selected.vodSource=C.data}),Z()}catch(oe){P.value=S.getErrorMessageAsHtml(oe),window.scrollTo(0,0)}finally{}},l=async()=>{await a()},a=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(C=>{T.lookups.sourceLocations=C.data}),T.item.sourceLocationId&&await U(T.item.sourceLocationId)}catch(oe){P.value=S.getErrorMessageAsHtml(oe),window.scrollTo(0,0)}finally{}},U=async oe=>{try{const C=`/api/v1/vodSources/lookup/source-location/${oe}/?type=3`;if(await j.get(C).then(ue=>{T.lookups.vodSources=ue.data}),$.value){$.value=!1;return}T.selected.vodSource=null,I()}catch(C){P.value=S.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{}},I=async()=>{const oe=T.selected.vodSource;if(oe){debugger;T.item.vodSourceId=oe.vodSourceId,T.startOffsetTime=S.moment.utc(0).format("HH:mm:ss"),T.endOffsetTime=S.moment.utc(oe.video.durationInMillis).format("HH:mm:ss"),Z()}else T.selected.vodSource=null,T.item.vodSourceId=null,T.startOffsetTime=null,T.endOffsetTime=null,T.hls&&(T.hls.stopLoad(),T.hls.destroy())},g=()=>{const oe={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};T.item.adBreaks.push(oe)},q=oe=>{T.item.adBreaks.splice(oe,1)},O=oe=>{const C=S.moment,ue=C().startOf("day"),se=ue.format("YYYY-MM-DD ")+oe.offsetTime,ce=C(se).subtract(ue);oe.offsetMillis=ce.valueOf()},h=oe=>{const C=S.moment,ue=C().startOf("day"),se=ue.format("YYYY-MM-DD ")+oe.durationTime,ce=C(se).subtract(ue);oe.durationInMillis=ce.valueOf()},E=async()=>{const oe=T;if(x.value)return;if(!await X.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const ue=S.clone(oe.item);debugger;const se=ue.adBreaks.filter(w=>w.durationInMillis>0).map(w=>{debugger;return{offsetMillis:w.offsetMillis,durationInMillis:w.durationInMillis,vodSourceId:w.vodSource?w.vodSource.vodSourceId:null}});ue.adBreaks=se,await j.put("/api/v1/programtemplates/",ue).then(w=>{G.success("Edit Program Template","Program template edit.",{onClose:async()=>{const ce=`${i.urlView}/${i.id}`;await Q.push(ce)}})})}catch(ue){P.value=S.getErrorMessageAsHtml(ue),window.scrollTo(0,0)}finally{x.value=!1}},Z=()=>{if(Hls.isSupported()){T.hls&&(T.hls.stopLoad(),T.hls.destroy());var oe=document.getElementById("video-edit-program-template");const ue=T.selected.vodSource.video.formats.find(w=>w.formatName==="HLS"),se=ue.serverUrl+ue.path;T.hls=S.createHlsStream(oe,se)}},V=async oe=>{try{let C=`/api/v1/vodSources/${oe}/blank-frames`;const ue=await j.get(C).then(se=>se.data);T.item.adBreaks=[],ue&&ue.length>0&&(T.item.adBreaks=ue.map(se=>{const w=(se.endInMillis-se.startInMillis)/2+se.startInMillis;return{offsetTime:S.moment.utc(w).format("HH:mm:ss"),offsetMillis:w,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch(C){P.value=S.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{}},re=async()=>{const oe=Ve(Be,{sourceLocationId:T.sourceLocationId,genreId:0,categoryId:3,withArn:!0},{chore:!0,keepInitial:!1}),{data:C,isCanceled:ue}=await oe.reveal();if(oe.closeAll(),!ue&&C){const se=C;T.selected.vodSource=se,T.item.vodSourceId=se.vodSourceId,I(),await V(se.vodSourceId)}},J=async oe=>{const C=Ve(Be,{sourceLocationId:null,genreId:0,categoryId:1,durationInMillis:oe.durationInMillis,withArn:!0},{chore:!0,keepInitial:!1}),{data:ue,isCanceled:se}=await C.reveal();C.closeAll(),!se&&ue&&(oe.vodSource=ue)};return(oe,C)=>{const ue=ae("PageHeader"),se=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(ue,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o(X).$dirty&&o(X).$invalid,onClick:C[0]||(C[0]=w=>E()),class:"btn btn-primary"},C[11]||(C[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,hv),e("button",{onClick:C[1]||(C[1]=w=>b()),class:"btn btn-secondary ms-2"},C[12]||(C[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:C[2]||(C[2]=w=>o(B)(i.urlMain)),class:"btn btn-secondary ms-1"},C[13]||(C[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(se,{errorMessage:o(P),vuelidate:o(X)},{default:F(()=>[e("div",null,[e("div",wv,[e("div",_v,[e("div",kv,[e("div",Sv,[e("div",Tv,[R(e("select",{"onUpdate:modelValue":C[3]||(C[3]=w=>T.item.sourceLocationId=w),onChange:C[4]||(C[4]=w=>U(T.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(H,null,N(T.lookups.sourceLocations,w=>(t(),s("option",{value:w.id},c(w.name),9,Iv))),256))],544),[[pe,T.item.sourceLocationId]]),C[14]||(C[14]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(X).item.sourceLocationId.$error?(t(),s("div",Mv,[(t(!0),s(H,null,N(o(X).item.sourceLocationId.$errors,w=>(t(),s("div",{key:w.$uid},c(w.$message),1))),128))])):L("",!0)])]),e("div",xv,[e("div",{onClick:re,class:"input-group mb-2"},[e("div",Cv,[e("div",Vv,[T.selected.vodSource?(t(),s(H,{key:0},[Y(" ["+c(o(S).moment.utc(T.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+c(T.selected.vodSource.name),1)],64)):L("",!0)]),C[15]||(C[15]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),C[16]||(C[16]=e("button",{class:"btn btn-primary",type:"button"},[e("i",{class:"fa-solid fa-filter"})],-1))])]),C[17]||(C[17]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-edit-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Pv,[e("div",Ov,[e("div",Av,[R(e("input",{"onUpdate:modelValue":C[5]||(C[5]=w=>T.item.name=w),id:"name",class:ee([o(S).getValidFeedbackCss(T.item.name),"form-control"]),placeholder:"Name"},null,2),[[te,T.item.name]]),C[18]||(C[18]=e("label",{for:"name",class:""},"Name",-1)),o(X).item.name.$error?(t(),s("div",Lv,[(t(!0),s(H,null,N(o(X).item.name.$errors,w=>(t(),s("div",{key:w.$uid},' d" '+c(w.$message),1))),128))])):L("",!0)])]),e("div",Uv,[e("div",Hv,[e("div",Dv,[R(e("input",{"onUpdate:modelValue":C[6]||(C[6]=w=>T.startOffsetTime=w),type:"time",step:"1",id:"startOffsetTime",class:ee([o(S).getValidFeedbackCss(T.startOffsetTime),"form-control"])},null,2),[[te,T.startOffsetTime]]),C[19]||(C[19]=e("label",{for:"startOffsetTime",class:""},"Start OffSet Time",-1))]),m.value>0&&m.value<3e4?(t(),s("div",Ev,C[20]||(C[20]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):L("",!0),m.value>y.value&&y.value>0?(t(),s("div",qv,C[21]||(C[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):L("",!0),T.selected.vodSource&&m.value>=T.selected.vodSource.durationInMillis?(t(),s("div",Bv,C[22]||(C[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):L("",!0),o(X).item.startOffsetMillis.$error?(t(),s("div",Nv,[(t(!0),s(H,null,N(o(X).item.startOffsetMillis.$errors,w=>(t(),s("div",{key:w.$uid},c(w.$message),1))),128))])):L("",!0)]),e("div",Rv,[e("div",Fv,[R(e("input",{"onUpdate:modelValue":C[7]||(C[7]=w=>T.endOffsetTime=w),type:"time",step:"1",id:"endOffsetTime",class:ee([o(S).getValidFeedbackCss(T.endOffsetTime),"form-control"])},null,2),[[te,T.endOffsetTime]]),C[23]||(C[23]=e("label",{for:"endOffsetTime",class:""},"End OffSet Time",-1))]),y.value>0&&y.value<3e4?(t(),s("div",zv,C[24]||(C[24]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):L("",!0),T.selected.vodSource&&y.value>T.selected.vodSource.durationInMillis?(t(),s("div",Gv,C[25]||(C[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):L("",!0),o(X).item.endOffsetMillis.$error?(t(),s("div",jv,[(t(!0),s(H,null,N(o(X).item.endOffsetMillis.$errors,w=>(t(),s("div",{key:w.$uid},c(w.$message),1))),128))])):L("",!0)]),e("div",Yv,[e("div",Wv,[R(e("input",{"onUpdate:modelValue":C[8]||(C[8]=w=>f.value=w),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[te,f.value]]),C[26]||(C[26]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),T.selected.vodSource?(t(),s("div",Kv,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[C[28]||(C[28]=e("b",null," Ad Break ",-1)),e("div",null,[e("button",{onClick:g,class:"btn btn-outline-primary btn-sm"},C[27]||(C[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",Qv,[e("table",Jv,[C[33]||(C[33]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",Xv,[(t(!0),s(H,null,N(T.item.adBreaks,(w,ce)=>(t(),s("tr",null,[e("td",null,c(ce+1),1),e("td",null,[R(e("input",{"onUpdate:modelValue":we=>w.offsetTime=we,onChange:we=>O(w),type:"time",step:"1",class:"form-control"},null,40,Zv),[[te,w.offsetTime]]),w.offsetMillis>=T.selected.vodSource.durationInMillis?(t(),s("div",eg,C[29]||(C[29]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):L("",!0)]),e("td",null,[R(e("input",{"onUpdate:modelValue":we=>w.durationTime=we,onChange:we=>h(w),type:"time",step:"1",class:"form-control"},null,40,tg),[[te,w.durationTime]])]),e("td",null,[w.vodSource?(t(),s("span",sg,[e("button",{onClick:we=>w.vodSource=null,class:"btn btn-outline-warning btn-sm me-1"},C[30]||(C[30]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]),8,og),Y(c(w.vodSource.name),1)])):L("",!0),w.durationInMillis<=0?(t(),s("span",ag," Specify the Ad Break Duration Time to configure the VOD to assign ")):L("",!0)]),e("td",lg,[e("div",ng,[w.durationInMillis>0?(t(),s("button",{key:0,onClick:we=>J(w),class:"btn btn-outline-info btn-sm"},C[31]||(C[31]=[e("span",{class:"fas fa-fw fa-cog"},null,-1)]),8,rg)):L("",!0),e("button",{onClick:we=>q(ce),class:"btn btn-outline-warning btn-sm ms-2"},C[32]||(C[32]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,ig)])])]))),256))])]),C[34]||(C[34]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),Y(" Vod source can also be defined during creation of Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):L("",!0),e("div",dg,[C[37]||(C[37]=e("b",null," Duration ",-1)),e("div",ug,[e("div",cg,[e("div",mg,[R(e("input",{"onUpdate:modelValue":C[9]||(C[9]=w=>u.value=w),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[te,u.value]]),C[35]||(C[35]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",fg,[e("div",pg,[R(e("input",{"onUpdate:modelValue":C[10]||(C[10]=w=>p.value=w),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[te,p.value]]),C[36]||(C[36]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},gg={class:"ms-1"},bg={class:"input-group"},yg={class:"table-responsive border shadow-sm"},$g={class:"table table-hover mb-0"},hg=["textContent"],wg={class:"d-flex flex-column flex-lg-row justify-content-start"},_g={class:""},kg={class:"mb-11"},Sg=["src"],Tg={class:"ms-lg-2"},Ig={key:0,class:"fas fa-fw fa-check-circle text-success"},Mg={class:"text-wrap text-truncate",style:{width:"20px !important"}},xg={class:"badge bg-primary me-1"},Cg={key:0},Vg={class:"badge bg-info me-1"},Pg={class:"text-end me-0 me-sm-5"},Og={class:"text-center"},Ag={class:"mt-3 mt-lg-2"},Lg="/api/v1/programTemplates/search",Ug={__name:"index",props:{urlAdd:{type:String,default:"/program-templates/add"},urlView:{type:String,default:"/program-templates/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(n){Me("$config");const k=$e().user,{appTitle:x,pageTitle:_,busy:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,generateReturnUrl:i,security:T,filter:$,initializeFilter:W,getQuery:X,saveQuery:m,search:y,getRowNumber:K,setSelected:f,isSelected:M}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Program Templates",cacheKey:`${k==null?void 0:k.userId}/program-templates/search`,baseUrl:Lg,filter:{updateUrl:!0}});return me(async()=>{W(),await y()}),(p,u)=>{const b=ae("router-link"),r=ae("PageHeader"),d=ae("m-pagination"),l=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(r,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(_)},{default:F(()=>[z(b,{to:n.urlAdd,class:"btn btn-primary"},{default:F(()=>u[3]||(u[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",gg,[e("div",bg,[R(e("input",{"onUpdate:modelValue":u[0]||(u[0]=a=>o($).query.criteria=a),onKeyup:u[1]||(u[1]=Le(a=>o(y)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[te,o($).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:u[2]||(u[2]=a=>o(y)(1))},u[4]||(u[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(l,{errorMessage:o(j)},{default:F(()=>[e("div",yg,[e("table",$g,[u[5]||(u[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th",null,"Source")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o($).items,(a,U)=>(t(),s("tr",{key:a.programTemplateId},[e("td",{textContent:c(o(K)(U)),class:"text-center"},null,8,hg),e("td",null,[e("div",wg,[e("div",_g,[a.vodSource.video.thumbnails.length>0?(t(!0),s(H,{key:0},N(a.vodSource.video.thumbnails,I=>(t(),s("div",kg,[e("img",{src:I.url,class:"img-fuild border",width:"128"},null,8,Sg)]))),256)):L("",!0)]),e("div",Tg,[z(b,{to:`${n.urlView}/${a.programTemplateId}`,class:"d-inline-block text-wrap link-offset-2"},{default:F(()=>[a.arn?(t(),s("span",Ig)):L("",!0),e("span",Mg,c(a.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(H,null,N(a.vodSource.video.categories,I=>(t(),s("div",null,[e("span",xg,c(I.categoryName),1)]))),256)),a.vodSource.video.genres.length>0?(t(),s("div",Cg,[(t(!0),s(H,null,N(a.vodSource.video.genres,I=>(t(),s("span",Vg,c(I.genreName),1))),256))])):L("",!0)])])])]),e("td",Pg,c(o(le).moment.utc(a.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",Og,c(a.adBreaks.length),1),e("td",null,[e("div",null,[z(b,{to:`${n.urlViewSourceLocation}/${a.sourceLocationId}/${o(i)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(a.sourceLocation.name),1)]),_:2},1032,["to"])]),e("div",Ag,[z(b,{to:`${n.urlViewVodSource}/${a.vodSourceId}/${o(i)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(a.vodSource.name),1)]),_:2},1032,["to"])])])]))),128))]),_:1},512),[[_e,o($).items.length>0]])])]),z(d,{filter:o($),search:o(y),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Hg={key:0},Dg={class:"nav nav-tabs",id:"myTab",role:"tablist"},Eg={class:"nav-item",role:"presentation"},qg={class:"nav-item",role:"presentation"},Bg={class:"nav-item d-none",role:"presentation"},Ng={class:"tab-content",id:"myTabContent"},Rg={class:""},Fg={class:""},zg={class:"row row-cols-1 row-cols-lg-2"},Gg={class:"col"},jg={class:"col"},Yg={class:"form-floating mb-2"},Wg={id:"sourceLocation",class:"form-control-plaintext"},Kg={class:"col"},Qg={class:"form-floating mb-2"},Jg={id:"vodSource",class:"form-control-plaintext"},Xg={class:"col"},Zg={class:"col"},e1={class:"form-floating mb-2"},t1={class:"row row-cols-1 row-cols-sm-3"},s1={class:"col"},o1={class:"form-floating mb-2"},a1={class:"col"},l1={class:"form-floating mb-2"},n1={class:"col"},r1={class:"form-floating mb-2"},i1={class:"row row-cols-1 row-cols-sm-3"},d1={class:"col"},u1={class:"form-floating mb-2"},c1={class:"col"},m1={class:"form-floating mb-2"},f1={class:""},p1={class:"table-responsive border"},v1={class:"table table-hover mb-0"},g1={class:"text-center"},b1={key:0},y1={class:"mt-2"},$1={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/program-templates"},urlEdit:{type:String,default:"/program-templates/edit"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const v=n,{appTitle:k,pageTitle:x,busy:_,isDirty:D,validations:P,infoMessage:Q,warningMessage:j,errorMessage:S,router:G,axios:le,utils:B,toasts:A,close:i,closeWithReturnUrl:T,generateReturnUrl:$,security:W}=ye({appTitle:"Arcadian-FAST",pageTitle:"View Program Template"});Me("$config");const X=$e();X.user;const m=ge({user:X.user,item:null,hls:null}),y=fe();me(async()=>{await p(),y.value=B.getPageTab("programTemplate")||"information-tab"});const K=r=>{B.setPageTab("programTemplate",r),y.value=r},f=r=>r!==y.value?"":"active",M=r=>r!==y.value?"":"show active",p=async()=>{const r=m;if(!_.value)try{_.value=!0,S.value="",m.item=null;const d=`/api/v1/programTemplates/${v.id}/`;await le.get(d).then(l=>{r.item=l.data;const a=r.item;a.startOffsetTime=B.moment.utc(a.startOffsetMillis).format("HH:mm:ss"),a.endOffsetTime=B.moment.utc(a.endOffsetMillis).format("HH:mm:ss"),a.durationTime=B.moment.utc(a.durationInMillis).format("HH:mm:ss"),a.adBreaksDurationTime=B.moment.utc(a.adBreaksDurationInMillis).format("HH:mm:ss"),a.totalProgramTemplateDurationTime=B.moment.utc(a.totalProgramTemplateDurationInMillis).format("HH:mm:ss");const U=a.vodSource.video,I=U.durationInMillis;U.durationInMillis=B.moment.utc(I).format("HH:mm:ss")}),m.item.vodSource&&await b(m.item.vodSourceId)}catch(d){S.value=B.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{_.value=!1}},u=async()=>{await p()},b=async r=>{try{let d=`/api/v1/vodSources/${r}/hls`;const l=await le.get(d).then(U=>U.data);m.hls&&m.hls.destroy();const a=document.getElementById("video-view-program-template");m.hls=B.createHlsStream(a,l,"Previewing VOD.")}catch(d){S.value=B.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}};return(r,d)=>{const l=ae("router-link"),a=ae("PageHeader"),U=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(a,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(x)},{default:F(()=>[z(l,{to:`${n.urlEdit}/${n.id}/${o($)()}`,class:"ms-2 btn btn-primary"},{default:F(()=>d[11]||(d[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:d[0]||(d[0]=I=>u()),class:"ms-2 btn btn-secondary"},d[12]||(d[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:d[1]||(d[1]=I=>o(T)(v.urlMain)),class:"btn btn-secondary ms-1"},d[13]||(d[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(U,{errorMessage:o(S)},{default:F(()=>[m.item?(t(),s("div",Hg,[e("div",null,[e("ul",Dg,[e("li",Eg,[e("button",{onClick:d[2]||(d[2]=I=>K("information-tab")),class:ee([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",qg,[e("button",{onClick:d[3]||(d[3]=I=>K("adBreaks-tab")),class:ee([f("adBreaks-tab"),"nav-link"]),id:"adBreaks-tab","data-bs-toggle":"tab","data-bs-target":"#adBreaks",type:"button",role:"tab","aria-controls":"adBreaks","aria-selected":"false"}," Ad Breaks ",2)]),e("li",Bg,[e("button",{onClick:d[4]||(d[4]=I=>K("programs-tab")),class:ee([f("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",Ng,[e("div",{class:ee([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Rg,[e("div",Fg,[e("div",zg,[e("div",Gg,[e("div",jg,[e("div",Yg,[e("div",Wg,[z(l,{to:`${n.urlViewSourceLocation}/${m.item.sourceLocationId}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(m.item.sourceLocation.name),1)]),_:1},8,["to"])]),d[14]||(d[14]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",Kg,[e("div",Qg,[e("div",Jg,[z(l,{to:`${n.urlViewVodSource}/${m.item.vodSourceId}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(m.item.vodSource.name),1)]),_:1},8,["to"])]),d[15]||(d[15]=e("label",{for:"vodSource",class:""},"VOD Name",-1))])]),d[16]||(d[16]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-view-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Xg,[e("div",Zg,[e("div",e1,[R(e("input",{"onUpdate:modelValue":d[5]||(d[5]=I=>m.item.name=I),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[te,m.item.name]]),d[17]||(d[17]=e("label",{for:"name",class:""},"Name",-1))])]),e("div",t1,[e("div",s1,[e("div",o1,[R(e("input",{"onUpdate:modelValue":d[6]||(d[6]=I=>m.item.startOffsetTime=I),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[te,m.item.startOffsetTime]]),d[18]||(d[18]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",a1,[e("div",l1,[R(e("input",{"onUpdate:modelValue":d[7]||(d[7]=I=>m.item.endOffsetTime=I),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[te,m.item.endOffsetTime]]),d[19]||(d[19]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",n1,[e("div",r1,[R(e("input",{"onUpdate:modelValue":d[8]||(d[8]=I=>m.item.durationTime=I),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[te,m.item.durationTime]]),d[20]||(d[20]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",i1,[e("div",d1,[e("div",u1,[R(e("input",{"onUpdate:modelValue":d[9]||(d[9]=I=>m.item.adBreaksDurationTime=I),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[te,m.item.adBreaksDurationTime]]),d[21]||(d[21]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks",-1))])]),e("div",c1,[e("div",m1,[R(e("input",{"onUpdate:modelValue":d[10]||(d[10]=I=>m.item.totalProgramTemplateDurationTime=I),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[te,m.item.totalProgramTemplateDurationTime]]),d[22]||(d[22]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])])])])])])])],2),e("div",{class:ee([M("adBreaks-tab"),"tab-pane fade"]),id:"adBreaks",role:"tabpanel","aria-labelledby":"adBreaks-tab"},[e("div",f1,[e("div",p1,[e("table",v1,[d[23]||(d[23]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"Vod Source")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.adBreaks,(I,g)=>(t(),s("tr",{key:I.programTemplateAdBreakId},[e("td",g1,c(g+1),1),e("td",null,c(o(B).moment.utc(I.offsetMillis).format("HH:mm:ss")),1),e("td",null,c(o(B).moment.utc(I.durationInMillis).format("HH:mm:ss")),1),e("td",null,[I.vodSource?(t(),s("span",b1,[z(l,{to:`${n.urlViewVodSource}/${I.vodSourceId}/${o($)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(I.vodSource.name),1)]),_:2},1032,["to"])])):L("",!0)])]))),128))]),_:1},512),[[_e,m.item.adBreaks.length>0]])])])])],2),e("div",{class:ee([M("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",y1,[e("pre",null,c(m.item.programs),1)])],2)])])])):L("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},h1=["disabled"],w1={class:"row row-cols-1 row-cols-lg-2"},_1={class:"col"},k1={class:""},S1={class:"col"},T1={class:"form-floating mb-2"},I1={key:0,class:"d-block invalid-feedback"},M1={class:"col"},x1={class:"form-floating mb-2"},C1={key:0,class:"d-block invalid-feedback"},V1={class:"col"},P1={class:"form-floating mb-2"},O1=["disabled"],A1={key:0,class:"d-block invalid-feedback"},L1={class:"col"},U1={class:""},H1={class:"col"},D1={class:"form-floating mb-2"},E1=["value"],q1={key:0,class:"d-block invalid-feedback"},B1={class:"col"},N1={class:"input-group mb-2"},R1={class:"form-floating"},F1={__name:"add",props:{urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Channel"}),A=n,i=ge({lookups:{sourceLocations:[],vodSources:[]},selected:{vodSource:null},item:{name:"",tier:"STANDARD",playbackMode:"LINEAR",fillerSlateSourceLocationId:null,fillerSlateVodSourceId:null,policy:null},hls:null}),T={item:{name:{title:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},tier:{title:ne.withMessage("Tier is required.",ie),$autoDirty:!0,$lazy:!0},playbackMode:{title:ne.withMessage("PlaybackMode is required.",ie),$autoDirty:!0,$lazy:!0},fillerSlateSourceLocationId:{title:ne.withMessage("Filler Slate Source Location is required.",ie),$autoDirty:!0,$lazy:!0},fillerSlateVodSourceId:{title:ne.withMessage("Filler Slate Vod Source is required.",ie),$autoDirty:!0,$lazy:!0},policy:{title:ne.withMessage("Policy is required.",ie),$autoDirty:!0,$lazy:!0}}},$=Se(T,i);me(async()=>{await W()});const W=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(b=>{i.lookups.sourceLocations=b.data,i.lookups.sourceLocations.length===1&&(i.item.fillerSlateSourceLocationId=i.lookups.sourceLocations[0].id)}),i.item.fillerSlateSourceLocationId&&await m(i.item.fillerSlateSourceLocationId)}catch(u){P.value=S.getErrorMessageAsHtml(u),window.scrollTo(0,0)}finally{}},X=async()=>{i.item.fillerSlateVodSourceId=null,await m(i.item.fillerSlateSourceLocationId)},m=async u=>{try{let b=`/api/v1/vodSources/lookup/source-location/${u}/?category=2`;await j.get(b).then(r=>{i.lookups.vodSources=r.data})}catch(b){P.value=S.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},y=()=>{if(i.item.name){const u=`{"Version":"2012-10-17","Statement": [{"Sid":"AllowAnonymous","Effect":"Allow","Principal":"*","Action":"mediatailor:GetManifest","Resource":"arn:aws:mediatailor:us-west-2:799350865909:channel/${i.item.name}"}]}`;i.item.policy=u}else i.item.policy=null},K=async()=>{const u=i;if(x.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{x.value=!0,P.value="";const r=S.clone(u.item);await j.post("/api/v1/channels/",r).then(d=>{G.success("Add Channel","Channel added.",{onClose:async()=>{const l=`${A.urlView}/${d.data}`;await Q.push(l)}})})}catch(r){P.value=S.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{x.value=!1}},f=()=>{i.item.playbackMode==="LOOP"&&i.item.tier!=="BASIC"&&(i.item.tier="BASIC")},M=async()=>{const u=Ve(Be,{sourceLocationId:i.item.sourceLocationId,genreId:0,categoryId:2,withArn:!0},{chore:!0,keepInitial:!1}),{data:b,isCanceled:r}=await u.reveal();if(u.closeAll(),!r&&b){const d=b;i.selected.vodSource=d,i.item.fillerSlateVodSourceId=d.vodSourceId,p()}},p=()=>{if(Hls.isSupported()){i.hls&&(i.hls.stopLoad(),i.hls.destroy());var u=document.getElementById("video-preview");const r=i.selected.vodSource.video.formats.find(l=>l.formatName==="HLS"),d=r.serverUrl+r.path;i.hls=S.createHlsStream(u,d)}};return(u,b)=>{const r=ae("router-link"),d=ae("PageHeader"),l=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(d,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(k)},{default:F(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:b[0]||(b[0]=a=>K()),class:"btn btn-primary"},b[8]||(b[8]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,h1),z(r,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:F(()=>b[9]||(b[9]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(l,{errorMessage:o(P),vuelidate:o($)},{default:F(()=>[e("div",w1,[e("div",_1,[e("div",k1,[e("div",S1,[e("div",T1,[R(e("input",{"onUpdate:modelValue":b[1]||(b[1]=a=>i.item.name=a),onChange:b[2]||(b[2]=a=>y()),id:"name",class:ee([o(S).getValidFeedbackCss(i.item.name),"form-control"]),placeholder:"name"},null,34),[[te,i.item.name]]),b[10]||(b[10]=e("label",{for:"name",class:""},"Name",-1)),o($).item.name.$error?(t(),s("div",I1,[(t(!0),s(H,null,N(o($).item.name.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",M1,[e("div",x1,[R(e("select",{"onUpdate:modelValue":b[3]||(b[3]=a=>i.item.playbackMode=a),onChange:b[4]||(b[4]=a=>f()),id:"playbackMode",class:"form-control",placeholder:"playbackMode"},b[11]||(b[11]=[e("option",{value:"LINEAR"},"LINEAR",-1),e("option",{value:"LOOP"},"LOOP",-1)]),544),[[pe,i.item.playbackMode]]),b[12]||(b[12]=e("label",{for:"playbackMode",class:""},"PlaybackMode",-1)),o($).item.playbackMode.$error?(t(),s("div",C1,[(t(!0),s(H,null,N(o($).item.playbackMode.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",V1,[e("div",P1,[R(e("select",{"onUpdate:modelValue":b[5]||(b[5]=a=>i.item.tier=a),id:"tier",class:"form-control",placeholder:"Tier",disabled:i.item.playbackMode==="LOOP"},b[13]||(b[13]=[e("option",{value:"BASIC"},"BASIC",-1),e("option",{value:"STANDARD"},"STANDARD",-1)]),8,O1),[[pe,i.item.tier]]),b[14]||(b[14]=e("label",{for:"tier",class:""},"Tier",-1)),o($).item.tier.$error?(t(),s("div",A1,[(t(!0),s(H,null,N(o($).item.tier.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])])])]),e("div",L1,[e("div",U1,[e("div",H1,[e("div",D1,[R(e("select",{"onUpdate:modelValue":b[6]||(b[6]=a=>i.item.fillerSlateSourceLocationId=a),onChange:b[7]||(b[7]=a=>X()),class:ee([o(S).getValidFeedbackCss(i.item.fillerSlateSourceLocationId),"form-select"]),id:"fillerSlateSourceLocationId"},[(t(!0),s(H,null,N(i.lookups.sourceLocations,a=>(t(),s("option",{value:a.id},c(a.name),9,E1))),256))],34),[[pe,i.item.fillerSlateSourceLocationId]]),b[15]||(b[15]=e("label",{for:"fillerSlateSourceLocationId",class:""},"Source Location",-1)),o($).item.fillerSlateSourceLocationId.$error?(t(),s("div",q1,[(t(!0),s(H,null,N(o($).item.fillerSlateSourceLocationId.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",B1,[e("div",N1,[e("div",R1,[e("div",{id:"fillerSlateVodSourceId",class:ee([o(S).getValidFeedbackCss(i.selected.vodSource),"form-control"]),placeholder:"Title"},[i.selected.vodSource?(t(),s(H,{key:0},[Y(" ["+c(o(S).moment.utc(i.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+c(i.selected.vodSource.name),1)],64)):L("",!0)],2),b[16]||(b[16]=e("label",{for:"fillerSlateVodSourceId",class:""},"VOD Source",-1))]),i.item.fillerSlateSourceLocationId?(t(),s("button",{key:0,onClick:M,class:"btn btn-primary",type:"button"},b[17]||(b[17]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):L("",!0)])]),R(e("div",null,b[18]||(b[18]=[e("video",{id:"video-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"},null,-1)]),512),[[_e,i.selected.vodSource]])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},z1={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function G1(n,v,k,x,_,D){const P=ae("Page");return t(),ve(P,{id:k.id,urlView:k.urlView},null,8,["id","urlView"])}const j1=xe(z1,[["render",G1]]),Y1={class:"ms-1"},W1={class:"input-group"},K1={class:"table-responsive border shadow-sm"},Q1={class:"table table-hover mb-0"},J1=["textContent"],X1={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Z1={key:0,class:"badge text-bg-success"},eb={key:1,class:"badge text-bg-secondary"},tb="/api/v1/channels/search",sb={__name:"index",props:{urlAdd:{type:String,default:"/channels/add"},urlView:{type:String,default:"/channels/view"}},setup(n){Me("$config");const k=$e().user,{appTitle:x,pageTitle:_,busy:D,infoMessage:P,warningMessage:Q,errorMessage:j,router:S,axios:G,utils:le,toasts:B,close:A,security:i,filter:T,initializeFilter:$,getQuery:W,saveQuery:X,search:m,getRowNumber:y,setSelected:K,isSelected:f}=Ue({appTitle:"ARC CMS",pageTitle:"Channels",cacheKey:`${k==null?void 0:k.userId}/Channels/search`,baseUrl:tb,filter:{updateUrl:!0}});return me(async()=>{$(),await m()}),(M,p)=>{const u=ae("router-link"),b=ae("PageHeader"),r=ae("m-pagination"),d=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(b,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(_)},{default:F(()=>[z(u,{to:n.urlAdd,class:"btn btn-primary"},{default:F(()=>p[3]||(p[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Y1,[e("div",W1,[R(e("input",{"onUpdate:modelValue":p[0]||(p[0]=l=>o(T).query.criteria=l),onKeyup:p[1]||(p[1]=Le(l=>o(m)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[te,o(T).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:p[2]||(p[2]=l=>o(m)(1))},p[4]||(p[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(d,{errorMessage:o(j)},{default:F(()=>[e("div",K1,[e("table",Q1,[p[5]||(p[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",null,"Playback Mode"),e("th",null,"Tier")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o(T).items,(l,a)=>(t(),s("tr",{key:l.channelId},[e("td",{textContent:c(o(y)(a)),class:"text-center"},null,8,J1),e("td",null,[z(u,{to:`${n.urlView}/${l.channelId}`,class:"d-inline-block text-truncate link-offset-2"},{default:F(()=>[l.arn?(t(),s("span",X1)):L("",!0),Y(c(l.name),1)]),_:2},1032,["to"]),e("div",null,[l.state==="RUNNING"?(t(),s("span",Z1,c(l.state),1)):l.state==="STOPPED"?(t(),s("span",eb,c(l.state),1)):L("",!0)])]),e("td",null,c(l.playbackMode),1),e("td",null,c(l.tier),1)]))),128))]),_:1},512),[[_e,o(T).items.length>0]])])]),z(r,{filter:o(T),search:o(m),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},ob=["id"],ab={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},lb={class:"modal-content"},nb={class:"modal-header"},rb={class:"modal-title"},ib={class:"modal-body p-1"},db={class:"row row-cols-1 row-cols-sm-2 g-2"},ub={class:"col-sm-4"},cb={class:"card"},mb={key:0,class:"mt-2"},fb={class:"col"},pb={class:"form-floating mb-2"},vb={class:"col ms-2 my-2"},gb={class:"badge bg-info me-1"},bb={class:"badge bg-primary me-1"},yb={class:"row row-cols-1 row-cols-sm-2"},$b={class:"col"},hb={class:"form-floating mb-2"},wb={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},_b={class:"col"},kb={class:"form-floating mb-2"},Sb={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Tb={class:"col"},Ib={class:"form-floating mb-2"},Mb={class:"col-sm-8"},xb={class:"col"},Cb={class:"input-group mb-2"},Vb={class:"form-floating"},Pb={class:"table-responsive border shadow-sm"},Ob={class:"table table-sm table-hover mb-0 overflow-auto"},Ab=["textContent"],Lb={class:"d-flex flex-row justify-content-start"},Ub={class:"mt-1"},Hb=["src"],Db={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Eb={class:"ms-2"},qb=["onClick"],Bb={class:"modal-footer"},Nb="/api/v1/programtemplates/search",Rb={__name:"_selectProgramTemplate",emits:["close"],setup(n,{expose:v,emit:k}){const _=$e().user,{appTitle:D,pageTitle:P,busy:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,security:T,filter:$,initializeFilter:W,getQuery:X,saveQuery:m,search:y,getRowNumber:K,setSelected:f,isSelected:M}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${_==null?void 0:_.userId}/program-templates/select`,baseUrl:Nb,filter:{updateUrl:!0,lookups:{genres:[]},query:{}}}),p=k,u=fe("modalSelectProgramTemplate"),b=ge({programTemplate:null,hls:null});me(async()=>{W(),await r()}),Ae(()=>{b.hls&&(b.hls.stopLoad(),b.hls.destroy())});const r=async()=>{await a(),await U()},d=async g=>{$.value.query.sourceLocationId=g,G.value="",await y();var q=document.getElementById(u.value),O=he.getOrCreateInstance(q);O.show()},l=async()=>{var g=document.getElementById(u.value),q=he.getOrCreateInstance(g);q.hide(),b.hls&&(b.hls.stopLoad(),b.hls.destroy()),p("close",b.programTemplate)},a=async g=>{try{const O=await B.get("/api/v1/lookups/video-categories/").then(h=>h.data);$.value.lookups.categories=O}catch(q){G.value=A.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{}},U=async g=>{try{const O=await B.get("/api/v1/lookups/video-genres/").then(h=>h.data);$.value.lookups.genres=O}catch(q){G.value=A.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{}},I=g=>{b.programTemplate=g,l()};return v({open:d,close:l}),(g,q)=>{const O=ae("m-pagination"),h=ae("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-hidden":"true"},[e("div",ab,[e("div",lb,[e("div",nb,[e("h5",rb,[q[8]||(q[8]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Y(c(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:q[0]||(q[0]=E=>l()),"aria-label":"Close"})]),e("div",ib,[z(h,{errorMessage:o(G)},{default:F(()=>[e("div",db,[e("div",ub,[e("div",cb,[q[13]||(q[13]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),b.programTemplate?(t(),s("div",mb,[e("div",fb,[e("div",pb,[R(e("input",{"onUpdate:modelValue":q[1]||(q[1]=E=>b.programTemplate.vodSource.video.title=E),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[te,b.programTemplate.vodSource.video.title]]),q[9]||(q[9]=e("label",{for:"title"},"Title",-1))])]),e("div",vb,[e("div",null,[(t(!0),s(H,null,N(b.programTemplate.vodSource.video.genres,E=>(t(),s("span",gb,c(E.genreName),1))),256)),(t(!0),s(H,null,N(b.programTemplate.vodSource.video.categories,E=>(t(),s("span",bb,c(E.categoryName),1))),256))])]),e("div",yb,[e("div",$b,[e("div",hb,[e("div",wb,c(o(A).moment(b.programTemplate.vodSource.video.dateReleased).calendar()),1),q[10]||(q[10]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",_b,[e("div",kb,[e("div",Sb,c(o(A).moment.utc(b.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),q[11]||(q[11]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Tb,[e("div",Ib,[R(e("textarea",{"onUpdate:modelValue":q[2]||(q[2]=E=>b.programTemplate.vodSource.video.description=E),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[te,b.programTemplate.vodSource.video.description]]),q[12]||(q[12]=e("label",{for:"description"},"Description",-1))])])])):L("",!0)])]),e("div",Mb,[e("div",xb,[e("div",Cb,[e("div",Vb,[R(e("input",{"onUpdate:modelValue":q[3]||(q[3]=E=>o($).query.criteria=E),onKeyup:q[4]||(q[4]=Le(E=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[te,o($).query.criteria]]),q[14]||(q[14]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:q[5]||(q[5]=E=>o(y)(1))},q[15]||(q[15]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",Pb,[e("table",Ob,[q[16]||(q[16]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o($).items,(E,Z)=>(t(),s("tr",{key:E.videoId},[e("td",{textContent:c(o(K)(Z)),class:"text-center"},null,8,Ab),e("td",null,[e("div",Lb,[e("div",null,[E.vodSource.video.thumbnails.length>0?(t(!0),s(H,{key:0},N(E.vodSource.video.thumbnails,V=>(t(),s("div",Ub,[e("img",{src:V.url,class:"img-fuild border",width:"128"},null,8,Hb)]))),256)):(t(),s("img",Db))]),e("div",Eb,[e("a",{onClick:V=>I(E),class:"text-wrap link-offset-2",role:"button"},c(E.name),9,qb)])])])]))),128))]),_:1},512),[[_e,o($).items.length>0]])])]),z(O,{filter:o($),search:o(y),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",Bb,[e("button",{onClick:q[6]||(q[6]=E=>l()),class:"btn btn-primary",type:"button"},q[17]||(q[17]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:q[7]||(q[7]=E=>l()),class:"btn btn-secondary ms-1"},q[18]||(q[18]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,ob)}}},Fb={key:0,class:"modal-content"},zb={class:"modal-header p-2"},Gb={class:"modal-title"},jb={class:"modal-body container-fluid py-1 overflow-y-auto"},Yb=["errorMessage"],Wb={class:"row row-cols-1 row-cols-sm-2"},Kb={class:"card"},Qb={key:0,class:"mt-2"},Jb={class:"col"},Xb={class:"form-floating mb-2"},Zb={class:"col ms-2 my-2"},ey={class:"badge bg-info me-1"},ty={class:"badge bg-primary me-1"},sy={class:"row row-cols-1 row-cols-sm-2"},oy={class:"col"},ay={class:"form-floating mb-2"},ly={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},ny={class:"col"},ry={class:"form-floating mb-2"},iy={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},dy={class:"col"},uy={class:"form-floating mb-2"},cy={class:"col"},my={class:"input-group mb-2"},fy={class:"form-floating"},py={class:"table-responsive border shadow-sm"},vy={class:"table table-sm table-hover mb-0 overflow-auto"},gy=["textContent"],by={class:"d-flex flex-row justify-content-start"},yy={class:"mt-1"},$y=["src"],hy={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},wy={class:"ms-2"},_y=["onClick"],ky={class:"modal-footer p-1"},Sy="/api/v1/programtemplates/search",Ty={__name:"_selectProgramTemplateInline",props:{isOpen:{type:Boolean,required:!0}},emits:["close"],setup(n,{expose:v,emit:k}){const _=$e().user,{appTitle:D,pageTitle:P,busy:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,security:T,filter:$,initializeFilter:W,getQuery:X,saveQuery:m,search:y,getRowNumber:K,setSelected:f,isSelected:M}=Ue({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${_==null?void 0:_.userId}/program-templates/select`,baseUrl:Sy,filter:{updateUrl:!1,lookups:{genres:[]},query:{}},initializeFilter:(q,O)=>{q.value,new URLSearchParams(window.location.search),JSON.parse(localStorage.getItem(O))},getQuery:q=>["?c=",encodeURIComponent(q.query.criteria),"&p=",q.pageIndex,"&s=",q.pageSize,"&sf=",q.sortField,"&so=",q.sortOrder,"&withArn=true"].join(""),saveQuery:(q,O)=>{},successAction:()=>{b.programTemplate&&(b.programTemplate=null)}}),p=n,u=k;fe("modalSelectProgramTemplateInline");const b=ge({programTemplate:null,hls:null});me(async()=>{W(),await r()}),Ae(()=>{b.hls&&(b.hls.stopLoad(),b.hls.destroy())});const r=async()=>{await a(),await U()},d=async q=>{debugger;$.value.query.sourceLocationId=q,G.value="",await y(),p.isOpen=!0},l=async()=>{b.hls&&(b.hls.stopLoad(),b.hls.destroy()),u("close",b.programTemplate),p.isOpen=!1},a=async q=>{try{const h=await B.get("/api/v1/lookups/video-categories/").then(E=>E.data);$.value.lookups.categories=h}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},U=async q=>{try{const h=await B.get("/api/v1/lookups/video-genres/").then(E=>E.data);$.value.lookups.genres=h}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},I=q=>{b.programTemplate=q,g()},g=()=>{if(Hls.isSupported()){b.hls&&(b.hls.stopLoad(),b.hls.destroy());var q=document.getElementById("video-select-preview");const h=b.programTemplate.vodSource.video.formats.find(Z=>Z.formatName==="HLS"),E=h.serverUrl+h.path;b.hls=A.createHlsStream(q,E)}};return v({open:d,close:l}),(q,O)=>{const h=ae("PageMessages"),E=ae("m-pagination");return t(),ve(be,null,{default:F(()=>[n.isOpen?(t(),s("div",Fb,[e("div",zb,[e("h6",Gb,[O[7]||(O[7]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Y(c(o(P)),1)])]),e("div",jb,[z(h,{errorMessage:o(G)},null,8,["errorMessage"]),e("div",{errorMessage:o(G),class:""},[e("div",Wb,[e("div",{class:ee([b.programTemplate?"col-sm-4":"d-none"])},[e("div",Kb,[O[12]||(O[12]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),b.programTemplate?(t(),s("div",Qb,[e("div",Jb,[e("div",Xb,[R(e("input",{"onUpdate:modelValue":O[0]||(O[0]=Z=>b.programTemplate.vodSource.video.title=Z),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[te,b.programTemplate.vodSource.video.title]]),O[8]||(O[8]=e("label",{for:"title"},"Title",-1))])]),e("div",Zb,[e("div",null,[(t(!0),s(H,null,N(b.programTemplate.vodSource.video.genres,Z=>(t(),s("span",ey,c(Z.genreName),1))),256)),(t(!0),s(H,null,N(b.programTemplate.vodSource.video.categories,Z=>(t(),s("span",ty,c(Z.categoryName),1))),256))])]),e("div",sy,[e("div",oy,[e("div",ay,[e("div",ly,c(o(A).moment(b.programTemplate.vodSource.video.dateReleased).calendar()),1),O[9]||(O[9]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",ny,[e("div",ry,[e("div",iy,c(o(A).moment.utc(b.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),O[10]||(O[10]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",dy,[e("div",uy,[R(e("textarea",{"onUpdate:modelValue":O[1]||(O[1]=Z=>b.programTemplate.vodSource.video.description=Z),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[te,b.programTemplate.vodSource.video.description]]),O[11]||(O[11]=e("label",{for:"description"},"Description",-1))])])])):L("",!0)])],2),e("div",{class:ee([[b.programTemplate?"col-sm-8":"col-sm-12"],"mt-2 mt-sm-0"])},[e("div",cy,[e("div",my,[e("div",fy,[R(e("input",{"onUpdate:modelValue":O[2]||(O[2]=Z=>o($).query.criteria=Z),onKeyup:O[3]||(O[3]=Le(Z=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[te,o($).query.criteria]]),O[13]||(O[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:O[4]||(O[4]=Z=>o(y)(1))},O[14]||(O[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",py,[e("table",vy,[O[15]||(O[15]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(o($).items,(Z,V)=>(t(),s("tr",{key:Z.videoId},[e("td",{textContent:c(o(K)(V)),class:"text-center"},null,8,gy),e("td",null,[e("div",by,[e("div",null,[Z.vodSource.video.thumbnails.length>0?(t(!0),s(H,{key:0},N(Z.vodSource.video.thumbnails,re=>(t(),s("div",yy,[e("img",{src:re.url,class:"img-fuild border",width:"128"},null,8,$y)]))),256)):(t(),s("img",hy))]),e("div",wy,[e("a",{onClick:re=>I(Z),class:"text-wrap link-offset-2",role:"button"},c(Z.name),9,_y)])])])]))),128))]),_:1},512),[[_e,o($).items.length>0]])])]),z(E,{filter:o($),search:o(y),showPerPage:!0},null,8,["filter","search"])],2)])],8,Yb)]),e("div",ky,[e("button",{onClick:O[5]||(O[5]=Z=>l()),class:"btn btn-primary btn-sm",type:"button"},O[16]||(O[16]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:O[6]||(O[6]=Z=>l(!1)),class:"btn btn-secondary btn-sm ms-1"},O[17]||(O[17]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])):L("",!0)]),_:1})}}},Iy=["id"],My={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},xy={class:"modal-content"},Cy={class:"modal-header"},Vy={class:"modal-title"},Py={class:"modal-body"},Oy={key:0},Ay={class:"row row-cols-1 row-cols-sm-3"},Ly={class:"col-sm-3"},Uy={class:"form-floating mb-2"},Hy={key:0,class:"d-block invalid-feedback"},Dy={class:"col-sm-3"},Ey={class:"form-floating mb-2"},qy={key:0,class:"d-block invalid-feedback"},By={class:"col-sm-6"},Ny={class:"form-floating"},Ry={id:"programTemplateId",class:"form-control",placeholder:"Title"},Fy={key:0,class:"d-block invalid-feedback"},zy={key:0},Gy={class:"row row-cols-1 row-cols-sm-2"},jy={class:"col"},Yy={class:"row row-cols-1"},Wy={class:"col"},Ky={class:"form-floating mb-2"},Qy={class:"col"},Jy={class:"form-floating mb-2"},Xy={class:"row row-cols-1 row-cols-sm-3"},Zy={class:"col"},e$={class:"form-floating mb-2"},t$={class:"col"},s$={class:"form-floating mb-2"},o$={class:"col"},a$={class:"form-floating mb-2"},l$={class:"row row-cols-1 row-cols-sm-3"},n$={class:"col"},r$={class:"form-floating mb-2"},i$={class:"col"},d$={class:"form-floating mb-2"},u$={key:1},c$={class:"table-responsive border mt-1"},m$={class:"table table-sm mb-0"},f$=["onUpdate:modelValue","onChange"],p$=["value"],v$={key:0,class:"modal-footer"},g$=["disabled"],b$={__name:"_addProgram",props:{channelId:{type:String,required:!0},eventId:{type:String,required:!0},dateScheduledStart:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),W=k,X=n,m=fe(),y=fe(),K=fe("modalAddProgramFromTemplate"),f=ge({eventId:null,lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},selected:{programTemplate:null,channel:null},item:{programTemplateId:null,name:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),M=(re,J,oe)=>re.length<=0?!0:re.every(ue=>ue.vodSourceId),p={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},programTemplateId:{required:ne.withMessage("Program Template is required.",ie),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:ne.withMessage("Date Scheduled Start is required.",ie),$autoDirty:!0,$lazy:!0},adBreaks:{adBreaksRequired:ne.withMessage("Ad Break is not properly configured.",M),$each:ne.forEach({vodSourceId:{required:ne.withMessage("Vod Source is required.",ie)}})}}},u=Se(p,f);me(async()=>{b()});const b=async()=>{const re=f;Q.value.clear(),G.value="";const J=A.moment(X.dateScheduledStart),C=J.format("YYYY-MM-DD HH:mm"),ue=J.format("YYYYMMDD_HHmm")+"_PRG_";re.eventId=X.eventId,re.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},re.selected={programTemplate:null},re.item={programTemplateId:null,name:ue,dateScheduledStart:C,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await d(),u.value.$reset();var se=document.getElementById(K.value),w=he.getOrCreateInstance(se);w.show()},r=async re=>{if(!re){var J=document.getElementById(K.value),oe=he.getOrCreateInstance(J);oe.hide(),W("cancel");return}if(!await u.value.$validate()){window.scrollTo(0,0);return}const ue=f,se=A.moment(ue.item.dateScheduledStart).utc(!0).format(),w=A.moment(ue.item.dateScheduledStart).add(ue.selected.programTemplate.totalProgramTemplateDurationInMillis,"milliseconds").utc(!0).format();f.item={eventId:X.eventId,programTemplateId:ue.selected.programTemplate.programTemplateId,channelId:X.channelId,name:ue.item.name,dateScheduledStart:se,dateScheduledEnd:w,adBreaks:ue.selected.programTemplate.adBreaks.map(ce=>({sourceLocationId:ce.sourceLocationId,vodSourceId:ce.vodSourceId,offsetMillis:ce.offsetMillis,durationInMillis:ce.durationInMillis}))};try{await B.post("/api/v1/programs/",f.item).then(Pe=>{i.success("Add New Program",`Program [${f.item.name}] was added to this channel.`)});var J=document.getElementById(K.value),oe=he.getOrCreateInstance(J);oe.hide(),W("confirm",f.item)}catch(ce){G.value=A.getErrorMessageAsHtml(ce)}},d=async()=>{await g(),await l(),await a()},l=async()=>{try{const re=`/api/v1/channelOutputs/get-by-channel/${X.channelId}`;await B.get(re).then(J=>{f.lookups.channelOutputs=J.data}),f.item.programTemplateId&&await U()}catch(re){G.value=A.getErrorMessageAsHtml(re),window.scrollTo(0,0)}finally{}},a=async()=>{try{const re=`/api/v1/programTemplates/lookup/by-channel/${X.channelId}`;await B.get(re).then(J=>{f.lookups.programTemplates=J.data,f.lookups.programTemplates.length===1&&(f.item.programTemplateId=f.lookups.programTemplates[0].id)}),f.item.programTemplateId&&await U(f.item.programTemplateId)}catch(re){G.value=A.getErrorMessageAsHtml(re),window.scrollTo(0,0)}finally{}},U=async re=>{await I(re)},I=async re=>{try{const J=`/api/v1/programTemplates/${re}/`;await B.get(J).then(ue=>{f.selected.programTemplate=ue.data;const se=f.selected.programTemplate;se.startOffsetTime=A.moment.utc(se.startOffsetMillis).format("HH:mm:ss"),se.endOffsetTime=A.moment.utc(se.endOffsetMillis).format("HH:mm:ss"),se.durationTime=A.moment.utc(se.durationInMillis).format("HH:mm:ss"),se.adBreaksDurationTime=A.moment.utc(se.adBreaksDurationInMillis).format("HH:mm:ss"),se.totalProgramTemplateDurationTime=A.moment.utc(se.totalProgramTemplateDurationInMillis).format("HH:mm:ss"),f.item.programTemplateId=se.programTemplateId,f.item.adBreaks=se.adBreaks});const oe=f,C=oe.lookups.channelOutputs[0].outputType;await O(oe.selected.programTemplate.sourceLocationId,C)}catch(J){G.value=A.getErrorMessageAsHtml(J),window.scrollTo(0,0)}finally{}},g=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(J=>{f.lookups.sourceLocations=J.data,f.lookups.sourceLocations.length===1&&(f.item.sourceLocationId=f.lookups.sourceLocations[0].id)}),f.item.sourceLocationId&&await q(f.item.sourceLocationId)}catch(re){G.value=A.getErrorMessageAsHtml(re),window.scrollTo(0,0)}finally{}},q=async re=>{try{let J=`/api/v1/vodSources/lookup/source-location/${re}`;await B.get(J).then(oe=>{f.lookups.vodSources=oe.data})}catch(J){G.value=A.getErrorMessageAsHtml(J),window.scrollTo(0,0)}finally{}},O=async(re,J)=>{try{let oe=`/api/v1/vodsources/lookup/output-type/${J}`;await B.get(oe).then(C=>{f.lookups.adBreakVodSources=C.data})}catch(oe){G.value=A.getErrorMessageAsHtml(oe),window.scrollTo(0,0)}finally{}},h=re=>{const J=f.lookups.adBreakVodSources.find(oe=>oe.id==re.vodSourceId);re.sourceLocationId=J.sourceLocationId},E=async re=>{V.value=!1,re&&(await U(re.programTemplateId),Z())},Z=()=>{if(Hls.isSupported()){f.hls&&(f.hls.stopLoad(),f.hls.destroy());var re=document.getElementById("video-add-program");const oe=f.selected.programTemplate.vodSource.video.formats.find(ue=>ue.formatName==="HLS"),C=oe.serverUrl+oe.path;f.hls=A.createHlsStream(re,C)}},V=fe(!1);return v({open:b,close:r}),(re,J)=>{const oe=ae("PageMessages");return t(),ve(be,null,{default:F(()=>[e("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:K.value,tabindex:"-1","aria-hidden":"false"},[e("div",My,[e("div",xy,[e("div",Cy,[e("h5",Vy,[J[13]||(J[13]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:J[0]||(J[0]=C=>r(!1)),"aria-label":"Close"})]),e("div",Py,[z(oe,{errorMessage:o(G),vuelidate:o(u)},null,8,["errorMessage","vuelidate"]),z(Ty,{ref_key:"modalSelectProgramTemplateInline",ref:y,isOpen:V.value,onClose:E},null,8,["isOpen"]),V.value?L("",!0):(t(),s("div",Oy,[e("div",Ay,[e("div",Ly,[e("div",Uy,[R(e("input",{"onUpdate:modelValue":J[1]||(J[1]=C=>f.item.name=C),id:"name",class:"form-control",placeholder:"Name"},null,512),[[te,f.item.name]]),J[14]||(J[14]=e("label",{for:"name",class:""},"Name",-1)),o(u).item.name.$error?(t(),s("div",Hy,[(t(!0),s(H,null,N(o(u).item.name.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),e("div",Dy,[e("div",Ey,[R(e("input",{"onUpdate:modelValue":J[2]||(J[2]=C=>f.item.dateScheduledStart=C),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[te,f.item.dateScheduledStart]]),J[15]||(J[15]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(u).item.dateScheduledStart.$error?(t(),s("div",qy,[(t(!0),s(H,null,N(o(u).item.dateScheduledStart.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),e("div",By,[e("div",{onClick:J[3]||(J[3]=C=>V.value=!V.value),class:"input-group mb-2"},[e("div",Ny,[e("div",Ry,[f.selected.programTemplate?(t(),s(H,{key:0},[Y(c(f.selected.programTemplate.name),1)],64)):L("",!0)]),J[16]||(J[16]=e("label",{for:"programTemplateId",class:""},"Program Template",-1))]),J[17]||(J[17]=e("button",{class:"btn btn-primary",type:"button"},[e("i",{class:"fa-solid fa-filter"})],-1))]),o(u).item.programTemplateId.$error?(t(),s("div",Fy,[(t(!0),s(H,null,N(o(u).item.programTemplateId.$errors,C=>(t(),s("div",{key:C.$uid},c(C.$message),1))),128))])):L("",!0)])]),f.selected.programTemplate?(t(),s("div",zy,[e("div",Gy,[J[25]||(J[25]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1)),e("div",jy,[e("div",Yy,[f.selected.programTemplate?(t(),s(H,{key:0},[e("div",Wy,[e("div",Ky,[R(e("input",{"onUpdate:modelValue":J[4]||(J[4]=C=>f.selected.programTemplate.sourceLocation.name=C),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[te,f.selected.programTemplate.sourceLocation.name]]),J[18]||(J[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1))])]),e("div",Qy,[e("div",Jy,[R(e("input",{"onUpdate:modelValue":J[5]||(J[5]=C=>f.selected.programTemplate.vodSource.name=C),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[te,f.selected.programTemplate.vodSource.name]]),J[19]||(J[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1))])])],64)):L("",!0)]),e("div",Xy,[e("div",Zy,[e("div",e$,[R(e("input",{"onUpdate:modelValue":J[6]||(J[6]=C=>f.selected.programTemplate.startOffsetTime=C),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[te,f.selected.programTemplate.startOffsetTime]]),J[20]||(J[20]=e("label",{for:"startOffsetTime"},"Total Program Duration",-1))])]),e("div",t$,[e("div",s$,[R(e("input",{"onUpdate:modelValue":J[7]||(J[7]=C=>f.selected.programTemplate.endOffsetTime=C),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[te,f.selected.programTemplate.endOffsetTime]]),J[21]||(J[21]=e("label",{for:"endOffsetTime"},"End Offset",-1))])]),e("div",o$,[e("div",a$,[R(e("input",{"onUpdate:modelValue":J[8]||(J[8]=C=>f.selected.programTemplate.durationTime=C),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[te,f.selected.programTemplate.durationTime]]),J[22]||(J[22]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),e("div",l$,[e("div",n$,[e("div",r$,[R(e("input",{"onUpdate:modelValue":J[9]||(J[9]=C=>f.selected.programTemplate.adBreaksDurationTime=C),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[te,f.selected.programTemplate.adBreaksDurationTime]]),J[23]||(J[23]=e("label",{for:"adBreaksDurationTime"},"Ad Breaks Total Duration",-1))])]),e("div",i$,[e("div",d$,[R(e("input",{"onUpdate:modelValue":J[10]||(J[10]=C=>f.selected.programTemplate.totalProgramTemplateDurationTime=C),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[te,f.selected.programTemplate.totalProgramTemplateDurationTime]]),J[24]||(J[24]=e("label",{for:"totalProgramTemplateDurationTime"},"Program Total Duration",-1))])])])])])])):L("",!0),f.selected.programTemplate&&f.selected.programTemplate.adBreaks.length>0?(t(),s("div",u$,[J[27]||(J[27]=e("div",{class:"d-flex flex-row justify-content-between"},[e("b",null," Ad Break ")],-1)),e("div",c$,[e("table",m$,[J[26]||(J[26]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(H,null,N(f.item.adBreaks,(C,ue)=>(t(),s("tr",null,[e("td",null,c(ue+1),1),e("td",null,c(o(A).moment.utc(C.offsetMillis).format("HH:mm:ss")),1),e("td",null,c(o(A).moment.utc(C.durationInMillis).format("HH:mm:ss")),1),e("td",null,[f.lookups.adBreakVodSources.length>0?(t(),s(H,{key:0},[R(e("select",{"onUpdate:modelValue":se=>C.vodSourceId=se,onChange:se=>h(C),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(H,null,N(f.lookups.adBreakVodSources,se=>(t(),s(H,null,[se.durationInMillis===C.durationInMillis?(t(),s("option",{key:0,value:se.id}," ["+c(o(A).moment.utc(se.durationInMillis).format("HH:mm:ss"))+"] "+c(se.name),9,p$)):L("",!0)],64))),256))],40,f$),[[pe,C.vodSourceId]]),o(u).item.adBreaks.$each.$response?(t(!0),s(H,{key:0},N(o(u).item.adBreaks.$each.$response.$errors[ue].vodSourceId,se=>(t(),s("div",{key:se,class:"d-block invalid-feedback"},c(se.$message),1))),128)):L("",!0)],64)):L("",!0)])]))),256))])])])])):L("",!0)]))]),V.value?L("",!0):(t(),s("div",v$,[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:J[11]||(J[11]=C=>r(!0)),class:"btn btn-primary",type:"button"},J[28]||(J[28]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,g$),e("button",{onClick:J[12]||(J[12]=C=>r(!1)),class:"btn btn-secondary ms-1"},J[29]||(J[29]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))]))])]),z(Rb,{ref_key:"modalSelectProgramTemplate",ref:m,onClose:E},null,512)],8,Iy)]),_:1})}}},y$=["id"],$$={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},h$={class:"modal-content"},w$={class:"modal-header"},_$={class:"modal-title"},k$={class:"modal-body"},S$={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},T$=["innerHTML"],I$={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},M$={key:2,class:"container"},x$={class:"row row-cols-1 row-cols-sm-2"},C$={class:"col"},V$={class:"form-floating mb-2"},P$={class:"col"},O$={class:"form-floating mb-2"},A$={class:"row row-cols-1 row-cols-sm-3 mt-2"},L$={class:"col"},U$={class:"form-floating mb-2"},H$={class:"col"},D$={class:"form-floating mb-2"},E$={key:0,class:"d-block invalid-feedback"},q$={class:"col"},B$={class:"form-floating mb-2"},N$={key:0,class:"d-block invalid-feedback"},R$={class:"row row-cols-1 row-cols-sm-3"},F$={class:"col"},z$={class:"form-floating mb-2"},G$={class:"col"},j$={class:"form-floating mb-2"},Y$={class:"col"},W$={class:"form-floating mb-2"},K$={class:"row row-cols-1 row-cols-sm-3"},Q$={class:"col"},J$={class:"form-floating mb-2"},X$={class:"col"},Z$={class:"form-floating mb-2"},eh={key:0,class:"col"},th={class:"form-floating mb-2"},sh={key:0},oh={class:"table-responsive border mt-1"},ah={class:"table mb-0"},lh=["onUpdate:modelValue","onChange"],nh=["value"],rh={class:"modal-footer"},ih=["disabled"],mt={__name:"_editProgram",props:{programId:{type:String,required:!0},dateScheduledStart:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Edit Program"}),W=k,X=n,m=fe("modalEditProgram"),y=ge({lookups:{adBreakSourceLocations:[],adBreakVodSources:[]},item:{programTemplateId:null,name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),K={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:ne.withMessage("Date Scheduled Start is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("sourceLocationId is required.",ie),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ne.withMessage("vodSourceId is required.",ie),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ne.withMessage("startOffsetMillis is required.",ie),minValue:Ee(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ne.withMessage("endOffsetMillis is required.",ie),minValue:Ee(0),$autoDirty:!0,$lazy:!0}}},f=Se(K,y);me(async()=>{f.value.$reset(),await M()});const M=async(l,a)=>{const U=y;Q.value.clear(),G.value="",U.lookups={adBreakSourceLocations:[],adBreakVodSources:[]},U.item=null,await u(),await b();var I=document.getElementById(m.value),g=he.getOrCreateInstance(I);g.show()},p=async l=>{if(!l){var a=document.getElementById(m.value),U=he.getOrCreateInstance(a);U.hide(),W("cancel");return}const I=y,g=A.moment(I.item.dateScheduledStart).utc(!0).format(),q={programId:X.programId,name:I.item.name,dateScheduledStart:g,adBreaks:I.item.adBreaks.map(O=>({sourceLocationId:O.sourceLocationId,vodSourceId:O.vodSourceId,offsetMillis:O.offsetMillis,durationInMillis:O.durationInMillis}))};try{await B.put("/api/v1/programs/",q).then(Z=>{i.success("Edit Program","Program was edited.")});var a=document.getElementById(m.value),U=he.getOrCreateInstance(a);U.hide(),W("confirm")}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0);return}finally{}},u=async()=>{try{const l=`/api/v1/programs/${X.programId}/`;await B.get(l).then(I=>{y.item=I.data;const g=y.item,h=A.moment.utc(g.dateScheduledStart).format("YYYY-MM-DD HH:mm");y.item.dateScheduledStart=h,g.startOffsetTime=A.moment.utc(g.startOffsetMillis).format("HH:mm:ss"),g.endOffsetTime=A.moment.utc(g.endOffsetMillis).format("HH:mm:ss"),g.durationTime=A.moment.utc(g.durationInMillis).format("HH:mm:ss"),g.adBreaksDurationTime=A.moment.utc(g.adBreaksDurationInMillis).format("HH:mm:ss"),g.totalProgramTemplateDurationTime=A.moment.utc(g.totalProgramTemplateDurationInMillis).format("HH:mm:ss")});const a=y,U=a.item.channel.outputs[0].outputType;await r(a.item.sourceLocationId,U)}catch(l){G.value=A.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},b=async()=>{},r=async(l,a)=>{try{let U=`/api/v1/vodsources/lookup/output-type/${a}`;await B.get(U).then(I=>{y.lookups.adBreakVodSources=I.data})}catch(U){G.value=A.getErrorMessageAsHtml(U),window.scrollTo(0,0)}finally{}},d=l=>{const a=y.lookups.adBreakVodSources.find(U=>U.id==l.vodSourceId);l.sourceLocationId=a.sourceLocationId};return v({open:M,close:p}),(l,a)=>(t(),s("div",{class:"modal show","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"false"},[e("div",$$,[e("div",h$,[e("div",w$,[e("h5",_$,[a[14]||(a[14]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=U=>p(!1)),"aria-label":"Close"})]),e("div",k$,[o(G)?(t(),s("div",S$,[a[15]||(a[15]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,T$)])):L("",!0),o(Q).size>0?(t(),s("div",I$,[a[16]||(a[16]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),U=>(t(),s("li",null,c(U),1))),256))])])):L("",!0),y.item?(t(),s("div",M$,[e("div",x$,[e("div",C$,[e("div",V$,[y.item.sourceLocation?R((t(),s("input",{key:0,"onUpdate:modelValue":a[1]||(a[1]=U=>y.item.sourceLocation.name=U),id:"sourceLocation",class:"form-control-plaintext",readonly:""},null,512)),[[te,y.item.sourceLocation.name]]):L("",!0),a[17]||(a[17]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",P$,[e("div",O$,[y.item.vodSource?R((t(),s("input",{key:0,"onUpdate:modelValue":a[2]||(a[2]=U=>y.item.vodSource.name=U),id:"vodSource",class:"form-control-plaintext",readonly:""},null,512)),[[te,y.item.vodSource.name]]):L("",!0),a[18]||(a[18]=e("label",{for:"vodSource",class:""},"VOD Source",-1))])])]),e("div",A$,[e("div",L$,[e("div",U$,[y.item.relativeProgram?R((t(),s("input",{key:0,"onUpdate:modelValue":a[3]||(a[3]=U=>y.item.relativeProgram.name=U),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512)),[[te,y.item.relativeProgram.name]]):L("",!0),a[19]||(a[19]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])]),e("div",H$,[e("div",D$,[R(e("input",{"onUpdate:modelValue":a[4]||(a[4]=U=>y.item.name=U),id:"name",class:ee([o(A).getValidFeedbackCss(y.item.name),"form-control"]),placeholder:"Name"},null,2),[[te,y.item.name]]),a[20]||(a[20]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",E$,[(t(!0),s(H,null,N(o(f).item.name.$errors,U=>(t(),s("div",{key:U.$uid},c(U.$message),1))),128))])):L("",!0)])]),e("div",q$,[e("div",B$,[R(e("input",{"onUpdate:modelValue":a[5]||(a[5]=U=>y.item.dateScheduledStart=U),type:"datetime-local",id:"dateScheduledStart",class:ee([o(A).getValidFeedbackCss(y.item.dateScheduledStart),"form-control"])},null,2),[[te,y.item.dateScheduledStart]]),a[21]||(a[21]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(f).item.dateScheduledStart.$error?(t(),s("div",N$,[(t(!0),s(H,null,N(o(f).item.dateScheduledStart.$errors,U=>(t(),s("div",{key:U.$uid},c(U.$message),1))),128))])):L("",!0)])])]),e("div",null,[e("div",R$,[e("div",F$,[e("div",z$,[R(e("input",{"onUpdate:modelValue":a[6]||(a[6]=U=>y.item.startOffsetTime=U),id:"startOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[te,y.item.startOffsetTime]]),a[22]||(a[22]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",G$,[e("div",j$,[R(e("input",{"onUpdate:modelValue":a[7]||(a[7]=U=>y.item.endOffsetTime=U),id:"endOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[te,y.item.endOffsetTime]]),a[23]||(a[23]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",Y$,[e("div",W$,[R(e("input",{"onUpdate:modelValue":a[8]||(a[8]=U=>y.item.durationTime=U),id:"durationTime",class:"form-control-plaintext",readonly:""},null,512),[[te,y.item.durationTime]]),a[24]||(a[24]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",K$,[e("div",Q$,[e("div",J$,[R(e("input",{"onUpdate:modelValue":a[9]||(a[9]=U=>y.item.adBreaksDurationTime=U),id:"adBreaksDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[te,y.item.adBreaksDurationTime]]),a[25]||(a[25]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks Duration",-1))])]),e("div",X$,[e("div",Z$,[R(e("input",{"onUpdate:modelValue":a[10]||(a[10]=U=>y.item.totalProgramTemplateDurationTime=U),id:"totalProgramTemplateDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[te,y.item.totalProgramTemplateDurationTime]]),a[26]||(a[26]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])]),y.item.relativeProgram?(t(),s("div",eh,[e("div",th,[R(e("input",{"onUpdate:modelValue":a[11]||(a[11]=U=>y.item.relativeProgram.name=U),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512),[[te,y.item.relativeProgram.name]]),a[27]||(a[27]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])])):L("",!0)])]),a[30]||(a[30]=e("hr",null,null,-1)),y.item?(t(),s("div",sh,[a[29]||(a[29]=e("div",{class:"d-flex flex-row justify-content-between"},[e("fieldset",null,[e("legend",null," Ad Breaks ")])],-1)),e("div",oh,[e("table",ah,[a[28]||(a[28]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(H,null,N(y.item.adBreaks,(U,I)=>(t(),s("tr",null,[e("td",null,c(I+1),1),e("td",null,c(o(A).moment.utc(U.offsetMillis).format("HH:mm:ss")),1),e("td",null,c(o(A).moment.utc(U.durationInMillis).format("HH:mm:ss")),1),e("td",null,[R(e("select",{"onUpdate:modelValue":g=>U.vodSourceId=g,onChange:g=>d(U),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(H,null,N(y.lookups.adBreakVodSources,g=>(t(),s(H,null,[g.durationInMillis===U.durationInMillis?(t(),s("option",{key:0,value:g.id}," ["+c(o(A).moment.utc(g.durationInMillis).format("HH:mm:ss"))+"] "+c(g.name),9,nh)):L("",!0)],64))),256))],40,lh),[[pe,U.vodSourceId]])])]))),256))])])])])):L("",!0)])):L("",!0)]),e("div",rh,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:a[12]||(a[12]=U=>p(!0)),class:"btn btn-primary ms-2",type:"button"},a[31]||(a[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,ih),e("button",{onClick:a[13]||(a[13]=U=>p(!1)),class:"btn btn-secondary ms-1"},a[32]||(a[32]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,y$))}},dh={__name:"index",props:{id:{type:String,required:!0},urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(n){const{appTitle:v,pageTitle:k,busy:x,infoMessage:_,warningMessage:D,errorMessage:P,router:Q,axios:j,utils:S,toasts:G,close:le,security:B}=ye({appTitle:"Arcadian-FAST",pageTitle:"Schedule Channel Programs"}),A=n,i=fe(null),T={viewType:"Week",cellDuration:15,startDate:Fe.DayPilot.Date.today(),onTimeRangeSelected:M=>{var p=M.control;const u={start:M.start,end:M.end,id:Fe.DayPilot.guid(),text:"NEW",tags:{type:"new"}};p.events.add(u);var b=p.events.find(u.id);K(b)},onBeforeEventRender:M=>{if(M.data.barColor="green",!!M.data.tags)switch(M.data.tags.type){case"new":M.data.barColor="yellow";break;case"business":M.data.barColor="red";break;case"personal":M.data.barColor="greem";break;case"vacation":M.data.barColor="black";break;default:M.data.barColor="orange";break}},eventDeleteHandling:"Disabled",onEventMoved:async M=>{const p=M.newStart.value,u=M.e.id(),b=S.moment(p).utc(!0).format();try{let r="/api/v1/programs/scheduled-date-start";const d={programId:u,dateScheduledStart:b};await j.put(r,d).then(l=>{G.success("Program date scheduled start was edited.")})}catch(r){P.value=S.getErrorMessageAsHtml(r),window.scrollTo(0,0);return}finally{}await m()},onEventResized:()=>{console.log("Event resized")},onEventClicked:async M=>{var p=M.e.id();f(p)},contextMenu:new Fe.DayPilot.Menu([{text:"Clone",onClick:async M=>{const p=M.source.id();try{let u=`/api/v1/programs/${p}/clone`;await j.post(u).then(b=>{G.success("Clone Program","Program was cloned.")})}catch(u){P.value=S.getErrorMessageAsHtml(u),window.scrollTo(0,0);return}finally{await m()}}},{text:"Delete",onClick:async M=>{if(!confirm("Do you want to remove this program?"))return;const u=M.source.id();try{let b=`/api/v1/programs/${u}/`;await j.delete(b).then(r=>{G.success("Delete Program","Program was deleted.")}),i.value.control.events.remove(M.source)}catch(b){P.value=S.getErrorMessageAsHtml(b),window.scrollTo(0,0);return}finally{await m()}}}])},$=fe([]),W=()=>{i.value.control.update({events:$.value})},X=ge({lookups:{visibilityTypes:[]},editorElementId:"editor",item:{userId:null,givenName:null,surname:null,displayName:null,email:null,mobilePhone:null,jobTitle:null}});me(async()=>{await m()});const m=async()=>{await y(),await W()},y=async()=>{const M=X;if(!x.value)try{x.value=!0,P.value="";const p=`/api/v1/channels/${A.id}/`;await j.get(p).then(u=>{M.item=u.data;const b=M.item.outputs,r=M.item.programs.map(d=>{let l=`${d.name}`,a=`[${d.name}]`;return d.relativeProgram&&(a+=` => [${d.relativeProgram.name}]`),{start:S.moment.utc(d.dateScheduledStart).format(),end:S.moment.utc(d.dateScheduledEnd).format(),id:d.programId,text:l,toolTip:a}});$.value=r})}catch(p){P.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{x.value=!1}},K=async M=>{const p=Ve(b$,{channelId:A.id,eventId:M.id(),dateScheduledStart:M.start().value},{chore:!0,keepInitial:!1}),{data:u,isCanceled:b}=await p.reveal();p.closeAll(),!b&&u&&await m()},f=async M=>{const p=Ve(mt,{programId:M},{chore:!0,keepInitial:!1}),{data:u,isCanceled:b}=await p.reveal();p.closeAll(),b||await m()};return(M,p)=>{const u=ae("router-link"),b=ae("PageHeader"),r=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(b,{"page-icon":"fas fa-fw fa-calendar-plus",pageTitle:o(k)},{default:F(()=>[e("button",{onClick:p[0]||(p[0]=d=>m()),class:"btn btn-secondary ms-1"},p[1]||(p[1]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(u,{to:`${n.urlView}/${n.id}`,class:"btn btn-secondary ms-1"},{default:F(()=>p[2]||(p[2]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(r,{errorMessage:o(P)},{default:F(()=>[e("div",null,[z(o(Fe.DayPilotCalendar),{id:"dp",config:T,ref_key:"calendarRef",ref:i},null,512)])]),_:1},8,["errorMessage"])])]),_:1})}}},uh=["id"],ch={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},mh={class:"modal-content"},fh={class:"modal-header"},ph={class:"modal-title"},vh={class:"modal-body"},gh={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},bh=["innerHTML"],yh={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},$h={class:"container"},hh={class:"row row-cols-1 row-cols-sm-3"},wh={class:"col"},_h={class:"form-floating mb-2"},kh=["disabled"],Sh=["value"],Th={class:"col"},Ih={class:"form-floating mb-2"},Mh={key:0,class:"d-block invalid-feedback"},xh={class:"col"},Ch={class:"form-floating mb-2"},Vh={key:0,class:"d-block invalid-feedback"},Ph={class:"row row-cols-sm-2"},Oh={class:"col"},Ah={class:"form-floating mb-2"},Lh=["value"],Uh={key:0,class:"d-block invalid-feedback"},Hh={class:"col"},Dh={class:"form-floating mb-2"},Eh=["value"],qh={key:0,class:"d-block invalid-feedback"},Bh={class:"col"},Nh={class:"input-group mb-1"},Rh={class:"form-floating"},Fh={key:0,class:"input-group-text"},zh={key:0},Gh={key:1},jh={key:2},Yh={key:3,class:"d-block invalid-feedback"},Wh={class:"col"},Kh={class:"input-group mb-1"},Qh={class:"form-floating"},Jh={key:0,class:"input-group-text"},Xh={key:0},Zh={key:1},ew={key:2,class:"d-block invalid-feedback"},tw={class:"table-responsive border mt-1"},sw={class:"table"},ow={class:"input-group mb-1"},aw=["onUpdate:modelValue"],lw={key:0,class:"input-group-text"},nw=["onUpdate:modelValue"],rw=["value"],iw=["onUpdate:modelValue"],dw=["value"],uw=["onClick"],cw={class:"modal-footer"},mw=["disabled"],fw={__name:"_addProgram",emits:["refresh"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),W=k,X=fe(),m=fe("modalAddProgram"),y=ge({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},item:{name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),K={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:ne.withMessage("Date Scheduled Start is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("sourceLocationId is required.",ie),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ne.withMessage("vodSourceId is required.",ie),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ne.withMessage("startOffsetMillis is required.",ie),minValue:Ee(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ne.withMessage("endOffsetMillis is required.",ie),minValue:Ee(0),$autoDirty:!0,$lazy:!0}}},f=Se(K,y);me(async()=>{f.value.$reset()});const M=async O=>{X.value=O;const h=y;Q.value.clear(),G.value="";const E=A.moment().local().add(2,"m"),V=E.format("YYYY-MM-DD HH:mm"),re=E.format("YYYY_MM_DD")+"_PROGRAM_";h.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},h.item={name:re,relativeProgramId:null,dateScheduledStart:V,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await b(),f.value.$reset();var J=document.getElementById(m.value),oe=he.getOrCreateInstance(J);oe.show()},p=async()=>{var O=document.getElementById(m.value),h=he.getOrCreateInstance(O);h.hide(),W("refresh")},u=async()=>{const O=y;if(D.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{D.value=!0,G.value="";const Z=O.item;delete Z.vodSource,Z.channelId=X.value;var E=Z.dateScheduledStart;Z.dateScheduledStart=A.moment(E).utc().format(),await B.post("/api/v1/programs/",Z).then(V=>{i.success("Add Program","Program added to Channel",{async onClose(){}})}),await p()}catch(Z){G.value=A.getErrorMessageAsHtml(Z),window.scrollTo(0,0)}finally{D.value=!1}},b=async()=>{await r(),await l(),await U()},r=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(h=>{y.lookups.sourceLocations=h.data,y.lookups.sourceLocations.length===1&&(y.item.sourceLocationId=y.lookups.sourceLocations[0].id)}),y.item.sourceLocationId&&await d(y.item.sourceLocationId)}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},d=async O=>{try{let h=`/api/v1/vodSources/lookup/source-location/${O}`;await B.get(h).then(E=>{y.lookups.vodSources=E.data})}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},l=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(h=>{y.lookups.adBreakSourceLocations=h.data})}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},a=async O=>{try{let h=`/api/v1/vodSources/lookup/source-location/${O}`;await B.get(h).then(E=>{y.lookups.adBreakVodSources=E.data})}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},U=async()=>{try{const O=`/api/v1/programs/lookup/?channelId=${X.value}`;await B.get(O).then(h=>{if(y.lookups.channelPrograms=h.data,y.lookups.channelPrograms.length===1){const Z=y.lookups.channelPrograms[0];y.item.relativeProgramId=Z.id}})}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},I=()=>{const O={offsetMillis:0,sourceLocationId:null,vodSourceId:null},h=y.item.adBreaks.length;if(h>0){const E=y.item.adBreaks[h-1];O.offsetMillis=E.offsetMillis+1e4}y.item.adBreaks.push(O)},g=O=>{y.item.adBreaks.splice(O,1)},q=()=>{const O=y.item.vodSource;y.item.vodSourceId=O.id};return v({open:M,close:p}),(O,h)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",ch,[e("div",mh,[e("div",fh,[e("h5",ph,[h[12]||(h[12]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:h[0]||(h[0]=E=>p()),"aria-label":"Close"})]),e("div",vh,[o(G)?(t(),s("div",gh,[h[13]||(h[13]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,bh)])):L("",!0),o(Q).size>0?(t(),s("div",yh,[h[14]||(h[14]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),E=>(t(),s("li",null,c(E),1))),256))])])):L("",!0),e("div",$h,[e("div",hh,[e("div",wh,[e("div",_h,[R(e("select",{"onUpdate:modelValue":h[1]||(h[1]=E=>y.item.relativeProgramId=E),class:"form-select",id:"sourceLocationId",disabled:y.lookups.channelPrograms.length<=0},[(t(!0),s(H,null,N(y.lookups.channelPrograms,E=>(t(),s("option",{value:E.id},c(E.name),9,Sh))),256))],8,kh),[[pe,y.item.relativeProgramId]]),h[15]||(h[15]=e("label",{for:"relativeProgramId",class:""},"Relative Program",-1))])]),e("div",Th,[e("div",Ih,[R(e("input",{"onUpdate:modelValue":h[2]||(h[2]=E=>y.item.name=E),id:"name",class:"form-control",placeholder:"Name"},null,512),[[te,y.item.name]]),h[16]||(h[16]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",Mh,[(t(!0),s(H,null,N(o(f).item.name.$errors,E=>(t(),s("div",{key:E.$uid},c(E.$message),1))),128))])):L("",!0)])]),e("div",xh,[e("div",Ch,[R(e("input",{"onUpdate:modelValue":h[3]||(h[3]=E=>y.item.dateScheduledStart=E),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[te,y.item.dateScheduledStart]]),h[17]||(h[17]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(f).item.dateScheduledStart.$error?(t(),s("div",Vh,[(t(!0),s(H,null,N(o(f).item.dateScheduledStart.$errors,E=>(t(),s("div",{key:E.$uid},c(E.$message),1))),128))])):L("",!0)])])]),e("div",Ph,[e("div",Oh,[e("div",Ah,[R(e("select",{"onUpdate:modelValue":h[4]||(h[4]=E=>y.item.sourceLocationId=E),onChange:h[5]||(h[5]=E=>d(y.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(H,null,N(y.lookups.sourceLocations,E=>(t(),s("option",{value:E.id},c(E.name),9,Lh))),256))],544),[[pe,y.item.sourceLocationId]]),h[18]||(h[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(f).item.sourceLocationId.$error?(t(),s("div",Uh,[(t(!0),s(H,null,N(o(f).item.sourceLocationId.$errors,E=>(t(),s("div",{key:E.$uid},c(E.$message),1))),128))])):L("",!0)])]),e("div",Hh,[e("div",Dh,[R(e("select",{"onUpdate:modelValue":h[6]||(h[6]=E=>y.item.vodSource=E),onChange:h[7]||(h[7]=E=>q()),class:"form-select",id:"vodSourceId"},[(t(!0),s(H,null,N(y.lookups.vodSources,E=>(t(),s("option",{value:E},c(E.name),9,Eh))),256))],544),[[pe,y.item.vodSource]]),h[19]||(h[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(f).item.vodSourceId.$error?(t(),s("div",qh,[(t(!0),s(H,null,N(o(f).item.vodSourceId.$errors,E=>(t(),s("div",{key:E.$uid},c(E.$message),1))),128))])):L("",!0)])]),e("div",Bh,[e("div",Nh,[e("div",Rh,[R(e("input",{"onUpdate:modelValue":h[8]||(h[8]=E=>y.item.startOffsetMillis=E),id:"startOffsetMillis",type:"number",class:"form-control",placeholder:"Start OffSet Millis"},null,512),[[te,y.item.startOffsetMillis]]),h[20]||(h[20]=e("label",{for:"startOffsetMillis",class:""},"Start OffSet Millis",-1))]),y.item.startOffsetMillis>0?(t(),s("span",Fh,c(o(A).moment.utc(y.item.startOffsetMillis).format("HH:mm:ss")),1)):L("",!0)]),y.item.startOffsetMillis>0&&y.item.startOffsetMillis<3e4?(t(),s("div",zh,h[21]||(h[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):L("",!0),y.item.startOffsetMillis>y.item.endOffsetMillis&&y.item.endOffsetMillis>0?(t(),s("div",Gh,h[22]||(h[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Exceeds End Offset Millis ",-1)]))):L("",!0),y.item.vodSource&&y.item.startOffsetMillis>y.item.vodSource.durationInMillis?(t(),s("div",jh,h[23]||(h[23]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Millis Exceeds VOD Source Duration ",-1)]))):L("",!0),o(f).item.startOffsetMillis.$error?(t(),s("div",Yh,[(t(!0),s(H,null,N(o(f).item.startOffsetMillis.$errors,E=>(t(),s("div",{key:E.$uid},c(E.$message),1))),128))])):L("",!0)]),e("div",Wh,[e("div",Kh,[e("div",Qh,[R(e("input",{"onUpdate:modelValue":h[9]||(h[9]=E=>y.item.endOffsetMillis=E),id:"endOffsetMillis",type:"number",class:"form-control",placeholder:"End OffSet Millis"},null,512),[[te,y.item.endOffsetMillis]]),h[24]||(h[24]=e("label",{for:"endOffsetMillis",class:""},"End OffSet Millis",-1))]),y.item.endOffsetMillis>0?(t(),s("span",Jh,c(o(A).moment.utc(y.item.endOffsetMillis).format("HH:mm:ss")),1)):L("",!0)]),y.item.endOffsetMillis>0&&y.item.endOffsetMillis<3e4?(t(),s("div",Xh,h[25]||(h[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):L("",!0),y.item.vodSource&&y.item.endOffsetMillis>y.item.vodSource.durationInMillis?(t(),s("div",Zh,h[26]||(h[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Millis Exceeds VOD Source Duration ",-1)]))):L("",!0),o(f).item.endOffsetMillis.$error?(t(),s("div",ew,[(t(!0),s(H,null,N(o(f).item.endOffsetMillis.$errors,E=>(t(),s("div",{key:E.$uid},c(E.$message),1))),128))])):L("",!0)])]),h[30]||(h[30]=e("hr",null,null,-1)),e("div",null,[e("div",{class:"d-flex flex-row justify-content-between"},[h[27]||(h[27]=e("fieldset",null,[e("legend",null," Ad Break ")],-1)),e("button",{onClick:I,class:"btn btn-outline-primary"}," Insert Ad Break ")]),e("div",tw,[e("table",sw,[h[29]||(h[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Millis"),e("th",null,"Source Location"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",null,[(t(!0),s(H,null,N(y.item.adBreaks,(E,Z)=>(t(),s("tr",null,[e("td",null,c(Z+1),1),e("td",null,[e("div",ow,[R(e("input",{"onUpdate:modelValue":V=>E.offsetMillis=V,type:"number",class:"form-control",placeholder:"Enter Offset Millis..."},null,8,aw),[[te,E.offsetMillis]]),E.offsetMillis>0?(t(),s("span",lw,c(o(A).moment.utc(E.offsetMillis).format("HH:mm:ss")),1)):L("",!0)])]),e("td",null,[R(e("select",{"onUpdate:modelValue":V=>E.sourceLocationId=V,onChange:h[10]||(h[10]=V=>a(y.item.sourceLocationId)),class:"form-select",id:"adBreakSourceLocationId"},[(t(!0),s(H,null,N(y.lookups.adBreakSourceLocations,V=>(t(),s("option",{value:V.id},c(V.name),9,rw))),256))],40,nw),[[pe,E.sourceLocationId]])]),e("td",null,[R(e("select",{"onUpdate:modelValue":V=>E.vodSourceId=V,class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(H,null,N(y.lookups.adBreakVodSources,V=>(t(),s("option",{value:V.id},c(V.name),9,dw))),256))],8,iw),[[pe,E.vodSourceId]])]),e("td",null,[e("button",{onClick:V=>g(Z),class:"btn btn-outline-warning"},h[28]||(h[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,uw)])]))),256))])])])])])]),e("div",cw,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:h[11]||(h[11]=E=>u()),class:"btn btn-primary",type:"button"},h[31]||(h[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,mw),h[32]||(h[32]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,uh))}},pw=["id"],vw={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},gw={class:"modal-content"},bw={class:"modal-header"},yw={class:"modal-title"},$w={class:"modal-body"},hw={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},ww=["innerHTML"],_w={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},kw={class:"container"},Sw={class:"col"},Tw={class:"form-floating mb-2"},Iw={class:"col"},Mw={class:"form-floating mb-2"},xw={key:0,class:"d-block invalid-feedback"},Cw={class:"col"},Vw={class:"form-floating mb-2 d-none"},Pw={key:0,class:"d-block invalid-feedback"},Ow={class:"col"},Aw={class:"form-floating mb-2"},Lw={key:0,class:"d-block invalid-feedback"},Uw={class:"modal-footer"},Hw=["disabled"],Dw={__name:"_addPlaybackConfiguration",props:{channelOutputId:{type:String,required:!0},playbackUrl:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output Playback Configuration"}),W=k,X=n,m=fe("modalAddPlaybackConfiguration"),y=ge({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),K={item:{name:{required:ne.withMessage("Name is required.",ie),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:ne.withMessage("adDecisionServerUrl is required.",ie),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:ne.withMessage("videoContentSourceUrl is required.",ie),$autoDirty:!0,$lazy:!0}}},f=Se(K,y);me(async()=>{f.value.$reset(),await M()});const M=async()=>{const b=y;Q.value.clear(),G.value="";const r=X.playbackUrl;let d=r.lastIndexOf("/");const l=r.substring(0,d);let a=r.substring(d+1);d=a.lastIndexOf("."),a=a.substring(0,d)+"_ADCAMPAIGN_",b.item={name:a,originalVideoContentSourceUrl:X.playbackUrl,videoContentSourceUrl:l,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},f.value.$reset();var U=document.getElementById(m.value),I=he.getOrCreateInstance(U);I.show()},p=async()=>{var b=document.getElementById(m.value),r=he.getOrCreateInstance(b);r.hide(),W("cancel")},u=async()=>{const b=y;if(D.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{D.value=!0,G.value="";const a=b.item;a.channelOutputId=X.channelOutputId,await B.put("/api/v1/channelOutputs/playback/",a).then(U=>{i.success("Add Channel Output Playback Configuration","Channel Output playback configuration added.",{async onClose(){}})});var d=document.getElementById(m.value),l=he.getOrCreateInstance(d);l.hide(),W("confirm")}catch(a){G.value=A.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{D.value=!1}};return v({open:M,close:p}),(b,r)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-hidden":"false"},[e("div",vw,[e("div",gw,[e("div",bw,[e("h5",yw,[r[6]||(r[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:r[0]||(r[0]=d=>p()),"aria-label":"Close"})]),e("div",$w,[o(G)?(t(),s("div",hw,[r[7]||(r[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,ww)])):L("",!0),o(Q).size>0?(t(),s("div",_w,[r[8]||(r[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),d=>(t(),s("li",null,c(d),1))),256))])])):L("",!0),e("div",kw,[e("div",Sw,[e("div",Tw,[R(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=d=>y.item.originalVideoContentSourceUrl=d),id:"originalVideoContentSourceUrl",class:"form-control",style:{height:"5rem"},placeholder:"originalVideoContentSourceUrl",readonly:""},null,512),[[te,y.item.originalVideoContentSourceUrl]]),r[9]||(r[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",Iw,[e("div",Mw,[R(e("input",{"onUpdate:modelValue":r[2]||(r[2]=d=>y.item.name=d),id:"name",class:"form-control",placeholder:"Name"},null,512),[[te,y.item.name]]),r[10]||(r[10]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",xw,[(t(!0),s(H,null,N(o(f).item.name.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):L("",!0)])]),e("div",Cw,[e("div",Vw,[R(e("input",{"onUpdate:modelValue":r[3]||(r[3]=d=>y.item.videoContentSourceUrl=d),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[te,y.item.videoContentSourceUrl]]),r[11]||(r[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),r[12]||(r[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(f).item.videoContentSourceUrl.$error?(t(),s("div",Pw,[(t(!0),s(H,null,N(o(f).item.videoContentSourceUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):L("",!0)])]),e("div",Ow,[e("div",Aw,[R(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=d=>y.item.adDecisionServerUrl=d),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[te,y.item.adDecisionServerUrl]]),r[13]||(r[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(f).item.adDecisionServerUrl.$error?(t(),s("div",Lw,[(t(!0),s(H,null,N(o(f).item.adDecisionServerUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):L("",!0),r[14]||(r[14]=Je('<div class="mt-2 ms-3"><span class="fas fa-fw fa-info-circle text-info"></span><span class="small">Sample value for the Ad Decision Server Url</span><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/pg/vast.xml</textarea><label for="" class="">Sample VAST 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/rama/vast.xml</textarea><label for="" class="">Sample VAST 2</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&amp;iu=/124319096/external/ad_rule_samples&amp;ciu_szs=300x250&amp;ad_rule=1&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=vmap&amp;unviewed_position_start=1&amp;cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&amp;cmsid=496&amp;vid=short_onecue&amp;correlator=[avail.random]</textarea><label for="" class="">Sample VMAP 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_ad_samples&amp;sz=640x480&amp;cust_params=sample_ct%3Dlinear&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 2 (Linear)</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_preroll_skippable&amp;sz=640x480&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 3 (Skippable)</label></div></div>',1))])])])]),e("div",Uw,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:r[5]||(r[5]=d=>u()),class:"btn btn-primary",type:"button"},r[15]||(r[15]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Hw),r[16]||(r[16]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,pw))}},Ew=["id"],qw={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Bw={class:"modal-content"},Nw={class:"modal-header"},Rw={class:"modal-title"},Fw={class:"modal-body"},zw={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Gw=["innerHTML"],jw={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Yw={class:"container"},Ww={class:"col"},Kw={class:"form-floating mb-2"},Qw=["value"],Jw={key:0,class:"d-block invalid-feedback"},Xw={class:"col"},Zw={class:"form-floating mb-2"},e_={key:0,class:"d-block invalid-feedback"},t_={class:"col"},s_={class:"form-floating mb-2"},o_={key:0,class:"d-block invalid-feedback"},a_={class:"modal-footer"},l_=["disabled"],n_={__name:"_addChannelOutput",props:{channelId:{type:String}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output"}),W=k,X=n,m=fe("modalAddChannelOutput"),y=ge({lookups:{sourceGroups:[]},item:{sourceGroupId:null,manifestName:null,outputType:null}}),K={item:{sourceGroupId:{required:ne.withMessage("Source Group is required.",ie),$autoDirty:!0,$lazy:!0},manifestName:{required:ne.withMessage("Manifest Name is required.",ie),$autoDirty:!0,$lazy:!0},outputType:{required:ne.withMessage("Output Type is required.",ie),$autoDirty:!0,$lazy:!0}}},f=Se(K,y);me(async()=>{f.value.$reset(),u()});const M=async()=>{await p()},p=async()=>{try{await B.get("/api/v1/sourceGroups/lookup/").then(l=>{y.lookups.sourceGroups=l.data,y.lookups.sourceGroups.length===1&&(y.item.sourceGroupId=y.lookups.sourceGroups[0].id)})}catch(d){G.value=A.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}},u=async()=>{const d=y;Q.value.clear(),G.value="",d.lookups={sourceGroups:[]},d.item={sourceGroupId:null,outputType:null},await M(),f.value.$reset();var l=document.getElementById(m.value),a=he.getOrCreateInstance(l);a.show()},b=async()=>{var d=document.getElementById(m.value),l=he.getOrCreateInstance(d);l.hide(),W("cancel")},r=async()=>{const d=y;if(D.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{D.value=!0,G.value="";const I=d.item;I.channelId=X.channelId,await B.post("/api/v1/channelOutputs",I).then(g=>{i.success("Add Channel Output","Channel output added.")});var a=document.getElementById(m.value),U=he.getOrCreateInstance(a);U.hide(),W("confirm")}catch(I){G.value=A.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{D.value=!1}};return v({open:u,close:b}),(d,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-hidden":"true"},[e("div",qw,[e("div",Bw,[e("div",Nw,[e("h5",Rw,[l[4]||(l[4]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),l[5]||(l[5]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",Fw,[o(G)?(t(),s("div",zw,[l[6]||(l[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Gw)])):L("",!0),o(Q).size>0?(t(),s("div",jw,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),a=>(t(),s("li",null,c(a),1))),256))])])):L("",!0),e("div",Yw,[e("div",Ww,[e("div",Kw,[R(e("select",{"onUpdate:modelValue":l[0]||(l[0]=a=>y.item.sourceGroupId=a),class:ee([o(A).getValidFeedbackCss(y.item.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(H,null,N(y.lookups.sourceGroups,a=>(t(),s("option",{value:a.id},c(a.name),9,Qw))),256))],2),[[pe,y.item.sourceGroupId]]),l[8]||(l[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(f).item.sourceGroupId.$error?(t(),s("div",Jw,[(t(!0),s(H,null,N(o(f).item.sourceGroupId.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",Xw,[e("div",Zw,[R(e("select",{"onUpdate:modelValue":l[1]||(l[1]=a=>y.item.outputType=a),class:ee([o(A).getValidFeedbackCss(y.item.outputType),"form-select"]),id:"outputType"},l[9]||(l[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),2),[[pe,y.item.outputType]]),l[10]||(l[10]=e("label",{for:"outputType",class:""},"Output Type",-1)),o(f).item.outputType.$error?(t(),s("div",e_,[(t(!0),s(H,null,N(o(f).item.outputType.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])]),e("div",t_,[e("div",s_,[R(e("input",{"onUpdate:modelValue":l[2]||(l[2]=a=>y.item.manifestName=a),class:ee([o(A).getValidFeedbackCss(y.item.manifestName),"form-control"]),id:"manifestName"},null,2),[[te,y.item.manifestName]]),l[11]||(l[11]=e("label",{for:"manifestName",class:""},"Manifest Name",-1)),o(f).item.manifestName.$error?(t(),s("div",o_,[(t(!0),s(H,null,N(o(f).item.manifestName.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):L("",!0)])])])]),e("div",a_,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:l[3]||(l[3]=a=>r()),class:"btn btn-primary",type:"button"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,l_),l[13]||(l[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,Ew))}},r_=["id"],i_={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},d_={class:"modal-content"},u_={class:"modal-header"},c_={class:"modal-title"},m_={class:"modal-body"},f_={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},p_=["innerHTML"],v_={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},g_={class:"container"},b_={class:"col"},y_={class:"form-floating mb-2"},$_=["value"],h_={key:0,class:"d-block invalid-feedback"},w_={class:"col"},__={class:"form-floating mb-2"},k_=["value"],S_={key:0,class:"d-block invalid-feedback"},T_={class:"col"},I_={class:"card h-100"},M_=["id"],x_={class:"modal-footer"},C_=["disabled"],V_={__name:"_editFillerSlate",props:{channelId:{type:String},sourceLocationId:{type:String},vodSourceId:{type:String}},emits:["confirm","cancel"],setup(n,{expose:v,emit:k}){const{appTitle:x,pageTitle:_,busy:D,isDirty:P,validations:Q,infoMessage:j,warningMessage:S,errorMessage:G,router:le,axios:B,utils:A,toasts:i,closeWithReturnUrl:T,security:$}=ye({appTitle:"Arcadian-FAST",pageTitle:"Edit Filler Slate"}),W=k,X=n,m=fe("modalEditFillerSlate"),y=ge({lookups:{sourceLocations:[],vodSources:[]},item:{channelId:null,sourceLocationId:null,vodSourceId:null},hls:null}),K={item:{channelId:{required:ne.withMessage("channelId is required.",ie),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ne.withMessage("sourceLocationId is required.",ie),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ne.withMessage("vodSourceId is required.",ie),$autoDirty:!0,$lazy:!0}}},f=Se(K,y);me(async()=>{b(),f.value.$reset()}),Ae(()=>{y.hls&&(y.hls.stopLoad(),y.hls.destroy())});const M=async()=>{await p()},p=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(g=>{y.lookups.sourceLocations=g.data}),y.item.sourceLocationId&&await u(y.item.sourceLocationId)}catch(I){G.value=A.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{}},u=async I=>{try{let g=`/api/v1/vodSources/lookup/source-Location/${I}/?category=2`;await B.get(g).then(q=>{y.lookups.vodSources=q.data})}catch(g){G.value=A.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{}},b=async()=>{const I=y;Q.value.clear(),G.value="",I.lookups={sourceLocations:[],vodSources:[]},I.item={channelId:X.channelId,sourceLocationId:X.sourceLocationId,vodSourceId:X.vodSourceId},await M(),y.item.vodSourceId&&await U(y.item.vodSourceId),f.value.$reset();var g=document.getElementById(m.value),q=he.getOrCreateInstance(g);q.show()},r=async()=>{var I=document.getElementById(m.value),g=he.getOrCreateInstance(I);g.hide(),y.hls&&(y.hls.stopLoad(),y.hls.destroy()),W("cancel","cancel clicked")},d=async()=>{const I=y;if(D.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{D.value=!0,G.value="";const h=I.item;await B.put("/api/v1/channels/filler-slate",h).then(E=>{i.success("Update Channel Filler Slate","Channel's Filler slate was updated.")});var q=document.getElementById(m.value),O=he.getOrCreateInstance(q);O.hide(),y.hls&&(y.hls.stopLoad(),y.hls.destroy()),W("confirm",y.item)}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{D.value=!1}},l=async()=>{y.item.vodSourceId=null,await u(y.item.sourceLocationId)},a=async()=>{await U(y.item.vodSourceId)},U=async I=>{try{let g=`/api/v1/vodSources/${I}/hls`;const q=await B.get(g).then(h=>h.data);if(y.hls){y.hls.loadSource(q);return}const O=document.getElementById(`video-${y.item.channelId}`);y.hls=A.createHlsStream(O,q)}catch(g){G.value=A.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{}};return v({open:b,close:r}),(I,g)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-hidden":"true"},[e("div",i_,[e("div",d_,[e("div",u_,[e("h5",c_,[g[6]||(g[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:g[0]||(g[0]=q=>r()),"aria-label":"Close"})]),e("div",m_,[o(G)?(t(),s("div",f_,[g[7]||(g[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,p_)])):L("",!0),o(Q).size>0?(t(),s("div",v_,[g[8]||(g[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(o(Q).values(),q=>(t(),s("li",null,c(q),1))),256))])])):L("",!0),e("div",g_,[e("div",b_,[e("div",y_,[R(e("select",{"onUpdate:modelValue":g[1]||(g[1]=q=>y.item.sourceLocationId=q),onChange:g[2]||(g[2]=q=>l()),class:ee([o(A).getValidFeedbackCss(y.item.sourceLocationId),"form-select"]),id:"sourceLocationId"},[(t(!0),s(H,null,N(y.lookups.sourceLocations,q=>(t(),s("option",{value:q.id},c(q.name),9,$_))),256))],34),[[pe,y.item.sourceLocationId]]),g[9]||(g[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(f).item.sourceLocationId.$error?(t(),s("div",h_,[(t(!0),s(H,null,N(o(f).item.sourceLocationId.$errors,q=>(t(),s("div",{key:q.$uid},c(q.$message),1))),128))])):L("",!0)])]),e("div",w_,[e("div",__,[R(e("select",{"onUpdate:modelValue":g[3]||(g[3]=q=>y.item.vodSourceId=q),onChange:a,class:ee([o(A).getValidFeedbackCss(y.item.vodSourceId),"form-select"]),id:"vodSourceId"},[(t(!0),s(H,null,N(y.lookups.vodSources,q=>(t(),s("option",{value:q.id},c(q.name),9,k_))),256))],34),[[pe,y.item.vodSourceId]]),g[10]||(g[10]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(f).item.vodSourceId.$error?(t(),s("div",S_,[(t(!0),s(H,null,N(o(f).item.vodSourceId.$errors,q=>(t(),s("div",{key:q.$uid},c(q.$message),1))),128))])):L("",!0)])]),e("div",T_,[e("div",I_,[e("video",{id:`video-${y.item.channelId}`,controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,8,M_)])])])]),e("div",x_,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:g[4]||(g[4]=q=>d()),class:"btn btn-primary",type:"button"},g[11]||(g[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,C_),e("button",{onClick:g[5]||(g[5]=q=>r()),class:"btn btn-secondary ms-1"},g[12]||(g[12]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,r_))}},P_={class:"my-2"},O_={class:""},A_={class:"form-floating mb-2"},L_={id:"vodSourceTitle",class:"form-control-plaintext"},U_={class:"row"},H_={class:"col-12 col-md-4"},D_={class:"form-floating mb-2"},E_={id:"vodSourceVideoTitle",class:"form-control-plaintext"},q_={class:"col-12 col-md-8"},B_={class:"form-floating mb-2"},N_={id:"vodSourceVideoDesc",class:"form-control-plaintext"},R_={class:"mt-2"},F_={class:"row row-cols-1 row-cols-sm-3"},z_={class:"col"},G_={class:"form-floating mb-2"},j_={id:"startOffsetMillis",class:"form-control-plaintext"},Y_={class:"col"},W_={class:"form-floating mb-2"},K_={id:"endOffsetMillis",class:"form-control-plaintext"},Q_={class:"col"},J_={class:"form-floating mb-2"},X_={id:"durationInMillis",class:"form-control-plaintext"},Z_={class:"row row-cols-1 row-cols-sm-3"},ek={class:"col"},tk={class:"form-floating mb-2"},sk={id:"adBreaksDurationInMillis",class:"form-control-plaintext"},ok={class:"col"},ak={class:"form-floating mb-2"},lk={id:"totalProgramTemplateDurationInMillis",class:"form-control-plaintext"},nk={class:"row row-cols-1 row-cols-sm-3"},rk={class:"col"},ik={class:"form-floating mb-2"},dk={id:"dateScheduledStart",class:"form-control-plaintext"},uk={class:"col"},ck={class:"form-floating mb-2"},mk={id:"dateScheduledEnd",class:"form-control-plaintext"},fk={key:0,class:"col"},pk={class:"form-floating mb-2"},vk={id:"relativeProgram",class:"form-control-plaintext"},gk={key:0,class:"mt-2"},bk={class:"table-responsive border"},yk={class:"table table-sm table-bordered1 mb-0"},$k={class:"text-center me-1"},hk={class:"text-center"},wk={class:"text-center"},_k={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},kk={key:1,class:"fas fa-fw fa-triangle-exclamation text-warning me-1"},Sk={__name:"_programDetail",props:{item:{type:Object,required:!0},urlViewVideo:{type:String,required:!0},urlViewVodSource:{type:String,required:!0}},setup(n){const v=n,{moment:k,generateReturnUrl:x}=Ze();return me(()=>{v.item.value}),(_,D)=>{const P=ae("router-link");return t(),s("div",P_,[e("div",null,[D[1]||(D[1]=e("h5",null," VOD ",-1)),e("div",O_,[e("div",A_,[e("div",L_,[z(P,{to:`${n.urlViewVodSource}/${n.item.vodSourceId}/${o(x)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(n.item.vodSource.name),1)]),_:1},8,["to"])]),D[0]||(D[0]=e("label",{for:"vodSourceTitle"},"Title",-1))])])]),e("div",null,[D[4]||(D[4]=e("h5",null," Video ",-1)),e("div",U_,[e("div",H_,[e("div",D_,[e("div",E_,[z(P,{to:`${n.urlViewVideo}/${n.item.vodSource.video.videoId}/${o(x)()}`,class:"link-offset-2"},{default:F(()=>[Y(c(n.item.vodSource.video.title),1)]),_:1},8,["to"])]),D[2]||(D[2]=e("label",{for:"vodSourceVideoTitle"},"Title",-1))])]),e("div",q_,[e("div",B_,[e("div",N_,c(n.item.vodSource.video.description),1),D[3]||(D[3]=e("label",{for:"vodSourceVideoDesc"},"Description",-1))])])])]),e("div",R_,[D[13]||(D[13]=e("h5",null," Schedule ",-1)),e("div",F_,[e("div",z_,[e("div",G_,[e("div",j_,c(o(k).utc(n.item.startOffsetMillis).format("HH:mm:ss")),1),D[5]||(D[5]=e("label",{for:"startOffsetMillis"},"Start Offset",-1))])]),e("div",Y_,[e("div",W_,[e("div",K_,c(o(k).utc(n.item.endOffsetMillis).format("HH:mm:ss")),1),D[6]||(D[6]=e("label",{for:"endOffsetMillis"},"End Offset",-1))])]),e("div",Q_,[e("div",J_,[e("div",X_,c(o(k).utc(n.item.durationInMillis).format("HH:mm:ss")),1),D[7]||(D[7]=e("label",{for:"durationInMillis"},"Clip Duration",-1))])])]),e("div",Z_,[e("div",ek,[e("div",tk,[e("div",sk,c(o(k).utc(n.item.adBreaksDurationInMillis).format("HH:mm:ss")),1),D[8]||(D[8]=e("label",{for:"adBreaksDurationInMillis"},"Total Ad Breaks Duration",-1))])]),e("div",ok,[e("div",ak,[e("div",lk,c(o(k).utc(n.item.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),D[9]||(D[9]=e("label",{for:"totalProgramTemplateDurationInMillis"},"Total Program Duration",-1))])])]),e("div",nk,[e("div",rk,[e("div",ik,[e("div",dk,c(o(k).utc(n.item.dateScheduledStart).format("lll")),1),D[10]||(D[10]=e("label",{for:"dateScheduledStart"},"Program Start",-1))])]),e("div",uk,[e("div",ck,[e("div",mk,c(o(k).utc(n.item.dateScheduledEnd).format("lll")),1),D[11]||(D[11]=e("label",{for:"dateScheduledEnd"},"Program End",-1))])]),n.item.relativeProgram?(t(),s("div",fk,[e("div",pk,[e("div",vk,c(n.item.relativeProgram.name),1),D[12]||(D[12]=e("label",{for:"relativeProgram"},"Relative Program",-1))])])):L("",!0)])]),n.item.adBreaks.length?(t(),s("div",gk,[D[15]||(D[15]=e("h5",null," Ad Breaks ",-1)),e("div",bk,[e("table",yk,[e("tbody",null,[D[14]||(D[14]=e("tr",null,[e("th",{class:"text-center"},"#"),e("th",{class:"text-center"},"Offset"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center1"},"VOD")],-1)),(t(!0),s(H,null,N(n.item.adBreaks,(Q,j)=>(t(),s("tr",null,[e("td",$k,c(j+1),1),e("td",hk,c(o(k).utc(Q.offsetMillis).format("HH:mm:ss")),1),e("td",wk,c(o(k).utc(Q.durationInMillis).format("HH:mm:ss")),1),e("td",null,[z(P,{to:`${n.urlViewVodSource}/${Q.vodSource.vodSourceId}/${o(x)()}`,class:"link-offset-2"},{default:F(()=>[Q.vodSource.arn?(t(),s("span",_k)):(t(),s("span",kk)),Y(" "+c(Q.vodSource.name),1)]),_:2},1032,["to"])])]))),256))])])])])):L("",!0)])}}},Tk={key:0,class:"dropdown"},Ik={key:0,class:"fas fa-fw fa-play"},Mk={key:1,class:"fas fa-fw fa-stop"},xk={class:"dropdown-menu"},Ck={key:0},Vk={key:1},Pk={key:0},Ok={class:"nav nav-tabs",id:"myTab",role:"tablist"},Ak={class:"nav-item",role:"presentation"},Lk={class:"nav-item",role:"presentation"},Uk={class:"nav-item",role:"presentation"},Hk={class:"nav-item",role:"presentation"},Dk={class:"nav-item",role:"presentation"},Ek={class:"tab-content",id:"myTabContent"},qk={class:""},Bk={class:"row row-cols-1 row-cols-sm-3"},Nk={class:"col"},Rk={class:"form-floating mb-2"},Fk={class:"col"},zk={class:"form-floating mb-2"},Gk={class:"col"},jk={class:"form-floating mb-2"},Yk={class:"d-flex flex-row justify-content-start align-items-center"},Wk={key:0,class:"ms-2"},Kk={class:"row row-cols-sm-2 mt-1"},Qk={class:"col"},Jk={class:"form-floating mb-2"},Xk={class:"form-control-plaintext",readonly:""},Zk={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},e2={class:"col"},t2={class:"form-floating mb-2"},s2={class:"form-control-plaintext",readonly:""},o2={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},a2={class:""},l2={class:"d-flex flex-row justify-content-start align-items-center"},n2={class:"ms-2"},r2={key:0,class:"alert bg-warning mt-2"},i2={class:"table-responsive border mt-1"},d2={class:"table table-bordered1 mb-0"},u2={class:"badge bg-info"},c2={key:0,class:"text-wrap"},m2={key:1,class:"text-warning"},f2={key:0,class:"text-end"},p2={key:1,class:"text-end"},v2=["onClick"],g2={key:0},b2={colspan:"999"},y2={class:"d-flex flex-row justify-content-start align-items-center"},$2={class:"ms-2"},h2={if:"item.playbackUrl"},w2=["onClick"],_2={key:0,class:"table-responsive mt-2"},k2={class:"table table-borderless mb-0 table-sm"},S2={class:"align-middle1"},T2={class:"badge bg-success"},I2={class:"border p-2 mt-2 text-wrap text-truncate",style:{"max-width":"65rem"}},M2={class:"text-end"},x2={class:"d-flex flex-row justify-content-end align-items-baseline"},C2=["onClick"],V2=["onClick"],P2={class:""},O2={class:"table-responsive border"},A2={class:"table mb-0 table-sm table-bordered1"},L2={class:"align-middle1"},U2={class:"text-center me-1"},H2={class:"d-flex flex-column flex-md-row justify-content-start gap-1"},D2={class:""},E2={class:"mb-1 mb-md-0"},q2=["src"],B2={class:"me-auto ms-md-2"},N2={key:0,class:"fas fa-fw fa-check-circle text-success"},R2={class:"mx-md-5"},F2={class:"fw-lighter small text-nowrap"},z2={class:"fw-lighter small text-nowrap"},G2={class:"me-md-5"},j2={class:"fw-lighter small text-nowrap"},Y2={class:"fw-lighter small text-nowrap"},W2={class:"text-center"},K2={class:"text-center"},Q2={class:"text-end"},J2={class:"btn-group position-static"},X2=["onClick"],Z2={key:0,class:"fas fa-fw fa-chevron-circle-up"},eS={key:1,class:"fas fa-fw fa-chevron-circle-down"},tS={class:"dropdown-menu"},sS=["onClick"],oS={key:0},aS=["onClick"],lS=["onClick"],nS=["onClick"],rS={key:0},iS={colspan:"999"},dS={class:"text-end mt-2 d-none"},uS={class:""},cS={class:"text-end mb-2"},mS={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4",id:"masonry"},fS={class:"col"},pS={class:"card shadow-sm"},vS=["id"],gS={class:"p-1"},bS={class:"card-title1 text-center"},yS={class:"col"},$S={class:"card shadow-sm"},hS=["id"],wS={class:"p-1"},_S={class:"card-title1 text-center text-truncate"},kS={class:"small1"},SS={class:""},TS={key:0,class:"fas fa-fw fa-check-circle text-success"},IS={key:1,class:"fas fa-fw fa-times-circle text-warning"},MS={key:0,class:"fas fa-fw fa-check-circle text-success"},xS={key:1,class:"fas fa-fw fa-times-circle text-warning"},CS={key:0,class:"fas fa-fw fa-check-circle text-success"},VS={key:1,class:"fas fa-fw fa-times-circle text-warning"},PS={key:0,class:"fas fa-fw fa-check text-warning"},OS={key:1,class:"fas fa-fw fa-circle-exclamation text-warning"},AS={key:0,class:"fas fa-fw fa-check-circle text-success"},LS={key:1,class:"fas fa-fw fa-times-circle text-warning"},US={__name:"index",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/channels"},urlViewSourceGroup:{type:String,default:"/source-groups/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlSchedulePrograms:{type:String,default:"/channels/schedule-programs"}},setup(n){const v=n,{appTitle:k,pageTitle:x,busy:_,isDirty:D,validations:P,infoMessage:Q,warningMessage:j,errorMessage:S,router:G,axios:le,utils:B,toasts:A,close:i,closeWithReturnUrl:T,generateReturnUrl:$,security:W}=ye({appTitle:"Arcadian-FAST",pageTitle:"View Channel"});Me("$config");const X=$e();X.user;const m=ge({user:X.user,item:null}),y=fe(null),K=fe(),f=Ie(()=>m.item&&m.item.state==="RUNNING");me(async()=>{await b();const se=B.getPageTab("channel")||"information-tab";M(se)}),Ae(()=>{ue()});const M=se=>{B.setPageTab("channel",se),K.value=se,se==="preview-tab"&&setTimeout(()=>{var w=document.getElementById("masonry");new nt(w,{})},2e3)},p=se=>se===K.value?"active":"",u=se=>se===K.value?"show active":"",b=async()=>{const se=m;if(ue(),!_.value)try{_.value=!0,S.value="",m.item=null;const w=`/api/v1/channels/${v.id}/`;await le.get(w).then(ce=>{se.item=ce.data,se.item.outputs.forEach(Pe=>{Pe.playbackConfigurations.forEach(de=>{if(Pe.playbackUrl){const Oe=Pe.playbackUrl,Te=Oe.lastIndexOf("/"),at=Oe.substring(0,Te),je=Oe.substring(Te+1),lt=de.hlsConfigurationManifestEndpointPrefix;lt&&(de.hlsPlaylist=lt+je)}})})})}catch(w){S.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{_.value=!1}},r=async()=>{if(confirm("Do you want to delete this Channel?")&&!_.value)try{_.value=!0,S.value="";const w=`/api/v1/channels/${v.id}/`;await le.delete(w).then(ce=>{}),T(v.urlMain)}catch(w){S.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{_.value=!1}},d=async()=>{await b()},l=async()=>{if(confirm("Channel will be submitted to AWS MediaTailer. Are you sure you want to publish the channel?")&&!_.value){S.value=null;try{_.value=!0,await le.post(`/api/v1/channels/${v.id}/publish/`).then(w=>{A.success("Publish Channel","Channel was published.")}),_.value=!1,await d()}catch(w){S.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{_.value=!1}}},a=async()=>{if(confirm("Channel will be removed to AWS MediaTailer. Are you sure you want to remove the channel?")&&!_.value){S.value=null;try{_.value=!0,await le.delete(`/api/v1/channels/${v.id}/unpublish/`).then(w=>{A.warning("Remove Channel","Channel was removed.")}),_.value=!1,await d()}catch(w){S.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{_.value=!1}}},U=()=>{y.value.open(v.id)},I=async se=>{if(se.outputType==="HLS"){const w=Ve(Dw,{channelOutputId:se.channelOutputId,playbackUrl:se.playbackUrl},{chore:!0,keepInitial:!1}),{data:ce,isCanceled:we}=await w.reveal();w.close(),we||await d()}},g=async()=>{const se=Ve(n_,{channelId:m.item.channelId},{chore:!0,keepInitial:!1}),{data:w,isCanceled:ce}=await se.reveal();se.close(),ce||await d()},q=async se=>{const w=Ve(mt,{programId:se},{chore:!0,keepInitial:!1}),{data:ce,isCanceled:we}=await w.reveal();w.closeAll(),we||await d()},O=async(se,w)=>{const ce=Ve(V_,{channelId:m.item.channelId,sourceLocationId:m.item.fillerSlateSourceLocation.sourceLocationId,vodSourceId:m.item.fillerSlateVodSource.vodSourceId},{chore:!0,keepInitial:!1}),{data:we,isCanceled:Pe}=await ce.reveal();ce.close(),Pe||await d()},h=async se=>{if(confirm("Program will be deleted. Are you sure you want to delete the program?")&&!_.value){S.value=null;try{_.value=!0,await le.delete(`/api/v1/programs/${se}/`).then(ce=>{A.success("Delete Program","Program was deleted..",{async onClose(){}})}),_.value=!1,await d()}catch(ce){S.value=B.getErrorMessageAsHtml(ce),window.scrollTo(0,0)}finally{_.value=!1}}},E=async se=>{if(confirm("Channel output will be unpublished (if published) and will be deleted. Are you sure you want to delete this channel output?")&&!_.value){S.value=null;try{_.value=!0,await le.delete(`/api/v1/channelOutputs/${se}/`).then(ce=>{A.success("Delete Channel Output","Channel output was deleted..")}),_.value=!1,await d()}catch(ce){S.value=B.getErrorMessageAsHtml(ce),window.scrollTo(0,0)}finally{_.value=!1}}},Z=async se=>{if(confirm("Program will be published to AWS MediaTailor. Are you sure you want to publish the program?")&&!_.value){S.value=null;try{_.value=!0,await le.post(`/api/v1/programs/${se}/publish/`).then(ce=>{A.success("Publish Program","Program was published..",{async onClose(){}})}),_.value=!1,await d()}catch(ce){S.value=B.getErrorMessageAsHtml(ce),window.scrollTo(0,0)}finally{_.value=!1}}},V=async se=>{if(confirm("Program will be unpublished to AWS MediaTailor. Are you sure you want to unpublish the program?")&&!_.value){S.value=null;try{_.value=!0,await le.delete(`/api/v1/programs/${se}/unpublish/`).then(ce=>{A.success("Unpublish Program","Program was unpublished..",{async onClose(){}})}),_.value=!1,await d()}catch(ce){S.value=B.getErrorMessageAsHtml(ce),window.scrollTo(0,0)}finally{_.value=!1}}},re=async se=>{if(!_.value){S.value=null;try{_.value=!0,await le.put(`/api/v1/channels/${v.id}/change-state/${se}`).then(w=>{A.success("Update Channel state","Change state was updated")}),_.value=!1,se==="STOPPED"&&K.value==="preview-tab"&&(ue(),M("information-tab")),await d()}catch(w){S.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{_.value=!1}}},J=async se=>{if(!_.value)try{_.value=!0,S.value="",await le.post(`/api/v1/channelOutputs/${se}/playback/publish/`).then(w=>{A.success("Publish Channel Output Playback Configuration","Channel Output playback configuration published.")}),_.value=!1,await d()}catch(w){S.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{_.value=!1}},oe=async se=>{if(confirm("Do you want to remove this Playback Configuration?")&&!_.value)try{_.value=!0,S.value="",await le.delete(`/api/v1/channelOutputs/${se}/playback/`).then(ce=>{A.warning("Delete Channel Output Playback Configuration","Channel Output playback configuration deleted.")}),_.value=!1,await d()}catch(ce){S.value=B.getErrorMessageAsHtml(ce),window.scrollTo(0,0)}finally{_.value=!1}},C=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?");const se=m.item.outputs;ue(),se.forEach(w=>{var ce=document.getElementById(`video-${w.channelOutputId}`);w.hls&&w.hls.destroy(),w.hls=B.createHlsStream(ce,w.playbackUrl,"Main playlist started."),ce.play(),w.playbackConfigurations.forEach(we=>{if(we.hls&&we.hls.destroy(),we.arn){var Pe=document.getElementById(`video-${we.channelOutputPlaybackConfigurationId}`);try{we.hls=B.createHlsStream(Pe,we.hlsPlaylist,"Playback with Server-side Ad Insertion playlist started."),Pe.play()}catch(de){A.error("Failed Stream SSAI Playlist",de)}}})}),setTimeout(()=>{var w=document.getElementById("masonry");new nt(w,{})},2e3)}},ue=()=>{m.item&&m.item.outputs&&m.item.outputs.forEach(w=>{w.hls&&(w.hls.detachMedia(),w.hls.destroy(),delete w.hls),w.playbackConfigurations.forEach(ce=>{ce.hls&&(ce.hls.detachMedia(),ce.hls.destroy(),delete ce.hls)})})};return(se,w)=>{const ce=ae("router-link"),we=ae("PageHeader"),Pe=ae("PageBody");return t(),ve(be,null,{default:F(()=>[e("div",null,[z(we,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(x)},{default:F(()=>[e("button",{onClick:w[0]||(w[0]=de=>r()),class:"me-2 btn btn-danger"},w[21]||(w[21]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)])),m.item?(t(),s("div",Tk,[e("button",{class:ee([[f.value?"btn-success":"btn-secondary"],"btn dropdown-toggle"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[f.value?(t(),s("span",Ik)):(t(),s("span",Mk)),Y(" "+c(m.item.state),1)],2),e("ul",xk,[m.item.arn?(t(),s("li",Ck,[f.value?(t(),s("button",{key:0,onClick:w[1]||(w[1]=de=>re("STOPPED")),class:"dropdown-item"},w[22]||(w[22]=[e("span",{class:"fas fa-fw fa-stop me-1"},null,-1),Y("Stop ")]))):(t(),s("button",{key:1,onClick:w[2]||(w[2]=de=>re("RUNNING")),class:"dropdown-item"},w[23]||(w[23]=[e("span",{class:"fas fa-fw fa-play me-1"},null,-1),Y("Start ")])))])):L("",!0),f.value?L("",!0):(t(),s("li",Vk,[m.item.arn?(t(),s("button",{key:0,onClick:w[3]||(w[3]=de=>a()),class:"dropdown-item"},w[24]||(w[24]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),Y("Unpublish ")]))):(t(),s("button",{key:1,onClick:w[4]||(w[4]=de=>l()),class:"dropdown-item"},w[25]||(w[25]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Publish ")])))])),m.item.arn?(t(),s(H,{key:2},[w[27]||(w[27]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("button",{onClick:w[5]||(w[5]=de=>l()),class:"dropdown-item"},w[26]||(w[26]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Republish ")]))])],64)):L("",!0)])])):L("",!0),z(ce,{to:`${n.urlSchedulePrograms}/${n.id}`,class:"ms-2 btn btn-outline-primary"},{default:F(()=>w[28]||(w[28]=[e("span",{class:"fas fa-fw fa-calendar"},null,-1)])),_:1},8,["to"]),e("button",{onClick:w[6]||(w[6]=de=>d()),class:"ms-2 btn btn-secondary"},w[29]||(w[29]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:w[7]||(w[7]=de=>o(T)(v.urlMain)),class:"btn btn-secondary ms-1"},w[30]||(w[30]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(Pe,{errorMessage:o(S)},{default:F(()=>[m.item?(t(),s("div",Pk,[e("ul",Ok,[e("li",Ak,[e("button",{onClick:w[8]||(w[8]=de=>M("information-tab")),class:ee([p("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"},w[31]||(w[31]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),Y("Information ")]),2)]),e("li",Lk,[e("button",{onClick:w[9]||(w[9]=de=>M("outputPlayback-tab")),class:ee([p("outputPlayback-tab"),"nav-link"]),id:"outputPlayback-tab","data-bs-toggle":"tab","data-bs-target":"#outputPlayback",type:"button",role:"tab","aria-controls":"outputPlayback","aria-selected":"false"},w[32]||(w[32]=[e("span",{class:"fas fa-fw fa-gears me-1"},null,-1),Y("Output/Playback ")]),2)]),e("li",Uk,[e("button",{onClick:w[10]||(w[10]=de=>M("programs-tab")),class:ee([p("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},w[33]||(w[33]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),Y("Programs ")]),2)]),e("li",Hk,[e("button",{onClick:w[11]||(w[11]=de=>M("preview-tab")),class:ee([[f.value?"":"disabled",p("preview-tab")],"nav-link"]),id:"preview-tab","data-bs-toggle":"tab","data-bs-target":"#preview",type:"button",role:"tab","aria-controls":"preview","aria-selected":"false"},w[34]||(w[34]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),Y("Preview ")]),2)]),e("li",Dk,[e("button",{onClick:w[12]||(w[12]=de=>M("checklist-tab")),class:ee([p("checklist-tab"),"nav-link"]),id:"checklist-tab","data-bs-toggle":"tab","data-bs-target":"#checklist",type:"button",role:"tab","aria-controls":"checklist","aria-selected":"false"},w[35]||(w[35]=[e("span",{class:"fas fa-fw fa-list-check me-1"},null,-1),Y("Checklist ")]),2)])]),e("div",Ek,[e("div",{class:ee([u("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",qk,[e("div",Bk,[e("div",Nk,[e("div",Rk,[R(e("input",{"onUpdate:modelValue":w[13]||(w[13]=de=>m.item.name=de),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[te,m.item.name]]),w[36]||(w[36]=e("label",{for:"name"},"Name",-1))])]),e("div",Fk,[e("div",zk,[R(e("input",{"onUpdate:modelValue":w[14]||(w[14]=de=>m.item.playbackMode=de),type:"text",class:"form-control-plaintext",id:"playbackMode",readonly:""},null,512),[[te,m.item.playbackMode]]),w[37]||(w[37]=e("label",{for:"playbackMode"},"Playback Mode",-1))])]),e("div",Gk,[e("div",jk,[R(e("input",{"onUpdate:modelValue":w[15]||(w[15]=de=>m.item.tier=de),type:"text",class:"form-control-plaintext",id:"tier",readonly:""},null,512),[[te,m.item.tier]]),w[38]||(w[38]=e("label",{for:"tier"},"Tier",-1))])])]),e("div",null,[e("div",Yk,[w[40]||(w[40]=e("div",null,[e("h5",{class:"m-0"},"Filler Slate")],-1)),f.value?L("",!0):(t(),s("div",Wk,[e("button",{onClick:w[16]||(w[16]=de=>O(m.item.fillerSlateSourceLocation.sourceLocationId,m.item.fillerSlateVodSource.vodSourceId)),class:"btn btn-outline-primary btn-sm"},w[39]||(w[39]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)]))]))]),e("div",Kk,[e("div",Qk,[e("div",Jk,[e("div",Xk,[z(ce,{to:`${n.urlViewSourceLocation}/${m.item.fillerSlateSourceLocation.sourceLocationId}/${o($)()}`,class:ee([[m.item.fillerSlateSourceLocation.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName"},{default:F(()=>[m.item.fillerSlateSourceLocation.arn?(t(),s("span",Zk)):L("",!0),Y(c(m.item.fillerSlateSourceLocation.name),1)]),_:1},8,["to","class"])]),w[41]||(w[41]=e("label",{for:"fillerSlateSourceLocationName"},"Filler Slate Source LocationName",-1))])]),e("div",e2,[e("div",t2,[e("div",s2,[z(ce,{to:`${n.urlViewVodSource}/${m.item.fillerSlateVodSource.vodSourceId}/${o($)()}`,class:ee([[m.item.fillerSlateVodSource.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName",readonly:""},{default:F(()=>[m.item.fillerSlateVodSource.arn?(t(),s("span",o2)):L("",!0),Y(c(m.item.fillerSlateVodSource.name),1)]),_:1},8,["to","class"])]),w[42]||(w[42]=e("label",{for:"fillerSlateVodSourceName"},"Filler Slate Vod SourceName",-1))])])])])])],2),e("div",{class:ee([u("outputPlayback-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",a2,[e("div",null,[e("div",l2,[w[44]||(w[44]=e("div",null,[e("h5",{class:"m-0"},"Outputs")],-1)),e("div",n2,[e("button",{onClick:w[17]||(w[17]=de=>g()),class:"btn btn-outline-primary btn-sm"},w[43]||(w[43]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),m.item.outputs.length<=0?(t(),s("div",r2,w[45]||(w[45]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),Y("Channel Output is required ")]))):L("",!0),e("div",i2,[e("table",d2,[w[54]||(w[54]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Manifest"),e("th",null,"Source Group"),e("th",null,"Playback Url"),e("th")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider align-middle"},{default:F(()=>[(t(!0),s(H,null,N(m.item.outputs,(de,Oe)=>(t(),s(H,{key:de.channelOutputId},[e("tr",null,[e("td",null,c(Oe+1),1),e("td",null,[e("div",null,c(de.manifestName),1),e("div",null,[e("span",u2,c(de.outputType),1)])]),e("td",null,[e("div",null,[z(ce,{to:`${n.urlViewSourceGroup}/${de.sourceGroupId}/${o($)()}`,class:"link-offset-2",tag:"button"},{default:F(()=>[Y(c(de.sourceGroup.name),1)]),_:2},1032,["to"])])]),e("td",null,[de.playbackUrl?(t(),s("div",c2,c(de.playbackUrl),1)):(t(),s("div",m2,w[46]||(w[46]=[e("span",{class:"fas fa-fw fa-info-circle"},null,-1),Y("Publish channel to get the playback url ")])))]),f.value?(t(),s("td",f2)):(t(),s("td",p2,[e("button",{onClick:Te=>E(de.channelOutputId),class:"btn btn-outline-danger btn-sm"},w[47]||(w[47]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,v2)]))]),de.playbackUrl?(t(),s("tr",g2,[w[52]||(w[52]=e("td",null,null,-1)),w[53]||(w[53]=e("td",null,null,-1)),e("td",b2,[e("div",y2,[w[49]||(w[49]=e("h5",null,[Y("Configuration "),e("sub",null,"(SSAI)")],-1)),e("div",$2,[e("div",h2,[e("button",{onClick:Te=>I(de),class:"btn btn-outline-primary btn-sm"},w[48]||(w[48]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]),8,w2)])])]),de.playbackConfigurations.length>0?(t(),s("div",_2,[e("table",k2,[e("tbody",null,[(t(!0),s(H,null,N(de.playbackConfigurations,(Te,at)=>(t(),s("tr",S2,[e("td",null,c(at+1),1),e("td",null,[e("span",T2,c(Te.name),1),e("div",I2,[e("span",null,c(Te.adDecisionServerUrl),1)])]),e("td",M2,[e("div",x2,[Te.arn?L("",!0):(t(),s("button",{key:0,onClick:je=>J(Te.channelOutputPlaybackConfigurationId),class:"btn btn-outline-warning btn-sm ms-1"},w[50]||(w[50]=[e("span",{class:"fas fa-fw fa-link"},null,-1)]),8,C2)),e("button",{onClick:je=>oe(Te.channelOutputPlaybackConfigurationId),class:"btn btn-outline-danger btn-sm ms-2"},w[51]||(w[51]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,V2)])])]))),256))])])])):L("",!0)])])):L("",!0)],64))),128))]),_:1},512),[[_e,m.item.outputs.length>0]])])])])])],2),e("div",{class:ee([u("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",P2,[e("div",O2,[e("table",A2,[w[63]||(w[63]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th")])],-1)),R(z(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:F(()=>[(t(!0),s(H,null,N(m.item.programs,(de,Oe)=>(t(),s(H,{key:de.programId},[e("tr",L2,[e("td",U2,c(Oe+1),1),e("td",null,[e("div",H2,[e("div",D2,[de.vodSource.video.thumbnails.length>0?(t(!0),s(H,{key:0},N(de.vodSource.video.thumbnails,Te=>(t(),s("div",E2,[e("img",{src:Te.url,class:"img-fuild border",width:"128"},null,8,q2)]))),256)):L("",!0)]),e("div",B2,[de.arn?(t(),s("span",N2)):L("",!0),e("span",null,c(de.name),1)]),e("div",R2,[w[55]||(w[55]=Y(" UTC ")),e("div",null,[e("span",F2,c(o(B).moment.utc(de.dateScheduledStart).format("lll"))+" (utc)",1)]),e("div",null,[e("span",z2,c(o(B).moment.utc(de.dateScheduledEnd).format("lll"))+" (utc)",1)])]),e("div",G2,[w[56]||(w[56]=Y(" Local ")),e("div",null,[e("span",j2,c(o(B).moment(de.dateScheduledStart).format("lll"))+" (local)",1)]),e("div",null,[e("span",Y2,c(o(B).moment(de.dateScheduledEnd).format("lll"))+" (local)",1)])])])]),e("td",W2,c(o(B).moment.utc(de.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",K2,c(de.adBreaks.length),1),e("td",Q2,[e("div",J2,[e("button",{onClick:Te=>de.expand=!de.expand,type:"button",class:ee([[de.expand?"btn-secondary":"btn-outline-secondary"],"btn btn-sm"])},[de.expand?(t(),s("span",Z2)):(t(),s("span",eS))],10,X2),w[61]||(w[61]=e("button",{type:"button",class:"btn btn-secondary btn-sm dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"visually-hidden"},"Toggle Dropdown")],-1)),e("ul",tS,[e("li",null,[e("button",{onClick:Te=>q(de.programId),class:"dropdown-item"},w[57]||(w[57]=[e("span",{class:"fas fa-fw fa-edit me-1"},null,-1),Y("Edit ")]),8,sS)]),de.arn?(t(),s("li",oS,[e("button",{onClick:Te=>V(de.programId),class:"dropdown-item"},w[58]||(w[58]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),Y("Unpublish ")]),8,aS)])):(t(),s(H,{key:1},[e("li",null,[e("button",{onClick:Te=>Z(de.programId),class:"dropdown-item"},w[59]||(w[59]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Publish ")]),8,lS)]),e("li",null,[e("button",{onClick:Te=>h(de.programId),class:"dropdown-item"},w[60]||(w[60]=[e("span",{class:"fas fa-fw fa-trash me-1"},null,-1),Y("Remove ")]),8,nS)])],64))])])])]),de.expand?(t(),s("tr",rS,[w[62]||(w[62]=e("td",null,null,-1)),e("td",iS,[z(Sk,{item:de,urlViewVideo:n.urlViewVideo,urlViewVodSource:n.urlViewVodSource},null,8,["item","urlViewVideo","urlViewVodSource"])])])):L("",!0)],64))),128))]),_:1},512),[[_e,m.item.programs.length>0]])])]),e("div",dS,[e("button",{onClick:w[18]||(w[18]=de=>U()),class:"btn btn-outline-primary"},w[64]||(w[64]=[e("span",{class:"fas fa-fw fa-plus me-1"},null,-1),Y("Program ")]))])])],2),f.value?(t(),s("div",{key:0,class:ee([u("preview-tab"),"tab-pane fade"]),id:"preview",role:"tabpanel","aria-labelledby":"preview-tab"},[e("div",uS,[e("div",cS,[m.item.outputs[0].hls?(t(),s("button",{key:1,onClick:w[20]||(w[20]=de=>ue()),class:"btn btn-primary"},w[66]||(w[66]=[e("span",{class:"fas fa-fw fa-eye-slash"},null,-1)]))):(t(),s("button",{key:0,onClick:w[19]||(w[19]=de=>C()),class:"btn btn-primary"},w[65]||(w[65]=[e("span",{class:"fas fa-fw fa-eye"},null,-1)])))]),e("div",mS,[(t(!0),s(H,null,N(m.item.outputs,de=>(t(),s(H,null,[e("div",fS,[e("div",pS,[e("video",{id:`video-${de.channelOutputId}`,controls:"",class:"card-img-top object-fit-cover shandow"},null,8,vS),e("div",gS,[e("div",bS,c(de.manifestName),1)])])]),(t(!0),s(H,null,N(de.playbackConfigurations,(Oe,Te)=>(t(),s("div",yS,[e("div",$S,[e("video",{id:`video-${Oe.channelOutputPlaybackConfigurationId}`,controls:"",class:"card-img-top object-fit-cover"},null,8,hS),e("div",wS,[e("div",_S,[Y(" #"+c(Te+1)+" ",1),e("span",kS,c(Oe.name),1)])])])]))),256))],64))),256))])])],2)):L("",!0),e("div",{class:ee([u("checklist-tab"),"tab-pane fade"]),id:"checklist",role:"tabpanel","aria-labelledby":"checklist-tab"},[e("div",SS,[w[72]||(w[72]=Y(" Checklist ")),e("ul",null,[e("li",null,[m.item.fillerSlateSourceLocation.arn?(t(),s("span",TS)):(t(),s("span",IS)),w[67]||(w[67]=Y(" Filler Slate Source Location "))]),e("li",null,[m.item.fillerSlateVodSource.arn?(t(),s("span",MS)):(t(),s("span",xS)),w[68]||(w[68]=Y(" Filler Slate VOD Source "))]),e("li",null,[m.item.outputs.length>0?(t(),s("span",CS)):(t(),s("span",VS)),w[70]||(w[70]=Y(" Outputs ")),e("ul",null,[e("li",null,[m.item.outputs.some(de=>de.playbackConfigurations.length>0)?(t(),s("span",PS)):(t(),s("span",OS)),w[69]||(w[69]=Y(" Ad Insertion setup "))])])]),e("li",null,[m.item.programs.length>0?(t(),s("span",AS)):(t(),s("span",LS)),w[71]||(w[71]=Y(" Programs "))])])])],2)])])):L("",!0)]),_:1},8,["errorMessage"]),z(fw,{ref_key:"modalAddProgram",ref:y,onRefresh:d},null,512)])]),_:1})}}},HS={path:"/",component:xa,props:!1,meta:{requiresAuth:!0},children:[{path:"",component:Za},{path:"videos",children:[{path:"",component:Xn},{path:"view/:id",component:Hr,props:!0},{path:"add",component:Ll},{path:"edit/:id",component:bn,props:!0}]},{path:"source-groups",children:[{path:"add",component:Br},{path:"edit/:id",component:ii,props:!0},{path:"",component:yi},{path:"view/:id",component:Ai,props:!0}]},{path:"source-locations",children:[{path:"add",component:qi},{path:"edit/:id",component:Ri,props:!0},{path:"",component:Zi},{path:"view/:id",component:hd,props:!0}]},{path:"vod-sources",children:[{path:"add",component:Eu},{path:"edit/:id",component:mc,props:!0},{path:"",component:Fc},{path:"view/:id",component:xf,props:!0}]},{path:"channels",children:[{path:"add",component:F1},{path:"edit/:id",component:j1,props:!0},{path:"",component:sb},{path:"schedule-programs/:id",component:dh,props:!0},{path:"view/:id",component:US,props:!0}]},{path:"program-templates",children:[{path:"add",component:$v},{path:"edit/:id",component:vg,props:!0},{path:"",component:Ug},{path:"view/:id",component:$1,props:!0}]}]},ot=vt({history:gt("/"),linkActiveClass:"active",routes:[{...po},{path:"/administrator",redirect:"/"},{...HS}]});ot.beforeEach(async n=>{_t().clear();var k=n.meta;const x=["/accounts/login","/accounts/loginRedirect","/accounts/logout","/accounts/register"],_=k.requiresAuth&&!x.includes(n.path),D=$e(),P=D.user;if(_&&!P)return D.returnUrl=n.fullPath,{path:"/accounts/login",query:{returnUrl:encodeURIComponent(n.fullPath)}};var Q=n.meta.roles;if(Q&&!D.user.roles.some(j=>Q.includes(j)))return alert("You are not authorized to acccess this page."),{path:"/accounts/login/",query:{returnUrl:encodeURIComponent(n.fullPath)}}});const DS={props:{uid:{type:String,required:!0},urlViewDeposit:{type:String,required:!1},urlViewWithdraw:{type:String,required:!1},urlViewManualModeOfPayment:{type:String,required:!1}},data(){return{messages:[],count:0}},created(){},async mounted(){await this.connectNotificationHub()},methods:{async connectNotificationHub(){const n=this,k=new bt().withUrl("https://sonyfastpoc.azurewebsites.net//notificationHub").withAutomaticReconnect().build();k.on("onNotificationCreated",function(x){let _=x.content;x.notificationEntityClassText==="Deposit"&&(_+="<br/>",_+=`<a href="${n.urlViewDeposit}${x.referenceId}">Click ${x.notificationEntityClassText} here</a>`),x.notificationEntityClassText==="Withdraw"&&(_+="<br/>",_+=`<a href="${n.urlViewWithdraw}${x.referenceId}">Click ${x.notificationEntityClassText} here</a>`),x.notificationEntityClassText==="ManualModeOfPayment"&&(_+="<br/>",_+=`<a href="${n.urlViewManualModeOfPayment}${x.referenceId}">Click ${x.notificationEntityClassText} here</a>`),x.iconClass;let D="secondary";switch(x.notificationType){case 1:D="success";break;case 3:D="info";break;case 3:D="success";break;case 4:D="info";break;case 5:D="warning";break;case 6:D="error";break}n.$toast[D](x.subject,_,{timeOut:1e4});const P=x.subject,S={body:_,icon:"/img/192x102.png"};new Notification(P,S)}),k.on("jobUpdated",function(x){n.$bus.$emit("event:job-updated",x)}),await k.start().then(function(){}).catch(function(x){})}}};function ES(n,v,k,x,_,D){return t(),s("div")}const qS=xe(DS,[["render",ES],["__scopeId","data-v-5b4a9fa2"]]),BS={class:"navbar bg-dark bg-gradient shadow flex-grow-0","data-bs-theme":"dark"},NS={class:"container-xxl"},RS={class:"col-md"},FS={class:"navbar-brand mb-0 ms-1 align-middle"},zS={class:"col-md-auto"},GS={class:"d-flex flex-row align-items-center justify-content-end"},jS={__name:"_pageHeader",props:{pageIcon:{type:String,required:!0},pageTitle:{type:String,required:!0},headerBreak:{type:String,required:!1,default:""}},setup(n){return(v,k)=>(t(),ve(be,null,{default:F(()=>[e("nav",BS,[e("div",NS,[e("div",RS,[He(v.$slots,"title",{},()=>[e("a",FS,[e("i",{class:ee([n.pageIcon,"me-1 me-lg-2"])},null,2),e("span",null,c(n.pageTitle),1)])],!0)]),e("div",zS,[e("div",GS,[He(v.$slots,"default",{},void 0,!0)])])])])]),_:3}))}},YS=xe(jS,[["__scopeId","data-v-a5844ba9"]]),WS={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},KS=["innerHTML"],QS={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},JS={__name:"_pageMessages",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(n){return(v,k)=>(t(),ve(be,null,{default:F(()=>[He(v.$slots,"default",{},()=>[n.errorMessage?(t(),s("div",WS,[k[0]||(k[0]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:n.errorMessage},null,8,KS)])):L("",!0),n.vuelidate&&n.vuelidate.$error?(t(),s("div",QS,[k[1]||(k[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(H,null,N(n.vuelidate.$errors,x=>(t(),s("li",{key:x.$uid},[x.$validator==="$each"?(t(),s(H,{key:0},[Y(" Check errors in '"+c(x.$property)+"' ",1)],64)):(t(),s(H,{key:1},[Y(c(x.$message),1)],64))]))),128))])])):L("",!0)])]),_:3}))}},XS={class:"py-3 container-xxl flex-grow-1 overflow-y-auto"},ZS={__name:"_pageBody",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(n){return(v,k)=>{const x=ae("PageMessages");return t(),ve(be,null,{default:F(()=>[e("div",XS,[z(x,{errorMessage:n.errorMessage,vuelidate:n.vuelidate},null,8,["errorMessage","vuelidate"]),He(v.$slots,"default")])]),_:3})}}},e0={props:{filter:Object,search:Function,noRecords:String,showPerPage:Boolean,busy:Boolean},data(){return{}},created(){},methods:{async changePagination(){const n=this;n.busy||(document.activeElement&&document.activeElement.blur(),await n.search(1))},async moveFirst(){const n=this;if(n.busy)return;n.filter.pageIndex!==1&&(document.activeElement&&document.activeElement.blur(),await n.search(1))},async moveLast(){const n=this;if(n.busy)return;const v=n.filter;v.pageIndex!==v.totalPages&&(document.activeElement&&document.activeElement.blur(),await n.search(v.totalPages))},async move(n){const v=this;if(v.busy)return;const k=v.filter,x=k.pageIndex+n;x>=0&&x<=k.totalPages&&(document.activeElement&&document.activeElement.blur(),await v.search(x))}}},t0={class:"mt-2"},s0={key:0,class:"row row-cols-1 row-cols-sm-2 align-items-center w-100 gy-2 gx-0"},o0={key:0,class:"col-sm order-2 order-sm-1"},a0={class:"d-flex align-items-center small justify-content-center justify-content-sm-start"},l0={class:"me-1 fw-bold"},n0={class:"fw-bold"},r0={class:"ms-1"},i0={class:"col-sm-auto ms-auto order-1 order-sm-2"},d0={class:"pagination m-0 ms-1 justify-content-center justify-content-sm-end"},u0={key:0,class:"page-item"},c0={key:1,class:"page-item"},m0={key:2,class:"page-item"},f0={class:"page-item active"},p0={class:"page-link"},v0={key:3,class:"page-item"},g0={key:4,class:"page-item"},b0={key:5,class:"page-item"},y0={key:1,class:"text-info font-weight-bold text-center"},$0={key:0},h0={key:1};function w0(n,v,k,x,_,D){return t(),s("div",t0,[k.filter.items.length?(t(),s("div",s0,[k.showPerPage?(t(),s("div",o0,[e("div",a0,[e("div",null,[e("span",l0,c(k.filter.totalCount),1),v[8]||(v[8]=Y("records in ")),e("span",n0,c(k.filter.totalPages),1),v[9]||(v[9]=Y(" page(s) "))]),e("div",r0,[R(e("select",{"onUpdate:modelValue":v[0]||(v[0]=P=>k.filter.pageSize=P),onChange:v[1]||(v[1]=(...P)=>D.changePagination&&D.changePagination(...P)),class:"form-select form-select-sm me-1"},v[10]||(v[10]=[Je('<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="5">5</option><option value="10">10</option><option value="15">15</option><option value="25">25</option><option value="50">50</option><option value="100">100</option>',9)]),544),[[pe,k.filter.pageSize]])]),v[11]||(v[11]=e("div",{class:"ms-1"},"per page",-1))])])):L("",!0),e("div",i0,[e("ul",d0,[k.filter.pageIndex!==1?(t(),s("li",u0,[e("button",{class:"page-link","aria-label":"Previous",onClick:v[2]||(v[2]=(...P)=>D.moveFirst&&D.moveFirst(...P))},v[12]||(v[12]=[e("span",{class:"fas fa-fw fa-backward-step"},null,-1)]))])):L("",!0),k.filter.pageIndex>2?(t(),s("li",c0,[e("button",{class:"page-link",onClick:v[3]||(v[3]=P=>D.move(-2))},c(k.filter.pageIndex-2),1)])):L("",!0),k.filter.pageIndex>1?(t(),s("li",m0,[e("button",{class:"page-link",onClick:v[4]||(v[4]=P=>D.move(-1))},c(k.filter.pageIndex-1),1)])):L("",!0),e("li",f0,[e("span",p0,c(k.filter.pageIndex),1)]),k.filter.pageIndex<k.filter.totalPages?(t(),s("li",v0,[e("button",{class:"page-link",onClick:v[5]||(v[5]=P=>D.move(1))},c(k.filter.pageIndex+1),1)])):L("",!0),k.filter.pageIndex<k.filter.totalPages-1?(t(),s("li",g0,[e("button",{class:"page-link",onClick:v[6]||(v[6]=P=>D.move(2))},c(k.filter.pageIndex+2),1)])):L("",!0),k.filter.pageIndex<k.filter.totalPages?(t(),s("li",b0,[e("button",{class:"page-link","aria-label":"Next",onClick:v[7]||(v[7]=(...P)=>D.moveLast&&D.moveLast(...P))},v[13]||(v[13]=[e("span",{class:"fas fa-fw fa-forward-step"},null,-1)]))])):L("",!0)])])])):(t(),s("div",y0,[k.noRecords?(t(),s("div",$0,c(k.noRecords),1)):(t(),s("div",h0,"No record(s) found."))]))])}const _0=xe(e0,[["render",w0]]),k0={props:{filter:Object,field:String,showSort:Boolean,enabled:Boolean},data(){return{}},mounted(){},methods:{currentSortField(){return this.filter.sortField===this.field},sortUp(){return this.filter.sortOrder===1},click(){let n=this;if(!n.enabled)return;let v=n.filter;v.sortField===n.field?v.sortOrder===0?v.sortField=null:v.sortOrder=v.sortOrder===0?1:0:(v.sortField=n.field,v.sortOrder=1),n.$emit("search")}}},S0={class:"align-self-center"};function T0(n,v,k,x,_,D){return t(),s("div",{onClick:v[0]||(v[0]=(...P)=>D.click&&D.click(...P)),class:"d-flex flex-row justify-content-start align-content-center",style:dt({cursor:k.enabled?"pointer":""})},[He(n.$slots,"default"),e("span",S0,[k.showSort?(t(),s("span",{key:0,class:ee([{"fa-sort text-gray-500":!D.currentSortField(),"fa-sort-up":D.currentSortField()&&D.sortUp(),"fa-sort-down":D.currentSortField()&&!D.sortUp()},"fas fa-fw mr-1"])},null,2)):L("",!0)])],4)}const I0=xe(k0,[["render",T0]]),M0={props:{items:Array,header:Object,getRowNumber:Function,setSelected:Function,isSelected:Function,tableCss:String,rowCss:String},data(){return{}},mounted(){},methods:{onSelectedRow(n){const v=this;v.setSelected(n),v.$emit("onSelectedRow",n)}}},x0={class:"table-responsive m-0"},C0=["href"],V0={key:1},P0=["onClick"],O0={class:"form-group row no-gutters"},A0={class:"col-5 col-form-label"},L0={class:"col align-self-center"},U0=["href"],H0={key:1};function D0(n,v,k,x,_,D){return t(),s("div",null,[e("div",x0,[e("table",{class:ee(["table table-hover d-none d-md-table card",k.tableCss])},[e("thead",null,[He(n.$slots,"header",{},()=>[v[0]||(v[0]=e("th",null,"#",-1)),(t(!0),s(H,null,N(k.header.columns,P=>(t(),s("th",null,c(P.title),1))),256))],!0)]),e("tbody",null,[(t(!0),s(H,null,N(k.items,(P,Q)=>He(n.$slots,"table-row",{key:`row1-${P[k.header.key]}`,item:P,index:Q},()=>[e("td",null,c(k.getRowNumber(Q)),1),(t(!0),s(H,null,N(k.header.columns,j=>(t(),s("td",null,[j.href?(t(),s("a",{key:0,href:j.href(P[k.header.key]),class:"font-weight-bold"},c(P[j.field]),9,C0)):(t(),s("span",V0,c(P[j.field]),1))]))),256))],!0)),128))])],2)]),e("div",{class:ee(["d-block d-md-none",k.rowCss])},[(t(!0),s(H,null,N(k.items,(P,Q)=>(t(),s("div",{key:`row2-${P[k.header.key]}`,onClick:j=>D.onSelectedRow(P),class:"border"},[e("div",{class:ee(["p-2",{"b-left":k.isSelected(P)}])},[He(n.$slots,"table-list",{item:P,index:Q},()=>[(t(!0),s(H,null,N(k.header.columns,j=>(t(),s("div",O0,[e("label",A0,c(j.title),1),e("div",L0,[j.href?(t(),s("a",{key:0,href:j.href(P[k.header.key]),class:"font-weight-bold"},c(P[j.field]),9,U0)):(t(),s("span",H0,c(P[j.field]),1))])]))),256))],!0)],2)],8,P0))),128))],2)])}const E0=xe(M0,[["render",D0],["__scopeId","data-v-65929213"]]),Ce=yt(wt);Ce.use($t());Ce.use(ht);Ce.use(ot);Ce.component("m-notification",qS);Ce.component("m-pagination",_0);Ce.component("sort-field",I0);Ce.component("table-list",E0);Ce.component("Toasts",Sa);Ce.component("PageHeader",YS);Ce.component("PageMessages",JS);Ce.component("PageBody",ZS);const q0="https://sonyfastpoc.azurewebsites.net/",B0="Arcadian-FAST",N0=void 0,R0={API_URL:q0,appName:B0,tenantId:N0};Ce.provide("$config",R0);Ce.provide("$bus",et);Ce.mount("#app");
