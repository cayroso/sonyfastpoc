import{r as se,o as t,c as ve,d as We,h as rt,u as Ke,a as ce,L as Ne,e as Re,b as s,f as e,g as z,w as R,i as Q,t as u,F as U,j as q,k as E,l as fe,m as Qe,n as Me,p as it,q as Fe,s as Je,P as ze,v as be,x as ae,y as re,z as Se,A as pt,B as o,T as ye,C as N,D as Z,E as Ye,G as te,H as dt,I as _e,J as Ae,K as Ie,M as qe,N as ge,O as Ue,Q as ke,R as we,S as Ee,U as Be,V as He,W as nt,X as vt,Y as gt,Z as bt,_ as De,$ as yt,a0 as $t,a1 as wt}from"./vendor-DtZVdVFy-chunk.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))V(_);new MutationObserver(_=>{for(const H of _)if(H.type==="childList")for(const P of H.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&V(P)}).observe(document,{childList:!0,subtree:!0});function T(_){const H={};return _.integrity&&(H.integrity=_.integrity),_.referrerPolicy&&(H.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?H.credentials="include":_.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function V(_){if(_.ep)return;_.ep=!0;const H=T(_);fetch(_.href,H)}})();const ht={__name:"App",setup(n){return(f,T)=>{const V=se("router-view");return t(),ve(V)}}},_t=We({id:"alert",state:()=>({alert:null}),actions:{success(n){this.alert={message:n,type:"alert-success"}},error(n){this.alert={message:n,type:"alert-danger"}},clear(){this.alert=null}}});function Xe(){const n=B=>{var w;let A=B,i=A.response,M="";if(!A.response)return B.message;if(i.status===500){if(typeof i.data=="string")return i.data;if(i.data.content)return i.data.content;if(i.data.detail)return i.data.detail}if(i.status===401){const K=`${window.location.pathname}${window.location.search}`;M=`You are not authorized or your session timed out. Please click <a href='${`/accounts/login/?returnUrl=${encodeURIComponent(K)}`}'>here</a> to login.`}else if(i.status===400){let K=A.response.data.errors;M=A.response.data.title||A.response.data,K&&(M+="<ul>");for(let X in K){let c=K[X];for(let v in K[X]){let Y=c[v];M+=`<li>${Y}</li>`}}K&&(M+="</ul>"),M||(M=A.message),M&&M.content&&(M=M.content)}else i.status===404?M=((w=i==null?void 0:i.data)==null?void 0:w.title)||(i==null?void 0:i.data)||"Record not found.":typeof i.data=="string"&&(M=A.message,M===""&&(M=`Error <b>Http ${i.status}</b>.<br/>Please contact the System Administrator.`));return M},f=B=>JSON.parse(JSON.stringify(B)),T=B=>{if(typeof B!="number")return B;var A=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2});return A.format(B)},V=(B,A,i)=>{const w={value:A,expiry:new Date().getTime()+i};debugger;localStorage.setItem(B,JSON.stringify(w))},_=B=>{debugger;const A=localStorage.getItem(B);if(!A)return null;const i=JSON.parse(A);return new Date().getTime()>i.expiry?(localStorage.removeItem(B),null):i.value},H="pageSelectedTabStorageKey";return{getErrorMessageAsHtml:n,clone:f,toCurrency:T,moment:rt,localStorageSetWithExpiry:V,localStorageGetWithExpiry:_,setPageTab:(B,A)=>{var i=localStorage.getItem(H);i?i=JSON.parse(i):i={},i[B]=A,localStorage.setItem(H,JSON.stringify(i))},getPageTab:B=>{var A=localStorage.getItem(H);return A?A=JSON.parse(A):A={},A[B]},createHlsStream:(B,A,i)=>{var M=new Hls({autoStartLoad:i??!0});return M.on(Hls.Events.MEDIA_ATTACHED,function(){}),M.on(Hls.Events.MANIFEST_PARSED,function(w,K){console.log("manifest loaded, found "+K.levels.length+" quality level")}),M.on(Hls.Events.ERROR,function(w,K){if(K.fatal)switch(K.type){case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),M.recoverMediaError();break;case Hls.ErrorTypes.NETWORK_ERROR:console.error("fatal network error encountered",K);break;default:M.destroy();break}}),M.loadSource(A),M.attachMedia(B),M},isValidTime:B=>/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/.test(B),generateReturnUrl:()=>{const B=Ke();let A=B.path;return B.query.returnUrl&&(A=B.query.returnUrl),A=`?returnUrl=${encodeURIComponent(A)}`,A},getValidFeedbackCss:B=>B?"is-valid":"is-invalid"}}const kt=Xe(),ut=JSON.parse(localStorage.getItem("user"))||{},St=kt.moment.utc(ut.exp*1e3),Tt=St.isAfter()?ut:null,he=We({id:"auth",state:()=>({user:Tt,returnUrl:null}),actions:{async login(n){try{this.user=n,localStorage.setItem("user",JSON.stringify(n))}catch(f){debugger;alert(f)}},logout(){this.user=null,localStorage.removeItem("user"),ot.push("/accounts/login")},logoutWithRedirect(){this.user=null,localStorage.removeItem("user")}}}),It="vue-3-pinia-registration-login-example-users";JSON.parse(localStorage.getItem(It));const Mt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://sonyfastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AUTH_POST_LOGOUT_URI:"https://lively-bay-00480981e.5.azurestaticapps.net/",VITE_AUTH_REDIRECT_URI:"window.location.origin + '/accounts/loginRedirect'"},je=Mt,Ze=We("msal",()=>{const n=ce({auth:{clientId:je.VITE_AUTH_CLIENT_ID,authority:je.VITE_AUTH_AUTHORITY_URL,postLogoutUri:je.VITE_AUTH_POST_LOGOUT_URI},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1,secureCookies:!1},system:{loggerOptions:{logLevel:Ne.Verbose,loggerCallback:(V,_,H)=>{if(!H)switch(V){case Ne.Error:console.error(_);return;case Ne.Info:console.info(_);return;case Ne.Verbose:console.debug(_);return;case Ne.Warning:console.warn(_);return}},piiLoggingEnabled:!1}}}),f=ce("");return{msalConfig:n,accessToken:f,setAccessToken:V=>{f.value=V}}}),et={$on:(...n)=>Re.on(...n),$once:(...n)=>Re.once(...n),$off:(...n)=>Re.off(...n),$emit:(...n)=>Re.emit(...n)};function xt(){const n=(H,P,J,j)=>{et.$emit("toast-message",{title:H,message:P,type:J,options:j})};return{success:(H,P,J={})=>{n(H,P,"success",J)},warning:(H,P,J={})=>{n(H,P,"warning",J)},info:(H,P,J={})=>{n(H,P,"info",J)},error:(H,P,J={})=>{n(H,P,"danger",J)}}}const Ve=(n,f)=>{const T=n.__vccOpts||n;for(const[V,_]of f)T[V]=_;return T},Ct={data(){return{notifications:[],messages:[]}},async created(){const n=this;n.$bus.$on("event:notification-received",()=>{n.getUnreadNotifications()}),n.$bus.$on("event:notification-marked-as-read",f=>{n.notifications.some(V=>V.notificationId===f)&&n.getUnreadNotifications()}),n.$bus.$on("event:notification-removed",f=>{n.notifications.some(V=>V.notificationId===f)&&n.getUnreadNotifications()}),n.$bus.$on("event:chat-marked-as-read",n.onChatMarkedAsRead),n.$bus.$on("event:chat-message-received",n.onChatMessageReceived)},async mounted(){const n=this,f=n.$refs.notifications,T=n.$refs.messages;f&&f.offsetParent,T&&T.offsetParent&&await n.getUnreadChats()},methods:{async logout(){const n=this;try{await n.$util.axios.post("/api/accounts/logout").then(f=>{const T="/";n.$toast.warning("Logout","You have logged out of the system.",{timeOut:5e3,async onClose(){n.$util.href(T)}})})}catch(f){n.$util.handleError(f)}},async onChatMarkedAsRead(n){let f=this,T=f.messages.find(V=>V.chatId===n);if(T){let V=f.messages.indexOf(T);f.messages.splice(V,1)}},async onChatMessageReceived(n){let f=this,T=f.messages.find(_=>_.chatId===n.chatId);if(T)T.lastMessageText=n.content;else{var V={chatId:n.chatId,isRead:!1,lastDateSent:n.dateSent,lastMessageText:n.content,senderFirstLastName:`${n.sender.firstName} ${n.sender.lastName}`,senderInitials:n.sender.initials,senderProfilePicture32:n.sender.profilePicture32,urlPicture:f.$util.getProfilePictureUrl(n.sender.profilePicture32,n.sender.initials)};f.messages.push(V)}},async getUnreadNotifications(){const n=this;try{await n.$util.axios.get("api/accounts/unread-notifications").then(f=>{n.notifications=f.data})}catch(f){n.$util.handleError(f)}},async getUnreadChats(){const n=this;try{await n.$util.axios.get("api/accounts/unread-chats").then(f=>{n.messages=f.data;for(let T in n.messages){let V=n.messages[T];n.$set(V,"urlPicture",n.$util.getProfilePictureUrl(V.senderProfilePicture32,V.senderInitials))}})}catch(f){n.$util.handleError(f)}},viewNotification(n){this.$bus.$emit("event:open-notification",n)},viewChat(n){this.$bus.$emit("event:open-chat",n)},showHiddenElements(){let f=this.$el.getElementsByClassName("initialHidden");for(let T=0;T<f.length;T++)f[T].classList.remove("invisible")}}},Vt={mixins:[Ct],props:{uid:String,appName:{type:String,required:!0,default:"SCH2"},urlProfilePicture:String,menus:Array},components:{},data(){const f=he().user;return{user:f,username:f?f.nameFull:"Guest"}},async mounted(){},methods:{isActive(n){return window.location.href.indexOf(n)>-1},async openModalSearchUser747(n){this.$refs.refModalSearchUser747.open(n)}}},Pt={class:"sticky-top navbar navbar-expand-sm navbar-dark bg-primary bg-gradient shadow-sm py-2","aria-label":"Offcanvas navbar large"},Ot={class:"container-md"},At={class:"navbar-collapse collapse",id:"navbarSideCollapse"},Ut={class:"navbar-nav"},Lt={class:"nav-item dropdown"},Ht={class:"dropdown-menu","aria-labelledby":"dropdown01"},Dt={class:"nav-item dropdown"},Et={class:"dropdown-menu","aria-labelledby":"dropdown01"},qt={class:"navbar-nav ms-auto"},Bt={class:"nav-item dropdown"},Nt={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Rt={class:"d-inline d-sm-none d-md-inline"},Ft={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},zt={class:"text-capitalize"};function Gt(n,f,T,V,_,H){const P=se("router-link");return t(),s("nav",Pt,[e("div",Ot,[z(P,{class:"navbar-brand",to:"/member"},{default:R(()=>[Q(u(T.appName),1)]),_:1}),f[14]||(f[14]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSideCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",At,[e("ul",Ut,[e("li",Lt,[f[3]||(f[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Social")])],-1)),e("ul",Ht,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/announcements"},{default:R(()=>f[0]||(f[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),Q(" Announcements ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/posts"},{default:R(()=>f[1]||(f[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),Q(" Posts ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/yellow-pages"},{default:R(()=>f[2]||(f[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),Q(" Yellow Pages ")])),_:1})])])]),e("li",Dt,[f[5]||(f[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Home Owners")])],-1)),e("ul",Et,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:R(()=>f[4]||(f[4]=[Q(" Property Monthly Dues ")])),_:1})])])])]),e("ul",qt,[e("li",Bt,[e("a",Nt,[e("span",null,[f[6]||(f[6]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Rt,u(_.username),1)])]),e("ul",Ft,[f[9]||(f[9]=e("li",null,[e("h6",{class:"dropdown-header"},"Settings")],-1)),f[10]||(f[10]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Profile ")],-1)),f[11]||(f[11]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Theme ")],-1)),f[12]||(f[12]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),_.user&&_.user.roles.length>1?(t(!0),s(U,{key:0},q(_.user.roles,J=>(t(),s("li",null,[z(P,{to:`/${J.toLowerCase()}`,class:"dropdown-item"},{default:R(()=>[e("span",zt,u(J),1)]),_:2},1032,["to"])]))),256)):E("",!0),e("li",null,[z(P,{to:"/",class:"dropdown-item"},{default:R(()=>f[7]||(f[7]=[Q(" Main ")])),_:1})]),f[13]||(f[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[z(P,{to:"/account/logout",class:"dropdown-item"},{default:R(()=>f[8]||(f[8]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Q("Logout ")])),_:1})])])])])])])])}const jt=Ve(Vt,[["render",Gt]]),Yt={props:{appName:{type:String,required:!1}},data(){return{busy:!1,enums:{orderStatuses:[{id:1,name:"Requested"},{id:2,name:"Placed"},{id:3,name:"Accepted"},{id:4,name:"Processed"},{id:5,name:"Delivered"},{id:6,name:"Completed"},{id:7,name:"Cancelled"}],promotionType:[{id:1,name:"Discounts"},{id:2,name:"Shipping"}],promotionProductApplicability:[{id:1,name:"All Products"},{id:2,name:"Specific Products"}],promotionOfferType:[{id:1,name:"No Code"},{id:2,name:"Generic Code"}],shipmentType:[{id:1,name:"Pickup"},{id:2,name:"Delivery"}]}}},async created(){},mounted(){this.showHiddenElements()},methods:{scrollIntoView(){const n=document.getElementById("top");n&&n.scrollIntoView({behavior:"smooth"})},showHiddenElements(){let n=this;if(!n.$el.getElementsByClassName)return;let f=n.$el.getElementsByClassName("initialHidden");for(let T=0;T<f.length;T++){let V=f[T];V.classList.remove("invisible"),V.classList.remove("d-none")}},close(){const n=this,f=document.referrer.toLowerCase();f&&f.includes("/account/login")?n.$router.go(-2):n.$router.go(-1)},toggle(n){const f=this;f.toggles[n]=!f.toggles[n],localStorage.setItem(f.togglesKey,JSON.stringify(f.toggles))}}},Wt={mixins:[Yt],props:{uid:String},data(){return{copyright:`2020-${new Date().getFullYear()} HOAMS - UbePages`}},computed:{},async created(){},async mounted(){},methods:{isActive(n){return window.location.href.indexOf(n)>-1}}},Kt={class:"footer sticky-bottom"},Qt={class:"d-none d-sm-block navbar navbar-dark bg-primary bg-gradient py-1"},Jt={class:"container-md"},Xt={class:"navbar-text small p-0"},Zt={class:"d-block d-sm-none navbar navbar-expand navbar-dark bg-primary bg-gradient py-1"},es={class:"container-md"},ts={class:"navbar-nav nav-fill w-100"},ss={class:"nav-item dropup"},os={class:"dropdown-menu","aria-labelledby":"dropdown01"},as={class:"nav-item dropup"},ls={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"};function ns(n,f,T,V,_,H){const P=se("router-link");return t(),s("footer",Kt,[e("div",Qt,[e("div",Jt,[e("span",Xt,"©"+u(_.copyright),1)])]),e("nav",Zt,[e("div",es,[e("ul",ts,[e("li",ss,[f[3]||(f[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group"})])],-1)),e("ul",os,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/announcements"},{default:R(()=>f[0]||(f[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),Q(" Announcements ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/posts"},{default:R(()=>f[1]||(f[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),Q(" Posts ")])),_:1})]),e("li",null,[z(P,{class:"dropdown-item",to:"/member/yellow-pages"},{default:R(()=>f[2]||(f[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),Q(" Yellow Pages ")])),_:1})])])]),e("li",as,[f[5]||(f[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user"})])],-1)),e("ul",ls,[e("li",null,[z(P,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:R(()=>f[4]||(f[4]=[Q(" Property Monthly Dues ")])),_:1})])])])])])])])}const rs=Ve(Wt,[["render",ns]]),is={name:"AdminLayout",components:{TopNav:jt,BottomNav:rs},inject:["$config"],mounted(){const f=this.$config;document.title=`Account - ${f.appName}`}},ds={class:"d-flex flex-column vh-100"};function us(n,f,T,V,_,H){const P=se("Toasts"),J=se("router-view");return t(),s("div",ds,[z(P),z(J,{class:"flex-grow-1 mb-2"})])}const cs=Ve(is,[["render",us]]),ms={__name:"index",setup(n){return he().user,fe(()=>{}),(T,V)=>(t(),s("div",null,V[0]||(V[0]=[Qe('<div class="mt-2 pb-2 shadow-sm"><div class="container-md"><div class="row align-items-center"><div class="col-md-auto"><h1><i class="fas fa-fw fa-dashboard me-1"></i>Dashboard </h1></div><div class="col-md"></div></div></div></div><div class="mt-2 container-md"> Dashboard contents here </div>',2)])))}},fs={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://sonyfastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AUTH_POST_LOGOUT_URI:"https://lively-bay-00480981e.5.azurestaticapps.net/",VITE_AUTH_REDIRECT_URI:"window.location.origin + '/accounts/loginRedirect'"},ps=fs;function vs(){Me("$config");const n=ps.VITE_API_URL,f=it.create({baseURL:n});return Fe.configure({template:'<div class="bar pt-1 bg-light" role="bar"><div class="peg1"></div></div><div class="spinner" role="spinner"><div class="fas fa-fw fa-spin fa-arrows-rotate text-white"></div></div>'}),f.interceptors.request.use(T=>{Fe.start();const{user:V}=he();return V&&V.token&&(T.headers?(T.headers.Authorization||(T.headers.Authorization=`Bearer ${V.token}`),T.headers["Access-Control-Allow-Origin"]||(T.headers["Access-Control-Allow-Origin"]="*")):T.headers={Authorization:`Bearer ${V.token}`,"Access-Control-Allow-Origin":"*"}),T}),f.interceptors.response.use(T=>(Fe.done(),T),T=>{throw Fe.done(),T}),f}function $e(n){if(!n.appTitle)throw Error("App Title is required.");if(!n.pageTitle)throw Error("Page Title is required.");const f=Ke(),T=Je(),V=vs(),_=Xe(),H=xt(),J=he().user,j=()=>J&&J.roles&&J.roles.includes("System"),x=()=>J&&J.roles&&J.roles.includes("administrator"),G=()=>J&&J.roles&&J.roles.includes("employee"),oe=()=>J&&J.roles&&J.roles.includes("Member"),B=async()=>{const Y=document.referrer.toLowerCase();Y&&Y.includes("/accounts/login")?await T.go(-2):await T.go(-1)},A=Y=>{var g;const d=f.path,C=(g=f.query)==null?void 0:g.returnUrl;C&&!(d.startsWith(C)||C.startsWith(d))?T.push(C):T.push(Y)},i=n.appTitle,M=n.pageTitle,w=ce(!1),K=ce(new Map),X=ce(""),c=ce(""),v=ce("");return{appTitle:i,pageTitle:M,busy:w,validations:K,infoMessage:X,warningMessage:c,errorMessage:v,router:T,route:f,axios:V,utils:_,toasts:H,close:B,closeWithReturnUrl:A,generateReturnUrl:_.generateReturnUrl,security:{userId:J?J.userId:"",isSystem:j(),isAdministrator:x(),isEmployee:G(),isMember:oe()}}}const gs={class:"h-100 d-flex align-items-center justify-content-center"},bs={class:"form-signin w-100 m-auto"},ys={class:"h3 mb-3 fw-normal"},$s={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},ws=["innerHTML"],hs={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},_s=["disabled"],ks={key:0,class:"fas fa-fw fa-sync fa-spinner fa-spin me-2"},Ss={__name:"login",props:{urlReturn:{type:String,required:!1}},setup(n){Me("$config");const f=he(),T=Ze(),V=new ze(T.msalConfig),_=be({username:"",password:""}),H={username:{required:ae.withMessage("Username is required.",re),$autoDirty:!0,$lazy:!0},password:{required:ae.withMessage("Password is required.",re),$autoDirty:!0,$lazy:!0}},P=Se(H,_),{appTitle:J,pageTitle:j,busy:x,isDirty:G,validations:oe,infoMessage:B,warningMessage:A,errorMessage:i,router:M,route:w,axios:K,utils:X,toasts:c,close:v,security:Y}=$e({appTitle:"Sony FAST POC",pageTitle:"Sign On"}),d={redirectUri:window.location.origin+"/accounts/login"};fe(async()=>{x.value=!0,await V.initialize();try{const y=await V.ssoSilent(d);if(y){await g(y.account);return}}catch(y){y.errorCode!=="login_required"&&c.error("Error while Signing In",y)}await V.handleRedirectPromise().then(async y=>{if(y){const l=V.getAllAccounts();if(l.length===0){await V.loginRedirect(d);return}const m=l[0];await g(m);return}else{c.info("SignIn","No recent session. Please sign in using your AD Account.");return}}).catch(y=>{debugger;c.error("Error while Signing In",y),console.log(y)}),x.value=!1});const C=async()=>{var y={account:V.getActiveAccount(),scopes:[]};await V.acquireTokenSilent(y).then(l=>{const a=l.account.idToken,r=pt(a);r.token=l.accessToken,console.log(l),r.roles||(r.roles=[]),r.userId=r.sub,f.login(r);var I=w.query.returnUrl;I?M.push(decodeURIComponent(I)):r.roles.length===1?M.push(`/${r.roles[0].toLowerCase()}`):M.push("/")}).catch(l=>{console.error(`error during acquireTokenSilent: ${l}`)})},g=async y=>{V.setActiveAccount(y),c.success("SignIn","Sign in successful.",{onClose:async()=>{await C()}})},p=async()=>{const y=V.getAllAccounts();if(y.length===0){await V.loginRedirect(d);return}const l=y[0];await g(l)};return(y,l)=>(t(),ve(ye,null,{default:R(()=>[e("div",gs,[e("main",bs,[e("div",null,[e("h1",ys,u(o(J)),1),e("div",null,[o(i)?(t(),s("div",$s,[l[1]||(l[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(i)},null,8,ws)])):E("",!0),o(P).$error?(t(),s("div",hs,[l[2]||(l[2]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(P).$errors,m=>(t(),s("li",{key:m.$uid},u(m.$message),1))),128))])])):E("",!0)]),e("button",{onClick:l[0]||(l[0]=m=>p()),disabled:o(x),class:"btn btn-primary w-100 py-2"},[o(x)?(t(),s("span",ks)):E("",!0),l[3]||(l[3]=Q("Single Sign On "))],8,_s)])])])]),_:1}))}},Ts=Ve(Ss,[["__scopeId","data-v-e1d5198f"]]),Is={__name:"loginRedirect",setup(n){const f=useMsal(),T=new ze(f.msalConfig);debugger;return fe(async()=>{debugger;await T.initialize(),await T.handleRedirectPromise()}),(V,_)=>(t(),ve(ye,null,{default:R(()=>_[0]||(_[0]=[e("div",null," Login successful, redirecting... ",-1)])),_:1}))}},Ms={class:"h-100 d-flex align-items-center justify-content-center"},xs={__name:"logout",setup(n){const f=he();return f.user,fe(async()=>{f.logoutWithRedirect()}),(T,V)=>(t(),s("div",Ms,V[0]||(V[0]=[e("div",{class:"card"},[e("div",{class:"card-header"}," Sign-Out "),e("div",{class:"card-body"},[Q(" You have logged out from HOA MS."),e("br"),Q(" Click "),e("a",{href:"/",class:"d-inline"},"here"),Q(" to go back to home page. ")])],-1)])))}},Cs={class:"h-100 d-flex align-items-center justify-content-center"},Vs={class:"card m-3"},Ps={class:"card-header"},Os={class:"card-body"},As={class:"m-2"},Us={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Ls=["innerHTML"],Hs={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Ds={class:"row row-cols-1 row-cols-sm-3"},Es={class:"col-sm"},qs={class:"form-group"},Bs={key:0,class:"d-block invalid-feedback"},Ns={class:"col-sm"},Rs={class:"form-group"},Fs={key:0,class:"d-block invalid-feedback"},zs={class:"col-sm"},Gs={class:"form-group"},js={key:0,class:"d-block invalid-feedback"},Ys={class:"row row-cols-1 row-cols-sm-3"},Ws={class:"col"},Ks={class:"form-group"},Qs={key:0,class:"d-block invalid-feedback"},Js={class:"col"},Xs={class:"form-group"},Zs={key:0,class:"d-block invalid-feedback"},eo={class:"row row-cols-1 row-cols-sm-3"},to={class:"col-sm"},so={class:"form-group"},oo={key:0,class:"d-block invalid-feedback"},ao={class:"col-sm"},lo={class:"form-group"},no={key:0,class:"d-block invalid-feedback"},ro={class:"mt-2 row row-cols-1 row-cols-sm-3 g-2"},io={class:"col"},uo=["disabled"],co={class:"col"},mo={class:"col"},fo={__name:"register",props:{urlReturn:{type:String,required:!1}},setup(n){const f=be({firstName:"",middleName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),T=(Y,d)=>Y===d.password,V={firstName:{required:ae.withMessage("First name is required.",re),$autoDirty:!0,$lazy:!0},middleName:{required:ae.withMessage("Middle name is required.",re),$autoDirty:!0,$lazy:!0},lastName:{required:ae.withMessage("Last name is required.",re),$autoDirty:!0,$lazy:!0},phoneNumber:{required:ae.withMessage("Phone number is required.",re),$autoDirty:!0,$lazy:!0},email:{required:ae.withMessage("Email is required.",re),$autoDirty:!0,$lazy:!0},password:{required:ae.withMessage("Password is required.",re),$autoDirty:!0,$lazy:!0},confirmPassword:{required:ae.withMessage("Confirm password is required.",re),confirmSamePassword:ae.withMessage("Password and confirm passwrod are different.",T),$autoDirty:!0,$lazy:!0}},_=Se(V,f),{appTitle:H,pageTitle:P,busy:J,isDirty:j,validations:x,infoMessage:G,warningMessage:oe,errorMessage:B,router:A,axios:i,utils:M,toasts:w,close:K,security:X}=$e({appTitle:"HOA MS",pageTitle:"Register User"}),c=Me("$config");fe(()=>{});const v=async()=>{const Y=f;if(J.value)return;if(!await _.value.$validate()){window.scrollTo(0,0);return}B.value=null;try{J.value=!0;const C=M.clone(Y);C.tenantid=c.tenantId;debugger;await i({method:"post",url:"/api/v1/accounts/register",data:C}).then(g=>{w.success("Register","Registration was successfull.",{onClose:async()=>{await A.push("/accounts/login")}})})}catch(C){B.value=M.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{J.value=!1}};return(Y,d)=>{const C=se("router-link");return t(),ve(ye,null,{default:R(()=>[e("div",Cs,[e("div",Vs,[e("h4",Ps,u(o(P)),1),e("div",Os,[e("div",As,[o(B)?(t(),s("div",Us,[d[8]||(d[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(B)},null,8,Ls)])):E("",!0),o(_).$error?(t(),s("div",Hs,[d[9]||(d[9]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(_).$errors,g=>(t(),s("li",{key:g.$uid},u(g.$message),1))),128))])])):E("",!0)]),e("div",Ds,[e("div",Es,[e("div",qs,[d[10]||(d[10]=e("label",null,"First Name",-1)),N(e("input",{"onUpdate:modelValue":d[0]||(d[0]=g=>f.firstName=g),type:"text",class:"form-control"},null,512),[[Z,f.firstName]]),o(_).firstName.$error?(t(),s("div",Bs,[(t(!0),s(U,null,q(o(_).firstName.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])]),e("div",Ns,[e("div",Rs,[d[11]||(d[11]=e("label",null,"Middle Name",-1)),N(e("input",{"onUpdate:modelValue":d[1]||(d[1]=g=>f.middleName=g),type:"text",class:"form-control"},null,512),[[Z,f.middleName]]),o(_).middleName.$error?(t(),s("div",Fs,[(t(!0),s(U,null,q(o(_).middleName.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])]),e("div",zs,[e("div",Gs,[d[12]||(d[12]=e("label",null,"Last Name",-1)),N(e("input",{"onUpdate:modelValue":d[2]||(d[2]=g=>f.lastName=g),type:"text",class:"form-control"},null,512),[[Z,f.lastName]]),o(_).lastName.$error?(t(),s("div",js,[(t(!0),s(U,null,q(o(_).lastName.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])])]),e("div",Ys,[e("div",Ws,[e("div",Ks,[d[13]||(d[13]=e("label",null,"Phone Number",-1)),N(e("input",{"onUpdate:modelValue":d[3]||(d[3]=g=>f.phoneNumber=g),type:"tel",class:"form-control"},null,512),[[Z,f.phoneNumber]]),o(_).phoneNumber.$error?(t(),s("div",Qs,[(t(!0),s(U,null,q(o(_).phoneNumber.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])]),e("div",Js,[e("div",Xs,[d[14]||(d[14]=e("label",null,"Email",-1)),N(e("input",{"onUpdate:modelValue":d[4]||(d[4]=g=>f.email=g),type:"email",class:"form-control"},null,512),[[Z,f.email]]),o(_).email.$error?(t(),s("div",Zs,[(t(!0),s(U,null,q(o(_).email.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])])]),e("div",eo,[e("div",to,[e("div",so,[d[15]||(d[15]=e("label",null,"Password",-1)),N(e("input",{"onUpdate:modelValue":d[5]||(d[5]=g=>f.password=g),type:"password",class:"form-control"},null,512),[[Z,f.password]]),o(_).password.$error?(t(),s("div",oo,[(t(!0),s(U,null,q(o(_).password.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])]),e("div",ao,[e("div",lo,[d[16]||(d[16]=e("label",null,"Confirm Password",-1)),N(e("input",{"onUpdate:modelValue":d[6]||(d[6]=g=>f.confirmPassword=g),type:"password",class:"form-control"},null,512),[[Z,f.confirmPassword]]),o(_).confirmPassword.$error?(t(),s("div",no,[(t(!0),s(U,null,q(o(_).confirmPassword.$errors,g=>(t(),s("div",{key:g.$uid},u(g.$message),1))),128))])):E("",!0)])])]),e("div",ro,[e("div",io,[e("button",{disabled:o(_).$dirty&&o(_).$invalid,onClick:d[7]||(d[7]=g=>v()),class:"btn btn-primary w-100"},d[17]||(d[17]=[e("span",{class:"fas fa-fw fa-save me-1"},null,-1),Q("Register ")]),8,uo)]),e("div",co,[z(C,{to:"/",class:"btn btn-outline-primary w-100"},{default:R(()=>d[18]||(d[18]=[Q("Home")])),_:1})]),e("div",mo,[z(C,{to:"/accounts/login",class:"btn btn-outline-primary w-100"},{default:R(()=>d[19]||(d[19]=[Q("Login")])),_:1})])])])])])]),_:1})}}},po={path:"/accounts",component:cs,props:!1,meta:{},children:[{path:"",component:ms},{path:"login",component:Ts},{path:"loginRedirect",component:Is},{path:"logout",component:xs},{path:"register",component:fo}]};function tt(){const n=Je(),f=j=>window.location.href.indexOf(j)>-1,T=j=>localStorage.getItem("data-bs-theme")||j,V=j=>{document.documentElement.setAttribute("data-bs-theme",j),localStorage.setItem("data-bs-theme",j)},_=async()=>await it.get("https://bootswatch.com/api/5.json").then(j=>j.data),H=j=>{const x=document.querySelector("link[href*='https://cdn.jsdelivr.net/npm/bootswatch']");x&&j?(x.setAttribute("href",j),localStorage.setItem("bootswatch-theme",j)):alert("cannot query css link")},P=j=>{J(),n.push(j)},J=()=>{if(screen.width<576){const x=document.getElementById("navbarCollapse");if(x){const G=Ye.getInstance(x);G&&G.hide()}}};return{isActive:f,getCurrentBsTheme:T,changeBsTheme:V,getBootswatch:_,changeTheme:H,navigate:P,collapseNavbar:J}}const vo={class:"sticky-top navbar navbar-expand-sm bg-primary","data-bs-theme":"dark"},go={class:"container-md"},bo={class:"navbar-collapse collapse",id:"navbarCollapse"},yo={class:"navbar-nav"},$o={class:"nav-item"},wo={class:"nav-item dropdown"},ho={class:"dropdown-menu","aria-labelledby":"dropdown01"},_o={class:"nav-item"},ko={class:"nav-item dropdown"},So={class:"dropdown-menu","aria-labelledby":"dropdown01"},To={class:"navbar-nav ms-auto"},Io={class:"nav-item dropdown"},Mo={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},xo=["onClick"],Co={class:"nav-item dropdown"},Vo={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Po={class:"d-sm-none d-xl-inline"},Oo={key:0},Ao={key:1},Uo={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Lo={key:0},Ho={key:1},Do={__name:"topNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(n){const f=Ze(),{isActive:T,getCurrentBsTheme:V,changeBsTheme:_,getBootswatch:H,changeTheme:P,navigate:J,collapseNavbar:j}=tt(),x=he(),G=x.user,oe=be({user:G,username:G?G.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});fe(async()=>{const M=oe;M.bootswatch=await H();const w=V(M.bsTheme);debugger;w&&(M.bsTheme=w,_(M.bsTheme));const K=localStorage.getItem("bootswatch-theme");K&&(M.currentTheme=K,P(K))});const B=M=>{P(M),oe.currentTheme=M,j()},A=M=>{_(M),oe.bsTheme=M,j()},i=async()=>{x.logoutWithRedirect();const M=new ze(f.msalConfig);await M.initialize();const w={mainWindowRedirectUri:"/"};await M.logoutPopup(w)};return(M,w)=>{const K=se("router-link");return t(),ve(ye,null,{default:R(()=>[e("nav",vo,[e("div",go,[z(K,{class:"navbar-brand",to:"/administrator"},{default:R(()=>[Q(u(n.appName),1)]),_:1}),w[18]||(w[18]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",bo,[e("ul",yo,[e("li",$o,[z(K,{to:"/videos",onClick:o(j),class:"nav-link"},{default:R(()=>w[3]||(w[3]=[e("span",{class:"fas fa-fw fa-video me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Videos ",-1)])),_:1},8,["onClick"])]),e("li",wo,[w[6]||(w[6]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-warehouse me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Sources ")],-1)),e("ul",ho,[e("li",null,[z(K,{to:"/source-groups",onClick:o(j),class:"dropdown-item"},{default:R(()=>w[4]||(w[4]=[Q(" Groups ")])),_:1},8,["onClick"])]),e("li",null,[z(K,{to:"/source-locations",onClick:o(j),class:"dropdown-item"},{default:R(()=>w[5]||(w[5]=[Q(" Locations ")])),_:1},8,["onClick"])])])]),e("li",_o,[z(K,{to:"/vod-sources",onClick:o(j),class:"nav-link"},{default:R(()=>w[7]||(w[7]=[e("span",{class:"fas fa-fw fa-tags me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Video on Demand (VOD) ",-1)])),_:1},8,["onClick"])]),e("li",ko,[w[10]||(w[10]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-microphone-lines me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Channel Assembly ")],-1)),e("ul",So,[e("li",null,[z(K,{to:"/program-templates",onClick:o(j),class:"dropdown-item"},{default:R(()=>w[8]||(w[8]=[Q(" Program Templates ")])),_:1},8,["onClick"])]),e("li",null,[z(K,{to:"/channels",onClick:o(j),class:"dropdown-item"},{default:R(()=>w[9]||(w[9]=[Q(" Channels ")])),_:1},8,["onClick"])])])])]),e("ul",To,[e("li",Io,[w[14]||(w[14]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-wand-sparkles me-1"}),e("span",{class:"d-sm-none d-xl-inline"},"Themes")],-1)),e("ul",Mo,[e("li",null,[oe.bsTheme==="dark"?(t(),s("button",{key:0,onClick:w[0]||(w[0]=X=>A("light")),class:"dropdown-item"},w[11]||(w[11]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Q("Dark Mode ")]))):(t(),s("button",{key:1,onClick:w[1]||(w[1]=X=>A("dark")),class:"dropdown-item"},w[12]||(w[12]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Q("Light Mode ")])))]),w[13]||(w[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),(t(!0),s(U,null,q(oe.bootswatch.themes,X=>(t(),s("li",null,[e("button",{onClick:c=>B(X.cssCdn),class:te(["dropdown-item",{active:oe.currentTheme===X.cssCdn}])},u(X.name),11,xo)]))),256))])]),e("li",Co,[e("a",Vo,[e("span",null,[w[15]||(w[15]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Po,[o(G)?(t(),s("span",Oo,u(o(G).name),1)):(t(),s("span",Ao," Guest "))])])]),e("ul",Uo,[o(G)?(t(),s("li",Lo,[e("button",{onClick:w[2]||(w[2]=X=>i()),class:"dropdown-item"},w[16]||(w[16]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Q("Logout ")]))])):(t(),s("li",Ho,[z(K,{to:"/accounts/login",class:"dropdown-item"},{default:R(()=>w[17]||(w[17]=[e("span",{class:"fas fa-fw fa-sign-in me-1"},null,-1),Q("Login ")])),_:1})]))])])])])])])]),_:1})}}},Eo={id:"sideNav",class:"collapse collapse-horizontal show"},qo={class:"d-flex flex-column bg-dark min-vh-100 overflow-y-auto"},Bo={class:"navbar bg-primary bg-gradient shadow-sm","data-bs-theme":"dark"},No={class:"navbar-brand me-0 mb-1 px-2"},Ro={class:"d-none d-sm-inline"},Fo={class:"nav nav-pills flex-column px-1 mt-2",role:"tablist"},zo={class:"nav-item"},Go={id:"sources",class:"list-group collapse border"},jo={class:"nav-item"},Yo={id:"assets",class:"list-group collapse border"},Wo={class:"nav-item"},Ko={id:"assembly",class:"list-group collapse border"},Qo={class:"nav-item"},Jo={id:"themes",class:"list-group collapse border"},Xo={class:"list-group-item border-bottom"},Zo=["onClick"],ea={class:"nav nav-pills flex-column mt-auto px-1 mb-3",role:"tablist"},ta={class:"nav-item dropdown"},sa={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},oa={class:"d-none d-sm-inline"},aa={key:0},la={key:1},na={class:"dropdown-menu dropdown-menu-end w-100 position-absolute","aria-labelledby":"dropdown01"},ra={key:0},ia={key:1},da={key:0,class:"fas fa-fw fa-angle-double-left"},ua={key:1,class:"fas fa-fw fa-angle-double-right"},ca={__name:"sideNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(n){const f=Ze(),T=Ke(),V=Je(),_=he(),H=_.user,{isActive:P,getCurrentBsTheme:J,changeBsTheme:j,getBootswatch:x,changeTheme:G,navigate:oe,collapseNavbar:B}=tt(),A=be({user:H,username:H?H.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});fe(async()=>{const g=A;g.bootswatch=await x();const p=J(g.bsTheme);p&&(g.bsTheme=p,j(g.bsTheme));const y=localStorage.getItem("bootswatch-theme");y&&(g.currentTheme=y,G(y)),X();const l=document.getElementById("sideNav");l&&(K.value?l.classList.add("show"):l.classList.remove("show"))});const i=g=>{G(g),A.currentTheme=g,C("themes")},M=g=>{j(g),A.bsTheme=g,C("themes")},w=async()=>{_.logoutWithRedirect();const g=new ze(f.msalConfig);await g.initialize();const p={mainWindowRedirectUri:window.location.origin};await g.logoutRedirect(p)},K=ce(!0),X=()=>{const g=localStorage.getItem("show-sideNav")||"true";K.value=g==="true"},c=()=>{localStorage.setItem("show-sideNav",K.value),Ye.getInstance("#sideNav").toggle()},v=()=>{K.value=!K.value,c()},Y=g=>{var p=T.path.startsWith(g);return p?"active":""},d=async(g,p)=>{C(p),await V.push(g)},C=g=>{const p=Ye.getInstance(`#${g}`);p&&p.hide()};return(g,p)=>{const y=se("router-link");return t(),s("div",null,[e("div",Eo,[e("div",qo,[e("nav",Bo,[z(y,{to:"/",class:"text-decoration-none w-100 text-center"},{default:R(()=>[e("h1",No,[p[9]||(p[9]=e("span",{class:"fas fa-fw fa-home d-inline d-md-none"},null,-1)),e("span",Ro,u(n.appName),1)])]),_:1})]),e("ul",Fo,[e("li",zo,[e("a",{href:"#",class:te([Y("/source-"),"nav-link dropdown-toggle collapsed"]),"data-bs-toggle":"collapse","data-bs-target":"#sources","aria-expanded":"false","aria-controls":"sources"},p[10]||(p[10]=[e("span",{class:"fas fa-fw fa-boxes-packing"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Sources",-1)]),2),e("ul",Go,[e("li",{class:te([Y("/source-groups"),"list-group-item"])},[e("button",{onClick:p[0]||(p[0]=l=>d("/source-groups","sources")),class:"dropdown-item",role:"button"},p[11]||(p[11]=[e("span",{class:"fas fa-fw fa-warehouse"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Groups",-1)]))],2),e("li",{class:te([Y("/source-locations"),"list-group-item"])},[e("button",{onClick:p[1]||(p[1]=l=>d("/source-locations","sources")),class:"dropdown-item",role:"button"},p[12]||(p[12]=[e("span",{class:"fas fa-fw fa-building"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Locations",-1)]))],2)])]),e("li",jo,[e("a",{href:"#",class:te([[Y("/videos"),Y("/vod-sources")],"nav-link dropdown-toggle collapsed"]),"data-bs-toggle":"collapse","data-bs-target":"#assets","aria-expanded":"false","aria-controls":"sources"},p[13]||(p[13]=[e("span",{class:"fas fa-fw fa-photo-video"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Assets",-1)]),2),e("ul",Yo,[e("li",{class:te([Y("/videos"),"list-group-item"])},[e("button",{onClick:p[2]||(p[2]=l=>d("/videos","assets")),class:"dropdown-item",role:"button"},p[14]||(p[14]=[e("span",{class:"fas fa-fw fa-video"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Videos",-1)]))],2),e("li",{class:te([Y("/vod-sources"),"list-group-item"])},[e("button",{onClick:p[3]||(p[3]=l=>d("/vod-sources","assets")),class:"dropdown-item",role:"button"},p[15]||(p[15]=[e("span",{class:"fas fa-fw fa-tags"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"VOD",-1)]))],2)])]),e("li",Wo,[e("a",{href:"#",class:te([[Y("/program-templates"),Y("/channels")],"nav-link dropdown-toggle collapsed"]),"data-bs-toggle":"collapse","data-bs-target":"#assembly","aria-expanded":"false","aria-controls":"sources"},p[16]||(p[16]=[e("span",{class:"fas fa-fw fa-industry"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Assembly",-1)]),2),e("ul",Ko,[e("li",{class:te([Y("/program-templates"),"list-group-item"])},[e("button",{onClick:p[4]||(p[4]=l=>d("/program-templates","assembly")),class:"dropdown-item",role:"button"},p[17]||(p[17]=[e("span",{class:"fas fa-fw fa-file-video"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Program Templates",-1)]))],2),e("li",{class:te([Y("/channels"),"list-group-item"])},[e("button",{onClick:p[5]||(p[5]=l=>d("/channels","assembly")),class:"dropdown-item",role:"button"},p[18]||(p[18]=[e("span",{class:"fas fa-fw fa-tv"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Channels",-1)]))],2)])]),e("li",Qo,[p[21]||(p[21]=e("a",{href:"#",class:"nav-link dropdown-toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#themes","aria-expanded":"false","aria-controls":"themes"},[e("span",{class:"fas fa-fw fa-wand-sparkles"}),e("span",{class:"d-none d-sm-inline ms-1"},"Themes")],-1)),e("ul",Jo,[e("li",Xo,[A.bsTheme==="dark"?(t(),s("button",{key:0,onClick:p[6]||(p[6]=l=>M("light")),class:"dropdown-item"},p[19]||(p[19]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Q("Dark Mode ")]))):(t(),s("button",{key:1,onClick:p[7]||(p[7]=l=>M("dark")),class:"dropdown-item"},p[20]||(p[20]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Q("Light Mode ")])))]),(t(!0),s(U,null,q(A.bootswatch.themes,l=>(t(),s("li",{class:te([{active:A.currentTheme===l.cssCdn},"list-group-item"])},[e("button",{onClick:m=>i(l.cssCdn),class:"dropdown-item"},u(l.name),9,Zo)],2))),256))])])]),e("ul",ea,[e("li",ta,[e("a",sa,[e("span",null,[p[22]||(p[22]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",oa,[o(H)?(t(),s("span",aa,u(o(H).name),1)):(t(),s("span",la," Guest "))])])]),e("ul",na,[o(H)?(t(),s("li",ra,[e("button",{onClick:p[8]||(p[8]=l=>w()),class:"dropdown-item"},p[23]||(p[23]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Q("Logout ")]))])):(t(),s("li",ia,[z(y,{to:"/accounts/login",class:"dropdown-item"},{default:R(()=>p[24]||(p[24]=[e("span",{class:"fas fa-fw fa-sign-in me-1"},null,-1),Q("Login ")])),_:1})]))])])])])]),e("button",{id:"sideNavToggler",onClick:v,"data-bs-target":"#sideNav","data-bs-toggle":"collapse",class:"d-none btn btn-sm btn-warning fixed-bottom z-3 p-0",style:{width:"2rem",height:"2rem"}},[K.value?(t(),s("span",da)):(t(),s("span",ua))])])}}},ma={class:"footer sticky-bottom"},fa={class:"d-sm-block navbar navbar-dark bg-dark bg-gradient1 py-1"},pa={class:"container-md"},va={class:"navbar-text small p-0"},ga={__name:"bottomNav",props:{appName:{type:String,default:"SCH2"}},setup(n){tt();const f=Me("$config"),V=he().user;let H=new Date().getFullYear();const P=be({user:V,username:V?V.nameFull:"Guest",copyright:`2020-${H} ${f.appName}`});return fe(async()=>{}),(J,j)=>(t(),s("footer",ma,[e("div",fa,[e("div",pa,[e("span",va,"©"+u(P.copyright),1)])])]))}},ba={props:{showProgress:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},maxMessages:{type:Number,default:5},timeOut:{type:Number,default:3e3},closeable:{type:Boolean,default:!0}},data(){return{messages:[],count:0}},created(){et.$on("toast-message",this.handleMessageEvent)},methods:{handleMessageEvent(n){n.message&&this.addMessage(n.title,n.message,n.type,n.options)},async addMessage(n,f,T,V={}){var _={id:this.count++,title:n,message:f,type:T,showProgress:this.showProgress,timeOut:this.timeOut,closeable:this.closeable,rtl:this.rtl,progress:0,paused:!1,animationFrame:null};_=Object.assign({},_,V),this.messages.unshift(_),this.messages.length>this.maxMessages&&this.messages.splice(this.maxMessages),_.timeOut>0&&await this.startTimeout(_)},async startTimeout(n,f=0){const T=this,V=performance.now(),_=async()=>{n.animationFrame=requestAnimationFrame(async H=>{const P=H+f-V;if(!T.exists(n)||n.paused){cancelAnimationFrame(n.animationFrame);return}else if(P<n.timeOut){const J=P/n.timeOut;n.progress=J,await _()}else{n.progress=1,cancelAnimationFrame(n.animationFrame),T.remove(n);return}})};await _()},pauseProgress(n){n.timeOut<=0||(n.paused=!0)},async resumeProgress(n){n.timeOut<=0||(n.paused=!1,await this.startTimeout(n,n.timeOut*n.progress))},getCurrentProgress(n){return Math.round(n.progress*100)===100?100:n.progress*100},getIconClass(n){const f=n.type;let T="";switch(f){case"success":T="fas fa-fw fa-circle-check";break;case"info":T="fas fa-fw fa-circle-info";break;case"warning":T="fas fa-fw fa-circle-exclamation";break;case"danger":T="fas fa-fw fa-triangle-exclamation";break}let V=T;return n.rtl?"icon-right "+V:"icon-left "+V},async remove(n){const f=this.messages.findIndex(T=>T.id===n.id);this.messages.splice(f,1),typeof n.onClose=="function"&&await n.onClose()},exists(n){return this.messages.findIndex(T=>T.id===n.id)!==-1}}},ya={"aria-live":"polite","aria-atomic":"true",class:"position-static"},$a=["onMouseover","onMouseout"],wa={class:"me-auto text-white"},ha=["onClick"],_a={class:"toast-body"},ka=["innerHTML"],Sa={key:0,class:"progress m-1",style:{height:"4px"}};function Ta(n,f,T,V,_,H){return t(),ve(ye,null,{default:R(()=>[e("div",ya,[z(_e,{class:"toast-container top-0 end-0 p-3",name:"toast",tag:"div",appear:""},{default:R(()=>[(t(!0),s(U,null,q(_.messages,P=>(t(),s("div",{key:P.id,class:te(["toast show mb-2 ms-auto",`border-${P.type}`]),role:"alert","aria-live":"assertive","aria-atomic":"true",onMouseover:J=>H.pauseProgress(P),onMouseout:J=>H.resumeProgress(P)},[e("div",{class:te(["toast-header",`bg-${P.type}`])},[e("strong",wa,[e("i",{class:te([H.getIconClass(P),"me-1"])},null,2),Q(u(P.title),1)]),P.closeable?(t(),s("button",{key:0,type:"button",class:"mr-2 mb-1 btn-close","data-dismiss":"toast","aria-label":"Close",onClick:J=>H.remove(P)},f[0]||(f[0]=[e("span",{"aria-hidden":"true"},null,-1)]),8,ha)):E("",!0)],2),e("div",_a,[e("div",{innerHTML:P.message},null,8,ka)]),P.timeOut>0&&P.showProgress?(t(),s("div",Sa,[e("div",{class:te(`bg-${P.type}`),style:dt({width:H.getCurrentProgress(P)+"%"})},null,6)])):E("",!0)],42,$a))),128))]),_:1})])]),_:1})}const Ia=Ve(ba,[["render",Ta],["__scopeId","data-v-5272bd9a"]]),Ma={name:"AdminLayout",components:{TopNav:Do,SideNav:ca,BottomNav:ga},inject:["$config"],mounted(){this.$config,document.title="Administrator"}},xa={class:"d-flex flex-row flex-nowrap vh-100"};function Ca(n,f,T,V,_,H){const P=se("Toasts"),J=se("SideNav"),j=se("router-view"),x=se("DialogsWrapper");return t(),s("div",xa,[z(P),z(J),z(j,{class:"d-flex flex-column w-100 h-100"}),z(x)])}const Va=Ve(Ma,[["render",Ca]]),Pa={class:"mt-2 container overflow-y-auto"},Oa={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Aa=["innerHTML"],Ua={class:"row mb-3"},La={class:"col-xl-4"},Ha={class:""},Da=["id"],Ea={key:1,class:"card card-header bg-warning-subtle mb-2"},qa={class:"col-xl-8 overflow-x-auto mt-2 mt-xl-0"},Ba={class:"d-flex flex-column align-items-start"},Na=["src"],Ra={class:""},Fa={class:"d-flex flex-row"},za={class:"me-2 px-2 border-end border-secondary",style:{width:"10rem"}},Ga={class:"text-center"},ja=["src"],Ya={class:"text-end"},Wa={class:"text-wrap text-truncate"},Ka={class:"overflow-y-auto"},Qa={class:"badge bg-info me-2"},Ja={key:0,class:"badge bg-warning mb-1"},Xa={__name:"Index",props:{urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,isDirty:_,validations:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,generateReturnUrl:i,security:M}=$e({appTitle:"ARC AIO",pageTitle:"Dashboard"});Me("$config"),he().user;const K=be({item:null});ce("805630ed-f288-4f2f-83a4-6c71312f6970"),ce(),fe(async()=>{await v()}),Ae(()=>{K.item.forEach(C=>{C.hls&&(C.hls.stopLoad(),C.hls.destroy())})});const X=async()=>{const C=K;if(!V.value)try{V.value=!0;const g="/api/v1/channels/epg/";C.item=[],await G.get(g).then(p=>{C.item=p.data}),C.item.forEach(p=>{Y(p)})}catch(g){j.value=oe.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{V.value=!1}},c=async()=>{if(confirm("Are you sure you want to Reset All Data?"))try{await G.get("/api/v1/channels/reset/").then(p=>{B.success("Reset All Data","Reset data was successful.")})}catch(g){j.value=oe.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{V.value=!1}},v=async()=>{await X()},Y=C=>{if(C.manifestUrl&&Hls.isSupported()){d(C);var g=document.getElementById(`video-${C.id}`);if(!g)return;C.hls&&(C.hsl.stopLoad(),C.hls.destroy());let p=C.manifestUrl;C.hls=oe.createHlsStream(g,p);return}},d=C=>{C.outputs&&C.outputs.forEach(p=>{if(p.hls){debugger;p.hls.detachMedia(),p.hls.destroy(),delete p.hls}p.playbackConfigurations.forEach(y=>{if(y.hls){debugger;y.hls.detachMedia(),y.hls.destroy(),delete y.hls}})})};return(C,g)=>{const p=se("PageHeader"),y=se("router-link");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(p,{"page-icon":"fas fa-fw fa-dashboard",pageTitle:o(T)},{default:R(()=>[e("div",null,[e("button",{onClick:g[0]||(g[0]=l=>c()),class:"ms-2 btn btn-danger"},g[2]||(g[2]=[e("span",{class:"fas fa-fw fa-recycle me-1"},null,-1),Q("Reset All Data ")])),e("button",{onClick:g[1]||(g[1]=l=>v()),class:"ms-2 btn btn-secondary"},g[3]||(g[3]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)]))])]),_:1},8,["pageTitle"]),e("div",Pa,[o(j)?(t(),s("div",Oa,[g[4]||(g[4]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:JSON.stringify(o(j))},null,8,Aa)])):E("",!0),(t(!0),s(U,null,q(K.item,l=>(t(),s("div",null,[e("div",Ua,[e("div",La,[e("div",Ha,[l.manifestUrl?(t(),s("video",{key:0,id:`video-${l.id}`,controls:"",autoplay:"",class:"card-img-top object-fit-scale align-middle border"},null,8,Da)):(t(),s("div",Ea," Channel not yet published "))])]),e("div",qa,[e("div",Ba,[e("div",null,[e("h4",null,[e("img",{src:l.logo,class:"img-fluid me-2",style:{height:"3rem"}},null,8,Na),z(y,{to:`${n.urlViewChannel}/${l.id}/${o(i)()}`},{default:R(()=>[Q(u(l.title),1)]),_:2},1032,["to"])])]),e("div",Ra,[e("div",Fa,[(t(!0),s(U,null,q(l.programs,m=>(t(),s("div",za,[e("div",Ga,[e("img",{src:m.image,class:"img-fluid border",style:{height:"64px"}},null,8,ja)]),e("div",Ya,u(o(oe).moment(m.since).format("hh:mm a"))+"-"+u(o(oe).moment(m.till).format("hh:mm a")),1),e("div",Wa,u(m.title),1),e("div",Ka,[(t(!0),s(U,null,q(m.genres,a=>(t(),s("span",Qa,u(a),1))),256))]),o(oe).moment().isAfter(m.since)&&o(oe).moment().isBefore(m.till)?(t(),s("span",Ja,"Now Playing")):E("",!0)]))),256))])])])])])]))),256))])])]),_:1})}}};function Le(n){if(!n.cacheKey)throw Error("Cache Key required.");if(!n.baseUrl)throw Error("Base Url required.");const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,closeWithReturnUrl:B,generateReturnUrl:A,security:i}=$e({appTitle:n.appTitle,pageTitle:n.pageTitle}),M=JSON.parse(JSON.stringify(n.filter));M.pageIndex=M.pageIndex||1,M.pageSize=M.pageSize||5,M.sortField=M.sortField||"",M.sortOrder=M.sortOrder||1,M.updateUrl=M.updateUrl||!1,M.items=M.items||[],M.query=M.query||{},M.query.criteria=M.query.criteria||"";const w=ce(M),K=()=>{var l;if(V.value){console.log("Paginated search is currently busy.");return}const g=JSON.parse(localStorage.getItem(n.cacheKey))||{},p=new URLSearchParams(window.location.search),y=w.value;y.query.criteria=p.get("c")||g.criteria||y.query.criteria||"",y.pageIndex=parseInt(p.get("p"),10)||g.pageIndex||y.pageIndex||1,y.pageSize=parseInt(p.get("s"),10)||g.pageSize||y.pageSize||5,y.sortField=p.get("sf")||g.sortField||y.sortField||"",y.sortOrder=parseInt(p.get("so"),10)||g.sortOrder||y.sortOrder||1,y.visible=g.visible||y.visible,(l=n.initializeFilter)==null||l.call(n,w,n.cacheKey)},X=()=>{if(n.getQuery)return n.getQuery(w.value);{const g=w.value;return["?c=",encodeURIComponent(g.query.criteria),"&p=",g.pageIndex,"&s=",g.pageSize,"&sf=",g.sortField,"&so=",g.sortOrder].join("")}},c=()=>{if(n.saveQuery)n.saveQuery(w.value,n.cacheKey);else{const g=w.value;localStorage.setItem(n.cacheKey,JSON.stringify({criteria:g.query.criteria,pageIndex:g.pageIndex,pageSize:g.pageSize,sortField:g.sortField,sortOrder:g.sortOrder,visible:g.visible}))}};return{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,closeWithReturnUrl:B,generateReturnUrl:A,security:i,filter:w,initializeFilter:K,getQuery:X,saveQuery:c,search:async g=>{var y;let p=w.value;if(V.value){console.log("Paginated search is currently busy.");return}g>0&&(p.pageIndex=g);try{V.value=!0,P.value="";const l=X();p.selected=null,await j(`${n.baseUrl}/${l}`).then(async m=>{var r;Array.isArray(m.data)?p.items=m.data:p=Object.assign(p,m.data);let a=location.pathname;a.endsWith("/")?a+=l:a+="/"+l,p.updateUrl&&window.history.replaceState(l,`${f}-search`,a),p.items.forEach(I=>{I.expand=!1}),c(),(r=n.successAction)==null||r.call(n,w.value)})}catch(l){if(localStorage.removeItem(n.cacheKey),n.failAction)n.failAction(l);else{const m=x.getErrorMessageAsHtml(l);P.value=m,G.error("Error Occured",m)}}finally{V.value=!1,(y=n.finalAction)==null||y.call(n)}},getRowNumber:g=>{const p=w.value;return(p.pageIndex-1)*p.pageSize+(g+1)},setSelected:g=>{const p=w.value;p.selected&&g&&p.selected===g?p.selected=null:(p.selected&&(p.selected.expand=!1),p.selected=g,p.selected.expand=!0)},isSelected:g=>{const p=w.value;return g===null||p.selected===null?!1:g===p.selected}}}const Za=["disabled"],el={class:"row row-cols-1 row-cols-sm-3"},tl={class:"col"},sl={class:"form-floating mb-2"},ol={key:0,class:"d-block invalid-feedback"},al={class:"col"},ll={class:"form-floating"},nl={class:"col"},rl={class:"form-floating"},il={class:"col"},dl={class:"form-floating mb-2"},ul={class:"row row-cols-1 row-cols-sm-2"},cl={class:"col-sm-8"},ml={class:"ps-2"},fl={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border"},pl={class:"col"},vl={class:"form-check"},gl=["onUpdate:modelValue","id"],bl=["for"],yl={class:"col-sm-4"},$l={class:"border p-2"},wl={class:"form-check"},hl=["onUpdate:modelValue","id"],_l=["for"],kl={class:"table-responsive mt-2"},Sl={class:"text-end"},Tl={class:"table table-sm mb-0 mt-2"},Il={class:"align-middle"},Ml={class:"text-center"},xl=["onUpdate:modelValue"],Cl=["onUpdate:modelValue"],Vl=["onUpdate:modelValue"],Pl={class:"text-start"},Ol=["onClick"],Al={__name:"add",props:{urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Video"}),A=n,i=be({lookups:{genres:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}]},durationTime:"00:00:00",item:{title:"Video # ",description:null,durationInMillis:12e4,dateReleased:x.moment().format("YYYY-MM-DD"),formats:[]}}),M={item:{title:{title:ae.withMessage("Title is required.",re),$autoDirty:!0,$lazy:!0},durationInMillis:{title:ae.withMessage("Duration is required.",re),$autoDirty:!0,$lazy:!0},dateReleased:{title:ae.withMessage("Date Released is required.",re),$autoDirty:!0,$lazy:!0}}},w=Se(M,i),K=Ie(()=>{const d=x.moment;if(i.durationTime&&i.durationTime!=="00:00:00"&&x.isValidTime(i.durationTime)){const C=d().startOf("day"),g=C.format("YYYY-MM-DD ")+i.durationTime,y=d(g).subtract(C);return i.item.durationInMillis=y.valueOf(),i.item.durationInMillis}return 0});fe(async()=>{await c()});const X=async()=>{const d=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const g=x.clone(d.item);g.durationInMillis=K.value;const p=x.moment(d.item.dateReleased).utc(!0).format();g.dateReleased=p;const y=i.lookups.genres.filter(m=>m.selected).map(m=>m.id);g.genres=y;const l=i.lookups.categories.filter(m=>m.selected).map(m=>m.id);g.categories=l;debugger;await j.post("/api/v1/videos/",g).then(m=>{G.success("Add Video","Video added",{onClose:async()=>{const a=`${A.urlView}/${m.data}`;await J.push(a)}})})}catch(g){P.value=x.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{V.value=!1}},c=async()=>{try{await j.get("/api/v1/lookups/video-genres/").then(d=>{const g=d.data.filter(p=>p.id!==0);i.lookups.genres=g})}catch(d){P.value=x.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}},v=()=>{const d={format:"HLS",serverUrl:"https://media-tailor-input.s3.us-west-2.amazonaws.com",path:"/sony-poc/vod-1/bbb_2mins.m3u8"};i.item.formats.push(d)},Y=d=>{i.item.formats.splice(d,1)};return(d,C)=>{const g=se("router-link"),p=se("PageHeader"),y=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(p,{"page-icon":"fas fa-fw fa-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:C[0]||(C[0]=l=>X()),class:"btn btn-primary"},C[6]||(C[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Za),z(g,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>C[7]||(C[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(y,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[e("div",null,[e("div",el,[e("div",tl,[e("div",sl,[N(e("input",{"onUpdate:modelValue":C[1]||(C[1]=l=>i.item.title=l),id:"name",class:te([o(x).getValidFeedbackCss(i.item.title),"form-control"]),placeholder:"Title"},null,2),[[Z,i.item.title]]),C[8]||(C[8]=e("label",{for:"title",class:""},"Title",-1)),o(w).item.title.$error?(t(),s("div",ol,[(t(!0),s(U,null,q(o(w).item.title.$errors,l=>(t(),s("div",{key:l.$uid},u(l.$message),1))),128))])):E("",!0)])]),e("div",al,[e("div",ll,[N(e("input",{"onUpdate:modelValue":C[2]||(C[2]=l=>i.item.dateReleased=l),type:"date",step:"1",id:"dateReleased",class:te([o(x).getValidFeedbackCss(i.item.dateReleased),"form-control"])},null,2),[[Z,i.item.dateReleased]]),C[9]||(C[9]=e("label",{for:"dateReleased",class:""},"Date Released",-1))])]),e("div",nl,[e("div",rl,[N(e("input",{"onUpdate:modelValue":C[3]||(C[3]=l=>i.durationTime=l),type:"time",step:"1",id:"durationTime",class:te([o(x).getValidFeedbackCss(i.item.durationTime),"form-control"])},null,2),[[Z,i.durationTime]]),C[10]||(C[10]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",il,[e("div",dl,[N(e("textarea",{"onUpdate:modelValue":C[4]||(C[4]=l=>i.item.description=l),id:"name",class:te([o(x).getValidFeedbackCss(i.item.description),"form-control"]),placeholder:"Description",style:{height:"5rem"}},null,2),[[Z,i.item.description]]),C[11]||(C[11]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",ul,[e("div",cl,[C[12]||(C[12]=e("b",null,"Genres",-1)),e("div",ml,[e("div",fl,[(t(!0),s(U,null,q(i.lookups.genres,l=>(t(),s("div",pl,[e("div",vl,[N(e("input",{"onUpdate:modelValue":m=>l.selected=m,class:"form-check-input",type:"checkbox",id:l.name},null,8,gl),[[qe,l.selected]]),e("label",{class:"form-check-label",for:l.name},u(l.name),9,bl)])]))),256))])])]),e("div",yl,[C[13]||(C[13]=e("b",null,"Categories",-1)),e("div",$l,[(t(!0),s(U,null,q(i.lookups.categories,l=>(t(),s("div",wl,[N(e("input",{"onUpdate:modelValue":m=>l.selected=m,class:"form-check-input",type:"checkbox",id:l.name},null,8,hl),[[qe,l.selected]]),e("label",{class:"form-check-label",for:l.name},u(l.name),9,_l)]))),256))])])]),e("div",kl,[e("div",Sl,[e("button",{onClick:C[5]||(C[5]=l=>v()),class:"btn btn-outline-primary btn-sm"},C[14]||(C[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",Tl,[C[17]||(C[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(i.item.formats,(l,m)=>(t(),s("tr",Il,[e("td",Ml,u(m+1),1),e("td",null,[N(e("select",{"onUpdate:modelValue":a=>l.format=a,class:"form-control"},C[15]||(C[15]=[e("option",{value:"HLS"},"HLS",-1),e("option",{value:"HLS"},"DASH",-1)]),8,xl),[[ge,l.format]])]),e("td",null,[N(e("input",{"onUpdate:modelValue":a=>l.serverUrl=a,type:"text",class:"form-control"},null,8,Cl),[[Z,l.serverUrl]])]),e("td",null,[N(e("input",{"onUpdate:modelValue":a=>l.path=a,type:"text",class:"form-control"},null,8,Vl),[[Z,l.path]])]),e("td",Pl,[e("button",{onClick:a=>Y(m),class:"btn btn-outline-warning btn-sm"},C[16]||(C[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Ol)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Ul=["disabled"],Ll={class:"row row-cols-1 row-cols-sm-3"},Hl={class:"col"},Dl={class:"form-floating mb-2"},El={key:0,class:"d-block invalid-feedback"},ql={class:"col"},Bl={class:"form-floating"},Nl={class:"col"},Rl={class:"form-floating"},Fl={class:"col"},zl={class:"form-floating mb-2"},Gl={class:"row row-cols-1 row-cols-sm-2"},jl={class:"col-sm-8"},Yl={class:"ps-2"},Wl={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border"},Kl={class:"col"},Ql={class:"form-check"},Jl=["onUpdate:modelValue","id"],Xl=["for"],Zl={class:"col-sm-4"},en={class:"border p-2"},tn={class:"form-check"},sn=["onUpdate:modelValue","id"],on=["for"],an={class:"table-responsive mt-2"},ln={class:"text-end"},nn={class:"table table-sm mb-0 mt-2 border1"},rn={class:"align-middle"},dn={class:"text-center"},un=["onUpdate:modelValue"],cn=["value"],mn=["onUpdate:modelValue"],fn=["onUpdate:modelValue"],pn={class:"text-end"},vn=["onClick"],gn={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Edit Video"}),A=n,i=be({lookups:{genres:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}],formats:[]},durationTime:"00:00:00",item:{title:null,description:null,rawBaseUrl:null,rawPath:null,hlsBaseUrl:null,hlsPath:null,durationInMillis:null,formats:[]}}),M={item:{title:{title:ae.withMessage("title is required.",re),$autoDirty:!0,$lazy:!0},durationInMillis:{title:ae.withMessage("durationInMillis is required.",re),$autoDirty:!0,$lazy:!0},dateReleased:{title:ae.withMessage("Date Released is required.",re),$autoDirty:!0,$lazy:!0}}},w=Se(M,i),K=Ie(()=>{const g=x.moment;if(i.durationTime&&i.durationTime!=="00:00:00"&&x.isValidTime(i.durationTime)){const p=g().startOf("day"),y=p.format("YYYY-MM-DD ")+i.durationTime,m=g(y).subtract(p);return i.item.durationInMillis=m.valueOf(),i.item.durationInMillis}return 0});fe(async()=>{await c(),await v(),await X()});const X=async()=>{try{await j.get(`/api/v1/videos/${A.id}/`).then(g=>{i.item=g.data;const p=x.moment(i.item.dateReleased).format("YYYY-MM-DD");i.item.dateReleased=p;const y=i.lookups.genres,l=i.item.genres.map(r=>r.genre);y.forEach(r=>{r.selected=l.includes(r.id)});const m=i.lookups.categories,a=i.item.categories.map(r=>r.category);m.forEach(r=>{r.selected=a.includes(r.id)})})}catch(g){P.value=x.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{}},c=async()=>{try{await j.get("/api/v1/lookups/video-genres/").then(g=>{const y=g.data.filter(l=>l.id!==0);i.lookups.genres=y})}catch(g){P.value=x.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{}},v=async()=>{try{await j.get("/api/v1/lookups/video-formats/").then(g=>{const y=g.data.filter(l=>l.id!==0);i.lookups.formats=y})}catch(g){P.value=x.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{}},Y=async()=>{const g=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const y=x.clone(g.item);y.durationInMillis=K.value;const l=x.moment(g.item.dateReleased).utc(!0).format();y.dateReleased=l;const m=i.lookups.genres.filter(r=>r.selected).map(r=>r.id);y.genres=m;const a=i.lookups.categories.filter(r=>r.selected).map(r=>r.id);y.categories=a;debugger;await j.put("/api/v1/videos/",y).then(r=>{G.success("Edit Video","Video edited.",{onClose:async()=>{const I=`${A.urlView}/${A.id}`;await J.push(I)}})})}catch(y){P.value=x.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{V.value=!1}},d=()=>{const g={format:"HLS",serverUrl:"https://media-tailor-input.s3.us-west-2.amazonaws.com",path:"/sony-poc/vod-1/bbb_2mins.m3u8"};i.item.formats.push(g)},C=g=>{i.item.formats.splice(g,1)};return(g,p)=>{const y=se("router-link"),l=se("PageHeader"),m=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(l,{"page-icon":"fas fa-fw fa-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:p[0]||(p[0]=a=>Y()),class:"btn btn-primary"},p[6]||(p[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Ul),e("button",{onClick:X,class:"btn btn-secondary ms-2"},p[7]||(p[7]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(y,{to:`${n.urlView}/${n.id}`,class:"btn btn-secondary ms-2"},{default:R(()=>p[8]||(p[8]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(m,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[e("div",null,[e("div",Ll,[e("div",Hl,[e("div",Dl,[N(e("input",{"onUpdate:modelValue":p[1]||(p[1]=a=>i.item.title=a),id:"name",class:te([o(x).getValidFeedbackCss(i.item.title),"form-control"]),placeholder:"Title"},null,2),[[Z,i.item.title]]),p[9]||(p[9]=e("label",{for:"title",class:""},"Title",-1)),o(w).item.title.$error?(t(),s("div",El,[(t(!0),s(U,null,q(o(w).item.title.$errors,a=>(t(),s("div",{key:a.$uid},u(a.$message),1))),128))])):E("",!0)])]),e("div",ql,[e("div",Bl,[N(e("input",{"onUpdate:modelValue":p[2]||(p[2]=a=>i.item.dateReleased=a),type:"date",step:"1",id:"dateReleased",class:te([o(x).getValidFeedbackCss(i.item.dateReleased),"form-control"])},null,2),[[Z,i.item.dateReleased]]),p[10]||(p[10]=e("label",{for:"dateReleased",class:""},"Duration Time",-1))])]),e("div",Nl,[e("div",Rl,[N(e("input",{"onUpdate:modelValue":p[3]||(p[3]=a=>i.durationTime=a),type:"time",step:"1",id:"durationTime",class:te([o(x).getValidFeedbackCss(i.item.ddurationTime),"form-control"])},null,2),[[Z,i.durationTime]]),p[11]||(p[11]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",Fl,[e("div",zl,[N(e("textarea",{"onUpdate:modelValue":p[4]||(p[4]=a=>i.item.description=a),id:"name",class:"form-control is-valid",placeholder:"Description",style:{height:"5rem"}},null,512),[[Z,i.item.description]]),p[12]||(p[12]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",Gl,[e("div",jl,[p[13]||(p[13]=e("b",null,"Genres",-1)),e("div",Yl,[e("div",Wl,[(t(!0),s(U,null,q(i.lookups.genres,a=>(t(),s("div",Kl,[e("div",Ql,[N(e("input",{"onUpdate:modelValue":r=>a.selected=r,class:"form-check-input",type:"checkbox",id:a.name},null,8,Jl),[[qe,a.selected]]),e("label",{class:"form-check-label",for:a.name},u(a.name),9,Xl)])]))),256))])])]),e("div",Zl,[p[14]||(p[14]=e("b",null,"Categories",-1)),e("div",en,[(t(!0),s(U,null,q(i.lookups.categories,a=>(t(),s("div",tn,[N(e("input",{"onUpdate:modelValue":r=>a.selected=r,class:"form-check-input",type:"checkbox",id:a.name},null,8,sn),[[qe,a.selected]]),e("label",{class:"form-check-label",for:a.name},u(a.name),9,on)]))),256))])])]),e("div",an,[e("div",ln,[e("button",{onClick:p[5]||(p[5]=a=>d()),class:"btn btn-outline-primary btn-sm"},p[15]||(p[15]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",nn,[p[17]||(p[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(i.item.formats,(a,r)=>(t(),s("tr",rn,[e("td",dn,u(r+1),1),e("td",null,[N(e("select",{"onUpdate:modelValue":I=>a.format=I,class:"form-control"},[(t(!0),s(U,null,q(i.lookups.formats,I=>(t(),s("option",{value:I.id},u(I.name),9,cn))),256))],8,un),[[ge,a.format]])]),e("td",null,[N(e("input",{"onUpdate:modelValue":I=>a.serverUrl=I,type:"text",class:"form-control"},null,8,mn),[[Z,a.serverUrl]])]),e("td",null,[N(e("input",{"onUpdate:modelValue":I=>a.path=I,type:"text",class:"form-control"},null,8,fn),[[Z,a.path]])]),e("td",pn,[e("button",{onClick:I=>C(r),class:"btn btn-outline-warning btn-sm"},p[16]||(p[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,vn)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},bn={class:"ms-2"},yn={class:"input-group"},$n=["value"],wn={class:"ms-1"},hn={class:"input-group"},_n={class:"ms-1"},kn={class:"input-group"},Sn={class:"table-responsive border shadow-sm"},Tn={class:"table table-hover mb-0"},In=["textContent"],Mn={class:"d-flex flex-row justify-content-start"},xn={class:"mt-1"},Cn=["src"],Vn={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Pn={class:"ms-2"},On={key:0},An={class:"badge bg-primary me-1"},Un={key:1},Ln={class:"badge bg-info me-1"},Hn={class:"text-center"},Dn={class:"text-end"},En=["onClick"],qn={key:0,class:"fas fa-fw fa-chevron-circle-up"},Bn={key:1,class:"fas fa-fw fa-chevron-circle-down"},Nn={key:0},Rn={colspan:"999"},Fn={class:""},zn={class:"d-flex flex-column flex-lg-row justify-content-between g-2"},Gn={class:"col mb-2"},jn={class:"col col-lg-auto mx-lg-5 px-lg-5 mb-2"},Yn={class:"col col-lg-auto mb-2"},Wn={key:0},Kn={class:"badge bg-secondary me-1"},Qn="/api/v1/videos/search",Jn={__name:"index",props:{urlAdd:{type:String,default:"/videos/add"},urlView:{type:String,default:"/videos/view"}},setup(n){Me("$config");const T=he().user,{appTitle:V,pageTitle:_,busy:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,security:i,filter:M,initializeFilter:w,getQuery:K,saveQuery:X,search:c,getRowNumber:v,setSelected:Y,isSelected:d}=Le({appTitle:"Arcadian-FAST",pageTitle:"Videos",cacheKey:`${T==null?void 0:T.userId}/videos/search`,baseUrl:Qn,filter:{updateUrl:!0,lookups:{genres:[]},query:{genre:0,category:0}},initializeFilter:(g,p)=>{const y=g.value,l=new URLSearchParams(window.location.search),m=JSON.parse(localStorage.getItem(p))||{};y.query.genre=l.get("genre")||m.genre||y.query.genre||0,y.query.category=l.get("category")||m.category||y.query.category||0},getQuery:g=>["?c=",encodeURIComponent(g.query.criteria),"&p=",g.pageIndex,"&s=",g.pageSize,"&sf=",g.sortField,"&so=",g.sortOrder,"&genre=",g.query.genre,"&category=",g.query.category].join(""),saveQuery:(g,p)=>{localStorage.setItem(p,JSON.stringify({criteria:g.query.criteria,pageIndex:g.pageIndex,pageSize:g.pageSize,sortField:g.sortField,sortOrder:g.sortOrder,visible:g.visible,genre:g.query.genre,category:g.query.category}))}});fe(async()=>{w(),await C(),await c()});const C=async()=>{try{await G.get("/api/v1/lookups/video-genres/").then(g=>{const p=g.data;M.value.lookups.genres=p})}catch(g){j.value=oe.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{}};return(g,p)=>{const y=se("router-link"),l=se("PageHeader"),m=se("m-pagination"),a=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(l,{"page-icon":"fas fa-fw fa-video",pageTitle:o(_)},{default:R(()=>[z(y,{to:n.urlAdd,class:"btn btn-primary"},{default:R(()=>p[5]||(p[5]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",bn,[e("div",yn,[p[6]||(p[6]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),N(e("select",{"onUpdate:modelValue":p[0]||(p[0]=r=>o(M).query.genre=r),class:"form-select"},[(t(!0),s(U,null,q(o(M).lookups.genres,r=>(t(),s("option",{value:r.id},u(r.name),9,$n))),256))],512),[[ge,o(M).query.genre]])])]),e("div",wn,[e("div",hn,[p[8]||(p[8]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),N(e("select",{"onUpdate:modelValue":p[1]||(p[1]=r=>o(M).query.category=r),class:"form-select"},p[7]||(p[7]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[ge,o(M).query.category]])])]),e("div",_n,[e("div",kn,[N(e("input",{"onUpdate:modelValue":p[2]||(p[2]=r=>o(M).query.criteria=r),onKeyup:p[3]||(p[3]=Ue(r=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[Z,o(M).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:p[4]||(p[4]=r=>o(c)(1))},p[9]||(p[9]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(a,{errorMessage:o(j)},{default:R(()=>[e("div",Sn,[e("table",Tn,[p[14]||(p[14]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title"),e("th",{class:"text-center"},"Duration"),e("th")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(M).items,(r,I)=>(t(),s(U,{key:r.videoId},[e("tr",null,[e("td",{textContent:u(o(v)(I)),class:"text-center"},null,8,In),e("td",null,[e("div",Mn,[e("div",null,[r.thumbnails.length>0?(t(!0),s(U,{key:0},q(r.thumbnails,h=>(t(),s("div",xn,[e("img",{src:h.url,class:"img-fuild border",width:"128"},null,8,Cn)]))),256)):(t(),s("img",Vn))]),e("div",Pn,[z(y,{to:`${n.urlView}/${r.videoId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[Q(u(r.title),1)]),_:2},1032,["to"]),e("div",null,[r.categories.length>0?(t(),s("div",On,[(t(!0),s(U,null,q(r.categories,h=>(t(),s("span",An,u(h.categoryName),1))),256))])):E("",!0),r.genres.length>0?(t(),s("div",Un,[(t(!0),s(U,null,q(r.genres,h=>(t(),s("span",Ln,u(h.genreName),1))),256))])):E("",!0)])])])]),e("td",Hn,u(o(oe).moment.utc(r.durationInMillis).format("HH:mm:ss")),1),e("td",Dn,[e("button",{onClick:h=>r.expand=!r.expand,class:te([[r.expand?"btn-primary":"btn-outline-primary"],"btn btn-sm"])},[r.expand?(t(),s("span",qn)):(t(),s("span",Bn))],10,En)])]),r.expand?(t(),s("tr",Nn,[p[13]||(p[13]=e("td",null,null,-1)),e("td",Rn,[e("div",Fn,[e("div",zn,[e("div",Gn,[p[10]||(p[10]=e("label",{class:"form-label"},"Description",-1)),e("div",null,u(r.description),1)]),e("div",jn,[p[11]||(p[11]=e("h6",{class:"fw-bold"},"Date Released",-1)),e("div",null,u(o(rt).utc(r.dateReleased).format("l")),1)]),e("div",Yn,[p[12]||(p[12]=e("h6",{class:"fw-bold"},"Formats",-1)),r.formats.length>0?(t(),s("div",Wn,[(t(!0),s(U,null,q(r.formats,h=>(t(),s("span",Kn,u(h.formatName),1))),256))])):E("",!0)])])])])])):E("",!0)],64))),128))]),_:1},512),[[ke,o(M).items.length>0]])])]),z(m,{filter:o(M),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Xn={key:0},Zn={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},er={class:"nav-item",role:"presentation"},tr={class:"nav-item",role:"presentation"},sr={class:"nav-item",role:"presentation"},or={class:"nav-item",role:"presentation"},ar={class:"tab-content",id:"myTabContent"},lr={class:"mt-2"},nr={class:"row row-cols-1 row-cols-sm-2"},rr={class:"col"},ir=["id"],dr={class:"col"},ur={class:"col"},cr={class:"form-floating mb-2"},mr={class:"row row-cols-1 row-cols-sm-2"},fr={class:"col"},pr={class:"form-floating mb-2"},vr={class:"col"},gr={class:"form-floating mb-2"},br={class:"col"},yr={class:"form-floating mb-2"},$r={class:"mt-1"},wr={class:"badge bg-info me-1"},hr={class:"badge bg-primary me-1"},_r={class:"mt-2"},kr={class:"table-responsive border"},Sr={class:"table table-hover mb-0"},Tr={class:"table-group-divider"},Ir={class:"align-middle"},Mr={class:"text-center"},xr={class:"mt-2"},Cr={class:"text-end"},Vr={class:"table-responsive border mt-2"},Pr={class:"table table-hover mb-0 caption-top"},Or={class:"mt-2"},Ar={class:"table-responsive"},Ur={class:"table table-hover mb-0 caption-top"},Lr={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/videos"},urlEdit:{type:String,default:"/videos/edit"},urlAddVodSource:{type:String,default:"/vod-sources/add"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(n){const f=n,{appTitle:T,pageTitle:V,busy:_,isDirty:H,validations:P,infoMessage:J,warningMessage:j,errorMessage:x,router:G,axios:oe,utils:B,toasts:A,close:i,closeWithReturnUrl:M,generateReturnUrl:w,security:K}=$e({appTitle:"Arcadian-FAST",pageTitle:"View Video"});Me("$config");const X=he();X.user;const c=be({user:X.user,item:null,hls:null}),v=ce();fe(async()=>{await g(),v.value=B.getPageTab("video")||"information-tab"}),Ae(()=>{c.hls&&(c.hls.stopLoad(),c.hls.destroy())});const Y=m=>{B.setPageTab("video",m),v.value=m},d=m=>m!==v.value?"":"active",C=m=>m!==v.value?"":"show active",g=async()=>{const m=c;if(!_.value)try{_.value=!0,x.value="",c.item=null;const a=`/api/v1/videos/${f.id}/`;await oe.get(a).then(r=>{m.item=r.data,m.item.duration=B.moment.utc(m.item.durationInMillis).format("HH:mm:ss"),m.item.dateReleased=B.moment.utc(m.item.dateReleased).format("ll")}),y()}catch(a){x.value=B.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{_.value=!1}},p=async()=>{await g()},y=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?"),c.hls&&c.hls.destroy();const a=`video-${c.item.videoId}`;var m=document.getElementById(a);const r=c.item.formats.find(h=>h.formatName==="HLS"),I=r.serverUrl+r.path;c.hls=B.createHlsStream(m,I,!1),c.hls.startLoad(-1)}},l=async()=>{if(!_.value)try{_.value=!0,x.value="";const m=`/api/v1/videos/${f.id}/get-blank-frames/`;await oe.post(m).then(a=>{}),_.value=!1,await p()}catch(m){x.value=B.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{_.value=!1}};return(m,a)=>{const r=se("router-link"),I=se("PageHeader"),h=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(I,{"page-icon":"fas fa-fw fa-video",pageTitle:o(V)},{default:R(()=>[z(r,{to:`${n.urlEdit}/${n.id}`,class:"btn btn-primary ms-1"},{default:R(()=>a[11]||(a[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:a[0]||(a[0]=b=>p()),class:"ms-2 btn btn-secondary"},a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:a[1]||(a[1]=b=>o(M)(f.urlMain)),class:"btn btn-secondary ms-1"},a[13]||(a[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(h,{errorMessage:o(x)},{default:R(()=>[c.item?(t(),s("div",Xn,[e("div",null,[e("ul",Zn,[e("li",er,[e("button",{onClick:a[2]||(a[2]=b=>Y("information-tab")),class:te([d("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",tr,[e("button",{onClick:a[3]||(a[3]=b=>Y("formats-tab")),class:te([d("formats-tab"),"nav-link"]),id:"formats-tab","data-bs-toggle":"tab","data-bs-target":"#formats",type:"button",role:"tab","aria-controls":"formats","aria-selected":"false"}," Formats ",2)]),e("li",sr,[e("button",{onClick:a[4]||(a[4]=b=>Y("blankFrames-tab")),class:te([d("blankFrames-tab"),"nav-link"]),id:"blankFrames-tab","data-bs-toggle":"tab","data-bs-target":"#blankFrames",type:"button",role:"tab","aria-controls":"blankFrames","aria-selected":"false"}," Blank Frames ",2)]),e("li",or,[e("button",{onClick:a[5]||(a[5]=b=>Y("vodSources-tab")),class:te([d("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)])]),e("div",ar,[e("div",{class:te([C("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",lr,[e("div",nr,[e("div",rr,[e("video",{id:`video-${c.item.videoId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,ir)]),e("div",dr,[e("div",ur,[e("div",cr,[N(e("input",{"onUpdate:modelValue":a[6]||(a[6]=b=>c.item.title=b),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[Z,c.item.title]]),a[14]||(a[14]=e("label",{for:"title"},"Title",-1))])]),e("div",mr,[e("div",fr,[e("div",pr,[N(e("input",{"onUpdate:modelValue":a[7]||(a[7]=b=>c.item.dateReleased=b),type:"text",class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},null,512),[[Z,c.item.dateReleased]]),a[15]||(a[15]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",vr,[e("div",gr,[N(e("input",{"onUpdate:modelValue":a[8]||(a[8]=b=>c.item.duration=b),type:"text",class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},null,512),[[Z,c.item.duration]]),a[16]||(a[16]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",br,[e("div",yr,[N(e("textarea",{"onUpdate:modelValue":a[9]||(a[9]=b=>c.item.description=b),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[Z,c.item.description]]),a[17]||(a[17]=e("label",{for:"description"},"Description",-1))])]),e("div",$r,[(t(!0),s(U,null,q(c.item.genres,b=>(t(),s("span",wr,u(b.genreName),1))),256)),(t(!0),s(U,null,q(c.item.categories,b=>(t(),s("span",hr,u(b.categoryName),1))),256))])])])])],2),e("div",{class:te([C("formats-tab"),"tab-pane fade"]),id:"formats",role:"tabpanel","aria-labelledby":"formats-tab"},[e("div",_r,[e("div",kr,[e("table",Sr,[a[18]||(a[18]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",Tr,[(t(!0),s(U,null,q(c.item.formats,(b,O)=>(t(),s("tr",Ir,[e("td",Mr,u(O+1),1),e("td",null,u(b.formatName),1),e("td",null,u(b.serverUrl),1),e("td",null,u(b.path),1)]))),256))])])])])],2),e("div",{class:te([C("blankFrames-tab"),"tab-pane fade"]),id:"blankFrames",role:"tabpanel","aria-labelledby":"blankFrames-tab"},[e("div",xr,[e("div",null,[e("div",Cr,[e("button",{onClick:a[10]||(a[10]=b=>l()),class:"btn btn-outline-primary btn-sm"},a[19]||(a[19]=[e("span",{class:"fas fa-fw fa-gear me-1"},null,-1),Q("Process ")]))]),e("div",Vr,[e("table",Pr,[a[20]||(a[20]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Start"),e("th",null,"End"),e("th",null,"Duration")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.blankFrames,(b,O)=>(t(),s("tr",{key:b.videoBlankFrameId},[e("td",null,u(O+1),1),e("td",null,u(o(B).moment.utc(b.startInMillis).format("HH:mm:ss")),1),e("td",null,u(o(B).moment.utc(b.endInMillis).format("HH:mm:ss")),1),e("td",null,u(o(B).moment.utc(b.durationInMillis).format("HH:mm:ss")),1)]))),128))]),_:1},512),[[ke,c.item.blankFrames.length>0]])])])])])],2),e("div",{class:te([C("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",Or,[e("div",Ar,[e("table",Ur,[a[21]||(a[21]=e("caption",null,"VOD Sources",-1)),a[22]||(a[22]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.vodSources,(b,O)=>(t(),s("tr",{key:b.vodSourceId},[e("td",null,u(O+1),1),e("td",null,[z(r,{to:`${f.urlViewVodSource}/${encodeURIComponent(b.vodSourceId)}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(b.name),1)]),_:2},1032,["to"])])]))),128))]),_:1},512),[[ke,c.item.vodSources.length>0]])])])])],2)])])])):E("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Hr=["disabled"],Dr={class:"form-floating mb-2"},Er={key:0,class:"d-block invalid-feedback"},qr={__name:"add",props:{urlView:{type:String,default:"/source-groups/view"},urlMain:{type:String,default:"/source-groups"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Source Group"}),A=n,i=be({lookups:{},item:{name:null}}),M={item:{name:{required:ae.withMessage("name is required.",re),$autoDirty:!0,$lazy:!0}}},w=Se(M,i);fe(async()=>{});const K=async()=>{const X=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const v=x.clone(X.item);await j.post("/api/v1/sourcegroups/",v).then(Y=>{G.success("Add Source Group","Source group added.",{onClose:async()=>{const d=`${A.urlView}/${Y.data}`;await J.push(d)}})})}catch(v){P.value=x.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{V.value=!1}};return(X,c)=>{const v=se("router-link"),Y=se("PageHeader"),d=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(Y,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:c[0]||(c[0]=C=>K()),class:"btn btn-primary"},c[2]||(c[2]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Hr),z(v,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>c[3]||(c[3]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(d,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[e("div",null,[e("div",Dr,[N(e("input",{"onUpdate:modelValue":c[1]||(c[1]=C=>i.item.name=C),type:"text",class:te([o(x).getValidFeedbackCss(i.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[Z,i.item.name]]),c[4]||(c[4]=e("label",{for:"name"},"Name",-1)),o(w).item.name.$error?(t(),s("div",Er,[(t(!0),s(U,null,q(o(w).item.name.$errors,C=>(t(),s("div",{key:C.$uid},u(C.$message),1))),128))])):E("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Br={key:0,class:"d-flex justify-content-end"},Nr=["disabled"],Rr={key:0},Fr={class:"row row-cols-1 row-cols-sm-2"},zr={class:"col"},Gr={class:"form-floating mb-2"},jr={key:0,class:"d-block invalid-feedback"},Yr={class:"col"},Wr={class:"form-floating mb-2"},Kr={key:0,class:"d-block invalid-feedback"},Qr={class:"row row-cols-sm-2"},Jr={class:"col"},Xr={class:"form-floating mb-2"},Zr={class:"form-floating mb-2"},ei={key:0,class:"d-block invalid-feedback"},ti={class:"form-floating mb-2"},si={key:0,class:"d-block invalid-feedback"},oi={class:"col"},ai={class:"form-floating mb-2"},st={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,required:!0}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"ARC CMS",pageTitle:"Edit Movie"}),A=n,i=be({editorElementId:"editor",htmlContent:"",item:null}),M={item:{title:{required:ae.withMessage("Title is required.",re),$autoDirty:!0,$lazy:!0},eidr:{required:ae.withMessage("eidr is required.",re),$autoDirty:!0,$lazy:!0},eidrPrefix:{required:ae.withMessage("eidrPrefix is required.",re),$autoDirty:!0,$lazy:!0}},htmlContent:{required:ae.withMessage("Content is required.",re),$autoDirty:!0,$lazy:!0}},w=Se(M,i);fe(async()=>{await c()});const K=()=>{const Y=i;var d=document.getElementById(Y.editorElementId);d.innerHTML=Y.htmlContent},X=Y=>{const d=i;d.htmlContent=Y.target.innerHTML;var C=document.getElementById(d.editorElementId);C.value=d.htmlContent},c=async()=>{const Y=i;if(!V.value)try{V.value=!0,i.item=null,await j.get(`/api/v1/movies/${A.id}`).then(d=>{Y.item=d.data,Y.htmlContent=Y.item.description}),K()}catch(d){P.value=x.getErrorMessageAsHtml(d)}finally{V.value=!1}},v=async()=>{const Y=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const C=x.clone(Y.item);C.description=Y.htmlContent,await j.put("/api/v1/movies",C).then(g=>{G.success("Edit Movie","Movie edited",{onClose:async()=>{const p=`${A.urlView}/${A.id}`;await J.push(p)}})})}catch(C){P.value=x.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{V.value=!1}};return(Y,d)=>{const C=se("router-link"),g=se("PageHeader"),p=se("PageBody");return t(),s("div",null,[z(g,{"page-icon":"fas fa-fw fa-film",pageTitle:o(T),"header-break":"row row-cols-2 row-cols-sm-2"},{default:R(()=>[i.item?(t(),s("div",Br,[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:d[0]||(d[0]=y=>v()),class:"btn btn-primary"},d[7]||(d[7]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Nr),e("button",{onClick:c,class:"ms-2 btn btn-secondary"},d[8]||(d[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(C,{to:`${A.urlView}/${A.id}`,class:"ms-1 btn btn-secondary"},{default:R(()=>d[9]||(d[9]=[e("i",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])])):E("",!0)]),_:1},8,["pageTitle"]),z(p,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[i.item?(t(),s("div",Rr,[e("div",Fr,[e("div",zr,[e("div",Gr,[N(e("input",{"onUpdate:modelValue":d[1]||(d[1]=y=>i.item.eidrPrefix=y),type:"text",class:"form-control",id:"eidrPrefix",placeholder:"Eidr Prefix"},null,512),[[Z,i.item.eidrPrefix]]),d[10]||(d[10]=e("label",{for:"title"},"Eidr Prefix",-1)),o(w).item.eidrPrefix.$error?(t(),s("div",jr,[(t(!0),s(U,null,q(o(w).item.eidrPrefix.$errors,y=>(t(),s("div",{key:y.$uid},u(y.$message),1))),128))])):E("",!0)])]),e("div",Yr,[e("div",Wr,[N(e("input",{"onUpdate:modelValue":d[2]||(d[2]=y=>i.item.eidr=y),type:"text",class:"form-control",id:"eidr",placeholder:"Eidr"},null,512),[[Z,i.item.eidr]]),d[11]||(d[11]=e("label",{for:"title"},"Eidr",-1)),o(w).item.eidr.$error?(t(),s("div",Kr,[(t(!0),s(U,null,q(o(w).item.eidr.$errors,y=>(t(),s("div",{key:y.$uid},u(y.$message),1))),128))])):E("",!0)])])]),e("div",Qr,[e("div",Jr,[e("div",Xr,[N(e("input",{"onUpdate:modelValue":d[3]||(d[3]=y=>i.item.releaseYear=y),type:"number",class:"form-control",id:"releaseYear",placeholder:"Release Year"},null,512),[[Z,i.item.releaseYear]]),d[12]||(d[12]=e("label",{for:"title"},"Release Year",-1))])]),e("div",null,[e("div",Zr,[N(e("input",{"onUpdate:modelValue":d[4]||(d[4]=y=>i.item.title=y),type:"text",class:"form-control",id:"title",placeholder:"Title"},null,512),[[Z,i.item.title]]),d[13]||(d[13]=e("label",{for:"title"},"Title",-1)),o(w).item.title.$error?(t(),s("div",ei,[(t(!0),s(U,null,q(o(w).item.title.$errors,y=>(t(),s("div",{key:y.$uid},u(y.$message),1))),128))])):E("",!0)])])]),e("div",null,[e("div",ti,[e("div",{id:"editor",name:"editor",contenteditable:"true",role:"textbox",class:"form-control",spellcheck:"true",style:{"min-height":"100px",height:"auto",overflow:"auto","user-select":"text","white-space":"pre-wrap","word-break":"break-word"},onInput:d[5]||(d[5]=y=>X(y))},null,32),d[14]||(d[14]=e("label",{for:"editor"},"Content",-1)),o(w).htmlContent.$error?(t(),s("div",si,[(t(!0),s(U,null,q(o(w).htmlContent.$errors,y=>(t(),s("div",{key:y.$uid},u(y.$message),1))),128))])):E("",!0)])]),e("div",oi,[e("div",ai,[N(e("textarea",{"onUpdate:modelValue":d[6]||(d[6]=y=>i.item.metadata=y),rows:"4",class:"form-control",id:"metadata",placeholder:"Metadata",style:{height:"125px"}},null,512),[[Z,i.item.metadata]]),d[15]||(d[15]=e("label",{for:"title"},"Metadata",-1))])])])):E("",!0)]),_:1},8,["errorMessage","vuelidate"])])}}},li={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function ni(n,f,T,V,_,H){const P=se("Page");return t(),ve(P,{id:T.id,urlView:T.urlView},null,8,["id","urlView"])}const ri=Ve(li,[["render",ni]]),ii={class:"ms-2"},di={class:"input-group"},ui={class:"table-responsive border shadow-sm"},ci={class:"table table-hover mb-0"},mi=["textContent"],fi={key:0,class:"fas fa-fw fa-check-circle text-success"},pi="/api/v1/sourcegroups/search",vi={__name:"index",props:{urlAdd:{type:String,default:"/source-groups/add"},urlView:{type:String,default:"/source-groups/view"}},setup(n){Me("$config");const T=he().user,{appTitle:V,pageTitle:_,busy:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,security:i,filter:M,initializeFilter:w,getQuery:K,saveQuery:X,search:c,getRowNumber:v,setSelected:Y,isSelected:d}=Le({appTitle:"Arcadian-FAST",pageTitle:"Source Groups",cacheKey:`${T==null?void 0:T.userId}/source-groups/search`,baseUrl:pi,filter:{updateUrl:!0}});return fe(async()=>{w(),await c()}),(C,g)=>{const p=se("router-link"),y=se("PageHeader"),l=se("m-pagination"),m=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(y,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(_)},{default:R(()=>[z(p,{to:n.urlAdd,class:"btn btn-primary"},{default:R(()=>g[3]||(g[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",ii,[e("div",di,[N(e("input",{"onUpdate:modelValue":g[0]||(g[0]=a=>o(M).query.criteria=a),onKeyup:g[1]||(g[1]=Ue(a=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria..."},null,544),[[Z,o(M).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:g[2]||(g[2]=a=>o(c)(1))},g[4]||(g[4]=[e("span",{class:"fas fa-fw fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(m,{errorMessage:o(j)},{default:R(()=>[e("div",ui,[e("table",ci,[g[5]||(g[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",null,"# of Channel Outputs"),e("th",null,"# of Package Configurations")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(M).items,(a,r)=>(t(),s("tr",{key:a.sourceGroupId},[e("td",{textContent:u(o(v)(r)),class:"text-center"},null,8,mi),e("td",null,[z(p,{to:`${n.urlView}/${a.sourceGroupId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[a.arn?(t(),s("span",fi)):E("",!0),Q(" "+u(a.name),1)]),_:2},1032,["to"])]),e("td",null,u(a.channelOutputs),1),e("td",null,u(a.packageConfigurations),1)]))),128))]),_:1},512),[[ke,o(M).items.length>0]])])]),z(l,{filter:o(M),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},gi={key:0},bi={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},yi={class:"nav-item",role:"presentation"},$i={class:"nav-item",role:"presentation"},wi={class:"nav-item",role:"presentation"},hi={class:"tab-content",id:"myTabContent"},_i={class:"mt-2"},ki={class:"form-floating mb-2"},Si={class:"mt-2"},Ti={class:"table-responsive border"},Ii={class:"table table-hover mb-0"},Mi={class:"mt-2"},xi={class:"table-responsive border"},Ci={class:"table table-hover mb-0"},Vi={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-groups"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const f=n,{appTitle:T,pageTitle:V,busy:_,isDirty:H,validations:P,infoMessage:J,warningMessage:j,errorMessage:x,router:G,axios:oe,utils:B,toasts:A,close:i,closeWithReturnUrl:M,generateReturnUrl:w,security:K}=$e({appTitle:"Arcadian-FAST",pageTitle:"View Source Group"});Me("$config");const X=he();X.user;const c=be({user:X.user,item:null}),v=ce();fe(async()=>{await g(),v.value=B.getPageTab("sourceGroup")||"information-tab"});const Y=l=>{B.setPageTab("sourceGroup",l),v.value=l},d=l=>l!==v.value?"":"active",C=l=>l!==v.value?"":"show active",g=async()=>{const l=c;if(!_.value)try{_.value=!0,x.value="",c.item=null;const m=`/api/v1/sourcegroups/${f.id}/`;await oe.get(m).then(a=>{l.item=a.data})}catch(m){x.value=B.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{_.value=!1}},p=async()=>{if(!_.value)try{_.value=!0,x.value="";const l=`/api/v1/sourcegroups/${f.id}/`;await oe.delete(l).then(m=>{A.success("Delete Source Group","Source group was deleted.",{onClose:async()=>{const a=`${f.urlMain}/`;await G.push(a)}})})}catch(l){x.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{_.value=!1}},y=async()=>{await g()};return(l,m)=>{const a=se("PageHeader"),r=se("router-link"),I=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(a,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(V)},{default:R(()=>[e("button",{onClick:m[0]||(m[0]=h=>p()),class:"ms-1 btn btn-warning"},m[7]||(m[7]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)])),e("button",{onClick:m[1]||(m[1]=h=>y()),class:"ms-2 btn btn-secondary"},m[8]||(m[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:m[2]||(m[2]=h=>o(M)(f.urlMain)),class:"btn btn-secondary ms-1"},m[9]||(m[9]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(I,{errorMessage:o(x)},{default:R(()=>[c.item?(t(),s("div",gi,[e("div",null,[e("ul",bi,[e("li",yi,[e("button",{onClick:m[3]||(m[3]=h=>Y("information-tab")),class:te([d("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",$i,[e("button",{onClick:m[4]||(m[4]=h=>Y("channelOutputs-tab")),class:te([d("channelOutputs-tab"),"nav-link"]),id:"channelOutputs-tab","data-bs-toggle":"tab","data-bs-target":"#channelOutputs",type:"button",role:"tab","aria-controls":"channelOutputs","aria-selected":"false"}," Channel Outputs ",2)]),e("li",wi,[e("button",{onClick:m[5]||(m[5]=h=>Y("packageConfigurations-tab")),class:te([d("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)])]),e("div",hi,[e("div",{class:te([C("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",_i,[e("div",ki,[N(e("input",{"onUpdate:modelValue":m[6]||(m[6]=h=>c.item.name=h),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[Z,c.item.name]]),m[10]||(m[10]=e("label",{for:"name"},"Name",-1))])])],2),e("div",{class:te([C("channelOutputs-tab"),"tab-pane fade"]),id:"channelOutputs",role:"tabpanel","aria-labelledby":"channelOutputs-tab"},[e("div",Si,[e("div",Ti,[e("table",Ii,[m[11]||(m[11]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Output Type")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.channelOutputs,(h,b)=>(t(),s("tr",{key:h.channelOutputId},[e("td",null,u(b+1),1),e("td",null,[z(r,{to:`${n.urlViewChannel}/${h.channelId}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(h.manifestName),1)]),_:2},1032,["to"])]),e("td",null,u(h.outputType),1)]))),128))]),_:1},512),[[ke,c.item.channelOutputs.length>0]])])])])],2),e("div",{class:te([C("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",Mi,[e("div",xi,[e("table",Ci,[m[12]||(m[12]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"VOD Source"),e("th",null,"Path"),e("th",null,"Type")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.packageConfigurations,(h,b)=>(t(),s("tr",{key:h.packageConfigurationId},[e("td",null,u(b+1),1),e("td",null,[z(r,{to:`${n.urlViewVodSource}/${h.vodSourceId}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(h.vodSource.name),1)]),_:2},1032,["to"])]),e("td",null,u(h.path),1),e("td",null,u(h.type),1)]))),128))]),_:1},512),[[ke,c.item.packageConfigurations.length>0]])])])])],2)])])])):E("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Pi=["disabled"],Oi={class:"form-floating mb-2"},Ai={key:0,class:"d-block invalid-feedback"},Ui={class:"form-floating mb-2"},Li={key:0,class:"d-block invalid-feedback"},Hi={__name:"add",props:{urlView:{type:String,default:"/source-locations/view"},urlMain:{type:String,default:"/source-locations"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Source Location"}),A=n,i=be({lookups:{},item:{name:null,httpConfigurationBaseUrl:null}}),M={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},httpConfigurationBaseUrl:{required:ae.withMessage("HTTP Configuration Base Url is required.",re),$autoDirty:!0,$lazy:!0}}},w=Se(M,i);fe(async()=>{});const K=async()=>{const X=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const v=x.clone(X.item);await j.post("/api/v1/sourcelocations/",v).then(Y=>{G.success("Add Source Location","Source location added.",{onClose:async()=>{const d=`${A.urlView}/${Y.data}`;await J.push(d)}})})}catch(v){P.value=x.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{V.value=!1}};return(X,c)=>{const v=se("router-link"),Y=se("PageHeader"),d=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(Y,{"page-icon":"fas fa-fw fa-building",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:c[0]||(c[0]=C=>K()),class:"btn btn-primary"},c[3]||(c[3]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Pi),z(v,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>c[4]||(c[4]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(d,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[e("div",null,[e("div",Oi,[N(e("input",{"onUpdate:modelValue":c[1]||(c[1]=C=>i.item.name=C),type:"text",class:te([o(x).getValidFeedbackCss(i.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[Z,i.item.name]]),c[5]||(c[5]=e("label",{for:"name"},"Name",-1)),o(w).item.name.$error?(t(),s("div",Ai,[(t(!0),s(U,null,q(o(w).item.name.$errors,C=>(t(),s("div",{key:C.$uid},u(C.$message),1))),128))])):E("",!0)]),e("div",Ui,[N(e("textarea",{"onUpdate:modelValue":c[2]||(c[2]=C=>i.item.httpConfigurationBaseUrl=C),type:"text",class:te([o(x).getValidFeedbackCss(i.item.httpConfigurationBaseUrl),"form-control"]),id:"httpConfigurationBaseUrl",placeholder:"HTTP Configuration Base Url",style:{height:"8rem"}},null,2),[[Z,i.item.httpConfigurationBaseUrl]]),c[6]||(c[6]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1)),o(w).item.httpConfigurationBaseUrl.$error?(t(),s("div",Li,[(t(!0),s(U,null,q(o(w).item.httpConfigurationBaseUrl.$errors,C=>(t(),s("div",{key:C.$uid},u(C.$message),1))),128))])):E("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Di={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function Ei(n,f,T,V,_,H){const P=se("Page");return t(),ve(P,{id:T.id,urlView:T.urlView},null,8,["id","urlView"])}const qi=Ve(Di,[["render",Ei]]),Bi={class:"ms-1"},Ni={class:"input-group"},Ri={class:"table-responsive border shadow-sm"},Fi={class:"table table-hover mb-0"},zi={class:"text-center"},Gi=["textContent"],ji={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Yi={class:"text-center"},Wi=["onUpdate:modelValue"],Ki="/api/v1/sourcelocations/search",Qi={__name:"index",props:{urlAdd:{type:String,default:"/source-locations/add"},urlView:{type:String,default:"/source-locations/view"}},setup(n){Me("$config");const T=he().user,{appTitle:V,pageTitle:_,busy:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,security:i,filter:M,initializeFilter:w,getQuery:K,saveQuery:X,search:c,getRowNumber:v,setSelected:Y,isSelected:d}=Le({appTitle:"Arcadian-FAST",pageTitle:"Source Locations",cacheKey:`${T==null?void 0:T.userId}/source-locations/search`,baseUrl:Ki,filter:{updateUrl:!0}}),C=Ie(()=>{const y=M.value;return y&&y.items?y.items.filter(a=>a.selected):null});fe(async()=>{w(),await c()});const g=async()=>{if(!(C.length<=0||!confirm("The selected Source Location(s) will be submitted to AWS MediaTailer. Are you sure you want to publish the selected Source Location(s)?"))&&!H.value){j.value=null;try{H.value=!0;const m={sourceLocationIds:C.value.map(a=>a.sourceLocationId)};await G.post("/api/v1/sourceLocations/publish/",m).then(a=>{B.success("Publish Source Location(s)","Source Location(s) was published.",{async onClose(){}})}),H.value=!1,await c()}catch(l){j.value=oe.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{H.value=!1}}},p=async()=>{if(!(C.length<=0||!confirm("The selected Source Location(s) will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected Source Location(s)?"))&&!H.value){j.value=null;try{H.value=!0;const m={sourceLocationIds:C.value.map(a=>a.sourceLocationId)};await G.post("/api/v1/sourceLocations/unpublish/",m).then(a=>{B.success("Unpublish Source Location(s)","Source Location(s) was inpublished.",{async onClose(){}})}),H.value=!1,await c()}catch(l){j.value=oe.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{H.value=!1}}};return(y,l)=>{const m=se("router-link"),a=se("PageHeader"),r=se("m-pagination"),I=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(a,{"page-icon":"fas fa-fw fa-building",pageTitle:o(_)},{default:R(()=>[z(m,{to:n.urlAdd,class:"btn btn-primary ms-2"},{default:R(()=>l[3]||(l[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Bi,[e("div",Ni,[N(e("input",{"onUpdate:modelValue":l[0]||(l[0]=h=>o(M).query.criteria=h),onKeyup:l[1]||(l[1]=Ue(h=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[Z,o(M).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:l[2]||(l[2]=h=>o(c)(1))},l[4]||(l[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(I,{errorMessage:o(j)},{default:R(()=>[e("div",Ri,[e("table",Fi,[e("thead",null,[e("tr",null,[l[7]||(l[7]=e("td",{class:"text-center"},"#",-1)),l[8]||(l[8]=e("th",null,"Name",-1)),l[9]||(l[9]=e("th",null,"HTTP Configuration Base Url",-1)),e("td",zi,[C.value.length?(t(),s(U,{key:0},[e("button",{onClick:g,class:"btn btn-primary btn-sm"},l[5]||(l[5]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:p,class:"btn btn-warning btn-sm ms-1"},l[6]||(l[6]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):E("",!0)])])]),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(M).items,(h,b)=>(t(),s("tr",{key:h.sourceLocationId},[e("td",{textContent:u(o(v)(b)),class:"text-center"},null,8,Gi),e("td",null,[z(m,{to:`${n.urlView}/${h.sourceLocationId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[h.arn?(t(),s("i",ji)):E("",!0),e("span",null,u(h.name),1)]),_:2},1032,["to"])]),e("td",null,u(h.httpConfigurationBaseUrl),1),e("td",Yi,[N(e("input",{"onUpdate:modelValue":O=>h.selected=O,type:"checkbox",class:"form-check-input"},null,8,Wi),[[qe,h.selected]])])]))),128))]),_:1},512),[[ke,o(M).items.length>0]])])]),z(r,{filter:o(M),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Ji={key:0},Xi={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},Zi={class:"nav-item",role:"presentation"},ed={class:"nav-item",role:"presentation"},td={class:"nav-item",role:"presentation"},sd={class:"tab-content",id:"myTabContent"},od={class:"mt-2"},ad={class:"col"},ld={class:"form-floating mb-2"},nd={class:"col"},rd={class:"form-floating mb-2"},id={class:"mt-2"},dd={class:"table-responsive border"},ud={class:"table table-hover mb-0"},cd={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},md={class:"mt-2"},fd={class:"table-responsive border"},pd={class:"table table-hover mb-0"},vd={key:0,class:"fas fa-fw fa-check-circle text-success"},gd={class:"badge bg-info"},bd={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-locations"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const f=n,{appTitle:T,pageTitle:V,busy:_,isDirty:H,validations:P,infoMessage:J,warningMessage:j,errorMessage:x,router:G,axios:oe,utils:B,toasts:A,close:i,closeWithReturnUrl:M,generateReturnUrl:w,security:K}=$e({appTitle:"Arcadian-FAST",pageTitle:"View Source Location"});Me("$config");const X=he();X.user;const c=be({user:X.user,item:null}),v=ce();fe(async()=>{await g(),v.value=B.getPageTab("sourceLocation")||"information-tab"});const Y=m=>{B.setPageTab("sourceLocation",m),v.value=m},d=m=>m!==v.value?"":"active",C=m=>m!==v.value?"":"show active",g=async()=>{const m=c;if(!_.value)try{_.value=!0,x.value="",c.item=null;const a=`/api/v1/sourcelocations/${f.id}/`;await oe.get(a).then(r=>{m.item=r.data})}catch(a){x.value=B.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{_.value=!1}},p=async()=>{await g()},y=async()=>{if(confirm("Source Location will be submitted to AWS MediaTailer. Are you sure you want to publish the Source Location?")&&!_.value){x.value=null;try{_.value=!0;const a={sourceLocationIds:[f.id]};await oe.post("/api/v1/sourcelocations/publish/",a).then(r=>{A.success("Publish Source Location","Source Location was published.",{async onClose(){}})}),_.value=!1,await p()}catch(a){x.value=B.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{_.value=!1}}},l=async()=>{if(confirm("Source Location will be removed to AWS MediaTailer. Are you sure you want to remove the Source Location?")&&!_.value){x.value=null;try{_.value=!0;const a={sourceLocationIds:[f.id]};await oe.post("/api/v1/sourcelocations/unpublish/",a).then(r=>{A.warning("Remove Source Location","Source Location was removed.",{async onClose(){}})}),_.value=!1,await p()}catch(a){x.value=B.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{_.value=!1}}};return(m,a)=>{const r=se("PageHeader"),I=se("router-link"),h=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(r,{"page-icon":"fas fa-fw fa-building",pageTitle:o(V)},{default:R(()=>[c.item?(t(),s(U,{key:0},[c.item.arn?(t(),s("button",{key:0,onClick:a[0]||(a[0]=b=>l()),class:"ms-1 btn btn-warning"},a[9]||(a[9]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:a[1]||(a[1]=b=>y()),class:"ms-1 btn btn-primary"},a[10]||(a[10]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):E("",!0),e("button",{onClick:a[2]||(a[2]=b=>p()),class:"ms-2 btn btn-secondary"},a[11]||(a[11]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:a[3]||(a[3]=b=>o(M)(f.urlMain)),class:"btn btn-secondary ms-1"},a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(h,{errorMessage:o(x)},{default:R(()=>[c.item?(t(),s("div",Ji,[e("div",null,[e("ul",Xi,[e("li",Zi,[e("button",{onClick:a[4]||(a[4]=b=>Y("information-tab")),class:te([d("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",ed,[e("button",{onClick:a[5]||(a[5]=b=>Y("vodSources-tab")),class:te([d("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)]),e("li",td,[e("button",{onClick:a[6]||(a[6]=b=>Y("programs-tab")),class:te([d("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",sd,[e("div",{class:te([C("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",od,[e("div",ad,[e("div",ld,[N(e("input",{"onUpdate:modelValue":a[7]||(a[7]=b=>c.item.name=b),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[Z,c.item.name]]),a[13]||(a[13]=e("label",{for:"name"},"Name",-1))])]),e("div",nd,[e("div",rd,[N(e("input",{"onUpdate:modelValue":a[8]||(a[8]=b=>c.item.httpConfigurationBaseUrl=b),type:"text",class:"form-control-plaintext",id:"httpConfigurationBaseUrl",readonly:""},null,512),[[Z,c.item.httpConfigurationBaseUrl]]),a[14]||(a[14]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1))])])])],2),e("div",{class:te([C("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",id,[e("div",dd,[e("table",ud,[a[15]||(a[15]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Video")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.vodSources,(b,O)=>(t(),s("tr",{key:b.vodSourceId},[e("td",null,u(O+1),1),e("td",null,[b.arn?(t(),s("span",cd)):E("",!0),z(I,{to:`${f.urlViewVodSource}/${encodeURIComponent(b.vodSourceId)}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(b.name),1)]),_:2},1032,["to"])]),e("td",null,[z(I,{to:`${f.urlViewVideo}/${encodeURIComponent(b.video.videoId)}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(b.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",null,u(o(B).moment.utc(b.video.durationInMillis).format("HH:mm:ss")),1)])])]))),128))]),_:1},512),[[ke,c.item.vodSources.length>0]])])])])],2),e("div",{class:te([C("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",md,[e("div",fd,[e("table",pd,[a[17]||(a[17]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Channel"),e("th",null,"Name"),e("th",null,"Date Scheduled Start")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.programs,(b,O)=>(t(),s("tr",{key:b.programId},[e("td",null,u(O+1),1),e("td",null,[z(I,{to:`${f.urlViewChannel}/${encodeURIComponent(b.channel.channelId)}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(b.channel.name),1)]),_:2},1032,["to"])]),e("td",null,[b.arn?(t(),s("span",vd)):E("",!0),Q(" "+u(b.name)+" ",1),e("div",null," Start: "+u(o(B).moment.utc(b.startOffsetMillis).format("HH:mm:ss")),1),e("div",null," End: "+u(o(B).moment.utc(b.endOffsetMillis).format("HH:mm:ss")),1)]),e("td",null,[Q(u(o(B).moment(b.dateScheduledStart).calendar())+" ",1),e("div",null,[e("span",gd,u(o(B).moment(b.dateScheduledStart).fromNow()),1)])]),a[16]||(a[16]=e("td",null,null,-1))]))),128))]),_:1},512),[[ke,c.item.programs.length>0]])])])])],2)])])])):E("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},yd=["id"],$d={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},wd={class:"modal-content"},hd={class:"modal-header"},_d={class:"modal-title"},kd={class:"modal-body p-1"},Sd={class:"row row-cols-1 row-cols-sm-3"},Td={class:"col"},Id={class:"form-floating mb-2"},Md=["value"],xd={class:"col"},Cd={class:"form-floating mb-2"},Vd=["value"],Pd={class:"col"},Od={class:"input-group mb-2"},Ad={class:"form-floating"},Ud={class:"row row-cols-1 row-cols-sm-2"},Ld={class:"col-sm-4"},Hd={class:"card"},Dd={key:0,class:"mt-2"},Ed={class:"col"},qd={class:"form-floating mb-2"},Bd={class:"col ms-2 my-2"},Nd={class:"badge bg-info me-1"},Rd={class:"badge bg-primary me-1"},Fd={class:"row row-cols-1 row-cols-sm-2"},zd={class:"col"},Gd={class:"form-floating mb-2"},jd={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Yd={class:"col"},Wd={class:"form-floating mb-2"},Kd={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Qd={class:"col"},Jd={class:"form-floating mb-2"},Xd={class:"col-sm-8"},Zd={class:"table-responsive border shadow-sm"},eu={class:"table table-sm table-hover mb-0 overflow-auto"},tu=["textContent"],su={class:"d-flex flex-row justify-content-start"},ou={class:"mt-1"},au=["src"],lu={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},nu={class:"ms-2"},ru=["onClick"],iu={class:"modal-footer"},du="/api/v1/videos/search",ct={__name:"_selectVideo",props:{sourceLocationId:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:f,emit:T}){const _=he().user,{appTitle:H,pageTitle:P,busy:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,security:M,filter:w,initializeFilter:K,getQuery:X,saveQuery:c,search:v,getRowNumber:Y,setSelected:d,isSelected:C}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select Video",cacheKey:`${_==null?void 0:_.userId}/videos/select`,baseUrl:du,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null}},initializeFilter:(D,$)=>{const k=D.value,F=new URLSearchParams(window.location.search),W=JSON.parse(localStorage.getItem($))||{};k.query.genreId=F.get("genre")||W.genreId||k.query.genreId||0,k.query.categoryId=F.get("category")||W.categoryId||k.query.categoryId||0},getQuery:D=>["?c=",encodeURIComponent(D.query.criteria),"&p=",D.pageIndex,"&s=",D.pageSize,"&sf=",D.sortField,"&so=",D.sortOrder,"&genre=",D.query.genreId,"&category=",D.query.categoryId,"&sourceLocationId=",D.query.sourceLocationId].join(""),saveQuery:(D,$)=>{localStorage.setItem($,JSON.stringify({criteria:D.query.criteria,pageIndex:D.pageIndex,pageSize:D.pageSize,sortField:D.sortField,sortOrder:D.sortOrder,visible:D.visible,genreId:D.query.genreId,category:D.query.categoryId}))}}),g=T,p=n,y=ce("modalSelectVideo"),l=be({video:null,hls:null});fe(async()=>{K(),await m(),await a(),await v(1)}),Ae(()=>{l.hls&&(l.hls.stopLoad(),l.hls.destroy())});const m=async()=>{await I(),await h()},a=async()=>{w.value.query.sourceLocationId=p.sourceLocationId,G.value="";var D=document.getElementById(y.value),$=we.getOrCreateInstance(D);$.show()},r=async D=>{var $=document.getElementById(y.value),k=we.getOrCreateInstance($);k.hide(),l.hls&&(l.hls.stopLoad(),l.hls.destroy()),g(D?"confirm":"cancel",D?l.video:null)},I=async D=>{try{const k=await B.get("/api/v1/lookups/video-categories/").then(F=>F.data);w.value.lookups.categories=k}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},h=async D=>{try{const k=await B.get("/api/v1/lookups/video-genres/").then(F=>F.data);w.value.lookups.genres=k}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},b=D=>{l.video=D,O()},O=()=>{if(Hls.isSupported()){l.hls&&(l.hls.stopLoad(),l.hls.destroy());var D=document.getElementById("video-select-preview");const k=l.video.formats.find(W=>W.formatName==="HLS"),F=k.serverUrl+k.path;l.hls=A.createHlsStream(D,F)}};return f({open:a,close:r}),(D,$)=>{const k=se("m-pagination"),F=se("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:y.value,tabindex:"-1","aria-hidden":"true"},[e("div",$d,[e("div",wd,[e("div",hd,[e("h5",_d,[$[10]||($[10]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Q(u(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:$[0]||($[0]=W=>r(!1)),"aria-label":"Close"})]),e("div",kd,[z(F,{errorMessage:o(G)},{default:R(()=>[e("div",Sd,[e("div",Td,[e("div",Id,[N(e("select",{"onUpdate:modelValue":$[1]||($[1]=W=>o(w).query.categoryId=W),class:"form-select",id:"category"},[(t(!0),s(U,null,q(o(w).lookups.categories,W=>(t(),s("option",{value:W.id},u(W.name),9,Md))),256))],512),[[ge,o(w).query.categoryId]]),$[11]||($[11]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",xd,[e("div",Cd,[N(e("select",{"onUpdate:modelValue":$[2]||($[2]=W=>o(w).query.genreId=W),class:"form-select",id:"genre"},[(t(!0),s(U,null,q(o(w).lookups.genres,W=>(t(),s("option",{value:W.id},u(W.name),9,Vd))),256))],512),[[ge,o(w).query.genreId]]),$[12]||($[12]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",Pd,[e("div",Od,[e("div",Ad,[N(e("input",{"onUpdate:modelValue":$[3]||($[3]=W=>o(w).query.criteria=W),onKeyup:$[4]||($[4]=Ue(W=>o(v)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[Z,o(w).query.criteria]]),$[13]||($[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:$[5]||($[5]=W=>o(v)(1))},$[14]||($[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",Ud,[e("div",Ld,[e("div",Hd,[$[19]||($[19]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),l.video?(t(),s("div",Dd,[e("div",Ed,[e("div",qd,[N(e("input",{"onUpdate:modelValue":$[6]||($[6]=W=>l.video.title=W),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[Z,l.video.title]]),$[15]||($[15]=e("label",{for:"title"},"Title",-1))])]),e("div",Bd,[e("div",null,[(t(!0),s(U,null,q(l.video.genres,W=>(t(),s("span",Nd,u(W.genreName),1))),256)),(t(!0),s(U,null,q(l.video.categories,W=>(t(),s("span",Rd,u(W.categoryName),1))),256))])]),e("div",Fd,[e("div",zd,[e("div",Gd,[e("div",jd,u(o(A).moment(l.video.dateReleased).calendar()),1),$[16]||($[16]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Yd,[e("div",Wd,[e("div",Kd,u(o(A).moment.utc(l.video.durationInMillis).format("HH:mm:ss")),1),$[17]||($[17]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Qd,[e("div",Jd,[N(e("textarea",{"onUpdate:modelValue":$[7]||($[7]=W=>l.video.description=W),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[Z,l.video.description]]),$[18]||($[18]=e("label",{for:"description"},"Description",-1))])])])):E("",!0)])]),e("div",Xd,[e("div",Zd,[e("table",eu,[$[20]||($[20]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(w).items,(W,pe)=>(t(),s("tr",{key:W.videoId},[e("td",{textContent:u(o(Y)(pe)),class:"text-center"},null,8,tu),e("td",null,[e("div",su,[e("div",null,[W.thumbnails.length>0?(t(!0),s(U,{key:0},q(W.thumbnails,ee=>(t(),s("div",ou,[e("img",{src:ee.url,class:"img-fuild border",width:"128"},null,8,au)]))),256)):(t(),s("img",lu))]),e("div",nu,[e("a",{onClick:ee=>b(W),class:"text-wrap link-offset-2",role:"button"},u(W.title),9,ru)])])])]))),128))]),_:1},512),[[ke,o(w).items.length>0]])])]),z(k,{filter:o(w),search:o(v),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",iu,[e("button",{onClick:$[8]||($[8]=W=>r(!0)),class:"btn btn-primary",type:"button"},$[21]||($[21]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:$[9]||($[9]=W=>r(!1)),class:"btn btn-secondary ms-1"},$[22]||($[22]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,yd)}}},uu=["disabled"],cu={class:"col"},mu={class:"form-floating mb-2"},fu={key:0,class:"d-block invalid-feedback"},pu={class:"row row-cols-1 row-cols-sm-2"},vu={class:"col"},gu={class:"form-floating mb-2"},bu=["value"],yu={key:0,class:"d-block invalid-feedback"},$u={class:"col"},wu={class:"input-group mb-2"},hu={class:"form-floating"},_u={key:0},ku={class:"d-flex flex-row justify-content-start align-items-center"},Su={key:0,class:"d-inline invalid-feedback"},Tu={class:"table-responsive border mt-1"},Iu={class:"table table-sm mb-0 caption-top"},Mu={class:"align-middle"},xu=["onUpdate:modelValue"],Cu=["value"],Vu=["onUpdate:modelValue"],Pu=["value"],Ou=["onClick"],Au={__name:"add",props:{videoId:{type:String},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,route:j,axios:x,utils:G,toasts:oe,close:B,closeWithReturnUrl:A,security:i}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source"}),M=n,w=be({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),K=(a,r,I)=>a.length>0,X={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},videoId:{required:ae.withMessage("Video is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("Source Locaton is required.",re),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:ae.withMessage("PackageConfigurations is required.",K),$each:ae.forEach({path:{required:ae.withMessage("Path is required.",re)},sourceGroupId:{required:ae.withMessage("Source Group is required.",re)}}),$autoDirty:!0,$lazy:!0}}},c=Se(X,w);fe(async()=>{if(await v(),await Y(),j.query.videoId)debugger});const v=async()=>{try{await x.get("/api/v1/sourcegroups/lookup/").then(r=>{w.lookups.sourceGroups=r.data})}catch(a){P.value=G.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},Y=async()=>{try{if(await x.get("/api/v1/sourcelocations/lookup/").then(r=>{w.lookups.sourceLocations=r.data}),w.lookups.sourceLocations.length===1){const r=w.lookups.sourceLocations[0];w.selected.sourceLocation=r,await d()}}catch(a){P.value=G.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},d=async()=>{const a=w.selected.sourceLocation;w.item.sourceLocationId=a.id},C=async()=>{w.item.videoId=w.selected.video.videoId,await g(w.item.videoId)},g=async a=>{try{const r=`/api/v1/videos/${a}/formats`;await x.get(r).then(I=>{w.selected.video.formats=I.data})}catch(r){P.value=G.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{}},p=async()=>{const a=w;if(V.value)return;if(!await c.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const I=G.clone(a.item),h=a.item.packageConfigurations.filter(b=>b.selectedFormat&&b.sourceGroupId);h.forEach(b=>{const O=b.selectedFormat;b.path=O.path,b.format=O.format,delete b.selectedFormat}),I.packageConfigurations=h,delete I.video,await x.post("/api/v1/vodSources/",I).then(b=>{debugger;oe.success("Add VOD Source","VOD source added",{onClose:async()=>{const O=`${M.urlView}/${b.data}`;await J.push(O)}})})}catch(I){P.value=G.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{V.value=!1}},y=()=>{const a={sourceGroupId:null,selectedFormat:null},r=w.selected.video;if(r){const I=r.formats.find(h=>h.formatName==="HLS");a.path=`${I.serverUrl}${I.path}`}w.item.packageConfigurations.push(a)},l=a=>{w.item.packageConfigurations.splice(a,1)},m=async()=>{const a=Ee(ct,{sourceLocationId:w.selected.sourceLocation.id},{chore:!0,keepInitial:!1}),{data:r,isCanceled:I}=await a.reveal();a.closeAll(),!I&&r&&(w.selected.video=r,await C())};return(a,r)=>{const I=se("PageHeader"),h=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(I,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(c).$dirty&&o(c).$invalid,onClick:r[0]||(r[0]=b=>p()),class:"btn btn-primary"},r[6]||(r[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,uu),e("button",{onClick:r[1]||(r[1]=b=>o(A)(M.urlMain)),class:"btn btn-secondary ms-1"},r[7]||(r[7]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(h,{errorMessage:o(P),vuelidate:o(c)},{default:R(()=>[e("div",null,[e("div",cu,[e("div",mu,[N(e("input",{"onUpdate:modelValue":r[2]||(r[2]=b=>w.item.name=b),id:"name",class:te([o(G).getValidFeedbackCss(w.item.name),"form-control"]),placeholder:"Name"},null,2),[[Z,w.item.name]]),r[8]||(r[8]=e("label",{for:"name",class:""},"Name",-1)),o(c).item.name.$error?(t(),s("div",fu,[(t(!0),s(U,null,q(o(c).item.name.$errors,b=>(t(),s("div",{key:b.$uid},u(b.$message),1))),128))])):E("",!0)])]),e("div",pu,[e("div",vu,[e("div",gu,[N(e("select",{"onUpdate:modelValue":r[3]||(r[3]=b=>w.selected.sourceLocation=b),onChange:r[4]||(r[4]=b=>d()),class:te([o(G).getValidFeedbackCss(w.selected.sourceLocation),"form-select"]),id:"sourceLocationId"},[(t(!0),s(U,null,q(w.lookups.sourceLocations,b=>(t(),s("option",{value:b},u(b.name),9,bu))),256))],34),[[ge,w.selected.sourceLocation]]),r[9]||(r[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(c).item.sourceLocationId.$error?(t(),s("div",yu,[(t(!0),s(U,null,q(o(c).item.sourceLocationId.$errors,b=>(t(),s("div",{key:b.$uid},u(b.$message),1))),128))])):E("",!0)])]),e("div",$u,[e("div",wu,[e("div",hu,[e("div",{id:"video",class:te([o(G).getValidFeedbackCss(w.selected.video),"form-control"]),placeholder:"Title"},[w.selected.video?(t(),s(U,{key:0},[Q(u(o(G).moment.utc(w.selected.video.durationInMillis).format("HH:mm:ss"))+" - "+u(w.selected.video.title),1)],64)):E("",!0)],2),r[10]||(r[10]=e("label",{for:"video",class:""},"Video",-1))]),w.selected.sourceLocation?(t(),s("button",{key:0,onClick:r[5]||(r[5]=b=>m()),class:"btn btn-primary",type:"button"},r[11]||(r[11]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):E("",!0)])])]),w.item.videoId?(t(),s("div",_u,[e("div",ku,[e("fieldset",null,[e("legend",null,[r[13]||(r[13]=Q(" Package Configurations ")),o(c).item.packageConfigurations.$error?(t(),s("span",Su,r[12]||(r[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):E("",!0)])]),e("div",{class:"ms-2"},[e("button",{onClick:y,class:"btn btn-outline-primary btn-sm"},r[14]||(r[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",Tu,[e("table",Iu,[r[16]||(r[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Type"),e("th",null,"Source Group"),e("th")])],-1)),e("tbody",Mu,[(t(!0),s(U,null,q(w.item.packageConfigurations,(b,O)=>(t(),s("tr",null,[e("td",null,u(O+1),1),e("td",null,[N(e("select",{"onUpdate:modelValue":D=>b.selectedFormat=D,class:te([o(G).getValidFeedbackCss(b.selectedFormat),"form-select"]),id:"videoId"},[(t(!0),s(U,null,q(w.selected.video.formats,D=>(t(),s("option",{value:D},u(D.path),9,Cu))),256))],10,xu),[[ge,b.selectedFormat]]),o(c).item.packageConfigurations.$each.$response?(t(!0),s(U,{key:0},q(o(c).item.packageConfigurations.$each.$response.$errors[O].path,D=>(t(),s("div",{key:D,class:"d-block invalid-feedback"},u(D.$message),1))),128)):E("",!0)]),e("td",null,[b.selectedFormat?(t(),s(U,{key:0},[Q(u(b.selectedFormat.formatName),1)],64)):E("",!0)]),e("td",null,[e("div",null,[N(e("select",{"onUpdate:modelValue":D=>b.sourceGroupId=D,class:te([o(G).getValidFeedbackCss(b.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(U,null,q(w.lookups.sourceGroups,D=>(t(),s("option",{value:D.id},u(D.name),9,Pu))),256))],10,Vu),[[ge,b.sourceGroupId]]),o(c).item.packageConfigurations.$each.$response?(t(!0),s(U,{key:0},q(o(c).item.packageConfigurations.$each.$response.$errors[O].path,D=>(t(),s("div",{key:D,class:"d-block invalid-feedback"},u(D.$message),1))),128)):E("",!0)])]),e("td",null,[e("button",{onClick:D=>l(O),class:"btn btn-outline-warning btn-sm"},r[15]||(r[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Ou)])]))),256))])])])])):E("",!0)])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Uu=["disabled"],Lu={key:0},Hu={class:"col"},Du={class:"form-floating mb-2"},Eu={key:0,class:"d-block invalid-feedback"},qu={class:"row row-cols-1 row-cols-sm-2"},Bu={class:"col"},Nu={class:"form-floating mb-2"},Ru=["value"],Fu={key:0,class:"d-block invalid-feedback"},zu={class:"col"},Gu={class:"col"},ju=["disabled"],Yu={class:"form-floating"},Wu={id:"video",class:"form-control",placeholder:"Title"},Ku={key:0},Qu={class:"d-flex flex-row justify-content-between mt-3"},Ju={key:0,class:"d-inline invalid-feedback"},Xu={class:"table-responsive border mt-1"},Zu={class:"table table-sm mb-0"},ec={class:"align-middle"},tc=["onUpdate:modelValue"],sc=["value"],oc=["onUpdate:modelValue"],ac=["value"],lc={class:"text-end"},nc=["onClick"],rc={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Edit VOD Source"}),A=n,i=be({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),M=(a,r,I)=>a.length>0,w={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},videoId:{required:ae.withMessage("Video is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("Source Locaton is required.",re),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:ae.withMessage("PackageConfigurations is required.",M),$each:ae.forEach({path:{required:ae.withMessage("Path is required.",re)},sourceGroupId:{required:ae.withMessage("Source Group is required.",re)}})}}},K=Se(w,i);fe(async()=>{await X(),await Y(),await d()});const X=async()=>{await c(),await v()},c=async()=>{const a=i;if(!V.value)try{V.value=!0,P.value="",i.item=null;const r=`/api/v1/vodsources/${A.id}/`;await j.get(r).then(I=>{a.item=I.data;const h=a.item,b=x.moment.utc(a.item.video.durationInMillis).format("HH:mm:ss");h.video.duration=b})}catch(r){P.value=x.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{V.value=!1}},v=async()=>{const a=i;if(!V.value)try{V.value=!0,P.value="";const r=`/api/v1/videos/${a.item.videoId}/`;await j.get(r).then(I=>{a.selected.video=I.data})}catch(r){P.value=x.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{V.value=!1}},Y=async()=>{try{await j.get("/api/v1/sourcegroups/lookup/").then(r=>{i.lookups.sourceGroups=r.data})}catch(a){P.value=x.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},d=async()=>{try{if(await j.get("/api/v1/sourcelocations/lookup/").then(r=>{i.lookups.sourceLocations=r.data}),i.lookups.sourceLocations.length>0){const r=i.lookups.sourceLocations.find(I=>I.id===i.item.sourceLocationId);i.selected.sourceLocation=r}}catch(a){P.value=x.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},C=async()=>{i.item.videoId=i.selected.video.videoId,i.item.packageConfigurations=[],await g(i.item.videoId)},g=async a=>{try{const r=`/api/v1/videos/${a}/formats`;await j.get(r).then(I=>{i.selected.video.formats=I.data;debugger})}catch(r){P.value=x.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{}},p=async()=>{const a=i;if(V.value)return;if(!await K.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const I=x.clone(a.item);delete I.video,delete I.programs,delete I.sourceLocation,await j.put("/api/v1/vodsources/",I).then(h=>{G.success("Edit VOD Source","VOD source edited.",{onClose:async()=>{const b=`${A.urlView}/${A.id}`;await J.push(b)}})})}catch(I){P.value=x.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{V.value=!1}},y=()=>{debugger;const a={path:"",sourceGroupId:null,type:"HLS"},r=i.selected.video;if(r){const I=r.formats.find(h=>h.formatName==="HLS");a.path=`${I.path}`}i.item.packageConfigurations.push(a)},l=a=>{i.item.packageConfigurations.splice(a,1)},m=async()=>{const a=Ee(ct,{sourceLocationId:i.selected.sourceLocation.id},{chore:!0,keepInitial:!1}),{data:r,isCanceled:I}=await a.reveal();a.close(),!I&&r&&(i.selected.video=r,await C())};return(a,r)=>{const I=se("router-link"),h=se("PageHeader"),b=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(h,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(K).$dirty&&o(K).$invalid,onClick:r[0]||(r[0]=O=>p()),class:"btn btn-primary"},r[5]||(r[5]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Uu),e("button",{onClick:r[1]||(r[1]=O=>X()),class:"btn btn-secondary ms-2"},r[6]||(r[6]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(I,{to:`${n.urlView}/${n.id}`,class:"btn btn-secondary ms-1"},{default:R(()=>r[7]||(r[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(b,{errorMessage:o(P),vuelidate:o(K)},{default:R(()=>[i.item?(t(),s("div",Lu,[e("div",Hu,[e("div",Du,[N(e("input",{"onUpdate:modelValue":r[2]||(r[2]=O=>i.item.name=O),id:"name",class:"form-control",placeholder:"Name"},null,512),[[Z,i.item.name]]),r[8]||(r[8]=e("label",{for:"name",class:""},"Name",-1)),o(K).item.name.$error?(t(),s("div",Eu,[(t(!0),s(U,null,q(o(K).item.name.$errors,O=>(t(),s("div",{key:O.$uid},u(O.$message),1))),128))])):E("",!0)])]),e("div",qu,[e("div",Bu,[e("div",Nu,[N(e("select",{"onUpdate:modelValue":r[3]||(r[3]=O=>i.selected.sourceLocation=O),class:"form-select",id:"sourceLocationId"},[(t(!0),s(U,null,q(i.lookups.sourceLocations,O=>(t(),s("option",{value:O},u(O.name),9,Ru))),256))],512),[[ge,i.selected.sourceLocation]]),r[9]||(r[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(K).item.sourceLocationId.$error?(t(),s("div",Fu,[(t(!0),s(U,null,q(o(K).item.sourceLocationId.$errors,O=>(t(),s("div",{key:O.$uid},u(O.$message),1))),128))])):E("",!0)])]),e("div",zu,[e("div",Gu,[e("div",{class:"input-group mb-2",disabled:i.item.packageConfigurations.length>0},[e("div",Yu,[e("div",Wu,[i.selected.video?(t(),s(U,{key:0},[Q(u(i.selected.video.title),1)],64)):E("",!0)]),r[10]||(r[10]=e("label",{for:"video",class:""},"Video",-1))]),e("button",{onClick:r[4]||(r[4]=O=>m()),class:"btn btn-primary",type:"button"},r[11]||(r[11]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))],8,ju)])])]),i.item.videoId?(t(),s("div",Ku,[e("div",Qu,[e("div",null,[e("h5",null,[r[13]||(r[13]=Q(" Package Configurations ")),o(K).item.packageConfigurations.$error?(t(),s("span",Ju,r[12]||(r[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):E("",!0)])]),e("button",{onClick:y,class:"btn btn-outline-primary btn-sm"},r[14]||(r[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",Xu,[e("table",Zu,[r[16]||(r[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),e("tbody",ec,[(t(!0),s(U,null,q(i.item.packageConfigurations,(O,D)=>(t(),s("tr",null,[e("td",null,u(D+1),1),e("td",null,[N(e("select",{"onUpdate:modelValue":$=>O.selectedFormat=$,class:te([o(x).getValidFeedbackCss(O.selectedFormat),"form-select"]),id:"videoId"},[(t(!0),s(U,null,q(i.selected.video.formats,$=>(t(),s("option",{value:$},u($.path),9,sc))),256))],10,tc),[[ge,O.selectedFormat]]),o(K).item.packageConfigurations.$each.$response?(t(!0),s(U,{key:0},q(o(K).item.packageConfigurations.$each.$response.$errors[D].path,$=>(t(),s("div",{key:$,class:"d-block invalid-feedback"},u($.$message),1))),128)):E("",!0)]),e("td",null,[e("div",null,[N(e("select",{"onUpdate:modelValue":$=>O.sourceGroupId=$,class:"form-select",id:"sourceGroupId"},[(t(!0),s(U,null,q(i.lookups.sourceGroups,$=>(t(),s("option",{value:$.id},u($.name),9,ac))),256))],8,oc),[[ge,O.sourceGroupId]]),o(K).item.packageConfigurations.$each.$response?(t(!0),s(U,{key:0},q(o(K).item.packageConfigurations.$each.$response.$errors[D].path,$=>(t(),s("div",{key:$,class:"d-block invalid-feedback"},u($.$message),1))),128)):E("",!0)])]),e("td",null,[O.selectedFormat?(t(),s(U,{key:0},[Q(u(O.selectedFormat.formatName),1)],64)):E("",!0)]),e("td",lc,[e("button",{onClick:$=>l(D),class:"btn btn-outline-warning btn-sm"},r[15]||(r[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,nc)])]))),256))])])])])):E("",!0)])):E("",!0)]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},ic={class:"ms-2"},dc={class:"input-group"},uc=["value"],cc={class:"ms-1"},mc={class:"input-group"},fc=["value"],pc={class:"ms-1"},vc={class:"input-group"},gc={class:"ms-1"},bc={class:"input-group"},yc={class:"table-responsive border shadow-sm"},$c={class:"table table-hover mb-0"},wc={class:"text-center"},hc=["textContent"],_c={class:"d-flex flex-row justify-content-start"},kc={class:"mt-1"},Sc=["src"],Tc={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Ic={class:"ms-2"},Mc={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},xc={class:"badge bg-primary me-1"},Cc={key:0},Vc={class:"badge bg-info me-1"},Pc={class:"d-flex flex-row justify-content-start"},Oc={class:"ms-2"},Ac={class:"small"},Uc={class:"badge bg-secondary me-1"},Lc={class:"text-center"},Hc=["onUpdate:modelValue"],Dc="/api/v1/vodsources/search",Ec={__name:"index",props:{urlAdd:{type:String,default:"/vod-sources/add"},urlView:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"}},setup(n){Me("$config");const T=he().user,{appTitle:V,pageTitle:_,busy:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,closeWithReturnUrl:i,generateReturnUrl:M,security:w,filter:K,initializeFilter:X,getQuery:c,saveQuery:v,search:Y,getRowNumber:d,setSelected:C,isSelected:g}=Le({appTitle:"Arcadian-FAST",pageTitle:"VOD Sources",cacheKey:`${T==null?void 0:T.userId}/vod-sources/search`,baseUrl:Dc,filter:{updateUrl:!0,lookups:{sourceLocations:[],genres:[]},query:{type:0,sourceLocationId:""}},initializeFilter:(I,h)=>{const b=I.value,O=new URLSearchParams(window.location.search),D=JSON.parse(localStorage.getItem(h))||{};b.query.category=O.get("category")||D.category||b.query.category||0,b.query.genre=O.get("genre")||D.genre||b.query.genre||0,b.query.sourceLocationId=O.get("slid")||D.sourceLocationId||b.query.sourceLocationId||""},getQuery:I=>["?c=",encodeURIComponent(I.query.criteria),"&p=",I.pageIndex,"&s=",I.pageSize,"&sf=",I.sortField,"&so=",I.sortOrder,"&category=",I.query.category,"&genre=",I.query.genre,"&slid=",I.query.sourceLocationId].join(""),saveQuery:(I,h)=>{localStorage.setItem(h,JSON.stringify({criteria:I.query.criteria,pageIndex:I.pageIndex,pageSize:I.pageSize,sortField:I.sortField,sortOrder:I.sortOrder,visible:I.visible,category:I.query.category,genre:I.query.genre,sourceLocationId:I.query.sourceLocationId}))}}),p=Ie(()=>{const I=K.value;return I&&I.items?I.items.filter(O=>O.selected):[]});fe(async()=>{X(),await a(),await r(),await Y()});const y=async()=>{if(!(p.length<=0||!confirm("The selected VODs will be submitted to AWS MediaTailer. Are you sure you want to publish the selected VODs?"))&&!H.value){j.value=null;try{H.value=!0;const b={vodSourceIds:p.value.map(O=>O.vodSourceId)};await G.post("/api/v1/vodsources/publish/",b).then(O=>{B.success("Publish VODs","VODs was published.",{async onClose(){}})}),H.value=!1,await Y()}catch(h){j.value=oe.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{H.value=!1}}},l=async()=>{if(!(p.length<=0||!confirm("The selected VODs will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected VODs?"))&&!H.value){j.value=null;try{H.value=!0;const b={vodSourceIds:p.value.map(O=>O.vodSourceId)};await G.post("/api/v1/vodsources/unpublish/",b).then(O=>{B.success("Unpublish VODs","VODs was inpublished.",{async onClose(){}})}),H.value=!1,await Y()}catch(h){j.value=oe.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{H.value=!1}}},m=()=>{const I=K.value.items;if(I.length<1)return;const h=!I[0].selected;K.value.items.forEach(b=>{b.selected=h})},a=async()=>{try{await G.get("/api/v1/sourcelocations/lookup/").then(h=>{K.value.lookups.sourceLocations=h.data})}catch(I){j.value=oe.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{}},r=async()=>{try{await G.get("/api/v1/lookups/video-genres/").then(I=>{const h=I.data;K.value.lookups.genres=h})}catch(I){j.value=oe.getErrorMessageAsHtml(I),window.scrollTo(0,0)}finally{}};return ce(!1),(I,h)=>{const b=se("router-link"),O=se("PageHeader"),D=se("m-pagination"),$=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(O,{"page-icon":"fas fa-fw fa-tags",pageTitle:o(_)},{default:R(()=>[z(b,{to:n.urlAdd,class:"btn btn-primary"},{default:R(()=>h[6]||(h[6]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",ic,[e("div",dc,[h[8]||(h[8]=e("span",{class:"input-group-text fw-bold"},"Source",-1)),N(e("select",{"onUpdate:modelValue":h[0]||(h[0]=k=>o(K).query.sourceLocationId=k),class:"form-select"},[h[7]||(h[7]=e("option",{value:""},"All",-1)),(t(!0),s(U,null,q(o(K).lookups.sourceLocations,k=>(t(),s("option",{value:k.id},u(k.name),9,uc))),256))],512),[[ge,o(K).query.sourceLocationId]])])]),e("div",cc,[e("div",mc,[h[9]||(h[9]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),N(e("select",{"onUpdate:modelValue":h[1]||(h[1]=k=>o(K).query.genre=k),class:"form-select"},[(t(!0),s(U,null,q(o(K).lookups.genres,k=>(t(),s("option",{value:k.id},u(k.name),9,fc))),256))],512),[[ge,o(K).query.genre]])])]),e("div",pc,[e("div",vc,[h[11]||(h[11]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),N(e("select",{"onUpdate:modelValue":h[2]||(h[2]=k=>o(K).query.category=k),class:"form-select"},h[10]||(h[10]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[ge,o(K).query.category]])])]),e("div",gc,[e("div",bc,[N(e("input",{"onUpdate:modelValue":h[3]||(h[3]=k=>o(K).query.criteria=k),onKeyup:h[4]||(h[4]=Ue(k=>o(Y)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[Z,o(K).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:h[5]||(h[5]=k=>o(Y)(1))},h[12]||(h[12]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z($,{errorMessage:o(j)},{default:R(()=>[e("div",yc,[e("table",$c,[e("thead",null,[e("tr",null,[h[16]||(h[16]=e("td",{class:"text-center"},"#",-1)),h[17]||(h[17]=e("th",null,"Name",-1)),h[18]||(h[18]=e("th",null,"Video Title",-1)),e("th",wc,[p.value.length?(t(),s(U,{key:0},[e("button",{onClick:y,class:"btn btn-sm btn-primary"},h[13]||(h[13]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:l,class:"btn btn-sm btn-warning ms-1"},h[14]||(h[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):E("",!0),e("button",{onClick:m,class:"btn btn-sm btn-outline-primary ms-2"},h[15]||(h[15]=[e("span",{class:"fas fa-fw fa-check-double"},null,-1)]))])])]),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(K).items,(k,F)=>(t(),s("tr",{key:k.vodSourceId},[e("td",{textContent:u(o(d)(F)),class:"text-center"},null,8,hc),e("td",null,[e("div",_c,[e("div",null,[k.video.thumbnails.length>0?(t(!0),s(U,{key:0},q(k.video.thumbnails,W=>(t(),s("div",kc,[e("img",{src:W.url,class:"img-fuild border",width:"128"},null,8,Sc)]))),256)):(t(),s("img",Tc))]),e("div",Ic,[z(b,{to:`${n.urlView}/${k.vodSourceId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[k.arn?(t(),s("span",Mc)):E("",!0),Q(u(k.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(U,null,q(k.video.categories,W=>(t(),s("div",null,[e("span",xc,u(W.categoryName),1)]))),256)),k.video.genres.length>0?(t(),s("div",Cc,[(t(!0),s(U,null,q(k.video.genres,W=>(t(),s("span",Vc,u(W.genreName),1))),256))])):E("",!0)])])])]),e("td",null,[e("div",Pc,[e("div",Oc,[z(b,{to:`${n.urlViewVideo}/${encodeURIComponent(k.video.videoId)}/${o(M)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(k.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",Ac,u(o(oe).moment.utc(k.video.durationInMillis).format("HH:mm:ss")),1)]),k.video.formats.length>0?(t(!0),s(U,{key:0},q(k.video.formats,W=>(t(),s("span",Uc,u(W.formatName),1))),256)):E("",!0)])])]),e("td",Lc,[N(e("input",{"onUpdate:modelValue":W=>k.selected=W,type:"checkbox",class:"form-check-input"},null,8,Hc),[[qe,k.selected]])])]))),128))]),_:1},512),[[ke,o(K).items.length>0]])])]),z(D,{filter:o(K),search:o(Y),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},qc=["id"],Bc={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Nc={class:"modal-content"},Rc={class:"modal-header"},Fc={class:"modal-title"},zc={class:"modal-body"},Gc={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},jc=["innerHTML"],Yc={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Wc={class:"container"},Kc={class:"col"},Qc={class:"form-floating mb-2"},Jc=["value"],Xc={key:0,class:"d-block invalid-feedback"},Zc={class:"col"},em={class:"form-floating mb-2"},tm={key:0,class:"d-block invalid-feedback"},sm={class:"col"},om={class:"form-floating mb-2"},am=["value"],lm={key:0,class:"d-block invalid-feedback"},nm={class:"modal-footer"},rm=["disabled"],im={__name:"_addPackageConfiguration",emits:["refresh"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source Package Configuration"}),K=T;ce();const X=ce("modalAddChannelOutput"),c=be({lookups:{sourceGroups:[],formats:[]},item:{sourceGroupId:null,vodSourceId:null,path:null,type:null}}),v={item:{sourceGroupId:{required:ae.withMessage("Source Group is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ae.withMessage("VOD Source is required.",re),$autoDirty:!0,$lazy:!0},path:{required:ae.withMessage("Path is required.",re),$autoDirty:!0,$lazy:!0},type:{required:ae.withMessage("Type is required.",re),$autoDirty:!0,$lazy:!0}}},Y=Se(v,c);fe(async()=>{Y.value.$reset()});const d=async()=>{await C()},C=async()=>{try{await B.get("/api/v1/sourceGroups/lookup/").then(a=>{c.lookups.sourceGroups=a.data,c.lookups.sourceGroups.length===1&&(c.item.sourceGroupId=c.lookups.sourceGroups[0].id)})}catch(m){G.value=A.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{}},g=async m=>{try{const a=`/api/v1/videos/${m}/formats/`;await B.get(a).then(r=>{c.lookups.formats=r.data})}catch(a){G.value=A.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},p=async(m,a)=>{const r=c;J.value.clear(),G.value="",r.lookups={sourceGroups:[],formats:[]},r.item={sourceGroupId:null,vodSourceId:m,path:null,type:null},await d(),await g(a),Y.value.$reset();var I=document.getElementById(X.value),h=we.getOrCreateInstance(I);h.show()},y=async()=>{var m=document.getElementById(X.value),a=we.getOrCreateInstance(m);a.hide(),K("refresh")},l=async()=>{const m=c;if(H.value)return;const a=await Y.value.$validate();debugger;if(!a){window.scrollTo(0,0);return}try{H.value=!0,G.value="";const r=m.item;await B.post("/api/v1/vodSources/package-configurations/",r).then(I=>{i.success("Add VOD Source Package Configuration","VOD Source package configuration added.")}),await y()}catch(r){G.value=A.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{H.value=!1}};return f({open:p,close:y}),(m,a)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:X.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",Bc,[e("div",Nc,[e("div",Rc,[e("h5",Fc,[a[5]||(a[5]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=r=>y()),"aria-label":"Close"})]),e("div",zc,[o(G)?(t(),s("div",Gc,[a[6]||(a[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,jc)])):E("",!0),o(J).size>0?(t(),s("div",Yc,[a[7]||(a[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),r=>(t(),s("li",null,u(r),1))),256))])])):E("",!0),e("div",Wc,[e("div",Kc,[e("div",Qc,[N(e("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>c.item.sourceGroupId=r),class:te([o(A).getValidFeedbackCss(c.item.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(U,null,q(c.lookups.sourceGroups,r=>(t(),s("option",{value:r.id},u(r.name),9,Jc))),256))],2),[[ge,c.item.sourceGroupId]]),a[8]||(a[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(Y).item.sourceGroupId.$error?(t(),s("div",Xc,[(t(!0),s(U,null,q(o(Y).item.sourceGroupId.$errors,r=>(t(),s("div",{key:r.$uid},u(r.$message),1))),128))])):E("",!0)])]),e("div",Zc,[e("div",em,[N(e("select",{"onUpdate:modelValue":a[2]||(a[2]=r=>c.item.type=r),class:te([o(A).getValidFeedbackCss(c.item.type),"form-select"]),id:"type"},a[9]||(a[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),2),[[ge,c.item.type]]),a[10]||(a[10]=e("label",{for:"type",class:""},"Type",-1)),o(Y).item.type.$error?(t(),s("div",tm,[(t(!0),s(U,null,q(o(Y).item.type.$errors,r=>(t(),s("div",{key:r.$uid},u(r.$message),1))),128))])):E("",!0)])]),e("div",sm,[e("div",om,[N(e("select",{"onUpdate:modelValue":a[3]||(a[3]=r=>c.item.path=r),class:te([o(A).getValidFeedbackCss(c.item.path),"form-control"]),id:"path"},[(t(!0),s(U,null,q(c.lookups.formats,r=>(t(),s("option",{value:r.path},u(r.path),9,am))),256))],2),[[ge,c.item.path]]),a[11]||(a[11]=e("label",{for:"path",class:""},"Path",-1)),o(Y).item.path.$error?(t(),s("div",lm,[(t(!0),s(U,null,q(o(Y).item.path.$errors,r=>(t(),s("div",{key:r.$uid},u(r.$message),1))),128))])):E("",!0)])])])]),e("div",nm,[e("button",{disabled:o(Y).$dirty&&o(Y).$invalid,onClick:a[4]||(a[4]=r=>l()),class:"btn btn-primary",type:"button"},a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,rm),a[13]||(a[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,qc))}},dm=["id"],um={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},cm={class:"modal-content"},mm={class:"modal-header"},fm={class:"modal-title"},pm={class:"modal-body"},vm={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},gm=["innerHTML"],bm={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},ym={class:"container"},$m={class:"col"},wm={class:"form-floating mb-2"},hm={class:"col"},_m={class:"form-floating mb-2"},km={key:0,class:"d-block invalid-feedback"},Sm={class:"col"},Tm={class:"form-floating mb-2"},Im={key:0,class:"d-block invalid-feedback"},Mm={class:"col"},xm={class:"form-floating mb-2"},Cm={key:0,class:"d-block invalid-feedback"},Vm={class:"modal-footer"},Pm=["disabled"],Om={__name:"_addPlaybackConfiguration",emits:["refresh"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Vod Source Playback Configuration"}),K=T,X=ce(),c=ce("modalAddPlaybackConfiguration"),v=be({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),Y={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:ae.withMessage("adDecisionServerUrl is required.",re),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:ae.withMessage("videoContentSourceUrl is required.",re),$autoDirty:!0,$lazy:!0}}},d=Se(Y,v);fe(async()=>{d.value.$reset()});const C=async(y,l)=>{X.value=y;const m=v;J.value.clear(),G.value="";const a=l,r=a.lastIndexOf("/"),I=a.substring(0,r),h="ad_campaign_"+a.substring(r+1).replace(".","_");m.item={name:h,originalVideoContentSourceUrl:l,videoContentSourceUrl:I,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},d.value.$reset();var b=document.getElementById(c.value),O=we.getOrCreateInstance(b);O.show()},g=async()=>{var y=document.getElementById(c.value),l=we.getOrCreateInstance(y);l.hide(),K("refresh")},p=async()=>{const y=v;if(H.value)return;if(!await d.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,G.value="";const m=y.item;m.vodSourceId=X.value,await B.post("/api/v1/playbackconfigurations/vodsource",m).then(a=>{i.success("Add Vod Source Playback Configuration","Vod Source playback configuration added.",{async onClose(){}})}),await g()}catch(m){G.value=A.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{H.value=!1}};return f({open:C,close:g}),(y,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",um,[e("div",cm,[e("div",mm,[e("h5",fm,[l[6]||(l[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=m=>g()),"aria-label":"Close"})]),e("div",pm,[o(G)?(t(),s("div",vm,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,gm)])):E("",!0),o(J).size>0?(t(),s("div",bm,[l[8]||(l[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),m=>(t(),s("li",null,u(m),1))),256))])])):E("",!0),e("div",ym,[e("div",$m,[e("div",wm,[N(e("input",{"onUpdate:modelValue":l[1]||(l[1]=m=>v.item.originalVideoContentSourceUrl=m),id:"originalVideoContentSourceUrl",class:"form-control",placeholder:"originalVideoContentSourceUrl",disabled:""},null,512),[[Z,v.item.originalVideoContentSourceUrl]]),l[9]||(l[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",hm,[e("div",_m,[N(e("input",{"onUpdate:modelValue":l[2]||(l[2]=m=>v.item.name=m),id:"name",class:"form-control",placeholder:"Name"},null,512),[[Z,v.item.name]]),l[10]||(l[10]=e("label",{for:"name",class:""},"Name",-1)),o(d).item.name.$error?(t(),s("div",km,[(t(!0),s(U,null,q(o(d).item.name.$errors,m=>(t(),s("div",{key:m.$uid},u(m.$message),1))),128))])):E("",!0)])]),e("div",Sm,[e("div",Tm,[N(e("input",{"onUpdate:modelValue":l[3]||(l[3]=m=>v.item.videoContentSourceUrl=m),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[Z,v.item.videoContentSourceUrl]]),l[11]||(l[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),l[12]||(l[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(d).item.videoContentSourceUrl.$error?(t(),s("div",Im,[(t(!0),s(U,null,q(o(d).item.videoContentSourceUrl.$errors,m=>(t(),s("div",{key:m.$uid},u(m.$message),1))),128))])):E("",!0)])]),e("div",Mm,[e("div",xm,[N(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=m=>v.item.adDecisionServerUrl=m),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[Z,v.item.adDecisionServerUrl]]),l[13]||(l[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(d).item.adDecisionServerUrl.$error?(t(),s("div",Cm,[(t(!0),s(U,null,q(o(d).item.adDecisionServerUrl.$errors,m=>(t(),s("div",{key:m.$uid},u(m.$message),1))),128))])):E("",!0)])])])]),e("div",Vm,[e("button",{disabled:o(d).$dirty&&o(d).$invalid,onClick:l[5]||(l[5]=m=>p()),class:"btn btn-primary",type:"button"},l[14]||(l[14]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Pm),l[15]||(l[15]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,dm))}},Am={key:0},Um={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},Lm={class:"nav-item",role:"presentation"},Hm={class:"nav-item",role:"presentation"},Dm={class:"nav-item",role:"presentation"},Em={class:"nav-item",role:"presentation"},qm={class:"nav-item",role:"presentation"},Bm={class:"tab-content",id:"myTabContent"},Nm={class:"mt-2"},Rm={class:"row row-cols-1 row-cols-sm-2"},Fm={class:"col"},zm=["id"],Gm={class:"col"},jm={class:"col"},Ym={class:"form-floating mb-2"},Wm={class:"mt-2"},Km={class:"row row-cols-sm-2"},Qm={class:"col"},Jm={class:"form-floating mb-2"},Xm={class:"form-control-plaintext"},Zm={class:"col"},ef={class:"form-floating mb-2"},tf={class:"mt-1"},sf={class:"badge bg-info me-1"},of={class:"badge bg-primary me-1"},af={class:"badge bg-info me-1"},lf={class:"table-responsive border mt-1"},nf={class:"table table-hover mb-0"},rf={class:"table-group-divider"},df={class:"align-middle"},uf={class:"text-center"},cf={class:"text-truncate text-wrap"},mf={class:"text-truncate text-wrap"},ff={class:"mt-2"},pf={class:"mt-2 text-end"},vf={class:"table-responsive border mt-2"},gf={class:"table table-hover mb-0 caption-top"},bf={class:"text-end"},yf=["onClick"],$f={class:"mt-2"},wf={class:"mt-1"},hf=["id"],_f={class:"text-end"},kf={__name:"view",props:{id:{type:String,required:!0},urlEdit:{type:String,default:"/vod-sources/edit"},urlMain:{type:String,default:"/vod-sources"},urlViewVideo:{type:String,default:"/videos/view"}},setup(n){const f=n,{appTitle:T,pageTitle:V,busy:_,isDirty:H,validations:P,infoMessage:J,warningMessage:j,errorMessage:x,router:G,axios:oe,utils:B,toasts:A,close:i,closeWithReturnUrl:M,generateReturnUrl:w,security:K}=$e({appTitle:"Arcadian-FAST",pageTitle:"View VOD Source"});Me("$config");const X=he();X.user;const c=be({user:X.user,item:null,hls:null}),v=ce();ce(null);const Y=ce();fe(async()=>{await p();const h=B.getPageTab("vodSource")||"information-tab";d(h)}),Ae(()=>{c.hls&&(c.hls.stopLoad(),c.hls.destroy())});const d=h=>{B.setPageTab("vodSource",h),v.value=h},C=h=>h!==v.value?"":"active",g=h=>h!==v.value?"":"show active",p=async()=>{const h=c;if(!_.value)try{_.value=!0,x.value="",c.item=null;const b=`/api/v1/vodsources/${f.id}/`;await oe.get(b).then(O=>{h.item=O.data;const D=h.item,$=B.moment.utc(h.item.video.durationInMillis).format("HH:mm:ss");D.video.duration=$}),I()}catch(b){x.value=B.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{_.value=!1}},y=async()=>{await p()},l=()=>{Y.value.open(c.item.vodSourceId,c.item.videoId)},m=async()=>{if(confirm("VOD will be submitted to AWS MediaTailer. Are you sure you want to publish the VOD?")&&!_.value){x.value=null;try{_.value=!0;const b={vodSourceIds:[f.id]};await oe.post("/api/v1/vodsources/publish/",b).then(O=>{A.success("Publish VOD","VOD was published.",{async onClose(){}})}),_.value=!1,await y()}catch(b){x.value=B.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{_.value=!1}}},a=async()=>{if(confirm("VOD will be removed to AWS MediaTailer. Are you sure you want to remove the VOD?")&&!_.value){x.value=null;try{_.value=!0;const b={vodSourceIds:[f.id]};await oe.post("/api/v1/vodsources/unpublish/",b).then(O=>{A.warning("Remove VOD","VOD was removed.",{async onClose(){}})}),_.value=!1,await y()}catch(b){x.value=B.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{_.value=!1}}},r=async h=>{if(confirm("Are you sure you want to remove the VOD Package configuration?")&&!_.value){x.value=null;try{_.value=!0,await oe.delete(`/api/v1/vodSources/package-configurations/${h}/`).then(O=>{A.warning("Remove VOD Source Package Configuration","VOD Source package configuration was removed.")}),_.value=!1,await y()}catch(O){x.value=B.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{_.value=!1}}},I=()=>{if(Hls.isSupported()){c.hls&&(c.hls.stopLoad(),c.hls.destroy());const h=`video-${c.item.vodSourceId}`,b=document.getElementById(h),O=c.item.video.formats.find($=>$.formatName==="HLS"),D=`${O.serverUrl}${O.path}`;c.hls=B.createHlsStream(b,D)}};return(h,b)=>{const O=se("router-link"),D=se("PageHeader"),$=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(D,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(V)},{default:R(()=>[c.item?(t(),s(U,{key:0},[c.item.arn?(t(),s("button",{key:0,onClick:b[0]||(b[0]=k=>a()),class:"ms-1 btn btn-warning"},b[14]||(b[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:b[1]||(b[1]=k=>m()),class:"ms-1 btn btn-primary"},b[15]||(b[15]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):E("",!0),z(O,{to:`${n.urlEdit}/${n.id}`,class:"ms-2 btn btn-primary"},{default:R(()=>b[16]||(b[16]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:b[2]||(b[2]=k=>y()),class:"ms-2 btn btn-secondary"},b[17]||(b[17]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:b[3]||(b[3]=k=>o(M)(f.urlMain)),class:"btn btn-secondary ms-1"},b[18]||(b[18]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z($,{errorMessage:o(x)},{default:R(()=>[c.item?(t(),s("div",Am,[e("div",null,[e("ul",Um,[e("li",Lm,[e("button",{onClick:b[4]||(b[4]=k=>d("information-tab")),class:te([C("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Hm,[e("button",{onClick:b[5]||(b[5]=k=>d("packageConfigurations-tab")),class:te([C("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)]),e("li",Dm,[e("button",{onClick:b[6]||(b[6]=k=>d("channels-tab")),class:te([C("channels-tab"),"nav-link"]),id:"channels-tab","data-bs-toggle":"tab","data-bs-target":"#channels",type:"button",role:"tab","aria-controls":"channels","aria-selected":"false"},b[19]||(b[19]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Q("Channels ")]),2)]),e("li",Em,[e("button",{onClick:b[7]||(b[7]=k=>d("programs-tab")),class:te([C("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},b[20]||(b[20]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Q("Programs ")]),2)]),e("li",qm,[e("button",{onClick:b[8]||(b[8]=k=>d("programTemplates-tab")),class:te([C("programTemplates-tab"),"nav-link"]),id:"programTemplates-tab","data-bs-toggle":"tab","data-bs-target":"#programTemplates",type:"button",role:"tab","aria-controls":"programTemplates","aria-selected":"false"},b[21]||(b[21]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Q("Program Templates ")]),2)])]),e("div",Bm,[e("div",{class:te([g("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Nm,[e("div",Rm,[e("div",Fm,[e("video",{id:`video-${c.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,zm)]),e("div",Gm,[e("div",jm,[e("div",Ym,[N(e("input",{"onUpdate:modelValue":b[9]||(b[9]=k=>c.item.name=k),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[Z,c.item.name]]),b[22]||(b[22]=e("label",{for:"name"},"Name",-1))])]),e("div",Wm,[b[26]||(b[26]=e("b",null," Video Information ",-1)),e("div",null,[e("div",Km,[e("div",Qm,[e("div",Jm,[e("div",Xm,[z(O,{to:`${n.urlViewVideo}/${c.item.video.videoId}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(c.item.video.title),1)]),_:1},8,["to"])]),b[23]||(b[23]=e("label",{for:"title"},"Title",-1))])]),e("div",Zm,[e("div",ef,[N(e("input",{"onUpdate:modelValue":b[10]||(b[10]=k=>c.item.video.duration=k),type:"text",class:"form-control-plaintext",id:"duration",readonly:""},null,512),[[Z,c.item.video.duration]]),b[24]||(b[24]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",tf,[(t(!0),s(U,null,q(c.item.video.genres,k=>(t(),s("span",sf,u(k.genreName),1))),256)),(t(!0),s(U,null,q(c.item.video.categories,k=>(t(),s("span",of,u(k.categoryName),1))),256)),(t(!0),s(U,null,q(c.item.video.categories,k=>(t(),s("span",af,u(k.categoryName),1))),256))]),e("div",lf,[e("table",nf,[b[25]||(b[25]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",rf,[(t(!0),s(U,null,q(c.item.video.formats,(k,F)=>(t(),s("tr",df,[e("td",uf,u(F+1),1),e("td",null,u(k.formatName),1),e("td",null,[e("div",cf,u(k.serverUrl),1)]),e("td",null,[e("div",mf,u(k.path),1)])]))),256))])])])])])])])])],2),e("div",{class:te([g("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",ff,[e("div",pf,[e("button",{onClick:b[11]||(b[11]=k=>l()),class:"btn btn-outline-primary btn-sm"},b[27]||(b[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",vf,[e("table",gf,[b[29]||(b[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.packageConfigurations,(k,F)=>(t(),s("tr",{key:k.packageConfigurationId,class:"align-middle"},[e("td",null,u(F+1),1),e("td",null,u(k.path),1),e("td",null,u(k.sourceGroup.name),1),e("td",null,u(k.type),1),e("td",bf,[e("button",{onClick:W=>r(k.packageConfigurationId),class:"btn btn-outline-warning btn-sm"},b[28]||(b[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,yf)])]))),128))]),_:1},512),[[ke,c.item.packageConfigurations.length>0]])])])])],2),e("div",{class:te([g("viewStream-tab"),"tab-pane fade"]),id:"viewStream",role:"tabpanel","aria-labelledby":"viewStream-tab"},[e("div",$f,[e("div",wf,[e("video",{id:`video-${c.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,hf),e("div",_f,[e("button",{onClick:b[12]||(b[12]=k=>c.hls.startLoad(-1)),class:"btn btn-outline-info btn-sm"},b[30]||(b[30]=[e("span",{class:"fas fa-fw fa-cloud-download"},null,-1)]))])])])],2),e("div",{class:te([g("channels-tab"),"tab-pane fade"]),id:"channels",role:"tabpanel","aria-labelledby":"channels-tab"},b[31]||(b[31]=[e("div",{class:"mt-2"}," TODO: List of Channels using this as filler slate ",-1)]),2),e("div",{class:te([g("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},b[32]||(b[32]=[e("div",{class:"mt-2"}," TODO: List of Programs using this as VOD source ",-1)]),2),e("div",{class:te([g("programTemplates-tab"),"tab-pane fade"]),id:"programTemplates",role:"tabpanel","aria-labelledby":"programTemplates-tab"},b[33]||(b[33]=[e("div",{class:"mt-2"}," TODO: List of Program Templates using this as VOD source ",-1)]),2)])])])):E("",!0)]),_:1},8,["errorMessage"]),z(im,{ref_key:"modalAddPackageConfiguration",ref:Y,onRefresh:y},null,512),z(Om,{ref:"modalAddPlaybackConfiguration",onRefresh:b[13]||(b[13]=k=>y())},null,512)])]),_:1})}}},Sf=["id"],Tf={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},If={class:"modal-content"},Mf={class:"modal-header"},xf={class:"modal-title"},Cf={class:"modal-body p-1"},Vf={class:"row row-cols-1 row-cols-sm-3"},Pf={class:"col"},Of={class:"form-floating mb-2"},Af=["value"],Uf={class:"col"},Lf={class:"form-floating mb-2"},Hf=["value"],Df={class:"col"},Ef={class:"input-group mb-2"},qf={class:"form-floating"},Bf={class:"row row-cols-1 row-cols-sm-2 g-2"},Nf={class:"col-sm-4"},Rf={class:"card"},Ff={key:0,class:"mt-2"},zf={class:"col"},Gf={class:"form-floating mb-2"},jf={class:"col ms-2 my-2"},Yf={class:"badge bg-info me-1"},Wf={class:"badge bg-primary me-1"},Kf={class:"row row-cols-1 row-cols-sm-2"},Qf={class:"col"},Jf={class:"form-floating mb-2"},Xf={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Zf={class:"col"},ep={class:"form-floating mb-2"},tp={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},sp={class:"col"},op={class:"form-floating mb-2"},ap={class:"col-sm-8"},lp={class:"table-responsive border shadow-sm"},np={class:"table table-sm table-hover mb-0 overflow-auto"},rp=["textContent"],ip={class:"d-flex flex-row justify-content-start"},dp={class:"mt-1"},up=["src"],cp={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},mp={class:"ms-2"},fp=["onClick"],pp={class:"modal-footer"},vp="/api/v1/vodSources/search",mt={__name:"_selectVodSource",props:{sourceLocationId:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:f,emit:T}){const _=he().user,{appTitle:H,pageTitle:P,busy:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,security:M,filter:w,initializeFilter:K,getQuery:X,saveQuery:c,search:v,getRowNumber:Y,setSelected:d,isSelected:C}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select VOD Source",cacheKey:`${_==null?void 0:_.userId}/vodsources/select`,baseUrl:vp,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null}},initializeFilter:(D,$)=>{const k=D.value,F=new URLSearchParams(window.location.search),W=JSON.parse(localStorage.getItem($))||{};k.query.genre=F.get("genre")||W.genre||k.query.genre||0,k.query.category=F.get("category")||W.category||k.query.category||0},getQuery:D=>["?c=",encodeURIComponent(D.query.criteria),"&p=",D.pageIndex,"&s=",D.pageSize,"&sf=",D.sortField,"&so=",D.sortOrder,"&genre=",D.query.genreId,"&category=",D.query.categoryId,"&slid=",D.query.sourceLocationId,"&withArn=true"].join(""),saveQuery:(D,$)=>{localStorage.setItem($,JSON.stringify({criteria:D.query.criteria,pageIndex:D.pageIndex,pageSize:D.pageSize,sortField:D.sortField,sortOrder:D.sortOrder,visible:D.visible,genre:D.query.genre,category:D.query.category}))}}),g=T,p=n,y=ce("modalSelectVodSource"),l=be({vodSource:null,hls:null});fe(async()=>{K(),await m(),await a()}),Ae(()=>{l.hls&&(l.hls.stopLoad(),l.hls.destroy())});const m=async()=>{await I(),await h()},a=async()=>{w.value.query.sourceLocationId=p.sourceLocationId,G.value="",await v();var D=document.getElementById(y.value),$=we.getOrCreateInstance(D);$.show()},r=async()=>{var D=document.getElementById(y.value),$=we.getOrCreateInstance(D);$.hide(),l.hls&&(l.hls.stopLoad(),l.hls.destroy()),g(confirm?"confirm":"cancel",confirm?l.vodSource:null)},I=async D=>{try{const k=await B.get("/api/v1/lookups/video-categories/").then(F=>F.data);w.value.lookups.categories=k}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},h=async D=>{try{const k=await B.get("/api/v1/lookups/video-genres/").then(F=>F.data);w.value.lookups.genres=k}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},b=D=>{l.vodSource=D,O()},O=()=>{if(Hls.isSupported()){l.hls&&(l.hls.stopLoad(),l.hls.destroy());var D=document.getElementById("video-select-preview");const k=l.vodSource.video.formats.find(W=>W.formatName==="HLS"),F=k.serverUrl+k.path;l.hls=A.createHlsStream(D,F)}};return f({open:a,close:r}),(D,$)=>{const k=se("m-pagination"),F=se("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:y.value,tabindex:"-1","aria-hidden":"true"},[e("div",Tf,[e("div",If,[e("div",Mf,[e("h5",xf,[$[10]||($[10]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:$[0]||($[0]=W=>r()),"aria-label":"Close"})]),e("div",Cf,[z(F,{errorMessage:o(G)},{default:R(()=>[e("div",Vf,[e("div",Pf,[e("div",Of,[N(e("select",{"onUpdate:modelValue":$[1]||($[1]=W=>o(w).query.categoryId=W),class:"form-select",id:"category"},[(t(!0),s(U,null,q(o(w).lookups.categories,W=>(t(),s("option",{value:W.id},u(W.name),9,Af))),256))],512),[[ge,o(w).query.categoryId]]),$[11]||($[11]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",Uf,[e("div",Lf,[N(e("select",{"onUpdate:modelValue":$[2]||($[2]=W=>o(w).query.genreId=W),class:"form-select",id:"genre"},[(t(!0),s(U,null,q(o(w).lookups.genres,W=>(t(),s("option",{value:W.id},u(W.name),9,Hf))),256))],512),[[ge,o(w).query.genreId]]),$[12]||($[12]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",Df,[e("div",Ef,[e("div",qf,[N(e("input",{"onUpdate:modelValue":$[3]||($[3]=W=>o(w).query.criteria=W),onKeyup:$[4]||($[4]=Ue(W=>o(v)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[Z,o(w).query.criteria]]),$[13]||($[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:$[5]||($[5]=W=>o(v)(1))},$[14]||($[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",Bf,[e("div",Nf,[e("div",Rf,[$[19]||($[19]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),l.vodSource?(t(),s("div",Ff,[e("div",zf,[e("div",Gf,[N(e("input",{"onUpdate:modelValue":$[6]||($[6]=W=>l.vodSource.video.title=W),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[Z,l.vodSource.video.title]]),$[15]||($[15]=e("label",{for:"title"},"Title",-1))])]),e("div",jf,[e("div",null,[(t(!0),s(U,null,q(l.vodSource.video.genres,W=>(t(),s("span",Yf,u(W.genreName),1))),256)),(t(!0),s(U,null,q(l.vodSource.video.categories,W=>(t(),s("span",Wf,u(W.categoryName),1))),256))])]),e("div",Kf,[e("div",Qf,[e("div",Jf,[e("div",Xf,u(o(A).moment(l.vodSource.video.dateReleased).calendar()),1),$[16]||($[16]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Zf,[e("div",ep,[e("div",tp,u(o(A).moment.utc(l.vodSource.video.durationInMillis).format("HH:mm:ss")),1),$[17]||($[17]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",sp,[e("div",op,[N(e("textarea",{"onUpdate:modelValue":$[7]||($[7]=W=>l.vodSource.video.description=W),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[Z,l.vodSource.video.description]]),$[18]||($[18]=e("label",{for:"description"},"Description",-1))])])])):E("",!0)])]),e("div",ap,[e("div",lp,[e("table",np,[$[20]||($[20]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(w).items,(W,pe)=>(t(),s("tr",{key:W.videoId},[e("td",{textContent:u(o(Y)(pe)),class:"text-center"},null,8,rp),e("td",null,[e("div",ip,[e("div",null,[W.video.thumbnails.length>0?(t(!0),s(U,{key:0},q(W.video.thumbnails,ee=>(t(),s("div",dp,[e("img",{src:ee.url,class:"img-fuild border",width:"128"},null,8,up)]))),256)):(t(),s("img",cp))]),e("div",mp,[e("a",{onClick:ee=>b(W),class:"text-wrap link-offset-2",role:"button"},u(W.name),9,fp)])])])]))),128))]),_:1},512),[[ke,o(w).items.length>0]])])]),z(k,{filter:o(w),search:o(v),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",pp,[e("button",{onClick:$[8]||($[8]=W=>r()),class:"btn btn-primary",type:"button"},$[21]||($[21]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:$[9]||($[9]=W=>r()),class:"btn btn-secondary ms-1"},$[22]||($[22]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Sf)}}},gp=["disabled"],bp={class:"container1"},yp={class:"row"},$p={class:"col-12 col-lg-6"},wp={class:"col"},hp={class:"form-floating mb-2"},_p=["value"],kp={key:0,class:"d-block invalid-feedback"},Sp={class:"col"},Tp={class:"input-group mb-2"},Ip={class:"form-floating"},Mp={class:"col-12 col-lg-6"},xp={class:"col"},Cp={class:"form-floating mb-2"},Vp={key:0,class:"d-block invalid-feedback"},Pp={class:"row row-cols-1 row-cols-sm-3 mt-2"},Op={class:"col"},Ap={class:"form-floating mb-2"},Up={key:0},Lp={key:1},Hp={key:2},Dp={key:3,class:"d-block invalid-feedback"},Ep={class:"col"},qp={class:"form-floating mb-2"},Bp={key:0},Np={key:1},Rp={key:2,class:"d-block invalid-feedback"},Fp={class:"col"},zp={class:"form-floating mb-2"},Gp={key:0,class:"mt-3"},jp={class:"table-responsive border mt-1"},Yp={class:"table table-borderless table-sm mb-0 align-middle"},Wp={class:"text-center"},Kp=["onUpdate:modelValue","onChange"],Qp={key:0},Jp=["onUpdate:modelValue","onChange"],Xp={class:"text-start"},Zp=["onClick"],ev={class:"col mt-2"},tv={class:"row row-cols-1 row-cols-sm-2"},sv={class:"col"},ov={class:"form-floating mb-2"},av={class:"col"},lv={class:"form-floating mb-2"},nv={__name:"add",props:{urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Program Template"}),A=n,i=be({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{vodSource:null},startOffsetTime:null,endOffsetTime:null,item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},hls:null}),M={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ae.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ae.withMessage("startOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ae.withMessage("endOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0}}},w=Se(M,i),K=Ie(()=>{const k=x.moment;if(i.startOffsetTime&&i.startOffsetTime!=="00:00:00"&&x.isValidTime(i.startOffsetTime)){const F=k().startOf("day"),W=F.format("YYYY-MM-DD ")+i.startOffsetTime,ee=k(W).subtract(F);return i.item.startOffsetMillis=ee.valueOf(),i.item.startOffsetMillis}return 0}),X=Ie(()=>{const k=x.moment;if(i.endOffsetTime&&i.endOffsetTime!=="00:00:00"&&x.isValidTime(i.endOffsetTime)){const F=k().startOf("day"),W=F.format("YYYY-MM-DD ")+i.endOffsetTime,ee=k(W).subtract(F);return i.item.endOffsetMillis=ee.valueOf(),i.item.endOffsetMillis}return 0}),c=Ie(()=>i.item.endOffsetMillis-i.item.startOffsetMillis),v=Ie(()=>x.moment.utc(c.value).format("HH:mm:ss")),Y=Ie(()=>{const k=i.item.adBreaks;return k&&k.length>0?k.reduce((W,pe,ee)=>W+pe.durationInMillis,0):0}),d=Ie(()=>{const k=c.value+Y.value;return x.moment.utc(k).format("HH:mm:ss")}),C=Ie(()=>x.moment.utc(Y.value).format("HH:mm:ss"));fe(async()=>{await g()}),Ae(()=>{i.hls&&(i.hls.stopLoad(),i.hls.destroy())});const g=async()=>{await p(),await a()},p=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(F=>{i.lookups.sourceLocations=F.data,i.lookups.sourceLocations.length===1&&(i.item.sourceLocationId=i.lookups.sourceLocations[0].id)}),i.item.sourceLocationId&&await y(i.item.sourceLocationId)}catch(k){P.value=x.getErrorMessageAsHtml(k),window.scrollTo(0,0)}finally{}},y=async k=>{try{const F=`/api/v1/vodSources/lookup/source-location/${k}/?category=3`;await j.get(F).then(W=>{i.lookups.vodSources=W.data}),i.selected.vodSource=null,l()}catch(F){P.value=x.getErrorMessageAsHtml(F),window.scrollTo(0,0)}finally{}},l=async()=>{const k=i.selected.vodSource;k?(i.item.vodSourceId=k.id,i.endOffsetTime=x.moment.utc(k.durationInMillis).format("HH:mm:ss"),await m(k.vodSourceId),D()):(i.selected.vodSource=null,i.item.vodSourceId=null,i.startOffsetTime=null,i.endOffsetTime=null,i.hls&&(i.hls.stopLoad(),i.hls.destroy()))},m=async k=>{try{let F=`/api/v1/vodSources/${k}/blank-frames`;const W=await j.get(F).then(pe=>pe.data);i.item.adBreaks=[],W&&W.length>0&&(i.item.adBreaks=W.map(pe=>{const ee=(pe.endInMillis-pe.startInMillis)/2+pe.startInMillis;return{offsetTime:x.moment.utc(ee).format("HH:mm:ss"),offsetMillis:ee,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch{}finally{}},a=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(F=>{i.lookups.adBreakSourceLocations=F.data})}catch(k){P.value=x.getErrorMessageAsHtml(k),window.scrollTo(0,0)}finally{}},r=()=>{const k={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};i.item.adBreaks.push(k)},I=k=>{i.item.adBreaks.splice(k,1)},h=k=>{const F=x.moment,W=F().startOf("day"),pe=W.format("YYYY-MM-DD ")+k.offsetTime,S=F(pe).subtract(W);k.offsetMillis=S.valueOf()},b=k=>{const F=x.moment,W=F().startOf("day"),pe=W.format("YYYY-MM-DD ")+k.durationTime,S=F(pe).subtract(W);k.durationInMillis=S.valueOf()},O=async()=>{const k=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const W=x.clone(k.item),pe=W.adBreaks.filter(ee=>ee.durationInMillis>0);W.adBreaks=pe,await j.post("/api/v1/programtemplates/",W).then(ee=>{G.success("Add Program Template","Program template added.",{onClose:async()=>{const S=`${A.urlView}/${ee.data}`;await J.push(S)}})})}catch(W){P.value=x.getErrorMessageAsHtml(W),window.scrollTo(0,0)}finally{V.value=!1}},D=()=>{if(Hls.isSupported()){i.hls&&(i.hls.stopLoad(),i.hls.destroy());var k=document.getElementById("video-add-program-template");const W=i.selected.vodSource.video.formats.find(ee=>ee.formatName==="HLS"),pe=W.serverUrl+W.path;i.hls=x.createHlsStream(k,pe)}},$=async()=>{const k=Ee(mt,{sourceLocationId:i.item.sourceLocationId},{chore:!0,keepInitial:!1}),{data:F,isCanceled:W}=await k.reveal();if(k.closeAll(),!W&&F){const pe=F;i.selected.vodSource=pe,i.item.vodSourceId=pe.vodSourceId,i.startOffsetTime="00:00:00",i.endOffsetTime=x.moment.utc(pe.video.durationInMillis).format("HH:mm:ss"),await m(pe.vodSourceId),D()}};return(k,F)=>{const W=se("router-link"),pe=se("PageHeader"),ee=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(pe,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:F[0]||(F[0]=S=>O()),class:"btn btn-primary"},F[9]||(F[9]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,gp),z(W,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>F[10]||(F[10]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(ee,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[e("div",null,[e("div",bp,[e("div",yp,[e("div",$p,[e("div",wp,[e("div",hp,[N(e("select",{"onUpdate:modelValue":F[1]||(F[1]=S=>i.item.sourceLocationId=S),onChange:F[2]||(F[2]=S=>y(i.item.sourceLocationId)),class:te([o(x).getValidFeedbackCss(i.item.sourceLocationId),"form-select"]),id:"sourceLocationId"},[(t(!0),s(U,null,q(i.lookups.sourceLocations,S=>(t(),s("option",{value:S.id},u(S.name),9,_p))),256))],34),[[ge,i.item.sourceLocationId]]),F[11]||(F[11]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(w).item.sourceLocationId.$error?(t(),s("div",kp,[(t(!0),s(U,null,q(o(w).item.sourceLocationId.$errors,S=>(t(),s("div",{key:S.$uid},u(S.$message),1))),128))])):E("",!0)])]),e("div",Sp,[e("div",Tp,[e("div",Ip,[e("div",{id:"selectedVodSource",class:te([o(x).getValidFeedbackCss(i.selected.vodSource),"form-control"]),placeholder:"Title"},[i.selected.vodSource?(t(),s(U,{key:0},[Q(" ["+u(o(x).moment.utc(i.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+u(i.selected.vodSource.name),1)],64)):E("",!0)],2),F[12]||(F[12]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),i.item.sourceLocationId?(t(),s("button",{key:0,onClick:$,class:"btn btn-primary",type:"button"},F[13]||(F[13]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):E("",!0)])]),F[14]||(F[14]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program-template",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Mp,[e("div",xp,[e("div",Cp,[N(e("input",{"onUpdate:modelValue":F[3]||(F[3]=S=>i.item.name=S),id:"name",class:te([o(x).getValidFeedbackCss(i.item.name),"form-control"]),placeholder:"Name"},null,2),[[Z,i.item.name]]),F[15]||(F[15]=e("label",{for:"name",class:""},"Name",-1)),o(w).item.name.$error?(t(),s("div",Vp,[(t(!0),s(U,null,q(o(w).item.name.$errors,S=>(t(),s("div",{key:S.$uid},u(S.$message),1))),128))])):E("",!0)])]),e("div",Pp,[e("div",Op,[e("div",null,[e("div",Ap,[N(e("input",{"onUpdate:modelValue":F[4]||(F[4]=S=>i.startOffsetTime=S),type:"time",step:"1",id:"startOffsetTime",class:te([o(x).getValidFeedbackCss(i.startOffsetTime),"form-control"])},null,2),[[Z,i.startOffsetTime]]),F[16]||(F[16]=e("label",{for:"startOffsetTime",class:""}," Start OffSet Time ",-1))]),K.value>0&&K.value<3e4?(t(),s("div",Up,F[17]||(F[17]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):E("",!0),K.value>X.value&&X.value>0?(t(),s("div",Lp,F[18]||(F[18]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):E("",!0),i.selected.vodSource&&K.value>=i.selected.vodSource.durationInMillis?(t(),s("div",Hp,F[19]||(F[19]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):E("",!0),o(w).item.startOffsetMillis.$error?(t(),s("div",Dp,[(t(!0),s(U,null,q(o(w).item.startOffsetMillis.$errors,S=>(t(),s("div",{key:S.$uid},u(S.$message),1))),128))])):E("",!0)])]),e("div",Ep,[e("div",null,[e("div",qp,[N(e("input",{"onUpdate:modelValue":F[5]||(F[5]=S=>i.endOffsetTime=S),type:"time",step:"1",id:"endOffsetTime",class:te([o(x).getValidFeedbackCss(i.endOffsetTime),"form-control"])},null,2),[[Z,i.endOffsetTime]]),F[20]||(F[20]=e("label",{for:"endOffsetTime",class:""}," End OffSet Time ",-1))]),X.value>0&&X.value<3e4?(t(),s("div",Bp,F[21]||(F[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):E("",!0),i.selected.vodSource&&X.value>i.selected.vodSource.durationInMillis?(t(),s("div",Np,F[22]||(F[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):E("",!0),o(w).item.endOffsetMillis.$error?(t(),s("div",Rp,[(t(!0),s(U,null,q(o(w).item.endOffsetMillis.$errors,S=>(t(),s("div",{key:S.$uid},u(S.$message),1))),128))])):E("",!0)])]),e("div",Fp,[e("div",zp,[N(e("input",{"onUpdate:modelValue":F[6]||(F[6]=S=>v.value=S),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[Z,v.value]]),F[23]||(F[23]=e("label",{for:"durationTime"},"Clip",-1))])])]),i.item.vodSourceId?(t(),s("div",Gp,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[F[25]||(F[25]=e("div",{class:"fw-bold small"}," Ad Break ",-1)),e("div",null,[e("button",{onClick:r,class:"btn btn-outline-primary btn-sm"},F[24]||(F[24]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",jp,[e("table",Yp,[F[28]||(F[28]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(i.item.adBreaks,(S,ue)=>(t(),s("tr",null,[e("td",Wp,u(ue+1),1),e("td",null,[N(e("input",{"onUpdate:modelValue":le=>S.offsetTime=le,onChange:le=>h(S),type:"time",step:"1",class:"form-control"},null,40,Kp),[[Z,S.offsetTime]]),S.offsetMillis>=i.selected.vodSource.durationInMillis?(t(),s("div",Qp,F[26]||(F[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):E("",!0)]),e("td",null,[N(e("input",{"onUpdate:modelValue":le=>S.durationTime=le,onChange:le=>b(S),type:"time",step:"1",class:"form-control"},null,40,Jp),[[Z,S.durationTime]])]),e("td",Xp,[e("button",{onClick:le=>I(ue),class:"btn btn-outline-warning btn-sm"},F[27]||(F[27]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Zp)])]))),256))])]),F[29]||(F[29]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),Q(" Vod source will be defined in Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):E("",!0),e("div",ev,[F[32]||(F[32]=e("div",{class:"fw-bold small"}," Duration ",-1)),e("div",tv,[e("div",sv,[e("div",ov,[N(e("input",{"onUpdate:modelValue":F[7]||(F[7]=S=>C.value=S),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[Z,C.value]]),F[30]||(F[30]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",av,[e("div",lv,[N(e("input",{"onUpdate:modelValue":F[8]||(F[8]=S=>d.value=S),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[Z,d.value]]),F[31]||(F[31]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},rv=["disabled"],iv={class:"container1"},dv={class:"row"},uv={class:"col-12 col-lg-6"},cv={class:"col"},mv={class:"form-floating mb-2"},fv=["value"],pv={key:0,class:"d-block invalid-feedback"},vv={class:"col"},gv={class:"input-group mb-2"},bv={class:"form-floating"},yv={id:"selectedVodSource",class:"form-control",placeholder:"Title"},$v={class:"col-12 col-lg-6"},wv={class:"col"},hv={class:"form-floating mb-2"},_v={key:0,class:"d-block invalid-feedback"},kv={class:"row row-cols- row-cols-sm-3"},Sv={class:"col"},Tv={class:"form-floating mb-2"},Iv={key:0},Mv={key:1},xv={key:2},Cv={key:3,class:"d-block invalid-feedback"},Vv={class:"col"},Pv={class:"form-floating"},Ov={key:0},Av={key:1},Uv={key:2,class:"d-block invalid-feedback"},Lv={class:"col"},Hv={class:"form-floating mb-2"},Dv={key:0,class:"mt-2"},Ev={class:"table-responsive border mt-1"},qv={class:"table table-borderless table-sm mb-0 align-middle"},Bv=["onUpdate:modelValue","onChange"],Nv={key:0},Rv=["onUpdate:modelValue","onChange"],Fv=["onClick"],zv={class:"col mt-2"},Gv={class:"row row-cols-1 row-cols-sm-2"},jv={class:"col"},Yv={class:"form-floating mb-2"},Wv={class:"col"},Kv={class:"form-floating mb-2"},Qv={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,closeWithReturnUrl:B,security:A}=$e({appTitle:"Arcadian-FAST",pageTitle:"Edit Program Template"}),i=n,M=be({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{sourceLocation:null,vodSource:null},startOffsetTime:"00:00:00",endOffsetTime:"00:00:00",item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),w=ce(!0),K={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ae.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ae.withMessage("startOffsetMillis is required.",re),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ae.withMessage("endOffsetMillis is required.",re),$autoDirty:!0,$lazy:!0}}},X=Se(K,M),c=Ie(()=>{if(M.startOffsetTime&&M.startOffsetTime!=="00:00:00"&&x.isValidTime(M.startOffsetTime)){const ee=x.moment,S=ee().startOf("day"),le=ee(M.startOffsetTime,"hh:mm:ss").diff(S);return M.item.startOffsetMillis=le.valueOf(),M.item.startOffsetMillis}return 0}),v=Ie(()=>{if(M.endOffsetTime&&M.endOffsetTime!=="00:00:00"&&x.isValidTime(M.endOffsetTime)){const ee=x.moment,S=ee().startOf("day"),le=ee(M.endOffsetTime,"hh:mm:ss").diff(S);return M.item.endOffsetMillis=le.valueOf(),M.item.endOffsetMillis}return 0}),Y=Ie(()=>M.item.endOffsetMillis-M.item.startOffsetMillis),d=Ie(()=>x.moment.utc(Y.value).format("HH:mm:ss")),C=Ie(()=>{const ee=M.item.adBreaks;return ee&&ee.length>0?ee.reduce((ue,le,ie)=>ue+le.durationInMillis,0):0}),g=Ie(()=>{const ee=Y.value+C.value;return x.moment.utc(ee).format("HH:mm:ss")}),p=Ie(()=>x.moment.utc(C.value).format("HH:mm:ss"));fe(async()=>{await y()});const y=async()=>{await l(),await m(),await a()},l=async()=>{try{const ee=`/api/v1/programtemplates/${i.id}/`;await j.get(ee).then(S=>{M.item=S.data}),M.startOffsetTime=x.moment.utc(M.item.startOffsetMillis).format("HH:mm:ss"),M.endOffsetTime=x.moment.utc(M.item.endOffsetMillis).format("HH:mm:ss"),M.item.adBreaks.forEach(S=>{S.offsetTime=x.moment.utc(S.offsetMillis).format("HH:mm:ss"),S.durationTime=x.moment.utc(S.durationInMillis).format("HH:mm:ss")})}catch(ee){P.value=x.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},m=async()=>{try{const ee=`/api/v1/vodSources/${M.item.vodSourceId}/`;await j.get(ee).then(S=>{M.selected.vodSource=S.data}),F()}catch(ee){P.value=x.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},a=async()=>{await r()},r=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(S=>{M.lookups.sourceLocations=S.data}),M.item.sourceLocationId&&await I(M.item.sourceLocationId)}catch(ee){P.value=x.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},I=async ee=>{try{const S=`/api/v1/vodSources/lookup/source-location/${ee}/?type=3`;if(await j.get(S).then(ue=>{M.lookups.vodSources=ue.data}),w.value){w.value=!1;return}M.selected.vodSource=null,h()}catch(S){P.value=x.getErrorMessageAsHtml(S),window.scrollTo(0,0)}finally{}},h=async()=>{const ee=M.selected.vodSource;if(ee){debugger;M.item.vodSourceId=ee.vodSourceId,M.startOffsetTime=x.moment.utc(0).format("HH:mm:ss"),M.endOffsetTime=x.moment.utc(ee.video.durationInMillis).format("HH:mm:ss"),F()}else M.selected.vodSource=null,M.item.vodSourceId=null,M.startOffsetTime=null,M.endOffsetTime=null,M.hls&&(M.hls.stopLoad(),M.hls.destroy())},b=()=>{const ee={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};M.item.adBreaks.push(ee)},O=ee=>{M.item.adBreaks.splice(ee,1)},D=ee=>{const S=x.moment,ue=S().startOf("day"),le=ue.format("YYYY-MM-DD ")+ee.offsetTime,ne=S(le).subtract(ue);ee.offsetMillis=ne.valueOf()},$=ee=>{const S=x.moment,ue=S().startOf("day"),le=ue.format("YYYY-MM-DD ")+ee.durationTime,ne=S(le).subtract(ue);ee.durationInMillis=ne.valueOf()},k=async()=>{const ee=M;if(V.value)return;if(!await X.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const ue=x.clone(ee.item);debugger;ue.startOffsetMillis=c.value,ue.endOffsetMillis=v.value,await j.put("/api/v1/programtemplates/",ue).then(le=>{G.success("Edit Program Template","Program template edit.",{onClose:async()=>{const ie=`${i.urlView}/${i.id}`;await J.push(ie)}})})}catch(ue){P.value=x.getErrorMessageAsHtml(ue),window.scrollTo(0,0)}finally{V.value=!1}},F=()=>{if(Hls.isSupported()){M.hls&&(M.hls.stopLoad(),M.hls.destroy());var ee=document.getElementById("video-edit-program-template");const ue=M.selected.vodSource.video.formats.find(ie=>ie.formatName==="HLS"),le=ue.serverUrl+ue.path;M.hls=x.createHlsStream(ee,le)}},W=async ee=>{try{let S=`/api/v1/vodSources/${ee}/blank-frames`;const ue=await j.get(S).then(le=>le.data);M.item.adBreaks=[],ue&&ue.length>0&&(M.item.adBreaks=ue.map(le=>{const ie=(le.endInMillis-le.startInMillis)/2+le.startInMillis;return{offsetTime:x.moment.utc(ie).format("HH:mm:ss"),offsetMillis:ie,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch(S){P.value=x.getErrorMessageAsHtml(S),window.scrollTo(0,0)}finally{}},pe=async()=>{const ee=Ee(mt,{sourceLocationId:M.sourceLocationId},{chore:!0,keepInitial:!1}),{data:S,isCanceled:ue}=await ee.reveal();if(ee.closeAll(),!ue&&S){const le=S;M.selected.vodSource=le,M.item.vodSourceId=le.vodSourceId,h();debugger;await W(le.vodSourceId)}};return(ee,S)=>{const ue=se("PageHeader"),le=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(ue,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(X).$dirty&&o(X).$invalid,onClick:S[0]||(S[0]=ie=>k()),class:"btn btn-primary"},S[11]||(S[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,rv),e("button",{onClick:S[1]||(S[1]=ie=>y()),class:"btn btn-secondary ms-2"},S[12]||(S[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:S[2]||(S[2]=ie=>o(B)(i.urlMain)),class:"btn btn-secondary ms-1"},S[13]||(S[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(le,{errorMessage:o(P),vuelidate:o(X)},{default:R(()=>[e("div",null,[e("div",iv,[e("div",dv,[e("div",uv,[e("div",cv,[e("div",mv,[N(e("select",{"onUpdate:modelValue":S[3]||(S[3]=ie=>M.item.sourceLocationId=ie),onChange:S[4]||(S[4]=ie=>I(M.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(U,null,q(M.lookups.sourceLocations,ie=>(t(),s("option",{value:ie.id},u(ie.name),9,fv))),256))],544),[[ge,M.item.sourceLocationId]]),S[14]||(S[14]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(X).item.sourceLocationId.$error?(t(),s("div",pv,[(t(!0),s(U,null,q(o(X).item.sourceLocationId.$errors,ie=>(t(),s("div",{key:ie.$uid},u(ie.$message),1))),128))])):E("",!0)])]),e("div",vv,[e("div",gv,[e("div",bv,[e("div",yv,[M.selected.vodSource?(t(),s(U,{key:0},[Q(" ["+u(o(x).moment.utc(M.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+u(M.selected.vodSource.name),1)],64)):E("",!0)]),S[15]||(S[15]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),e("button",{onClick:pe,class:"btn btn-primary",type:"button"},S[16]||(S[16]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))])]),S[17]||(S[17]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-edit-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",$v,[e("div",wv,[e("div",hv,[N(e("input",{"onUpdate:modelValue":S[5]||(S[5]=ie=>M.item.name=ie),id:"name",class:te([o(x).getValidFeedbackCss(M.item.name),"form-control"]),placeholder:"Name"},null,2),[[Z,M.item.name]]),S[18]||(S[18]=e("label",{for:"name",class:""},"Name",-1)),o(X).item.name.$error?(t(),s("div",_v,[(t(!0),s(U,null,q(o(X).item.name.$errors,ie=>(t(),s("div",{key:ie.$uid},' d" '+u(ie.$message),1))),128))])):E("",!0)])]),e("div",kv,[e("div",Sv,[e("div",Tv,[N(e("input",{"onUpdate:modelValue":S[6]||(S[6]=ie=>M.startOffsetTime=ie),type:"time",step:"1",id:"startOffsetTime",class:te([o(x).getValidFeedbackCss(M.startOffsetTime),"form-control"])},null,2),[[Z,M.startOffsetTime]]),S[19]||(S[19]=e("label",{for:"startOffsetTime",class:""},"Start OffSet Time",-1))]),c.value>0&&c.value<3e4?(t(),s("div",Iv,S[20]||(S[20]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):E("",!0),c.value>v.value&&v.value>0?(t(),s("div",Mv,S[21]||(S[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):E("",!0),M.selected.vodSource&&c.value>=M.selected.vodSource.durationInMillis?(t(),s("div",xv,S[22]||(S[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):E("",!0),o(X).item.startOffsetMillis.$error?(t(),s("div",Cv,[(t(!0),s(U,null,q(o(X).item.startOffsetMillis.$errors,ie=>(t(),s("div",{key:ie.$uid},u(ie.$message),1))),128))])):E("",!0)]),e("div",Vv,[e("div",Pv,[N(e("input",{"onUpdate:modelValue":S[7]||(S[7]=ie=>M.endOffsetTime=ie),type:"time",step:"1",id:"endOffsetTime",class:te([o(x).getValidFeedbackCss(M.endOffsetTime),"form-control"])},null,2),[[Z,M.endOffsetTime]]),S[23]||(S[23]=e("label",{for:"endOffsetTime",class:""},"End OffSet Time",-1))]),v.value>0&&v.value<3e4?(t(),s("div",Ov,S[24]||(S[24]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):E("",!0),M.selected.vodSource&&v.value>M.selected.vodSource.durationInMillis?(t(),s("div",Av,S[25]||(S[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):E("",!0),o(X).item.endOffsetMillis.$error?(t(),s("div",Uv,[(t(!0),s(U,null,q(o(X).item.endOffsetMillis.$errors,ie=>(t(),s("div",{key:ie.$uid},u(ie.$message),1))),128))])):E("",!0)]),e("div",Lv,[e("div",Hv,[N(e("input",{"onUpdate:modelValue":S[8]||(S[8]=ie=>d.value=ie),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[Z,d.value]]),S[26]||(S[26]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),M.selected.vodSource?(t(),s("div",Dv,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[S[28]||(S[28]=e("b",null," Ad Break ",-1)),e("div",null,[e("button",{onClick:b,class:"btn btn-outline-primary btn-sm"},S[27]||(S[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",Ev,[e("table",qv,[S[31]||(S[31]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(M.item.adBreaks,(ie,ne)=>(t(),s("tr",null,[e("td",null,u(ne+1),1),e("td",null,[N(e("input",{"onUpdate:modelValue":L=>ie.offsetTime=L,onChange:L=>D(ie),type:"time",step:"1",class:"form-control"},null,40,Bv),[[Z,ie.offsetTime]]),ie.offsetMillis>=M.selected.vodSource.durationInMillis?(t(),s("div",Nv,S[29]||(S[29]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):E("",!0)]),e("td",null,[N(e("input",{"onUpdate:modelValue":L=>ie.durationTime=L,onChange:L=>$(ie),type:"time",step:"1",class:"form-control"},null,40,Rv),[[Z,ie.durationTime]])]),e("td",null,[e("button",{onClick:L=>O(ne),class:"btn btn-outline-warning btn-sm"},S[30]||(S[30]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Fv)])]))),256))])]),S[32]||(S[32]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),Q(" Vod source will be defined in Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):E("",!0),e("div",zv,[S[35]||(S[35]=e("b",null," Duration ",-1)),e("div",Gv,[e("div",jv,[e("div",Yv,[N(e("input",{"onUpdate:modelValue":S[9]||(S[9]=ie=>p.value=ie),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[Z,p.value]]),S[33]||(S[33]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",Wv,[e("div",Kv,[N(e("input",{"onUpdate:modelValue":S[10]||(S[10]=ie=>g.value=ie),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[Z,g.value]]),S[34]||(S[34]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Jv={class:"ms-1"},Xv={class:"input-group"},Zv={class:"table-responsive border shadow-sm"},eg={class:"table table-hover mb-0"},tg=["textContent"],sg={class:"d-flex flex-row"},og={class:""},ag={class:"mb-1"},lg=["src"],ng={class:"ms-2"},rg={key:0,class:"fas fa-fw fa-check-circle text-success"},ig={class:"text-wrap text-truncate",style:{width:"20px !important"}},dg={class:"badge bg-primary me-1"},ug={key:0},cg={class:"badge bg-info me-1"},mg={class:"text-end me-0 me-sm-5"},fg={class:"text-center"},pg={class:"mt-1"},vg="/api/v1/programTemplates/search",gg={__name:"index",props:{urlAdd:{type:String,default:"/program-templates/add"},urlView:{type:String,default:"/program-templates/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(n){Me("$config");const T=he().user,{appTitle:V,pageTitle:_,busy:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,generateReturnUrl:i,security:M,filter:w,initializeFilter:K,getQuery:X,saveQuery:c,search:v,getRowNumber:Y,setSelected:d,isSelected:C}=Le({appTitle:"Arcadian-FAST",pageTitle:"Program Templates",cacheKey:`${T==null?void 0:T.userId}/program-templates/search`,baseUrl:vg,filter:{updateUrl:!0}});return fe(async()=>{K(),await v()}),(g,p)=>{const y=se("router-link"),l=se("PageHeader"),m=se("m-pagination"),a=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(l,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(_)},{default:R(()=>[z(y,{to:n.urlAdd,class:"btn btn-primary"},{default:R(()=>p[3]||(p[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Jv,[e("div",Xv,[N(e("input",{"onUpdate:modelValue":p[0]||(p[0]=r=>o(w).query.criteria=r),onKeyup:p[1]||(p[1]=Ue(r=>o(v)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[Z,o(w).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:p[2]||(p[2]=r=>o(v)(1))},p[4]||(p[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(a,{errorMessage:o(j)},{default:R(()=>[e("div",Zv,[e("table",eg,[p[5]||(p[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th",null,"Source")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(w).items,(r,I)=>(t(),s("tr",{key:r.programTemplateId},[e("td",{textContent:u(o(Y)(I)),class:"text-center"},null,8,tg),e("td",null,[e("div",sg,[e("div",og,[r.vodSource.video.thumbnails.length>0?(t(!0),s(U,{key:0},q(r.vodSource.video.thumbnails,h=>(t(),s("div",ag,[e("img",{src:h.url,class:"img-fuild border",width:"128"},null,8,lg)]))),256)):E("",!0)]),e("div",ng,[z(y,{to:`${n.urlView}/${r.programTemplateId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[r.arn?(t(),s("span",rg)):E("",!0),e("span",ig,u(r.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(U,null,q(r.vodSource.video.categories,h=>(t(),s("div",null,[e("span",dg,u(h.categoryName),1)]))),256)),r.vodSource.video.genres.length>0?(t(),s("div",ug,[(t(!0),s(U,null,q(r.vodSource.video.genres,h=>(t(),s("span",cg,u(h.genreName),1))),256))])):E("",!0)])])])]),e("td",mg,u(o(oe).moment.utc(r.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",fg,u(r.adBreaks.length),1),e("td",null,[e("div",null,[z(y,{to:`${n.urlViewSourceLocation}/${r.sourceLocationId}/${o(i)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(r.sourceLocation.name),1)]),_:2},1032,["to"])]),e("div",pg,[z(y,{to:`${n.urlViewVodSource}/${r.vodSourceId}/${o(i)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(r.vodSource.name),1)]),_:2},1032,["to"])])])]))),128))]),_:1},512),[[ke,o(w).items.length>0]])])]),z(m,{filter:o(w),search:o(v),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},bg={key:0},yg={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},$g={class:"nav-item",role:"presentation"},wg={class:"nav-item",role:"presentation"},hg={class:"nav-item d-none",role:"presentation"},_g={class:"tab-content",id:"myTabContent"},kg={class:"mt-2"},Sg={class:""},Tg={class:"row row-cols-1 row-cols-lg-2"},Ig={class:"col"},Mg={class:"col"},xg={class:"form-floating mb-2"},Cg={id:"sourceLocation",class:"form-control-plaintext"},Vg={class:"col"},Pg={class:"form-floating mb-2"},Og={id:"vodSource",class:"form-control-plaintext"},Ag={class:"col"},Ug={class:"col"},Lg={class:"form-floating mb-2"},Hg={class:"row row-cols-1 row-cols-sm-3"},Dg={class:"col"},Eg={class:"form-floating mb-2"},qg={class:"col"},Bg={class:"form-floating mb-2"},Ng={class:"col"},Rg={class:"form-floating mb-2"},Fg={class:"row row-cols-1 row-cols-sm-3"},zg={class:"col"},Gg={class:"form-floating mb-2"},jg={class:"col"},Yg={class:"form-floating mb-2"},Wg={class:"mt-2"},Kg={class:"table-responsive"},Qg={class:"table table-hover mb-0"},Jg={class:"text-center"},Xg={class:"mt-2"},Zg={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/program-templates"},urlEdit:{type:String,default:"/program-templates/edit"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(n){const f=n,{appTitle:T,pageTitle:V,busy:_,isDirty:H,validations:P,infoMessage:J,warningMessage:j,errorMessage:x,router:G,axios:oe,utils:B,toasts:A,close:i,closeWithReturnUrl:M,generateReturnUrl:w,security:K}=$e({appTitle:"Arcadian-FAST",pageTitle:"View Program Template"});Me("$config");const X=he();X.user;const c=be({user:X.user,item:null,hls:null}),v=ce();fe(async()=>{await g(),v.value=B.getPageTab("programTemplate")||"information-tab"});const Y=l=>{B.setPageTab("programTemplate",l),v.value=l},d=l=>l!==v.value?"":"active",C=l=>l!==v.value?"":"show active",g=async()=>{const l=c;if(!_.value)try{_.value=!0,x.value="",c.item=null;const m=`/api/v1/programTemplates/${f.id}/`;await oe.get(m).then(a=>{l.item=a.data;const r=l.item;r.startOffsetTime=B.moment.utc(r.startOffsetMillis).format("HH:mm:ss"),r.endOffsetTime=B.moment.utc(r.endOffsetMillis).format("HH:mm:ss"),r.durationTime=B.moment.utc(r.durationInMillis).format("HH:mm:ss"),r.adBreaksDurationTime=B.moment.utc(r.adBreaksDurationInMillis).format("HH:mm:ss"),r.totalProgramTemplateDurationTime=B.moment.utc(r.totalProgramTemplateDurationInMillis).format("HH:mm:ss");const I=r.vodSource.video,h=I.durationInMillis;I.durationInMillis=B.moment.utc(h).format("HH:mm:ss")}),c.item.vodSource&&await y(c.item.vodSourceId)}catch(m){x.value=B.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{_.value=!1}},p=async()=>{await g()},y=async l=>{try{let m=`/api/v1/vodSources/${l}/hls`;const a=await oe.get(m).then(I=>I.data);c.hls&&c.hls.destroy();const r=document.getElementById("video-view-program-template");c.hls=B.createHlsStream(r,a,"Previewing VOD.")}catch(m){x.value=B.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{}};return(l,m)=>{const a=se("router-link"),r=se("PageHeader"),I=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(r,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(V)},{default:R(()=>[z(a,{to:`${n.urlEdit}/${n.id}/${o(w)()}`,class:"ms-2 btn btn-primary"},{default:R(()=>m[11]||(m[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:m[0]||(m[0]=h=>p()),class:"ms-2 btn btn-secondary"},m[12]||(m[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:m[1]||(m[1]=h=>o(M)(f.urlMain)),class:"btn btn-secondary ms-1"},m[13]||(m[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(I,{errorMessage:o(x)},{default:R(()=>[c.item?(t(),s("div",bg,[e("div",null,[e("ul",yg,[e("li",$g,[e("button",{onClick:m[2]||(m[2]=h=>Y("information-tab")),class:te([d("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",wg,[e("button",{onClick:m[3]||(m[3]=h=>Y("adBreaks-tab")),class:te([d("adBreaks-tab"),"nav-link"]),id:"adBreaks-tab","data-bs-toggle":"tab","data-bs-target":"#adBreaks",type:"button",role:"tab","aria-controls":"adBreaks","aria-selected":"false"}," Ad Breaks ",2)]),e("li",hg,[e("button",{onClick:m[4]||(m[4]=h=>Y("programs-tab")),class:te([d("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",_g,[e("div",{class:te([C("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",kg,[e("div",Sg,[e("div",Tg,[e("div",Ig,[e("div",Mg,[e("div",xg,[e("div",Cg,[z(a,{to:`${n.urlViewSourceLocation}/${c.item.sourceLocationId}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(c.item.sourceLocation.name),1)]),_:1},8,["to"])]),m[14]||(m[14]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",Vg,[e("div",Pg,[e("div",Og,[z(a,{to:`${n.urlViewVodSource}/${c.item.vodSourceId}/${o(w)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(c.item.vodSource.name),1)]),_:1},8,["to"])]),m[15]||(m[15]=e("label",{for:"vodSource",class:""},"VOD Name",-1))])]),m[16]||(m[16]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-view-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Ag,[e("div",Ug,[e("div",Lg,[N(e("input",{"onUpdate:modelValue":m[5]||(m[5]=h=>c.item.name=h),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[Z,c.item.name]]),m[17]||(m[17]=e("label",{for:"name",class:""},"Name",-1))])]),e("div",Hg,[e("div",Dg,[e("div",Eg,[N(e("input",{"onUpdate:modelValue":m[6]||(m[6]=h=>c.item.startOffsetTime=h),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[Z,c.item.startOffsetTime]]),m[18]||(m[18]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",qg,[e("div",Bg,[N(e("input",{"onUpdate:modelValue":m[7]||(m[7]=h=>c.item.endOffsetTime=h),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[Z,c.item.endOffsetTime]]),m[19]||(m[19]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",Ng,[e("div",Rg,[N(e("input",{"onUpdate:modelValue":m[8]||(m[8]=h=>c.item.durationTime=h),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[Z,c.item.durationTime]]),m[20]||(m[20]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",Fg,[e("div",zg,[e("div",Gg,[N(e("input",{"onUpdate:modelValue":m[9]||(m[9]=h=>c.item.adBreaksDurationTime=h),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[Z,c.item.adBreaksDurationTime]]),m[21]||(m[21]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks",-1))])]),e("div",jg,[e("div",Yg,[N(e("input",{"onUpdate:modelValue":m[10]||(m[10]=h=>c.item.totalProgramTemplateDurationTime=h),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[Z,c.item.totalProgramTemplateDurationTime]]),m[22]||(m[22]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])])])])])])])],2),e("div",{class:te([C("adBreaks-tab"),"tab-pane fade"]),id:"adBreaks",role:"tabpanel","aria-labelledby":"adBreaks-tab"},[e("div",Wg,[e("div",Kg,[e("table",Qg,[m[23]||(m[23]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Offset"),e("th",null,"Duration")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.adBreaks,(h,b)=>(t(),s("tr",{key:h.programTemplateAdBreakId},[e("td",Jg,u(b+1),1),e("td",null,u(o(B).moment.utc(h.offsetMillis).format("HH:mm:ss")),1),e("td",null,u(o(B).moment.utc(h.durationInMillis).format("HH:mm:ss")),1)]))),128))]),_:1},512),[[ke,c.item.adBreaks.length>0]])])])])],2),e("div",{class:te([C("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",Xg,[e("pre",null,u(c.item.programs),1)])],2)])])])):E("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},e1=["disabled"],t1={class:"row row-cols-1 row-cols-sm-3"},s1={class:"col-sm-6"},o1={class:"form-floating mb-2"},a1={key:0,class:"d-block invalid-feedback"},l1={class:"col-sm-3"},n1={class:"form-floating mb-2"},r1={key:0,class:"d-block invalid-feedback"},i1={class:"col-sm-3"},d1={class:"form-floating mb-2"},u1={key:0,class:"d-block invalid-feedback"},c1={class:"row row-cols-1 row-cols-sm-2"},m1={class:"col"},f1={class:"form-floating mb-2"},p1=["value"],v1={key:0,class:"d-block invalid-feedback"},g1={class:"col"},b1={class:"form-floating mb-2"},y1=["value"],$1={key:0,class:"d-block invalid-feedback"},w1={__name:"add",props:{urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Channel"}),A=n,i=be({lookups:{sourceLocations:[],vodSources:[]},item:{name:"",tier:"STANDARD",playbackMode:"LINEAR",fillerSlateSourceLocationId:null,fillerSlateVodSourceId:null,policy:null}}),M={item:{name:{title:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},tier:{title:ae.withMessage("Tier is required.",re),$autoDirty:!0,$lazy:!0},playbackMode:{title:ae.withMessage("PlaybackMode is required.",re),$autoDirty:!0,$lazy:!0},fillerSlateSourceLocationId:{title:ae.withMessage("Filler Slate Source Location is required.",re),$autoDirty:!0,$lazy:!0},fillerSlateVodSourceId:{title:ae.withMessage("Filler Slate Vod Source is required.",re),$autoDirty:!0,$lazy:!0},policy:{title:ae.withMessage("Policy is required.",re),$autoDirty:!0,$lazy:!0}}},w=Se(M,i);fe(async()=>{await K()});const K=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(C=>{i.lookups.sourceLocations=C.data,i.lookups.sourceLocations.length===1&&(i.item.fillerSlateSourceLocationId=i.lookups.sourceLocations[0].id)}),i.item.fillerSlateSourceLocationId&&await c(i.item.fillerSlateSourceLocationId)}catch(d){P.value=x.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}},X=async()=>{i.item.fillerSlateVodSourceId=null,await c(i.item.fillerSlateSourceLocationId)},c=async d=>{try{let C=`/api/v1/vodSources/lookup/source-location/${d}/?category=2`;await j.get(C).then(g=>{i.lookups.vodSources=g.data})}catch(C){P.value=x.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{}},v=()=>{if(i.item.name){const d=`{"Version":"2012-10-17","Statement": [{"Sid":"AllowAnonymous","Effect":"Allow","Principal":"*","Action":"mediatailor:GetManifest","Resource":"arn:aws:mediatailor:us-west-2:799350865909:channel/${i.item.name}"}]}`;i.item.policy=d}else i.item.policy=null},Y=async()=>{const d=i;if(V.value)return;if(!await w.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const g=x.clone(d.item);await j.post("/api/v1/channels/",g).then(p=>{G.success("Add Channel","Channel added.",{onClose:async()=>{const y=`${A.urlView}/${p.data}`;await J.push(y)}})})}catch(g){P.value=x.getErrorMessageAsHtml(g),window.scrollTo(0,0)}finally{V.value=!1}};return(d,C)=>{const g=se("router-link"),p=se("PageHeader"),y=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(p,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(w).$dirty&&o(w).$invalid,onClick:C[0]||(C[0]=l=>Y()),class:"btn btn-primary"},C[8]||(C[8]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,e1),z(g,{to:A.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>C[9]||(C[9]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(y,{errorMessage:o(P),vuelidate:o(w)},{default:R(()=>[e("div",null,[e("div",t1,[e("div",s1,[e("div",o1,[N(e("input",{"onUpdate:modelValue":C[1]||(C[1]=l=>i.item.name=l),onChange:C[2]||(C[2]=l=>v()),id:"name",class:te([o(x).getValidFeedbackCss(i.item.name),"form-control"]),placeholder:"name"},null,34),[[Z,i.item.name]]),C[10]||(C[10]=e("label",{for:"name",class:""},"Name",-1)),o(w).item.name.$error?(t(),s("div",a1,[(t(!0),s(U,null,q(o(w).item.name.$errors,l=>(t(),s("div",{key:l.$uid},u(l.$message),1))),128))])):E("",!0)])]),e("div",l1,[e("div",n1,[N(e("input",{"onUpdate:modelValue":C[3]||(C[3]=l=>i.item.tier=l),id:"tier",class:"form-control-plaintext",placeholder:"tier",readonly:""},null,512),[[Z,i.item.tier]]),C[11]||(C[11]=e("label",{for:"tier",class:""},"Tier",-1)),o(w).item.tier.$error?(t(),s("div",r1,[(t(!0),s(U,null,q(o(w).item.tier.$errors,l=>(t(),s("div",{key:l.$uid},u(l.$message),1))),128))])):E("",!0)])]),e("div",i1,[e("div",d1,[N(e("input",{"onUpdate:modelValue":C[4]||(C[4]=l=>i.item.playbackMode=l),id:"playbackMode",class:"form-control-plaintext",placeholder:"playbackMode",readonly:""},null,512),[[Z,i.item.playbackMode]]),C[12]||(C[12]=e("label",{for:"playbackMode",class:""},"PlaybackMode",-1)),o(w).item.playbackMode.$error?(t(),s("div",u1,[(t(!0),s(U,null,q(o(w).item.playbackMode.$errors,l=>(t(),s("div",{key:l.$uid},u(l.$message),1))),128))])):E("",!0)])])]),C[15]||(C[15]=e("div",{class:"mt-2"},[e("h5",null,"Filler Slate")],-1)),e("div",c1,[e("div",m1,[e("div",f1,[N(e("select",{"onUpdate:modelValue":C[5]||(C[5]=l=>i.item.fillerSlateSourceLocationId=l),onChange:C[6]||(C[6]=l=>X()),class:te([o(x).getValidFeedbackCss(i.item.fillerSlateSourceLocationId),"form-select"]),id:"fillerSlateSourceLocationId"},[(t(!0),s(U,null,q(i.lookups.sourceLocations,l=>(t(),s("option",{value:l.id},u(l.name),9,p1))),256))],34),[[ge,i.item.fillerSlateSourceLocationId]]),C[13]||(C[13]=e("label",{for:"fillerSlateSourceLocationId",class:""},"Source Location",-1)),o(w).item.fillerSlateSourceLocationId.$error?(t(),s("div",v1,[(t(!0),s(U,null,q(o(w).item.fillerSlateSourceLocationId.$errors,l=>(t(),s("div",{key:l.$uid},u(l.$message),1))),128))])):E("",!0)])]),e("div",g1,[e("div",b1,[N(e("select",{"onUpdate:modelValue":C[7]||(C[7]=l=>i.item.fillerSlateVodSourceId=l),class:te([o(x).getValidFeedbackCss(i.item.fillerSlateVodSourceId),"form-select"]),id:"fillerSlateVodSourceId"},[(t(!0),s(U,null,q(i.lookups.vodSources,l=>(t(),s("option",{value:l.id},u(l.name),9,y1))),256))],2),[[ge,i.item.fillerSlateVodSourceId]]),C[14]||(C[14]=e("label",{for:"fillerSlateVodSourceId",class:""},"VOD Source",-1)),o(w).item.fillerSlateVodSourceId.$error?(t(),s("div",$1,[(t(!0),s(U,null,q(o(w).item.fillerSlateVodSourceId.$errors,l=>(t(),s("div",{key:l.$uid},u(l.$message),1))),128))])):E("",!0)])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},h1={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function _1(n,f,T,V,_,H){const P=se("Page");return t(),ve(P,{id:T.id,urlView:T.urlView},null,8,["id","urlView"])}const k1=Ve(h1,[["render",_1]]),S1={class:"ms-1"},T1={class:"input-group"},I1={class:"table-responsive border shadow-sm"},M1={class:"table table-hover mb-0"},x1=["textContent"],C1={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},V1={key:0,class:"badge text-bg-success"},P1={key:1,class:"badge text-bg-secondary"},O1="/api/v1/channels/search",A1={__name:"index",props:{urlAdd:{type:String,default:"/channels/add"},urlView:{type:String,default:"/channels/view"}},setup(n){Me("$config");const T=he().user,{appTitle:V,pageTitle:_,busy:H,infoMessage:P,warningMessage:J,errorMessage:j,router:x,axios:G,utils:oe,toasts:B,close:A,security:i,filter:M,initializeFilter:w,getQuery:K,saveQuery:X,search:c,getRowNumber:v,setSelected:Y,isSelected:d}=Le({appTitle:"ARC CMS",pageTitle:"Channels",cacheKey:`${T==null?void 0:T.userId}/Channels/search`,baseUrl:O1,filter:{updateUrl:!0}});return fe(async()=>{w(),await c()}),(C,g)=>{const p=se("router-link"),y=se("PageHeader"),l=se("m-pagination"),m=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(y,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(_)},{default:R(()=>[z(p,{to:n.urlAdd,class:"btn btn-primary"},{default:R(()=>g[3]||(g[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",S1,[e("div",T1,[N(e("input",{"onUpdate:modelValue":g[0]||(g[0]=a=>o(M).query.criteria=a),onKeyup:g[1]||(g[1]=Ue(a=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[Z,o(M).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:g[2]||(g[2]=a=>o(c)(1))},g[4]||(g[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),z(m,{errorMessage:o(j)},{default:R(()=>[e("div",I1,[e("table",M1,[g[5]||(g[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",null,"Playback Mode"),e("th",null,"Tier")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(M).items,(a,r)=>(t(),s("tr",{key:a.channelId},[e("td",{textContent:u(o(v)(r)),class:"text-center"},null,8,x1),e("td",null,[z(p,{to:`${n.urlView}/${a.channelId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[a.arn?(t(),s("span",C1)):E("",!0),Q(u(a.name),1)]),_:2},1032,["to"]),e("div",null,[a.state==="RUNNING"?(t(),s("span",V1,u(a.state),1)):a.state==="STOPPED"?(t(),s("span",P1,u(a.state),1)):E("",!0)])]),e("td",null,u(a.playbackMode),1),e("td",null,u(a.tier),1)]))),128))]),_:1},512),[[ke,o(M).items.length>0]])])]),z(l,{filter:o(M),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},U1=["id"],L1={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},H1={class:"modal-content"},D1={class:"modal-header"},E1={class:"modal-title"},q1={class:"modal-body p-1"},B1={class:"row row-cols-1 row-cols-sm-2 g-2"},N1={class:"col-sm-4"},R1={class:"card"},F1={key:0,class:"mt-2"},z1={class:"col"},G1={class:"form-floating mb-2"},j1={class:"col ms-2 my-2"},Y1={class:"badge bg-info me-1"},W1={class:"badge bg-primary me-1"},K1={class:"row row-cols-1 row-cols-sm-2"},Q1={class:"col"},J1={class:"form-floating mb-2"},X1={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Z1={class:"col"},eb={class:"form-floating mb-2"},tb={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},sb={class:"col"},ob={class:"form-floating mb-2"},ab={class:"col-sm-8"},lb={class:"col"},nb={class:"input-group mb-2"},rb={class:"form-floating"},ib={class:"table-responsive border shadow-sm"},db={class:"table table-sm table-hover mb-0 overflow-auto"},ub=["textContent"],cb={class:"d-flex flex-row justify-content-start"},mb={class:"mt-1"},fb=["src"],pb={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},vb={class:"ms-2"},gb=["onClick"],bb={class:"modal-footer"},yb="/api/v1/programtemplates/search",$b={__name:"_selectProgramTemplate",emits:["close"],setup(n,{expose:f,emit:T}){const _=he().user,{appTitle:H,pageTitle:P,busy:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,security:M,filter:w,initializeFilter:K,getQuery:X,saveQuery:c,search:v,getRowNumber:Y,setSelected:d,isSelected:C}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${_==null?void 0:_.userId}/program-templates/select`,baseUrl:yb,filter:{updateUrl:!0,lookups:{genres:[]},query:{}}}),g=T,p=ce("modalSelectProgramTemplate"),y=be({programTemplate:null,hls:null});fe(async()=>{K(),await l()}),Ae(()=>{y.hls&&(y.hls.stopLoad(),y.hls.destroy())});const l=async()=>{await r(),await I()},m=async b=>{w.value.query.sourceLocationId=b,G.value="",await v();var O=document.getElementById(p.value),D=we.getOrCreateInstance(O);D.show()},a=async()=>{var b=document.getElementById(p.value),O=we.getOrCreateInstance(b);O.hide(),y.hls&&(y.hls.stopLoad(),y.hls.destroy()),g("close",y.programTemplate)},r=async b=>{try{const D=await B.get("/api/v1/lookups/video-categories/").then($=>$.data);w.value.lookups.categories=D}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},I=async b=>{try{const D=await B.get("/api/v1/lookups/video-genres/").then($=>$.data);w.value.lookups.genres=D}catch(O){G.value=A.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},h=b=>{y.programTemplate=b,a()};return f({open:m,close:a}),(b,O)=>{const D=se("m-pagination"),$=se("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:p.value,tabindex:"-1","aria-hidden":"true"},[e("div",L1,[e("div",H1,[e("div",D1,[e("h5",E1,[O[8]||(O[8]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Q(u(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:O[0]||(O[0]=k=>a()),"aria-label":"Close"})]),e("div",q1,[z($,{errorMessage:o(G)},{default:R(()=>[e("div",B1,[e("div",N1,[e("div",R1,[O[13]||(O[13]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),y.programTemplate?(t(),s("div",F1,[e("div",z1,[e("div",G1,[N(e("input",{"onUpdate:modelValue":O[1]||(O[1]=k=>y.programTemplate.vodSource.video.title=k),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[Z,y.programTemplate.vodSource.video.title]]),O[9]||(O[9]=e("label",{for:"title"},"Title",-1))])]),e("div",j1,[e("div",null,[(t(!0),s(U,null,q(y.programTemplate.vodSource.video.genres,k=>(t(),s("span",Y1,u(k.genreName),1))),256)),(t(!0),s(U,null,q(y.programTemplate.vodSource.video.categories,k=>(t(),s("span",W1,u(k.categoryName),1))),256))])]),e("div",K1,[e("div",Q1,[e("div",J1,[e("div",X1,u(o(A).moment(y.programTemplate.vodSource.video.dateReleased).calendar()),1),O[10]||(O[10]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Z1,[e("div",eb,[e("div",tb,u(o(A).moment.utc(y.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),O[11]||(O[11]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",sb,[e("div",ob,[N(e("textarea",{"onUpdate:modelValue":O[2]||(O[2]=k=>y.programTemplate.vodSource.video.description=k),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[Z,y.programTemplate.vodSource.video.description]]),O[12]||(O[12]=e("label",{for:"description"},"Description",-1))])])])):E("",!0)])]),e("div",ab,[e("div",lb,[e("div",nb,[e("div",rb,[N(e("input",{"onUpdate:modelValue":O[3]||(O[3]=k=>o(w).query.criteria=k),onKeyup:O[4]||(O[4]=Ue(k=>o(v)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[Z,o(w).query.criteria]]),O[14]||(O[14]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:O[5]||(O[5]=k=>o(v)(1))},O[15]||(O[15]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",ib,[e("table",db,[O[16]||(O[16]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(w).items,(k,F)=>(t(),s("tr",{key:k.videoId},[e("td",{textContent:u(o(Y)(F)),class:"text-center"},null,8,ub),e("td",null,[e("div",cb,[e("div",null,[k.vodSource.video.thumbnails.length>0?(t(!0),s(U,{key:0},q(k.vodSource.video.thumbnails,W=>(t(),s("div",mb,[e("img",{src:W.url,class:"img-fuild border",width:"128"},null,8,fb)]))),256)):(t(),s("img",pb))]),e("div",vb,[e("a",{onClick:W=>h(k),class:"text-wrap link-offset-2",role:"button"},u(k.name),9,gb)])])])]))),128))]),_:1},512),[[ke,o(w).items.length>0]])])]),z(D,{filter:o(w),search:o(v),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",bb,[e("button",{onClick:O[6]||(O[6]=k=>a()),class:"btn btn-primary",type:"button"},O[17]||(O[17]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:O[7]||(O[7]=k=>a()),class:"btn btn-secondary ms-1"},O[18]||(O[18]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,U1)}}},wb={key:0,class:"modal-content"},hb={class:"modal-header"},_b={class:"modal-title"},kb={class:"modal-body1"},Sb={class:"row row-cols-1 row-cols-sm-2 g-2"},Tb={class:"card"},Ib={key:0,class:"mt-2"},Mb={class:"col"},xb={class:"form-floating mb-2"},Cb={class:"col ms-2 my-2"},Vb={class:"badge bg-info me-1"},Pb={class:"badge bg-primary me-1"},Ob={class:"row row-cols-1 row-cols-sm-2"},Ab={class:"col"},Ub={class:"form-floating mb-2"},Lb={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Hb={class:"col"},Db={class:"form-floating mb-2"},Eb={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},qb={class:"col"},Bb={class:"form-floating mb-2"},Nb={class:"col"},Rb={class:"input-group mb-2"},Fb={class:"form-floating"},zb={class:"table-responsive border shadow-sm"},Gb={class:"table table-sm table-hover mb-0 overflow-auto"},jb=["textContent"],Yb={class:"d-flex flex-row justify-content-start"},Wb={class:"mt-1"},Kb=["src"],Qb={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Jb={class:"ms-2"},Xb=["onClick"],Zb={class:"modal-footer"},ey="/api/v1/programtemplates/search",ty={__name:"_selectProgramTemplateInline",props:{isOpen:{type:Boolean,required:!0}},emits:["close"],setup(n,{expose:f,emit:T}){const _=he().user,{appTitle:H,pageTitle:P,busy:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,security:M,filter:w,initializeFilter:K,getQuery:X,saveQuery:c,search:v,getRowNumber:Y,setSelected:d,isSelected:C}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${_==null?void 0:_.userId}/program-templates/select`,baseUrl:ey,filter:{updateUrl:!0,lookups:{genres:[]},query:{}},getQuery:O=>["?c=",encodeURIComponent(O.query.criteria),"&p=",O.pageIndex,"&s=",O.pageSize,"&sf=",O.sortField,"&so=",O.sortOrder,"&withArn=true"].join(""),successAction:()=>{y.programTemplate&&(y.programTemplate=null)}}),g=n,p=T;ce("modalSelectProgramTemplateInline");const y=be({programTemplate:null,hls:null});fe(async()=>{K(),await l()}),Ae(()=>{y.hls&&(y.hls.stopLoad(),y.hls.destroy())});const l=async()=>{await r(),await I()},m=async O=>{w.value.query.sourceLocationId=O,G.value="",await v(),g.isOpen=!0},a=async()=>{y.hls&&(y.hls.stopLoad(),y.hls.destroy()),p("close",y.programTemplate),g.isOpen=!1},r=async O=>{try{const $=await B.get("/api/v1/lookups/video-categories/").then(k=>k.data);w.value.lookups.categories=$}catch(D){G.value=A.getErrorMessageAsHtml(D),window.scrollTo(0,0)}finally{}},I=async O=>{try{const $=await B.get("/api/v1/lookups/video-genres/").then(k=>k.data);w.value.lookups.genres=$}catch(D){G.value=A.getErrorMessageAsHtml(D),window.scrollTo(0,0)}finally{}},h=O=>{y.programTemplate=O,b()},b=()=>{if(Hls.isSupported()){y.hls&&(y.hls.stopLoad(),y.hls.destroy());var O=document.getElementById("video-select-preview");const $=y.programTemplate.vodSource.video.formats.find(F=>F.formatName==="HLS"),k=$.serverUrl+$.path;y.hls=A.createHlsStream(O,k)}};return f({open:m,close:a}),(O,D)=>{const $=se("m-pagination"),k=se("PageBody");return t(),ve(ye,null,{default:R(()=>[n.isOpen?(t(),s("div",wb,[e("div",hb,[e("h6",_b,[D[7]||(D[7]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Q(u(o(P)),1)])]),e("div",kb,[z(k,{errorMessage:o(G)},{default:R(()=>[e("div",Sb,[e("div",{class:te([y.programTemplate?"col-sm-4":"d-none"])},[e("div",Tb,[D[12]||(D[12]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),y.programTemplate?(t(),s("div",Ib,[e("div",Mb,[e("div",xb,[N(e("input",{"onUpdate:modelValue":D[0]||(D[0]=F=>y.programTemplate.vodSource.video.title=F),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[Z,y.programTemplate.vodSource.video.title]]),D[8]||(D[8]=e("label",{for:"title"},"Title",-1))])]),e("div",Cb,[e("div",null,[(t(!0),s(U,null,q(y.programTemplate.vodSource.video.genres,F=>(t(),s("span",Vb,u(F.genreName),1))),256)),(t(!0),s(U,null,q(y.programTemplate.vodSource.video.categories,F=>(t(),s("span",Pb,u(F.categoryName),1))),256))])]),e("div",Ob,[e("div",Ab,[e("div",Ub,[e("div",Lb,u(o(A).moment(y.programTemplate.vodSource.video.dateReleased).calendar()),1),D[9]||(D[9]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Hb,[e("div",Db,[e("div",Eb,u(o(A).moment.utc(y.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),D[10]||(D[10]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",qb,[e("div",Bb,[N(e("textarea",{"onUpdate:modelValue":D[1]||(D[1]=F=>y.programTemplate.vodSource.video.description=F),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[Z,y.programTemplate.vodSource.video.description]]),D[11]||(D[11]=e("label",{for:"description"},"Description",-1))])])])):E("",!0)])],2),e("div",{class:te([y.programTemplate?"col-sm-8":"col-sm-12"])},[e("div",Nb,[e("div",Rb,[e("div",Fb,[N(e("input",{"onUpdate:modelValue":D[2]||(D[2]=F=>o(w).query.criteria=F),onKeyup:D[3]||(D[3]=Ue(F=>o(v)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[Z,o(w).query.criteria]]),D[13]||(D[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:D[4]||(D[4]=F=>o(v)(1))},D[14]||(D[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",zb,[e("table",Gb,[D[15]||(D[15]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(o(w).items,(F,W)=>(t(),s("tr",{key:F.videoId},[e("td",{textContent:u(o(Y)(W)),class:"text-center"},null,8,jb),e("td",null,[e("div",Yb,[e("div",null,[F.vodSource.video.thumbnails.length>0?(t(!0),s(U,{key:0},q(F.vodSource.video.thumbnails,pe=>(t(),s("div",Wb,[e("img",{src:pe.url,class:"img-fuild border",width:"128"},null,8,Kb)]))),256)):(t(),s("img",Qb))]),e("div",Jb,[e("a",{onClick:pe=>h(F),class:"text-wrap link-offset-2",role:"button"},u(F.name),9,Xb)])])])]))),128))]),_:1},512),[[ke,o(w).items.length>0]])])]),z($,{filter:o(w),search:o(v),showPerPage:!0},null,8,["filter","search"])],2)])]),_:1},8,["errorMessage"])]),e("div",Zb,[e("button",{onClick:D[5]||(D[5]=F=>a()),class:"btn btn-primary",type:"button"},D[16]||(D[16]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:D[6]||(D[6]=F=>a(!1)),class:"btn btn-secondary ms-1"},D[17]||(D[17]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])):E("",!0)]),_:1})}}},sy=["id"],oy={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},ay={class:"modal-content"},ly={class:"modal-header"},ny={class:"modal-title"},ry={class:"modal-body"},iy={key:0},dy={class:"row row-cols-1 row-cols-sm-3"},uy={class:"col-sm-3"},cy={class:"form-floating mb-2"},my={key:0,class:"d-block invalid-feedback"},fy={class:"col-sm-3"},py={class:"form-floating mb-2"},vy={key:0,class:"d-block invalid-feedback"},gy={class:"col-sm-6"},by={class:"input-group mb-2"},yy={class:"form-floating"},$y={id:"programTemplateId",class:"form-control",placeholder:"Title"},wy={key:0,class:"d-block invalid-feedback"},hy={key:0},_y={class:"row row-cols-1 row-cols-sm-2"},ky={class:"col"},Sy={class:"row row-cols-1"},Ty={class:"col"},Iy={class:"form-floating mb-2"},My={class:"col"},xy={class:"form-floating mb-2"},Cy={class:"row row-cols-1 row-cols-sm-3"},Vy={class:"col"},Py={class:"form-floating mb-2"},Oy={class:"col"},Ay={class:"form-floating mb-2"},Uy={class:"col"},Ly={class:"form-floating mb-2"},Hy={class:"row row-cols-1 row-cols-sm-3"},Dy={class:"col"},Ey={class:"form-floating mb-2"},qy={class:"col"},By={class:"form-floating mb-2"},Ny={key:1},Ry={class:"table-responsive border mt-1"},Fy={class:"table table-sm mb-0"},zy=["onUpdate:modelValue","onChange"],Gy=["value"],jy={key:0,class:"modal-footer"},Yy=["disabled"],Wy={__name:"_addProgram",emits:["onClose"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),K=T,X=ce(),c=ce(),v=ce(),Y=ce("modalAddProgramFromTemplate"),d=be({eventId:null,lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},selected:{programTemplate:null,channel:null},item:{programTemplateId:null,name:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),C=(ee,S,ue)=>ee.length<=0?!0:ee.every(ie=>ie.vodSourceId),g={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},programTemplateId:{required:ae.withMessage("Program Template is required.",re),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:ae.withMessage("Date Scheduled Start is required.",re),$autoDirty:!0,$lazy:!0},adBreaks:{adBreaksRequired:ae.withMessage("Ad Break is not properly configured.",C),$each:ae.forEach({vodSourceId:{required:ae.withMessage("Vod Source is required.",re)}})}}},p=Se(g,d);fe(async()=>{p.value.$reset()});const y=async(ee,S,ue)=>{v.value=ee;const le=d;J.value.clear(),G.value="";const ie=A.moment(ue),L=ie.format("YYYY-MM-DD HH:mm"),me=ie.format("YYYYMMDD_HHmm")+"_PRG_";le.eventId=S,le.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},le.selected={programTemplate:null},le.item={programTemplateId:null,name:me,dateScheduledStart:L,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await a(),p.value.$reset();var xe=document.getElementById(Y.value),Ce=we.getOrCreateInstance(xe);Ce.show()},l=async ee=>{if(!ee){K("onClose",{eventId:d.eventId},ee);var S=document.getElementById(Y.value),ue=we.getOrCreateInstance(S);ue.hide();return}if(!await p.value.$validate()){window.scrollTo(0,0);return}const ie=d,ne=A.moment(ie.item.dateScheduledStart).utc(!0).format(),L=A.moment(ie.item.dateScheduledStart).add(ie.selected.programTemplate.totalProgramTemplateDurationInMillis,"milliseconds").utc(!0).format();d.item={eventId:ie.eventId,programTemplateId:ie.selected.programTemplate.programTemplateId,channelId:v.value,name:ie.item.name,dateScheduledStart:ne,dateScheduledEnd:L,adBreaks:ie.selected.programTemplate.adBreaks.map(me=>({sourceLocationId:me.sourceLocationId,vodSourceId:me.vodSourceId,offsetMillis:me.offsetMillis,durationInMillis:me.durationInMillis}))},await B.post("/api/v1/programs/",d.item).then(me=>{i.success("Add New Program",`Program [${d.item.name}] was added to this channel.`),K("onClose",d.item,ee);var xe=document.getElementById(Y.value),Ce=we.getOrCreateInstance(xe);Ce.hide()},me=>{G.value=A.getErrorMessageAsHtml(me)})},m=async()=>{await l(!0)},a=async()=>{await O(),await r(),await I()},r=async()=>{try{const ee=`/api/v1/channelOutputs/get-by-channel/${v.value}`;await B.get(ee).then(S=>{d.lookups.channelOutputs=S.data}),d.item.programTemplateId&&await h()}catch(ee){G.value=A.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},I=async()=>{try{const ee=`/api/v1/programTemplates/lookup/by-channel/${v.value}`;await B.get(ee).then(S=>{d.lookups.programTemplates=S.data,d.lookups.programTemplates.length===1&&(d.item.programTemplateId=d.lookups.programTemplates[0].id)}),d.item.programTemplateId&&await h(d.item.programTemplateId)}catch(ee){G.value=A.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},h=async ee=>{await b(ee)},b=async ee=>{try{const S=`/api/v1/programTemplates/${ee}/`;await B.get(S).then(ie=>{d.selected.programTemplate=ie.data;const ne=d.selected.programTemplate;ne.startOffsetTime=A.moment.utc(ne.startOffsetMillis).format("HH:mm:ss"),ne.endOffsetTime=A.moment.utc(ne.endOffsetMillis).format("HH:mm:ss"),ne.durationTime=A.moment.utc(ne.durationInMillis).format("HH:mm:ss"),ne.adBreaksDurationTime=A.moment.utc(ne.adBreaksDurationInMillis).format("HH:mm:ss"),ne.totalProgramTemplateDurationTime=A.moment.utc(ne.totalProgramTemplateDurationInMillis).format("HH:mm:ss"),ne.adBreaks.forEach(L=>{L.vodSourceId=null}),d.item.programTemplateId=ne.programTemplateId,d.item.adBreaks=ne.adBreaks});const ue=d,le=ue.lookups.channelOutputs[0].outputType;await $(ue.selected.programTemplate.sourceLocationId,le)}catch(S){G.value=A.getErrorMessageAsHtml(S),window.scrollTo(0,0)}finally{}},O=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(S=>{d.lookups.sourceLocations=S.data,d.lookups.sourceLocations.length===1&&(d.item.sourceLocationId=d.lookups.sourceLocations[0].id)}),d.item.sourceLocationId&&await D(d.item.sourceLocationId)}catch(ee){G.value=A.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},D=async ee=>{try{let S=`/api/v1/vodSources/lookup/source-location/${ee}`;await B.get(S).then(ue=>{d.lookups.vodSources=ue.data})}catch(S){G.value=A.getErrorMessageAsHtml(S),window.scrollTo(0,0)}finally{}},$=async(ee,S)=>{try{let ue=`/api/v1/vodsources/lookup/source-location/${ee}/output-type/${S}`;await B.get(ue).then(le=>{d.lookups.adBreakVodSources=le.data})}catch(ue){G.value=A.getErrorMessageAsHtml(ue),window.scrollTo(0,0)}finally{}},k=ee=>{const S=d.lookups.adBreakVodSources.find(ue=>ue.id==ee.vodSourceId);ee.sourceLocationId=S.sourceLocationId},F=async ee=>{pe.value=!1,ee&&(await h(ee.programTemplateId),W())},W=()=>{if(Hls.isSupported()){d.hls&&(d.hls.stopLoad(),d.hls.destroy());var ee=document.getElementById("video-add-program");const ue=d.selected.programTemplate.vodSource.video.formats.find(ie=>ie.formatName==="HLS"),le=ue.serverUrl+ue.path;d.hls=A.createHlsStream(ee,le)}},pe=ce(!1);return f({open:y,close:l}),(ee,S)=>{const ue=se("PageMessages");return t(),ve(ye,null,{default:R(()=>[e("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:Y.value,tabindex:"-1","aria-hidden":"true"},[e("div",oy,[e("div",ay,[e("div",ly,[e("h5",ny,[S[13]||(S[13]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:S[0]||(S[0]=le=>l(!1)),"aria-label":"Close"})]),e("div",ry,[z(ue,{errorMessage:o(G),vuelidate:o(p)},null,8,["errorMessage","vuelidate"]),z(ty,{ref_key:"modalSelectProgramTemplateInline",ref:c,isOpen:pe.value,onClose:F},null,8,["isOpen"]),pe.value?E("",!0):(t(),s("div",iy,[e("div",dy,[e("div",uy,[e("div",cy,[N(e("input",{"onUpdate:modelValue":S[1]||(S[1]=le=>d.item.name=le),id:"name",class:"form-control",placeholder:"Name"},null,512),[[Z,d.item.name]]),S[14]||(S[14]=e("label",{for:"name",class:""},"Name",-1)),o(p).item.name.$error?(t(),s("div",my,[(t(!0),s(U,null,q(o(p).item.name.$errors,le=>(t(),s("div",{key:le.$uid},u(le.$message),1))),128))])):E("",!0)])]),e("div",fy,[e("div",py,[N(e("input",{"onUpdate:modelValue":S[2]||(S[2]=le=>d.item.dateScheduledStart=le),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[Z,d.item.dateScheduledStart]]),S[15]||(S[15]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(p).item.dateScheduledStart.$error?(t(),s("div",vy,[(t(!0),s(U,null,q(o(p).item.dateScheduledStart.$errors,le=>(t(),s("div",{key:le.$uid},u(le.$message),1))),128))])):E("",!0)])]),e("div",gy,[e("div",by,[e("div",yy,[e("div",$y,[d.selected.programTemplate?(t(),s(U,{key:0},[Q(u(d.selected.programTemplate.name),1)],64)):E("",!0)]),S[16]||(S[16]=e("label",{for:"programTemplateId",class:""},"Program Template",-1))]),e("button",{onClick:S[3]||(S[3]=le=>pe.value=!pe.value),class:"btn btn-primary",type:"button"},S[17]||(S[17]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))]),o(p).item.programTemplateId.$error?(t(),s("div",wy,[(t(!0),s(U,null,q(o(p).item.programTemplateId.$errors,le=>(t(),s("div",{key:le.$uid},u(le.$message),1))),128))])):E("",!0)])]),d.selected.programTemplate?(t(),s("div",hy,[e("div",_y,[S[25]||(S[25]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1)),e("div",ky,[e("div",Sy,[d.selected.programTemplate?(t(),s(U,{key:0},[e("div",Ty,[e("div",Iy,[N(e("input",{"onUpdate:modelValue":S[4]||(S[4]=le=>d.selected.programTemplate.sourceLocation.name=le),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[Z,d.selected.programTemplate.sourceLocation.name]]),S[18]||(S[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1))])]),e("div",My,[e("div",xy,[N(e("input",{"onUpdate:modelValue":S[5]||(S[5]=le=>d.selected.programTemplate.vodSource.name=le),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[Z,d.selected.programTemplate.vodSource.name]]),S[19]||(S[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1))])])],64)):E("",!0)]),e("div",Cy,[e("div",Vy,[e("div",Py,[N(e("input",{"onUpdate:modelValue":S[6]||(S[6]=le=>d.selected.programTemplate.startOffsetTime=le),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[Z,d.selected.programTemplate.startOffsetTime]]),S[20]||(S[20]=e("label",{for:"startOffsetTime"},"Total Program Duration",-1))])]),e("div",Oy,[e("div",Ay,[N(e("input",{"onUpdate:modelValue":S[7]||(S[7]=le=>d.selected.programTemplate.endOffsetTime=le),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[Z,d.selected.programTemplate.endOffsetTime]]),S[21]||(S[21]=e("label",{for:"endOffsetTime"},"End Offset",-1))])]),e("div",Uy,[e("div",Ly,[N(e("input",{"onUpdate:modelValue":S[8]||(S[8]=le=>d.selected.programTemplate.durationTime=le),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[Z,d.selected.programTemplate.durationTime]]),S[22]||(S[22]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),e("div",Hy,[e("div",Dy,[e("div",Ey,[N(e("input",{"onUpdate:modelValue":S[9]||(S[9]=le=>d.selected.programTemplate.adBreaksDurationTime=le),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[Z,d.selected.programTemplate.adBreaksDurationTime]]),S[23]||(S[23]=e("label",{for:"adBreaksDurationTime"},"Ad Breaks Total Duration",-1))])]),e("div",qy,[e("div",By,[N(e("input",{"onUpdate:modelValue":S[10]||(S[10]=le=>d.selected.programTemplate.totalProgramTemplateDurationTime=le),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[Z,d.selected.programTemplate.totalProgramTemplateDurationTime]]),S[24]||(S[24]=e("label",{for:"totalProgramTemplateDurationTime"},"Program Total Duration",-1))])])])])])])):E("",!0),d.selected.programTemplate&&d.selected.programTemplate.adBreaks.length>0?(t(),s("div",Ny,[S[27]||(S[27]=e("div",{class:"d-flex flex-row justify-content-between"},[e("b",null," Ad Break ")],-1)),e("div",Ry,[e("table",Fy,[S[26]||(S[26]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(d.item.adBreaks,(le,ie)=>(t(),s("tr",null,[e("td",null,u(ie+1),1),e("td",null,u(o(A).moment.utc(le.offsetMillis).format("HH:mm:ss")),1),e("td",null,u(o(A).moment.utc(le.durationInMillis).format("HH:mm:ss")),1),e("td",null,[d.lookups.adBreakVodSources.length>0?(t(),s(U,{key:0},[N(e("select",{"onUpdate:modelValue":ne=>le.vodSourceId=ne,onChange:ne=>k(le),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(U,null,q(d.lookups.adBreakVodSources,ne=>(t(),s(U,null,[ne.durationInMillis===le.durationInMillis?(t(),s("option",{key:0,value:ne.id}," ["+u(o(A).moment.utc(ne.durationInMillis).format("HH:mm:ss"))+"] "+u(ne.name),9,Gy)):E("",!0)],64))),256))],40,zy),[[ge,le.vodSourceId]]),o(p).item.adBreaks.$each.$response?(t(!0),s(U,{key:0},q(o(p).item.adBreaks.$each.$response.$errors[ie].vodSourceId,ne=>(t(),s("div",{key:ne,class:"d-block invalid-feedback"},u(ne.$message),1))),128)):E("",!0)],64)):E("",!0)])]))),256))])])])])):E("",!0)]))]),pe.value?E("",!0):(t(),s("div",jy,[e("button",{disabled:o(p).$dirty&&o(p).$invalid,onClick:S[11]||(S[11]=le=>m()),class:"btn btn-primary",type:"button"},S[28]||(S[28]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Yy),e("button",{onClick:S[12]||(S[12]=le=>l(!1)),class:"btn btn-secondary ms-1"},S[29]||(S[29]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))]))])]),z($b,{ref_key:"modalSelectProgramTemplate",ref:X,onClose:F},null,512)],8,sy)]),_:1})}}},Ky=["id"],Qy={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Jy={class:"modal-content"},Xy={class:"modal-header"},Zy={class:"modal-title"},e$={class:"modal-body"},t$={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},s$=["innerHTML"],o$={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},a$={key:2,class:"container"},l$={class:"row row-cols-1 row-cols-sm-2"},n$={class:"col"},r$={class:"form-floating mb-2"},i$={class:"col"},d$={class:"form-floating mb-2"},u$={class:"row row-cols-1 row-cols-sm-3 mt-2"},c$={class:"col"},m$={class:"form-floating mb-2"},f$={class:"col"},p$={class:"form-floating mb-2"},v$={key:0,class:"d-block invalid-feedback"},g$={class:"col"},b$={class:"form-floating mb-2"},y$={key:0,class:"d-block invalid-feedback"},$$={class:"row row-cols-1 row-cols-sm-3"},w$={class:"col"},h$={class:"form-floating mb-2"},_$={class:"col"},k$={class:"form-floating mb-2"},S$={class:"col"},T$={class:"form-floating mb-2"},I$={class:"row row-cols-1 row-cols-sm-3"},M$={class:"col"},x$={class:"form-floating mb-2"},C$={class:"col"},V$={class:"form-floating mb-2"},P$={key:0,class:"col"},O$={class:"form-floating mb-2"},A$={key:0},U$={class:"table-responsive border mt-1"},L$={class:"table mb-0"},H$=["onUpdate:modelValue","onChange"],D$=["value"],E$={class:"modal-footer"},q$=["disabled"],ft={__name:"_editProgram",emits:["onClose"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Edit Program"}),K=T,X=ce(),c=ce("modalEditProgram"),v=be({lookups:{adBreakSourceLocations:[],adBreakVodSources:[]},item:{programTemplateId:null,name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),Y={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:ae.withMessage("Date Scheduled Start is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ae.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ae.withMessage("startOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ae.withMessage("endOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0}}},d=Se(Y,v);fe(async()=>{d.value.$reset()});const C=async(r,I)=>{X.value=r;const h=v;J.value.clear(),G.value="",h.lookups={adBreakSourceLocations:[],adBreakVodSources:[]},h.item=null,await y(),await l(),d.value.$reset();var b=document.getElementById(c.value),O=we.getOrCreateInstance(b);O.show()},g=async r=>{if(!r){K("onClose",r);var O=document.getElementById(c.value),D=we.getOrCreateInstance(O);D.hide();return}const I=v,h=A.moment(I.item.dateScheduledStart).utc(!0).format(),b={programId:X.value,name:I.item.name,dateScheduledStart:h,adBreaks:I.item.adBreaks.map($=>({sourceLocationId:$.sourceLocationId,vodSourceId:$.vodSourceId,offsetMillis:$.offsetMillis,durationInMillis:$.durationInMillis}))};try{await B.put("/api/v1/programs/",b).then(k=>{i.success("Edit Program","Program was edited.")})}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0);return}finally{}K("onClose",r);var O=document.getElementById(c.value),D=we.getOrCreateInstance(O);D.hide()},p=async()=>{await g(!0)},y=async()=>{try{const r=`/api/v1/programs/${X.value}/`;await B.get(r).then(b=>{v.item=b.data;const O=v.item,k=A.moment.utc(O.dateScheduledStart).format("YYYY-MM-DD HH:mm");v.item.dateScheduledStart=k,O.startOffsetTime=A.moment.utc(O.startOffsetMillis).format("HH:mm:ss"),O.endOffsetTime=A.moment.utc(O.endOffsetMillis).format("HH:mm:ss"),O.durationTime=A.moment.utc(O.durationInMillis).format("HH:mm:ss"),O.adBreaksDurationTime=A.moment.utc(O.adBreaksDurationInMillis).format("HH:mm:ss"),O.totalProgramTemplateDurationTime=A.moment.utc(O.totalProgramTemplateDurationInMillis).format("HH:mm:ss")});const I=v,h=I.item.channel.outputs[0].outputType;await m(I.item.sourceLocationId,h)}catch(r){G.value=A.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{}},l=async()=>{},m=async(r,I)=>{try{let h=`/api/v1/vodsources/lookup/source-location/${r}/output-type/${I}`;await B.get(h).then(b=>{v.lookups.adBreakVodSources=b.data})}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},a=r=>{const I=v.lookups.adBreakVodSources.find(h=>h.id==r.vodSourceId);r.sourceLocationId=I.sourceLocationId};return f({open:C,close:g}),(r,I)=>(t(),s("div",{class:"modal show","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"false"},[e("div",Qy,[e("div",Jy,[e("div",Xy,[e("h5",Zy,[I[14]||(I[14]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:I[0]||(I[0]=h=>g(!1)),"aria-label":"Close"})]),e("div",e$,[o(G)?(t(),s("div",t$,[I[15]||(I[15]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,s$)])):E("",!0),o(J).size>0?(t(),s("div",o$,[I[16]||(I[16]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),h=>(t(),s("li",null,u(h),1))),256))])])):E("",!0),v.item?(t(),s("div",a$,[e("div",l$,[e("div",n$,[e("div",r$,[v.item.sourceLocation?N((t(),s("input",{key:0,"onUpdate:modelValue":I[1]||(I[1]=h=>v.item.sourceLocation.name=h),id:"sourceLocation",class:"form-control-plaintext",readonly:""},null,512)),[[Z,v.item.sourceLocation.name]]):E("",!0),I[17]||(I[17]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",i$,[e("div",d$,[v.item.vodSource?N((t(),s("input",{key:0,"onUpdate:modelValue":I[2]||(I[2]=h=>v.item.vodSource.name=h),id:"vodSource",class:"form-control-plaintext",readonly:""},null,512)),[[Z,v.item.vodSource.name]]):E("",!0),I[18]||(I[18]=e("label",{for:"vodSource",class:""},"VOD Source",-1))])])]),e("div",u$,[e("div",c$,[e("div",m$,[v.item.relativeProgram?N((t(),s("input",{key:0,"onUpdate:modelValue":I[3]||(I[3]=h=>v.item.relativeProgram.name=h),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512)),[[Z,v.item.relativeProgram.name]]):E("",!0),I[19]||(I[19]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])]),e("div",f$,[e("div",p$,[N(e("input",{"onUpdate:modelValue":I[4]||(I[4]=h=>v.item.name=h),id:"name",class:te([o(A).getValidFeedbackCss(v.item.name),"form-control"]),placeholder:"Name"},null,2),[[Z,v.item.name]]),I[20]||(I[20]=e("label",{for:"name",class:""},"Name",-1)),o(d).item.name.$error?(t(),s("div",v$,[(t(!0),s(U,null,q(o(d).item.name.$errors,h=>(t(),s("div",{key:h.$uid},u(h.$message),1))),128))])):E("",!0)])]),e("div",g$,[e("div",b$,[N(e("input",{"onUpdate:modelValue":I[5]||(I[5]=h=>v.item.dateScheduledStart=h),type:"datetime-local",id:"dateScheduledStart",class:te([o(A).getValidFeedbackCss(v.item.dateScheduledStart),"form-control"])},null,2),[[Z,v.item.dateScheduledStart]]),I[21]||(I[21]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(d).item.dateScheduledStart.$error?(t(),s("div",y$,[(t(!0),s(U,null,q(o(d).item.dateScheduledStart.$errors,h=>(t(),s("div",{key:h.$uid},u(h.$message),1))),128))])):E("",!0)])])]),e("div",null,[e("div",$$,[e("div",w$,[e("div",h$,[N(e("input",{"onUpdate:modelValue":I[6]||(I[6]=h=>v.item.startOffsetTime=h),id:"startOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[Z,v.item.startOffsetTime]]),I[22]||(I[22]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",_$,[e("div",k$,[N(e("input",{"onUpdate:modelValue":I[7]||(I[7]=h=>v.item.endOffsetTime=h),id:"endOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[Z,v.item.endOffsetTime]]),I[23]||(I[23]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",S$,[e("div",T$,[N(e("input",{"onUpdate:modelValue":I[8]||(I[8]=h=>v.item.durationTime=h),id:"durationTime",class:"form-control-plaintext",readonly:""},null,512),[[Z,v.item.durationTime]]),I[24]||(I[24]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",I$,[e("div",M$,[e("div",x$,[N(e("input",{"onUpdate:modelValue":I[9]||(I[9]=h=>v.item.adBreaksDurationTime=h),id:"adBreaksDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[Z,v.item.adBreaksDurationTime]]),I[25]||(I[25]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks Duration",-1))])]),e("div",C$,[e("div",V$,[N(e("input",{"onUpdate:modelValue":I[10]||(I[10]=h=>v.item.totalProgramTemplateDurationTime=h),id:"totalProgramTemplateDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[Z,v.item.totalProgramTemplateDurationTime]]),I[26]||(I[26]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])]),v.item.relativeProgram?(t(),s("div",P$,[e("div",O$,[N(e("input",{"onUpdate:modelValue":I[11]||(I[11]=h=>v.item.relativeProgram.name=h),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512),[[Z,v.item.relativeProgram.name]]),I[27]||(I[27]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])])):E("",!0)])]),I[30]||(I[30]=e("hr",null,null,-1)),v.item?(t(),s("div",A$,[I[29]||(I[29]=e("div",{class:"d-flex flex-row justify-content-between"},[e("fieldset",null,[e("legend",null," Ad Breaks ")])],-1)),e("div",U$,[e("table",L$,[I[28]||(I[28]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(v.item.adBreaks,(h,b)=>(t(),s("tr",null,[e("td",null,u(b+1),1),e("td",null,u(o(A).moment.utc(h.offsetMillis).format("HH:mm:ss")),1),e("td",null,u(o(A).moment.utc(h.durationInMillis).format("HH:mm:ss")),1),e("td",null,[N(e("select",{"onUpdate:modelValue":O=>h.vodSourceId=O,onChange:O=>a(h),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(U,null,q(v.lookups.adBreakVodSources,O=>(t(),s(U,null,[O.durationInMillis===h.durationInMillis?(t(),s("option",{key:0,value:O.id}," ["+u(o(A).moment.utc(O.durationInMillis).format("HH:mm:ss"))+"] "+u(O.name),9,D$)):E("",!0)],64))),256))],40,H$),[[ge,h.vodSourceId]])])]))),256))])])])])):E("",!0)])):E("",!0)]),e("div",E$,[e("button",{disabled:o(d).$dirty&&o(d).$invalid,onClick:I[12]||(I[12]=h=>p()),class:"btn btn-primary ms-2",type:"button"},I[31]||(I[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,q$),e("button",{onClick:I[13]||(I[13]=h=>g(!1)),class:"btn btn-secondary ms-1"},I[32]||(I[32]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Ky))}},B$={__name:"index",props:{id:{type:String,required:!0},urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(n){const{appTitle:f,pageTitle:T,busy:V,infoMessage:_,warningMessage:H,errorMessage:P,router:J,axios:j,utils:x,toasts:G,close:oe,security:B}=$e({appTitle:"Arcadian-FAST",pageTitle:"Schedule Channel Programs"}),A=n,i=ce(null),M=ce(null),w=ce(null),K={viewType:"Week",cellDuration:15,startDate:He.DayPilot.Date.today(),onTimeRangeSelected:y=>{var l=y.control;const m={start:y.start,end:y.end,id:He.DayPilot.guid(),text:"NEW",tags:{type:"new"}};l.events.add(m);var a=l.events.find(m.id);C(a)},onBeforeEventRender:y=>{if(y.data.barColor="green",!!y.data.tags)switch(y.data.tags.type){case"new":y.data.barColor="yellow";break;case"business":y.data.barColor="red";break;case"personal":y.data.barColor="greem";break;case"vacation":y.data.barColor="black";break;default:y.data.barColor="orange";break}},eventDeleteHandling:"Disabled",onEventMoved:async y=>{const l=y.newStart.value,m=y.e.id(),a=x.moment(l).utc(!0).format();try{let r="/api/v1/programs/scheduled-date-start";const I={programId:m,dateScheduledStart:a};await j.put(r,I).then(h=>{G.success("Program date scheduled start was edited.")})}catch(r){P.value=x.getErrorMessageAsHtml(r),window.scrollTo(0,0);return}finally{}await Y()},onEventResized:()=>{console.log("Event resized")},onEventClicked:async y=>{var l=y.e.id();p(l)},contextMenu:new He.DayPilot.Menu([{text:"Clone",onClick:async y=>{const l=y.source.id();try{let m=`/api/v1/programs/${l}/clone`;await j.post(m).then(a=>{G.success("Clone Program","Program was cloned.")})}catch(m){P.value=x.getErrorMessageAsHtml(m),window.scrollTo(0,0);return}finally{await Y()}}},{text:"Delete",onClick:async y=>{if(!confirm("Do you want to remove this program?"))return;const m=y.source.id();try{let a=`/api/v1/programs/${m}/`;await j.delete(a).then(r=>{G.success("Delete Program","Program was deleted.")}),i.value.control.events.remove(y.source)}catch(a){P.value=x.getErrorMessageAsHtml(a),window.scrollTo(0,0);return}finally{await Y()}}}])},X=ce([]),c=()=>{i.value.control.update({events:X.value})},v=be({lookups:{visibilityTypes:[]},editorElementId:"editor",item:{userId:null,givenName:null,surname:null,displayName:null,email:null,mobilePhone:null,jobTitle:null}});fe(async()=>{await Y()});const Y=async()=>{await d(),await c()},d=async()=>{const y=v;if(!V.value)try{V.value=!0,P.value="";const l=`/api/v1/channels/${A.id}/`;await j.get(l).then(m=>{y.item=m.data;const a=y.item.outputs,r=y.item.programs.map(I=>{let h=`${I.name}`,b=`[${I.name}]`;return I.relativeProgram&&(b+=` => [${I.relativeProgram.name}]`),{start:x.moment.utc(I.dateScheduledStart).format(),end:x.moment.utc(I.dateScheduledEnd).format(),id:I.programId,text:h,toolTip:b}});X.value=r})}catch(l){P.value=x.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{V.value=!1}},C=y=>{M.value.open(A.id,y.id(),y.start().value)},g=async(y,l)=>{var m=i.value,a=m.control.events.find(y.eventId);if(!l&&a){i.value.control.events.remove(a);return}m.control.events.find(D=>D.text()==y.name)&&(alert("Program already exists in this channel. Removing in the calendar."),i.value.control.events.remove(a));const I=x.moment(y.dateScheduledStart).utc(!0).format(),h=x.moment(y.dateScheduledEnd).utc(!0).format(),b=new He.DayPilot.Date(I),O=new He.DayPilot.Date(h);a.text(y.name),a.start(new He.DayPilot.Date(b)),a.end(new He.DayPilot.Date(O)),a.data.tags.program=y,a.commit(),i.value.control.update(),await Y()},p=(y,l)=>{w.value.open(y,l)};return(y,l)=>{const m=se("router-link"),a=se("PageHeader"),r=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(a,{"page-icon":"fas fa-fw fa-calendar-plus",pageTitle:o(T)},{default:R(()=>[e("button",{onClick:l[0]||(l[0]=I=>Y()),class:"btn btn-secondary ms-1"},l[1]||(l[1]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),z(m,{to:`${n.urlView}/${n.id}`,class:"btn btn-secondary ms-1"},{default:R(()=>l[2]||(l[2]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),z(r,{errorMessage:o(P)},{default:R(()=>[e("div",null,[z(o(He.DayPilotCalendar),{id:"dp",config:K,ref_key:"calendarRef",ref:i},null,512),z(Wy,{ref_key:"modalAddProgram",ref:M,onOnClose:g},null,512),z(ft,{ref_key:"modalEditProgram",ref:w,onOnClose:Y},null,512)])]),_:1},8,["errorMessage"])])]),_:1})}}},N$=["id"],R$={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},F$={class:"modal-content"},z$={class:"modal-header"},G$={class:"modal-title"},j$={class:"modal-body"},Y$={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},W$=["innerHTML"],K$={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Q$={class:"container"},J$={class:"row row-cols-1 row-cols-sm-3"},X$={class:"col"},Z$={class:"form-floating mb-2"},ew=["disabled"],tw=["value"],sw={class:"col"},ow={class:"form-floating mb-2"},aw={key:0,class:"d-block invalid-feedback"},lw={class:"col"},nw={class:"form-floating mb-2"},rw={key:0,class:"d-block invalid-feedback"},iw={class:"row row-cols-sm-2"},dw={class:"col"},uw={class:"form-floating mb-2"},cw=["value"],mw={key:0,class:"d-block invalid-feedback"},fw={class:"col"},pw={class:"form-floating mb-2"},vw=["value"],gw={key:0,class:"d-block invalid-feedback"},bw={class:"col"},yw={class:"input-group mb-1"},$w={class:"form-floating"},ww={key:0,class:"input-group-text"},hw={key:0},_w={key:1},kw={key:2},Sw={key:3,class:"d-block invalid-feedback"},Tw={class:"col"},Iw={class:"input-group mb-1"},Mw={class:"form-floating"},xw={key:0,class:"input-group-text"},Cw={key:0},Vw={key:1},Pw={key:2,class:"d-block invalid-feedback"},Ow={class:"table-responsive border mt-1"},Aw={class:"table"},Uw={class:"input-group mb-1"},Lw=["onUpdate:modelValue"],Hw={key:0,class:"input-group-text"},Dw=["onUpdate:modelValue"],Ew=["value"],qw=["onUpdate:modelValue"],Bw=["value"],Nw=["onClick"],Rw={class:"modal-footer"},Fw=["disabled"],zw={__name:"_addProgram",emits:["refresh"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),K=T,X=ce(),c=ce("modalAddProgram"),v=be({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},item:{name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),Y={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:ae.withMessage("Date Scheduled Start is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ae.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:ae.withMessage("startOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:ae.withMessage("endOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0}}},d=Se(Y,v);fe(async()=>{d.value.$reset()});const C=async D=>{X.value=D;const $=v;J.value.clear(),G.value="";const k=A.moment().local().add(2,"m"),W=k.format("YYYY-MM-DD HH:mm"),pe=k.format("YYYY_MM_DD")+"_PROGRAM_";$.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},$.item={name:pe,relativeProgramId:null,dateScheduledStart:W,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await y(),d.value.$reset();var ee=document.getElementById(c.value),S=we.getOrCreateInstance(ee);S.show()},g=async()=>{var D=document.getElementById(c.value),$=we.getOrCreateInstance(D);$.hide(),K("refresh")},p=async()=>{const D=v;if(H.value)return;if(!await d.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,G.value="";const F=D.item;delete F.vodSource,F.channelId=X.value;var k=F.dateScheduledStart;F.dateScheduledStart=A.moment(k).utc().format(),await B.post("/api/v1/programs/",F).then(W=>{i.success("Add Program","Program added to Channel",{async onClose(){}})}),await g()}catch(F){G.value=A.getErrorMessageAsHtml(F),window.scrollTo(0,0)}finally{H.value=!1}},y=async()=>{await l(),await a(),await I()},l=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then($=>{v.lookups.sourceLocations=$.data,v.lookups.sourceLocations.length===1&&(v.item.sourceLocationId=v.lookups.sourceLocations[0].id)}),v.item.sourceLocationId&&await m(v.item.sourceLocationId)}catch(D){G.value=A.getErrorMessageAsHtml(D),window.scrollTo(0,0)}finally{}},m=async D=>{try{let $=`/api/v1/vodSources/lookup/source-location/${D}`;await B.get($).then(k=>{v.lookups.vodSources=k.data})}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},a=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then($=>{v.lookups.adBreakSourceLocations=$.data})}catch(D){G.value=A.getErrorMessageAsHtml(D),window.scrollTo(0,0)}finally{}},r=async D=>{try{let $=`/api/v1/vodSources/lookup/source-location/${D}`;await B.get($).then(k=>{v.lookups.adBreakVodSources=k.data})}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},I=async()=>{try{const D=`/api/v1/programs/lookup/?channelId=${X.value}`;await B.get(D).then($=>{if(v.lookups.channelPrograms=$.data,v.lookups.channelPrograms.length===1){const F=v.lookups.channelPrograms[0];v.item.relativeProgramId=F.id}})}catch(D){G.value=A.getErrorMessageAsHtml(D),window.scrollTo(0,0)}finally{}},h=()=>{const D={offsetMillis:0,sourceLocationId:null,vodSourceId:null},$=v.item.adBreaks.length;if($>0){const k=v.item.adBreaks[$-1];D.offsetMillis=k.offsetMillis+1e4}v.item.adBreaks.push(D)},b=D=>{v.item.adBreaks.splice(D,1)},O=()=>{const D=v.item.vodSource;v.item.vodSourceId=D.id};return f({open:C,close:g}),(D,$)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",R$,[e("div",F$,[e("div",z$,[e("h5",G$,[$[12]||($[12]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:$[0]||($[0]=k=>g()),"aria-label":"Close"})]),e("div",j$,[o(G)?(t(),s("div",Y$,[$[13]||($[13]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,W$)])):E("",!0),o(J).size>0?(t(),s("div",K$,[$[14]||($[14]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),k=>(t(),s("li",null,u(k),1))),256))])])):E("",!0),e("div",Q$,[e("div",J$,[e("div",X$,[e("div",Z$,[N(e("select",{"onUpdate:modelValue":$[1]||($[1]=k=>v.item.relativeProgramId=k),class:"form-select",id:"sourceLocationId",disabled:v.lookups.channelPrograms.length<=0},[(t(!0),s(U,null,q(v.lookups.channelPrograms,k=>(t(),s("option",{value:k.id},u(k.name),9,tw))),256))],8,ew),[[ge,v.item.relativeProgramId]]),$[15]||($[15]=e("label",{for:"relativeProgramId",class:""},"Relative Program",-1))])]),e("div",sw,[e("div",ow,[N(e("input",{"onUpdate:modelValue":$[2]||($[2]=k=>v.item.name=k),id:"name",class:"form-control",placeholder:"Name"},null,512),[[Z,v.item.name]]),$[16]||($[16]=e("label",{for:"name",class:""},"Name",-1)),o(d).item.name.$error?(t(),s("div",aw,[(t(!0),s(U,null,q(o(d).item.name.$errors,k=>(t(),s("div",{key:k.$uid},u(k.$message),1))),128))])):E("",!0)])]),e("div",lw,[e("div",nw,[N(e("input",{"onUpdate:modelValue":$[3]||($[3]=k=>v.item.dateScheduledStart=k),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[Z,v.item.dateScheduledStart]]),$[17]||($[17]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(d).item.dateScheduledStart.$error?(t(),s("div",rw,[(t(!0),s(U,null,q(o(d).item.dateScheduledStart.$errors,k=>(t(),s("div",{key:k.$uid},u(k.$message),1))),128))])):E("",!0)])])]),e("div",iw,[e("div",dw,[e("div",uw,[N(e("select",{"onUpdate:modelValue":$[4]||($[4]=k=>v.item.sourceLocationId=k),onChange:$[5]||($[5]=k=>m(v.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(U,null,q(v.lookups.sourceLocations,k=>(t(),s("option",{value:k.id},u(k.name),9,cw))),256))],544),[[ge,v.item.sourceLocationId]]),$[18]||($[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(d).item.sourceLocationId.$error?(t(),s("div",mw,[(t(!0),s(U,null,q(o(d).item.sourceLocationId.$errors,k=>(t(),s("div",{key:k.$uid},u(k.$message),1))),128))])):E("",!0)])]),e("div",fw,[e("div",pw,[N(e("select",{"onUpdate:modelValue":$[6]||($[6]=k=>v.item.vodSource=k),onChange:$[7]||($[7]=k=>O()),class:"form-select",id:"vodSourceId"},[(t(!0),s(U,null,q(v.lookups.vodSources,k=>(t(),s("option",{value:k},u(k.name),9,vw))),256))],544),[[ge,v.item.vodSource]]),$[19]||($[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(d).item.vodSourceId.$error?(t(),s("div",gw,[(t(!0),s(U,null,q(o(d).item.vodSourceId.$errors,k=>(t(),s("div",{key:k.$uid},u(k.$message),1))),128))])):E("",!0)])]),e("div",bw,[e("div",yw,[e("div",$w,[N(e("input",{"onUpdate:modelValue":$[8]||($[8]=k=>v.item.startOffsetMillis=k),id:"startOffsetMillis",type:"number",class:"form-control",placeholder:"Start OffSet Millis"},null,512),[[Z,v.item.startOffsetMillis]]),$[20]||($[20]=e("label",{for:"startOffsetMillis",class:""},"Start OffSet Millis",-1))]),v.item.startOffsetMillis>0?(t(),s("span",ww,u(o(A).moment.utc(v.item.startOffsetMillis).format("HH:mm:ss")),1)):E("",!0)]),v.item.startOffsetMillis>0&&v.item.startOffsetMillis<3e4?(t(),s("div",hw,$[21]||($[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):E("",!0),v.item.startOffsetMillis>v.item.endOffsetMillis&&v.item.endOffsetMillis>0?(t(),s("div",_w,$[22]||($[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Exceeds End Offset Millis ",-1)]))):E("",!0),v.item.vodSource&&v.item.startOffsetMillis>v.item.vodSource.durationInMillis?(t(),s("div",kw,$[23]||($[23]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Millis Exceeds VOD Source Duration ",-1)]))):E("",!0),o(d).item.startOffsetMillis.$error?(t(),s("div",Sw,[(t(!0),s(U,null,q(o(d).item.startOffsetMillis.$errors,k=>(t(),s("div",{key:k.$uid},u(k.$message),1))),128))])):E("",!0)]),e("div",Tw,[e("div",Iw,[e("div",Mw,[N(e("input",{"onUpdate:modelValue":$[9]||($[9]=k=>v.item.endOffsetMillis=k),id:"endOffsetMillis",type:"number",class:"form-control",placeholder:"End OffSet Millis"},null,512),[[Z,v.item.endOffsetMillis]]),$[24]||($[24]=e("label",{for:"endOffsetMillis",class:""},"End OffSet Millis",-1))]),v.item.endOffsetMillis>0?(t(),s("span",xw,u(o(A).moment.utc(v.item.endOffsetMillis).format("HH:mm:ss")),1)):E("",!0)]),v.item.endOffsetMillis>0&&v.item.endOffsetMillis<3e4?(t(),s("div",Cw,$[25]||($[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):E("",!0),v.item.vodSource&&v.item.endOffsetMillis>v.item.vodSource.durationInMillis?(t(),s("div",Vw,$[26]||($[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Millis Exceeds VOD Source Duration ",-1)]))):E("",!0),o(d).item.endOffsetMillis.$error?(t(),s("div",Pw,[(t(!0),s(U,null,q(o(d).item.endOffsetMillis.$errors,k=>(t(),s("div",{key:k.$uid},u(k.$message),1))),128))])):E("",!0)])]),$[30]||($[30]=e("hr",null,null,-1)),e("div",null,[e("div",{class:"d-flex flex-row justify-content-between"},[$[27]||($[27]=e("fieldset",null,[e("legend",null," Ad Break ")],-1)),e("button",{onClick:h,class:"btn btn-outline-primary"}," Insert Ad Break ")]),e("div",Ow,[e("table",Aw,[$[29]||($[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Millis"),e("th",null,"Source Location"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",null,[(t(!0),s(U,null,q(v.item.adBreaks,(k,F)=>(t(),s("tr",null,[e("td",null,u(F+1),1),e("td",null,[e("div",Uw,[N(e("input",{"onUpdate:modelValue":W=>k.offsetMillis=W,type:"number",class:"form-control",placeholder:"Enter Offset Millis..."},null,8,Lw),[[Z,k.offsetMillis]]),k.offsetMillis>0?(t(),s("span",Hw,u(o(A).moment.utc(k.offsetMillis).format("HH:mm:ss")),1)):E("",!0)])]),e("td",null,[N(e("select",{"onUpdate:modelValue":W=>k.sourceLocationId=W,onChange:$[10]||($[10]=W=>r(v.item.sourceLocationId)),class:"form-select",id:"adBreakSourceLocationId"},[(t(!0),s(U,null,q(v.lookups.adBreakSourceLocations,W=>(t(),s("option",{value:W.id},u(W.name),9,Ew))),256))],40,Dw),[[ge,k.sourceLocationId]])]),e("td",null,[N(e("select",{"onUpdate:modelValue":W=>k.vodSourceId=W,class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(U,null,q(v.lookups.adBreakVodSources,W=>(t(),s("option",{value:W.id},u(W.name),9,Bw))),256))],8,qw),[[ge,k.vodSourceId]])]),e("td",null,[e("button",{onClick:W=>b(F),class:"btn btn-outline-warning"},$[28]||($[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Nw)])]))),256))])])])])])]),e("div",Rw,[e("button",{disabled:o(d).$dirty&&o(d).$invalid,onClick:$[11]||($[11]=k=>p()),class:"btn btn-primary",type:"button"},$[31]||($[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Fw),$[32]||($[32]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,N$))}},Gw=["id"],jw={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Yw={class:"modal-content"},Ww={class:"modal-header"},Kw={class:"modal-title"},Qw={class:"modal-body"},Jw={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Xw=["innerHTML"],Zw={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},eh={class:"container"},th={class:"col"},sh={class:"form-floating mb-2"},oh={class:"col"},ah={class:"form-floating mb-2"},lh={key:0,class:"d-block invalid-feedback"},nh={class:"col"},rh={class:"form-floating mb-2 d-none"},ih={key:0,class:"d-block invalid-feedback"},dh={class:"col"},uh={class:"form-floating mb-2"},ch={key:0,class:"d-block invalid-feedback"},mh={class:"modal-footer"},fh=["disabled"],ph={__name:"_addPlaybackConfiguration",props:{channelOutputId:{type:String,required:!0},playbackUrl:{type:String,required:!0}},emits:["confirm","cancel"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output Playback Configuration"}),K=T,X=n,c=ce("modalAddPlaybackConfiguration"),v=be({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),Y={item:{name:{required:ae.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:ae.withMessage("adDecisionServerUrl is required.",re),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:ae.withMessage("videoContentSourceUrl is required.",re),$autoDirty:!0,$lazy:!0}}},d=Se(Y,v);fe(async()=>{d.value.$reset(),await C()});const C=async()=>{const y=v;J.value.clear(),G.value="";const l=X.playbackUrl;let m=l.lastIndexOf("/");const a=l.substring(0,m);let r=l.substring(m+1);m=r.lastIndexOf("."),r=r.substring(0,m)+"_ADCAMPAIGN_",y.item={name:r,originalVideoContentSourceUrl:X.playbackUrl,videoContentSourceUrl:a,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},d.value.$reset();var I=document.getElementById(c.value),h=we.getOrCreateInstance(I);h.show()},g=async()=>{var y=document.getElementById(c.value),l=we.getOrCreateInstance(y);l.hide(),K("cancel")},p=async()=>{const y=v;if(H.value)return;if(!await d.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,G.value="";const r=y.item;r.channelOutputId=X.channelOutputId,await B.put("/api/v1/channelOutputs/playback/",r).then(I=>{i.success("Add Channel Output Playback Configuration","Channel Output playback configuration added.",{async onClose(){}})});var m=document.getElementById(c.value),a=we.getOrCreateInstance(m);a.hide(),K("confirm")}catch(r){G.value=A.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{H.value=!1}};return f({open:C,close:g}),(y,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-hidden":"false"},[e("div",jw,[e("div",Yw,[e("div",Ww,[e("h5",Kw,[l[6]||(l[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=m=>g()),"aria-label":"Close"})]),e("div",Qw,[o(G)?(t(),s("div",Jw,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Xw)])):E("",!0),o(J).size>0?(t(),s("div",Zw,[l[8]||(l[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),m=>(t(),s("li",null,u(m),1))),256))])])):E("",!0),e("div",eh,[e("div",th,[e("div",sh,[N(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=m=>v.item.originalVideoContentSourceUrl=m),id:"originalVideoContentSourceUrl",class:"form-control",style:{height:"5rem"},placeholder:"originalVideoContentSourceUrl",readonly:""},null,512),[[Z,v.item.originalVideoContentSourceUrl]]),l[9]||(l[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",oh,[e("div",ah,[N(e("input",{"onUpdate:modelValue":l[2]||(l[2]=m=>v.item.name=m),id:"name",class:"form-control",placeholder:"Name"},null,512),[[Z,v.item.name]]),l[10]||(l[10]=e("label",{for:"name",class:""},"Name",-1)),o(d).item.name.$error?(t(),s("div",lh,[(t(!0),s(U,null,q(o(d).item.name.$errors,m=>(t(),s("div",{key:m.$uid},u(m.$message),1))),128))])):E("",!0)])]),e("div",nh,[e("div",rh,[N(e("input",{"onUpdate:modelValue":l[3]||(l[3]=m=>v.item.videoContentSourceUrl=m),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[Z,v.item.videoContentSourceUrl]]),l[11]||(l[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),l[12]||(l[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(d).item.videoContentSourceUrl.$error?(t(),s("div",ih,[(t(!0),s(U,null,q(o(d).item.videoContentSourceUrl.$errors,m=>(t(),s("div",{key:m.$uid},u(m.$message),1))),128))])):E("",!0)])]),e("div",dh,[e("div",uh,[N(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=m=>v.item.adDecisionServerUrl=m),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[Z,v.item.adDecisionServerUrl]]),l[13]||(l[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(d).item.adDecisionServerUrl.$error?(t(),s("div",ch,[(t(!0),s(U,null,q(o(d).item.adDecisionServerUrl.$errors,m=>(t(),s("div",{key:m.$uid},u(m.$message),1))),128))])):E("",!0),l[14]||(l[14]=Qe('<div class="mt-2 ms-3"><span class="fas fa-fw fa-info-circle text-info"></span><span class="small">Sample value for the Ad Decision Server Url</span><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/pg/vast.xml</textarea><label for="" class="">Sample VAST 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/rama/vast.xml</textarea><label for="" class="">Sample VAST 2</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&amp;iu=/124319096/external/ad_rule_samples&amp;ciu_szs=300x250&amp;ad_rule=1&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=vmap&amp;unviewed_position_start=1&amp;cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&amp;cmsid=496&amp;vid=short_onecue&amp;correlator=[avail.random]</textarea><label for="" class="">Sample VMAP 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_ad_samples&amp;sz=640x480&amp;cust_params=sample_ct%3Dlinear&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 2 (Linear)</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_preroll_skippable&amp;sz=640x480&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 3 (Skippable)</label></div></div>',1))])])])]),e("div",mh,[e("button",{disabled:o(d).$dirty&&o(d).$invalid,onClick:l[5]||(l[5]=m=>p()),class:"btn btn-primary",type:"button"},l[15]||(l[15]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,fh),l[16]||(l[16]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,Gw))}},vh=["id"],gh={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},bh={class:"modal-content"},yh={class:"modal-header"},$h={class:"modal-title"},wh={class:"modal-body"},hh={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},_h=["innerHTML"],kh={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Sh={class:"container"},Th={class:"col"},Ih={class:"form-floating mb-2"},Mh=["value"],xh={key:0,class:"d-block invalid-feedback"},Ch={class:"col"},Vh={class:"form-floating mb-2"},Ph={key:0,class:"d-block invalid-feedback"},Oh={class:"col"},Ah={class:"form-floating mb-2"},Uh={key:0,class:"d-block invalid-feedback"},Lh={class:"modal-footer"},Hh=["disabled"],Dh={__name:"_addChannelOutput",props:{channelId:{type:String}},emits:["confirm","cancel"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output"}),K=T,X=n,c=ce("modalAddChannelOutput"),v=be({lookups:{sourceGroups:[]},item:{sourceGroupId:null,manifestName:null,outputType:null}}),Y={item:{sourceGroupId:{required:ae.withMessage("Source Group is required.",re),$autoDirty:!0,$lazy:!0},manifestName:{required:ae.withMessage("Manifest Name is required.",re),$autoDirty:!0,$lazy:!0},outputType:{required:ae.withMessage("Output Type is required.",re),$autoDirty:!0,$lazy:!0}}},d=Se(Y,v);fe(async()=>{d.value.$reset(),p()});const C=async()=>{await g()},g=async()=>{try{await B.get("/api/v1/sourceGroups/lookup/").then(a=>{v.lookups.sourceGroups=a.data,v.lookups.sourceGroups.length===1&&(v.item.sourceGroupId=v.lookups.sourceGroups[0].id)})}catch(m){G.value=A.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{}},p=async()=>{const m=v;J.value.clear(),G.value="",m.lookups={sourceGroups:[]},m.item={sourceGroupId:null,outputType:null},await C(),d.value.$reset();var a=document.getElementById(c.value),r=we.getOrCreateInstance(a);r.show()},y=async()=>{var m=document.getElementById(c.value),a=we.getOrCreateInstance(m);a.hide(),K("cancel")},l=async()=>{const m=v;if(H.value)return;if(!await d.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,G.value="";const h=m.item;h.channelId=X.channelId,await B.post("/api/v1/channelOutputs",h).then(b=>{i.success("Add Channel Output","Channel output added.")});var r=document.getElementById(c.value),I=we.getOrCreateInstance(r);I.hide(),K("confirm")}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{H.value=!1}};return f({open:p,close:y}),(m,a)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-hidden":"true"},[e("div",gh,[e("div",bh,[e("div",yh,[e("h5",$h,[a[4]||(a[4]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),a[5]||(a[5]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",wh,[o(G)?(t(),s("div",hh,[a[6]||(a[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,_h)])):E("",!0),o(J).size>0?(t(),s("div",kh,[a[7]||(a[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),r=>(t(),s("li",null,u(r),1))),256))])])):E("",!0),e("div",Sh,[e("div",Th,[e("div",Ih,[N(e("select",{"onUpdate:modelValue":a[0]||(a[0]=r=>v.item.sourceGroupId=r),class:te([o(A).getValidFeedbackCss(v.item.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(U,null,q(v.lookups.sourceGroups,r=>(t(),s("option",{value:r.id},u(r.name),9,Mh))),256))],2),[[ge,v.item.sourceGroupId]]),a[8]||(a[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(d).item.sourceGroupId.$error?(t(),s("div",xh,[(t(!0),s(U,null,q(o(d).item.sourceGroupId.$errors,r=>(t(),s("div",{key:r.$uid},u(r.$message),1))),128))])):E("",!0)])]),e("div",Ch,[e("div",Vh,[N(e("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>v.item.outputType=r),class:te([o(A).getValidFeedbackCss(v.item.outputType),"form-select"]),id:"outputType"},a[9]||(a[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),2),[[ge,v.item.outputType]]),a[10]||(a[10]=e("label",{for:"outputType",class:""},"Output Type",-1)),o(d).item.outputType.$error?(t(),s("div",Ph,[(t(!0),s(U,null,q(o(d).item.outputType.$errors,r=>(t(),s("div",{key:r.$uid},u(r.$message),1))),128))])):E("",!0)])]),e("div",Oh,[e("div",Ah,[N(e("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>v.item.manifestName=r),class:te([o(A).getValidFeedbackCss(v.item.manifestName),"form-control"]),id:"manifestName"},null,2),[[Z,v.item.manifestName]]),a[11]||(a[11]=e("label",{for:"manifestName",class:""},"Manifest Name",-1)),o(d).item.manifestName.$error?(t(),s("div",Uh,[(t(!0),s(U,null,q(o(d).item.manifestName.$errors,r=>(t(),s("div",{key:r.$uid},u(r.$message),1))),128))])):E("",!0)])])])]),e("div",Lh,[e("button",{disabled:o(d).$dirty&&o(d).$invalid,onClick:a[3]||(a[3]=r=>l()),class:"btn btn-primary",type:"button"},a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Hh),a[13]||(a[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,vh))}},Eh=["id"],qh={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Bh={class:"modal-content"},Nh={class:"modal-header"},Rh={class:"modal-title"},Fh={class:"modal-body"},zh={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Gh=["innerHTML"],jh={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Yh={class:"container"},Wh={class:"col"},Kh={class:"form-floating mb-2"},Qh=["value"],Jh={key:0,class:"d-block invalid-feedback"},Xh={class:"col"},Zh={class:"form-floating mb-2"},e_=["value"],t_={key:0,class:"d-block invalid-feedback"},s_={class:"col"},o_={class:"card h-100"},a_=["id"],l_={class:"modal-footer"},n_=["disabled"],r_={__name:"_editFillerSlate",props:{channelId:{type:String},sourceLocationId:{type:String},vodSourceId:{type:String}},emits:["confirm","cancel"],setup(n,{expose:f,emit:T}){const{appTitle:V,pageTitle:_,busy:H,isDirty:P,validations:J,infoMessage:j,warningMessage:x,errorMessage:G,router:oe,axios:B,utils:A,toasts:i,closeWithReturnUrl:M,security:w}=$e({appTitle:"Arcadian-FAST",pageTitle:"Edit Filler Slate"}),K=T,X=n,c=ce("modalEditFillerSlate"),v=be({lookups:{sourceLocations:[],vodSources:[]},item:{channelId:null,sourceLocationId:null,vodSourceId:null},hls:null}),Y={item:{channelId:{required:ae.withMessage("channelId is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:ae.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:ae.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0}}},d=Se(Y,v);fe(async()=>{y(),d.value.$reset()}),Ae(()=>{v.hls&&(v.hls.stopLoad(),v.hls.destroy())});const C=async()=>{await g()},g=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(b=>{v.lookups.sourceLocations=b.data}),v.item.sourceLocationId&&await p(v.item.sourceLocationId)}catch(h){G.value=A.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},p=async h=>{try{let b=`/api/v1/vodSources/lookup/source-Location/${h}/?type=2`;await B.get(b).then(O=>{v.lookups.vodSources=O.data})}catch(b){G.value=A.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},y=async()=>{const h=v;J.value.clear(),G.value="",h.lookups={sourceLocations:[],vodSources:[]},h.item={channelId:X.channelId,sourceLocationId:X.sourceLocationId,vodSourceId:X.vodSourceId},await C(),v.item.vodSourceId&&await I(v.item.vodSourceId),d.value.$reset();var b=document.getElementById(c.value),O=we.getOrCreateInstance(b);O.show()},l=async()=>{var h=document.getElementById(c.value),b=we.getOrCreateInstance(h);b.hide(),v.hls&&(v.hls.stopLoad(),v.hls.destroy()),K("cancel","cancel clicked")},m=async()=>{const h=v;if(H.value)return;if(!await d.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,G.value="";const $=h.item;await B.put("/api/v1/channels/filler-slate",$).then(k=>{i.success("Update Channel Filler Slate","Channel's Filler slate was updated.")});var O=document.getElementById(c.value),D=we.getOrCreateInstance(O);D.hide(),v.hls&&(v.hls.stopLoad(),v.hls.destroy()),K("confirm",v.item)}catch($){G.value=A.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{H.value=!1}},a=async()=>{v.item.vodSourceId=null,await p(v.item.sourceLocationId)},r=async()=>{await I(v.item.vodSourceId)},I=async h=>{try{let b=`/api/v1/vodSources/${h}/hls`;const O=await B.get(b).then($=>$.data);if(v.hls){v.hls.loadSource(O);return}const D=document.getElementById(`video-${v.item.channelId}`);v.hls=A.createHlsStream(D,O)}catch(b){G.value=A.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}};return f({open:y,close:l}),(h,b)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-hidden":"true"},[e("div",qh,[e("div",Bh,[e("div",Nh,[e("h5",Rh,[b[6]||(b[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Q(u(o(_)),1)]),e("button",{type:"button",class:"btn-close",onClick:b[0]||(b[0]=O=>l()),"aria-label":"Close"})]),e("div",Fh,[o(G)?(t(),s("div",zh,[b[7]||(b[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Gh)])):E("",!0),o(J).size>0?(t(),s("div",jh,[b[8]||(b[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(o(J).values(),O=>(t(),s("li",null,u(O),1))),256))])])):E("",!0),e("div",Yh,[e("div",Wh,[e("div",Kh,[N(e("select",{"onUpdate:modelValue":b[1]||(b[1]=O=>v.item.sourceLocationId=O),onChange:b[2]||(b[2]=O=>a()),class:te([o(A).getValidFeedbackCss(v.item.sourceLocationId),"form-select"]),id:"sourceLocationId"},[(t(!0),s(U,null,q(v.lookups.sourceLocations,O=>(t(),s("option",{value:O.id},u(O.name),9,Qh))),256))],34),[[ge,v.item.sourceLocationId]]),b[9]||(b[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(d).item.sourceLocationId.$error?(t(),s("div",Jh,[(t(!0),s(U,null,q(o(d).item.sourceLocationId.$errors,O=>(t(),s("div",{key:O.$uid},u(O.$message),1))),128))])):E("",!0)])]),e("div",Xh,[e("div",Zh,[N(e("select",{"onUpdate:modelValue":b[3]||(b[3]=O=>v.item.vodSourceId=O),onChange:r,class:te([o(A).getValidFeedbackCss(v.item.vodSourceId),"form-select"]),id:"vodSourceId"},[(t(!0),s(U,null,q(v.lookups.vodSources,O=>(t(),s("option",{value:O.id},u(O.name),9,e_))),256))],34),[[ge,v.item.vodSourceId]]),b[10]||(b[10]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(d).item.vodSourceId.$error?(t(),s("div",t_,[(t(!0),s(U,null,q(o(d).item.vodSourceId.$errors,O=>(t(),s("div",{key:O.$uid},u(O.$message),1))),128))])):E("",!0)])]),e("div",s_,[e("div",o_,[e("video",{id:`video-${v.item.channelId}`,controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,8,a_)])])])]),e("div",l_,[e("button",{disabled:o(d).$dirty&&o(d).$invalid,onClick:b[4]||(b[4]=O=>m()),class:"btn btn-primary",type:"button"},b[11]||(b[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,n_),e("button",{onClick:b[5]||(b[5]=O=>l()),class:"btn btn-secondary ms-1"},b[12]||(b[12]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Eh))}},i_={class:"my-2"},d_={class:""},u_={class:"form-floating mb-2"},c_={id:"vodSourceTitle",class:"form-control-plaintext"},m_={class:"row"},f_={class:"col-12 col-md-4"},p_={class:"form-floating mb-2"},v_={id:"vodSourceVideoTitle",class:"form-control-plaintext"},g_={class:"col-12 col-md-8"},b_={class:"form-floating mb-2"},y_={id:"vodSourceVideoDesc",class:"form-control-plaintext"},$_={class:"mt-2"},w_={class:"row row-cols-1 row-cols-sm-3"},h_={class:"col"},__={class:"form-floating mb-2"},k_={id:"startOffsetMillis",class:"form-control-plaintext"},S_={class:"col"},T_={class:"form-floating mb-2"},I_={id:"endOffsetMillis",class:"form-control-plaintext"},M_={class:"col"},x_={class:"form-floating mb-2"},C_={id:"durationInMillis",class:"form-control-plaintext"},V_={class:"row row-cols-1 row-cols-sm-3"},P_={class:"col"},O_={class:"form-floating mb-2"},A_={id:"adBreaksDurationInMillis",class:"form-control-plaintext"},U_={class:"col"},L_={class:"form-floating mb-2"},H_={id:"totalProgramTemplateDurationInMillis",class:"form-control-plaintext"},D_={class:"row row-cols-1 row-cols-sm-3"},E_={class:"col"},q_={class:"form-floating mb-2"},B_={id:"dateScheduledStart",class:"form-control-plaintext"},N_={class:"col"},R_={class:"form-floating mb-2"},F_={id:"dateScheduledEnd",class:"form-control-plaintext"},z_={key:0,class:"col"},G_={class:"form-floating mb-2"},j_={id:"relativeProgram",class:"form-control-plaintext"},Y_={key:0,class:"mt-2"},W_={class:"table-responsive border"},K_={class:"table table-sm table-bordered1 mb-0"},Q_={class:"text-center me-1"},J_={class:"text-center"},X_={class:"text-center"},Z_={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},e2={key:1,class:"fas fa-fw fa-triangle-exclamation text-warning me-1"},t2={__name:"_programDetail",props:{item:{type:Object,required:!0},urlViewVideo:{type:String,required:!0},urlViewVodSource:{type:String,required:!0}},setup(n){const f=n,{moment:T,generateReturnUrl:V}=Xe();return fe(()=>{f.item.value}),(_,H)=>{const P=se("router-link");return t(),s("div",i_,[e("div",null,[H[1]||(H[1]=e("h5",null," VOD ",-1)),e("div",d_,[e("div",u_,[e("div",c_,[z(P,{to:`${n.urlViewVodSource}/${n.item.vodSourceId}/${o(V)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(n.item.vodSource.name),1)]),_:1},8,["to"])]),H[0]||(H[0]=e("label",{for:"vodSourceTitle"},"Title",-1))])])]),e("div",null,[H[4]||(H[4]=e("h5",null," Video ",-1)),e("div",m_,[e("div",f_,[e("div",p_,[e("div",v_,[z(P,{to:`${n.urlViewVideo}/${n.item.vodSource.video.videoId}/${o(V)()}`,class:"link-offset-2"},{default:R(()=>[Q(u(n.item.vodSource.video.title),1)]),_:1},8,["to"])]),H[2]||(H[2]=e("label",{for:"vodSourceVideoTitle"},"Title",-1))])]),e("div",g_,[e("div",b_,[e("div",y_,u(n.item.vodSource.video.description),1),H[3]||(H[3]=e("label",{for:"vodSourceVideoDesc"},"Description",-1))])])])]),e("div",$_,[H[13]||(H[13]=e("h5",null," Schedule ",-1)),e("div",w_,[e("div",h_,[e("div",__,[e("div",k_,u(o(T).utc(n.item.startOffsetMillis).format("HH:mm:ss")),1),H[5]||(H[5]=e("label",{for:"startOffsetMillis"},"Start Offset",-1))])]),e("div",S_,[e("div",T_,[e("div",I_,u(o(T).utc(n.item.endOffsetMillis).format("HH:mm:ss")),1),H[6]||(H[6]=e("label",{for:"endOffsetMillis"},"End Offset",-1))])]),e("div",M_,[e("div",x_,[e("div",C_,u(o(T).utc(n.item.durationInMillis).format("HH:mm:ss")),1),H[7]||(H[7]=e("label",{for:"durationInMillis"},"Clip Duration",-1))])])]),e("div",V_,[e("div",P_,[e("div",O_,[e("div",A_,u(o(T).utc(n.item.adBreaksDurationInMillis).format("HH:mm:ss")),1),H[8]||(H[8]=e("label",{for:"adBreaksDurationInMillis"},"Total Ad Breaks Duration",-1))])]),e("div",U_,[e("div",L_,[e("div",H_,u(o(T).utc(n.item.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),H[9]||(H[9]=e("label",{for:"totalProgramTemplateDurationInMillis"},"Total Program Duration",-1))])])]),e("div",D_,[e("div",E_,[e("div",q_,[e("div",B_,u(o(T).utc(n.item.dateScheduledStart).format("lll")),1),H[10]||(H[10]=e("label",{for:"dateScheduledStart"},"Program Start",-1))])]),e("div",N_,[e("div",R_,[e("div",F_,u(o(T).utc(n.item.dateScheduledEnd).format("lll")),1),H[11]||(H[11]=e("label",{for:"dateScheduledEnd"},"Program End",-1))])]),n.item.relativeProgram?(t(),s("div",z_,[e("div",G_,[e("div",j_,u(n.item.relativeProgram.name),1),H[12]||(H[12]=e("label",{for:"relativeProgram"},"Relative Program",-1))])])):E("",!0)])]),n.item.adBreaks.length?(t(),s("div",Y_,[H[15]||(H[15]=e("h5",null," Ad Breaks ",-1)),e("div",W_,[e("table",K_,[e("tbody",null,[H[14]||(H[14]=e("tr",null,[e("th",{class:"text-center"},"#"),e("th",{class:"text-center"},"Offset"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center1"},"VOD")],-1)),(t(!0),s(U,null,q(n.item.adBreaks,(J,j)=>(t(),s("tr",null,[e("td",Q_,u(j+1),1),e("td",J_,u(o(T).utc(J.offsetMillis).format("HH:mm:ss")),1),e("td",X_,u(o(T).utc(J.durationInMillis).format("HH:mm:ss")),1),e("td",null,[z(P,{to:`${n.urlViewVodSource}/${J.vodSource.vodSourceId}/${o(V)()}`,class:"link-offset-2"},{default:R(()=>[J.vodSource.arn?(t(),s("span",Z_)):(t(),s("span",e2)),Q(" "+u(J.vodSource.name),1)]),_:2},1032,["to"])])]))),256))])])])])):E("",!0)])}}},s2={key:0,class:"dropdown"},o2={key:0,class:"fas fa-fw fa-play"},a2={key:1,class:"fas fa-fw fa-stop"},l2={class:"dropdown-menu"},n2={key:0},r2={key:1},i2={key:0},d2={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},u2={class:"nav-item",role:"presentation"},c2={class:"nav-item",role:"presentation"},m2={class:"nav-item",role:"presentation"},f2={class:"nav-item",role:"presentation"},p2={class:"nav-item",role:"presentation"},v2={class:"tab-content",id:"myTabContent"},g2={class:"mt-2"},b2={class:"row row-cols-1 row-cols-sm-3"},y2={class:"col"},$2={class:"form-floating mb-2"},w2={class:"col"},h2={class:"form-floating mb-2"},_2={class:"col"},k2={class:"form-floating mb-2"},S2={class:"d-flex flex-row justify-content-start align-items-center"},T2={key:0,class:"ms-2"},I2={class:"row row-cols-sm-2 mt-1"},M2={class:"col"},x2={class:"form-floating mb-2"},C2={class:"form-control-plaintext",readonly:""},V2={class:"col"},P2={class:"form-floating mb-2"},O2={class:"form-control-plaintext",readonly:""},A2={class:"mt-2"},U2={class:"d-flex flex-row justify-content-start align-items-center"},L2={class:"ms-2"},H2={key:0,class:"alert bg-warning mt-2"},D2={class:"table-responsive border mt-1"},E2={class:"table table-bordered1 mb-0"},q2={class:"badge bg-info"},B2={key:0,class:"text-wrap"},N2={key:1,class:"text-warning"},R2={key:0,class:"text-end"},F2={key:1,class:"text-end"},z2=["onClick"],G2={key:0},j2={colspan:"999"},Y2={class:"d-flex flex-row justify-content-start align-items-center"},W2={class:"ms-2"},K2={if:"item.playbackUrl"},Q2=["onClick"],J2={key:0,class:"table-responsive mt-2"},X2={class:"table table-borderless mb-0 table-sm"},Z2={class:"align-middle1"},ek={class:"badge bg-success"},tk={class:"border p-2 mt-2 overflow-auto",style:{width:"50rem"}},sk={class:"text-end"},ok=["onClick"],ak=["onClick"],lk={class:"mt-2"},nk={class:"table-responsive border"},rk={class:"table mb-0 table-sm table-bordered1"},ik={class:"align-middle1"},dk={class:"text-center me-1"},uk={class:"d-flex flex-row justify-content-start"},ck={class:""},mk={class:"mb-1"},fk=["src"],pk={class:"ms-2"},vk={key:0,class:"fas fa-fw fa-check-circle text-success"},gk={class:"fw-lighter small"},bk={class:"fw-lighter small"},yk={class:"text-center"},$k={class:"text-center"},wk={class:"text-end"},hk={class:"btn-group position-static"},_k=["onClick"],kk={key:0,class:"fas fa-fw fa-chevron-circle-up"},Sk={key:1,class:"fas fa-fw fa-chevron-circle-down"},Tk={class:"dropdown-menu"},Ik=["onClick"],Mk={key:0},xk=["onClick"],Ck=["onClick"],Vk=["onClick"],Pk={key:0},Ok={colspan:"999"},Ak={class:"text-end mt-2 d-none"},Uk={class:"mt-2"},Lk={class:"text-end mb-2"},Hk={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4",id:"masonry"},Dk={class:"col"},Ek={class:"card shadow-sm"},qk=["id"],Bk={class:"p-1"},Nk={class:"card-title1 text-center"},Rk={class:"col"},Fk={class:"card shadow-sm"},zk=["id"],Gk={class:"p-1"},jk={class:"card-title1 text-center text-truncate"},Yk={class:"small1"},Wk={class:"mt-2"},Kk={key:0,class:"fas fa-fw fa-check-circle text-success"},Qk={key:1,class:"fas fa-fw fa-times-circle text-warning"},Jk={key:0,class:"fas fa-fw fa-check-circle text-success"},Xk={key:1,class:"fas fa-fw fa-times-circle text-warning"},Zk={key:0,class:"fas fa-fw fa-check-circle text-success"},eS={key:1,class:"fas fa-fw fa-times-circle text-warning"},tS={key:0,class:"fas fa-fw fa-check text-warning"},sS={key:1,class:"fas fa-fw fa-circle-exclamation text-warning"},oS={key:0,class:"fas fa-fw fa-check-circle text-success"},aS={key:1,class:"fas fa-fw fa-times-circle text-warning"},lS={__name:"index",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/channels"},urlViewSourceGroup:{type:String,default:"/source-groups/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlSchedulePrograms:{type:String,default:"/channels/schedule-programs"}},setup(n){const f=n,{appTitle:T,pageTitle:V,busy:_,isDirty:H,validations:P,infoMessage:J,warningMessage:j,errorMessage:x,router:G,axios:oe,utils:B,toasts:A,close:i,closeWithReturnUrl:M,generateReturnUrl:w,security:K}=$e({appTitle:"Arcadian-FAST",pageTitle:"View Channel"});Me("$config");const X=he();X.user;const c=be({user:X.user,item:null}),v=ce(null),Y=ce(null),d=ce(),C=Ie(()=>c.item&&c.item.state==="RUNNING");fe(async()=>{await l();const ne=B.getPageTab("channel")||"information-tab";g(ne)}),Ae(()=>{ie()});const g=ne=>{B.setPageTab("channel",ne),d.value=ne,ne==="preview-tab"&&setTimeout(()=>{var L=document.getElementById("masonry");new nt(L,{})},2e3)},p=ne=>ne===d.value?"active":"",y=ne=>ne===d.value?"show active":"",l=async()=>{const ne=c;if(ie(),!_.value)try{_.value=!0,x.value="",c.item=null;const L=`/api/v1/channels/${f.id}/`;await oe.get(L).then(me=>{ne.item=me.data,ne.item.outputs.forEach(Ce=>{Ce.playbackConfigurations.forEach(de=>{if(Ce.playbackUrl){const Oe=Ce.playbackUrl,Te=Oe.lastIndexOf("/"),at=Oe.substring(0,Te),Ge=Oe.substring(Te+1),lt=de.hlsConfigurationManifestEndpointPrefix;lt&&(de.hlsPlaylist=lt+Ge)}})})})}catch(L){x.value=B.getErrorMessageAsHtml(L),window.scrollTo(0,0)}finally{_.value=!1}},m=async()=>{if(confirm("Do you want to delete this Channel?")&&!_.value)try{_.value=!0,x.value="";const L=`/api/v1/channels/${f.id}/`;await oe.delete(L).then(me=>{}),M(f.urlMain)}catch(L){x.value=B.getErrorMessageAsHtml(L),window.scrollTo(0,0)}finally{_.value=!1}},a=async()=>{await l()},r=async()=>{if(confirm("Channel will be submitted to AWS MediaTailer. Are you sure you want to publish the channel?")&&!_.value){x.value=null;try{_.value=!0,await oe.post(`/api/v1/channels/${f.id}/publish/`).then(L=>{A.success("Publish Channel","Channel was published.")}),_.value=!1,await a()}catch(L){x.value=B.getErrorMessageAsHtml(L),window.scrollTo(0,0)}finally{_.value=!1}}},I=async()=>{if(confirm("Channel will be removed to AWS MediaTailer. Are you sure you want to remove the channel?")&&!_.value){x.value=null;try{_.value=!0,await oe.delete(`/api/v1/channels/${f.id}/unpublish/`).then(L=>{A.warning("Remove Channel","Channel was removed.")}),_.value=!1,await a()}catch(L){x.value=B.getErrorMessageAsHtml(L),window.scrollTo(0,0)}finally{_.value=!1}}},h=()=>{v.value.open(f.id)},b=async ne=>{if(ne.outputType==="HLS"){const L=Ee(ph,{channelOutputId:ne.channelOutputId,playbackUrl:ne.playbackUrl},{chore:!0,keepInitial:!1}),{data:me,isCanceled:xe}=await L.reveal();L.close(),xe||await a()}},O=async()=>{const ne=Ee(Dh,{channelId:c.item.channelId},{chore:!0,keepInitial:!1}),{data:L,isCanceled:me}=await ne.reveal();ne.close(),me||await a()},D=ne=>{Y.value.open(ne)},$=async(ne,L)=>{const me=Ee(r_,{channelId:c.item.channelId,sourceLocationId:c.item.fillerSlateSourceLocation.sourceLocationId,vodSourceId:c.item.fillerSlateVodSource.vodSourceId},{chore:!0,keepInitial:!1}),{data:xe,isCanceled:Ce}=await me.reveal();me.close(),Ce||await a()},k=async ne=>{if(confirm("Program will be deleted. Are you sure you want to delete the program?")&&!_.value){x.value=null;try{_.value=!0,await oe.delete(`/api/v1/programs/${ne}/`).then(me=>{A.success("Delete Program","Program was deleted..",{async onClose(){}})}),_.value=!1,await a()}catch(me){x.value=B.getErrorMessageAsHtml(me),window.scrollTo(0,0)}finally{_.value=!1}}},F=async ne=>{if(confirm("Channel output will be unpublished (if published) and will be deleted. Are you sure you want to delete this channel output?")&&!_.value){x.value=null;try{_.value=!0,await oe.delete(`/api/v1/channelOutputs/${ne}/`).then(me=>{A.success("Delete Channel Output","Channel output was deleted..")}),_.value=!1,await a()}catch(me){x.value=B.getErrorMessageAsHtml(me),window.scrollTo(0,0)}finally{_.value=!1}}},W=async ne=>{if(confirm("Program will be published to AWS MediaTailor. Are you sure you want to publish the program?")&&!_.value){x.value=null;try{_.value=!0,await oe.post(`/api/v1/programs/${ne}/publish/`).then(me=>{A.success("Publish Program","Program was published..",{async onClose(){}})}),_.value=!1,await a()}catch(me){x.value=B.getErrorMessageAsHtml(me),window.scrollTo(0,0)}finally{_.value=!1}}},pe=async ne=>{if(confirm("Program will be unpublished to AWS MediaTailor. Are you sure you want to unpublish the program?")&&!_.value){x.value=null;try{_.value=!0,await oe.delete(`/api/v1/programs/${ne}/unpublish/`).then(me=>{A.success("Unpublish Program","Program was unpublished..",{async onClose(){}})}),_.value=!1,await a()}catch(me){x.value=B.getErrorMessageAsHtml(me),window.scrollTo(0,0)}finally{_.value=!1}}},ee=async ne=>{if(!_.value){x.value=null;try{_.value=!0,await oe.put(`/api/v1/channels/${f.id}/change-state/${ne}`).then(L=>{A.success("Update Channel state","Change state was updated")}),_.value=!1,ne==="STOPPED"&&d.value==="preview-tab"&&(ie(),g("information-tab")),await a()}catch(L){x.value=B.getErrorMessageAsHtml(L),window.scrollTo(0,0)}finally{_.value=!1}}},S=async ne=>{if(!_.value)try{_.value=!0,x.value="",await oe.post(`/api/v1/channelOutputs/${ne}/playback/publish/`).then(L=>{A.success("Publish Channel Output Playback Configuration","Channel Output playback configuration published.")}),_.value=!1,await a()}catch(L){x.value=B.getErrorMessageAsHtml(L),window.scrollTo(0,0)}finally{_.value=!1}},ue=async ne=>{if(confirm("Do you want to remove this Playback Configuration?")&&!_.value)try{_.value=!0,x.value="",await oe.delete(`/api/v1/channelOutputs/${ne}/playback/`).then(me=>{A.warning("Delete Channel Output Playback Configuration","Channel Output playback configuration deleted.")}),_.value=!1,await a()}catch(me){x.value=B.getErrorMessageAsHtml(me),window.scrollTo(0,0)}finally{_.value=!1}},le=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?");const ne=c.item.outputs;ie(),ne.forEach(L=>{var me=document.getElementById(`video-${L.channelOutputId}`);L.hls&&L.hls.destroy(),L.hls=B.createHlsStream(me,L.playbackUrl,"Main playlist started."),me.play(),L.playbackConfigurations.forEach(xe=>{if(xe.hls&&xe.hls.destroy(),xe.arn){var Ce=document.getElementById(`video-${xe.channelOutputPlaybackConfigurationId}`);try{xe.hls=B.createHlsStream(Ce,xe.hlsPlaylist,"Playback with Server-side Ad Insertion playlist started."),Ce.play()}catch(de){A.error("Failed Stream SSAI Playlist",de)}}})}),setTimeout(()=>{var L=document.getElementById("masonry");new nt(L,{})},2e3)}},ie=()=>{c.item&&c.item.outputs&&c.item.outputs.forEach(L=>{L.hls&&(L.hls.detachMedia(),L.hls.destroy(),delete L.hls),L.playbackConfigurations.forEach(me=>{me.hls&&(me.hls.detachMedia(),me.hls.destroy(),delete me.hls)})})};return(ne,L)=>{const me=se("router-link"),xe=se("PageHeader"),Ce=se("PageBody");return t(),ve(ye,null,{default:R(()=>[e("div",null,[z(xe,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(V)},{default:R(()=>[e("button",{onClick:L[0]||(L[0]=de=>m()),class:"me-2 btn btn-danger"},L[21]||(L[21]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)])),c.item?(t(),s("div",s2,[e("button",{class:te([[C.value?"btn-success":"btn-secondary"],"btn dropdown-toggle"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[C.value?(t(),s("span",o2)):(t(),s("span",a2)),Q(" "+u(c.item.state),1)],2),e("ul",l2,[c.item.arn?(t(),s("li",n2,[C.value?(t(),s("button",{key:0,onClick:L[1]||(L[1]=de=>ee("STOPPED")),class:"dropdown-item"},L[22]||(L[22]=[e("span",{class:"fas fa-fw fa-stop me-1"},null,-1),Q("Stop ")]))):(t(),s("button",{key:1,onClick:L[2]||(L[2]=de=>ee("RUNNING")),class:"dropdown-item"},L[23]||(L[23]=[e("span",{class:"fas fa-fw fa-play me-1"},null,-1),Q("Start ")])))])):E("",!0),C.value?E("",!0):(t(),s("li",r2,[c.item.arn?(t(),s("button",{key:0,onClick:L[3]||(L[3]=de=>I()),class:"dropdown-item"},L[24]||(L[24]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),Q("Unpublish ")]))):(t(),s("button",{key:1,onClick:L[4]||(L[4]=de=>r()),class:"dropdown-item"},L[25]||(L[25]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Q("Publish ")])))])),c.item.arn?(t(),s(U,{key:2},[L[27]||(L[27]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("button",{onClick:L[5]||(L[5]=de=>r()),class:"dropdown-item"},L[26]||(L[26]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Q("Republish ")]))])],64)):E("",!0)])])):E("",!0),z(me,{to:`${n.urlSchedulePrograms}/${n.id}`,class:"ms-2 btn btn-outline-primary"},{default:R(()=>L[28]||(L[28]=[e("span",{class:"fas fa-fw fa-calendar"},null,-1)])),_:1},8,["to"]),e("button",{onClick:L[6]||(L[6]=de=>a()),class:"ms-2 btn btn-secondary"},L[29]||(L[29]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:L[7]||(L[7]=de=>o(M)(f.urlMain)),class:"btn btn-secondary ms-1"},L[30]||(L[30]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),z(Ce,{errorMessage:o(x)},{default:R(()=>[c.item?(t(),s("div",i2,[e("ul",d2,[e("li",u2,[e("button",{onClick:L[8]||(L[8]=de=>g("information-tab")),class:te([p("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"},L[31]||(L[31]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),Q("Information ")]),2)]),e("li",c2,[e("button",{onClick:L[9]||(L[9]=de=>g("outputPlayback-tab")),class:te([p("outputPlayback-tab"),"nav-link"]),id:"outputPlayback-tab","data-bs-toggle":"tab","data-bs-target":"#outputPlayback",type:"button",role:"tab","aria-controls":"outputPlayback","aria-selected":"false"},L[32]||(L[32]=[e("span",{class:"fas fa-fw fa-gears me-1"},null,-1),Q("Output/Playback ")]),2)]),e("li",m2,[e("button",{onClick:L[10]||(L[10]=de=>g("programs-tab")),class:te([p("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},L[33]||(L[33]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),Q("Programs ")]),2)]),e("li",f2,[e("button",{onClick:L[11]||(L[11]=de=>g("preview-tab")),class:te([[C.value?"":"disabled",p("preview-tab")],"nav-link"]),id:"preview-tab","data-bs-toggle":"tab","data-bs-target":"#preview",type:"button",role:"tab","aria-controls":"preview","aria-selected":"false"},L[34]||(L[34]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),Q("Preview ")]),2)]),e("li",p2,[e("button",{onClick:L[12]||(L[12]=de=>g("checklist-tab")),class:te([p("checklist-tab"),"nav-link"]),id:"checklist-tab","data-bs-toggle":"tab","data-bs-target":"#checklist",type:"button",role:"tab","aria-controls":"checklist","aria-selected":"false"},L[35]||(L[35]=[e("span",{class:"fas fa-fw fa-list-check me-1"},null,-1),Q("Checklist ")]),2)])]),e("div",v2,[e("div",{class:te([y("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",g2,[e("div",b2,[e("div",y2,[e("div",$2,[N(e("input",{"onUpdate:modelValue":L[13]||(L[13]=de=>c.item.name=de),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[Z,c.item.name]]),L[36]||(L[36]=e("label",{for:"name"},"Name",-1))])]),e("div",w2,[e("div",h2,[N(e("input",{"onUpdate:modelValue":L[14]||(L[14]=de=>c.item.playbackMode=de),type:"text",class:"form-control-plaintext",id:"playbackMode",readonly:""},null,512),[[Z,c.item.playbackMode]]),L[37]||(L[37]=e("label",{for:"playbackMode"},"Playback Mode",-1))])]),e("div",_2,[e("div",k2,[N(e("input",{"onUpdate:modelValue":L[15]||(L[15]=de=>c.item.tier=de),type:"text",class:"form-control-plaintext",id:"tier",readonly:""},null,512),[[Z,c.item.tier]]),L[38]||(L[38]=e("label",{for:"tier"},"Tier",-1))])])]),e("div",null,[e("div",S2,[L[40]||(L[40]=e("div",null,[e("h5",{class:"m-0"},"Filler Slate")],-1)),C.value?E("",!0):(t(),s("div",T2,[e("button",{onClick:L[16]||(L[16]=de=>$(c.item.fillerSlateSourceLocation.sourceLocationId,c.item.fillerSlateVodSource.vodSourceId)),class:"btn btn-outline-primary btn-sm"},L[39]||(L[39]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)]))]))]),e("div",I2,[e("div",M2,[e("div",x2,[e("div",C2,[z(me,{to:`${n.urlViewSourceLocation}/${c.item.fillerSlateSourceLocation.sourceLocationId}/${o(w)()}`,class:te([[c.item.fillerSlateSourceLocation.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName"},{default:R(()=>[Q(u(c.item.fillerSlateSourceLocation.name),1)]),_:1},8,["to","class"])]),L[41]||(L[41]=e("label",{for:"fillerSlateSourceLocationName"},"Filler Slate Source LocationName",-1))])]),e("div",V2,[e("div",P2,[e("div",O2,[z(me,{to:`${n.urlViewVodSource}/${c.item.fillerSlateVodSource.vodSourceId}/${o(w)()}`,class:te([[c.item.fillerSlateVodSource.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName",readonly:""},{default:R(()=>[Q(u(c.item.fillerSlateVodSource.name),1)]),_:1},8,["to","class"])]),L[42]||(L[42]=e("label",{for:"fillerSlateVodSourceName"},"Filler Slate Vod SourceName",-1))])])])])])],2),e("div",{class:te([y("outputPlayback-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",A2,[e("div",null,[e("div",U2,[L[44]||(L[44]=e("div",null,[e("h5",{class:"m-0"},"Outputs")],-1)),e("div",L2,[e("button",{onClick:L[17]||(L[17]=de=>O()),class:"btn btn-outline-primary btn-sm"},L[43]||(L[43]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),c.item.outputs.length<=0?(t(),s("div",H2,L[45]||(L[45]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),Q("Channel Output is required ")]))):E("",!0),e("div",D2,[e("table",E2,[L[55]||(L[55]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Manifest"),e("th",null,"Source Group"),e("th",null,"Playback Url")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.outputs,(de,Oe)=>(t(),s(U,{key:de.channelOutputId},[e("tr",null,[e("td",null,u(Oe+1),1),e("td",null,[e("div",null,u(de.manifestName),1),e("div",null,[e("span",q2,u(de.outputType),1)])]),e("td",null,[e("div",null,[z(me,{to:`${n.urlViewSourceGroup}/${de.sourceGroupId}/${o(w)()}`,class:"link-offset-2",tag:"button"},{default:R(()=>[Q(u(de.sourceGroup.name),1)]),_:2},1032,["to"])])]),e("td",null,[de.playbackUrl?(t(),s("div",B2,u(de.playbackUrl),1)):(t(),s("div",N2,L[46]||(L[46]=[e("span",{class:"fas fa-fw fa-info-circle"},null,-1),Q("Publish channel to get the playback url ")])))]),C.value?(t(),s("td",R2)):(t(),s("td",F2,[e("button",{onClick:Te=>F(de.channelOutputId),class:"btn btn-outline-warning btn-sm"},L[47]||(L[47]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,z2)]))]),de.playbackUrl?(t(),s("tr",G2,[L[52]||(L[52]=e("td",null,null,-1)),L[53]||(L[53]=e("td",null,null,-1)),L[54]||(L[54]=e("td",null,null,-1)),e("td",j2,[e("div",Y2,[L[49]||(L[49]=e("h5",null,[Q("Configuration "),e("sub",null,"(SSAI)")],-1)),e("div",W2,[e("div",K2,[e("button",{onClick:Te=>b(de),class:"btn btn-outline-primary btn-sm"},L[48]||(L[48]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]),8,Q2)])])]),de.playbackConfigurations.length>0?(t(),s("div",J2,[e("table",X2,[e("tbody",null,[(t(!0),s(U,null,q(de.playbackConfigurations,(Te,at)=>(t(),s("tr",Z2,[e("td",null,u(at+1),1),e("td",null,[e("span",ek,u(Te.name),1),e("div",tk,[e("span",null,u(Te.adDecisionServerUrl),1)])]),e("td",sk,[Te.arn?E("",!0):(t(),s("button",{key:0,onClick:Ge=>S(Te.channelOutputPlaybackConfigurationId),class:"btn btn-outline-warning btn-sm ms-1"},L[50]||(L[50]=[e("span",{class:"fas fa-fw fa-link"},null,-1)]),8,ok)),e("button",{onClick:Ge=>ue(Te.channelOutputPlaybackConfigurationId),class:"btn btn-outline-warning btn-sm ms-2"},L[51]||(L[51]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,ak)])]))),256))])])])):E("",!0)])])):E("",!0)],64))),128))]),_:1},512),[[ke,c.item.outputs.length>0]])])])])])],2),e("div",{class:te([y("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",lk,[e("div",nk,[e("table",rk,[L[62]||(L[62]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th")])],-1)),N(z(_e,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(U,null,q(c.item.programs,(de,Oe)=>(t(),s(U,{key:de.programId},[e("tr",ik,[e("td",dk,u(Oe+1),1),e("td",null,[e("div",uk,[e("div",ck,[de.vodSource.video.thumbnails.length>0?(t(!0),s(U,{key:0},q(de.vodSource.video.thumbnails,Te=>(t(),s("div",mk,[e("img",{src:Te.url,class:"img-fuild border",width:"128"},null,8,fk)]))),256)):E("",!0)]),e("div",pk,[e("div",null,[de.arn?(t(),s("span",vk)):E("",!0),e("span",null,u(de.name),1)]),e("div",null,[e("span",gk,u(o(B).moment.utc(de.dateScheduledStart).calendar())+" (utc)",1)]),e("div",null,[e("span",bk,u(o(B).moment(de.dateScheduledStart).calendar())+" (local)",1)])])])]),e("td",yk,u(o(B).moment.utc(de.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",$k,u(de.adBreaks.length),1),e("td",wk,[e("div",hk,[e("button",{onClick:Te=>de.expand=!de.expand,type:"button",class:te([[de.expand?"btn-secondary":"btn-outline-secondary"],"btn btn-sm"])},[de.expand?(t(),s("span",kk)):(t(),s("span",Sk))],10,_k),L[60]||(L[60]=e("button",{type:"button",class:"btn btn-secondary btn-sm dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"visually-hidden"},"Toggle Dropdown")],-1)),e("ul",Tk,[e("li",null,[e("button",{onClick:Te=>D(de.programId),class:"dropdown-item"},L[56]||(L[56]=[e("span",{class:"fas fa-fw fa-edit me-1"},null,-1),Q("Edit ")]),8,Ik)]),de.arn?(t(),s("li",Mk,[e("button",{onClick:Te=>pe(de.programId),class:"dropdown-item"},L[57]||(L[57]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),Q("Unpublish ")]),8,xk)])):(t(),s(U,{key:1},[e("li",null,[e("button",{onClick:Te=>W(de.programId),class:"dropdown-item"},L[58]||(L[58]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Q("Publish ")]),8,Ck)]),e("li",null,[e("button",{onClick:Te=>k(de.programId),class:"dropdown-item"},L[59]||(L[59]=[e("span",{class:"fas fa-fw fa-trash me-1"},null,-1),Q("Remove ")]),8,Vk)])],64))])])])]),de.expand?(t(),s("tr",Pk,[L[61]||(L[61]=e("td",null,null,-1)),e("td",Ok,[z(t2,{item:de,urlViewVideo:n.urlViewVideo,urlViewVodSource:n.urlViewVodSource},null,8,["item","urlViewVideo","urlViewVodSource"])])])):E("",!0)],64))),128))]),_:1},512),[[ke,c.item.programs.length>0]])])]),e("div",Ak,[e("button",{onClick:L[18]||(L[18]=de=>h()),class:"btn btn-outline-primary"},L[63]||(L[63]=[e("span",{class:"fas fa-fw fa-plus me-1"},null,-1),Q("Program ")]))])])],2),C.value?(t(),s("div",{key:0,class:te([y("preview-tab"),"tab-pane fade"]),id:"preview",role:"tabpanel","aria-labelledby":"preview-tab"},[e("div",Uk,[e("div",Lk,[c.item.outputs[0].hls?(t(),s("button",{key:1,onClick:L[20]||(L[20]=de=>ie()),class:"btn btn-primary"},L[65]||(L[65]=[e("span",{class:"fas fa-fw fa-eye-slash"},null,-1)]))):(t(),s("button",{key:0,onClick:L[19]||(L[19]=de=>le()),class:"btn btn-primary"},L[64]||(L[64]=[e("span",{class:"fas fa-fw fa-eye"},null,-1)])))]),e("div",Hk,[(t(!0),s(U,null,q(c.item.outputs,de=>(t(),s(U,null,[e("div",Dk,[e("div",Ek,[e("video",{id:`video-${de.channelOutputId}`,controls:"",class:"card-img-top object-fit-cover shandow"},null,8,qk),e("div",Bk,[e("div",Nk,u(de.manifestName),1)])])]),(t(!0),s(U,null,q(de.playbackConfigurations,(Oe,Te)=>(t(),s("div",Rk,[e("div",Fk,[e("video",{id:`video-${Oe.channelOutputPlaybackConfigurationId}`,controls:"",class:"card-img-top object-fit-cover"},null,8,zk),e("div",Gk,[e("div",jk,[Q(" #"+u(Te+1)+" ",1),e("span",Yk,u(Oe.name),1)])])])]))),256))],64))),256))])])],2)):E("",!0),e("div",{class:te([y("checklist-tab"),"tab-pane fade"]),id:"checklist",role:"tabpanel","aria-labelledby":"checklist-tab"},[e("div",Wk,[L[71]||(L[71]=Q(" Checklist ")),e("ul",null,[e("li",null,[c.item.fillerSlateSourceLocation.arn?(t(),s("span",Kk)):(t(),s("span",Qk)),L[66]||(L[66]=Q(" Filler Slate Source Location "))]),e("li",null,[c.item.fillerSlateVodSource.arn?(t(),s("span",Jk)):(t(),s("span",Xk)),L[67]||(L[67]=Q(" Filler Slate VOD Source "))]),e("li",null,[c.item.outputs.length>0?(t(),s("span",Zk)):(t(),s("span",eS)),L[69]||(L[69]=Q(" Outputs ")),e("ul",null,[e("li",null,[c.item.outputs.some(de=>de.playbackConfigurations.length>0)?(t(),s("span",tS)):(t(),s("span",sS)),L[68]||(L[68]=Q(" Ad Insertion setup "))])])]),e("li",null,[c.item.programs.length>0?(t(),s("span",oS)):(t(),s("span",aS)),L[70]||(L[70]=Q(" Programs "))])])])],2)])])):E("",!0)]),_:1},8,["errorMessage"]),z(zw,{ref_key:"modalAddProgram",ref:v,onRefresh:a},null,512),z(ft,{ref_key:"modalEditProgram",ref:Y,onOnClose:a},null,512)])]),_:1})}}},nS={path:"/",component:Va,props:!1,meta:{requiresAuth:!0},children:[{path:"",component:Xa},{path:"videos",children:[{path:"",component:Jn},{path:"view/:id",component:Lr,props:!0},{path:"add",component:Al},{path:"edit/:id",component:gn,props:!0}]},{path:"source-groups",children:[{path:"add",component:qr},{path:"edit/:id",component:ri,props:!0},{path:"",component:vi},{path:"view/:id",component:Vi,props:!0}]},{path:"source-locations",children:[{path:"add",component:Hi},{path:"edit/:id",component:qi,props:!0},{path:"",component:Qi},{path:"view/:id",component:bd,props:!0}]},{path:"vod-sources",children:[{path:"add",component:Au},{path:"edit/:id",component:rc,props:!0},{path:"",component:Ec},{path:"view/:id",component:kf,props:!0}]},{path:"channels",children:[{path:"add",component:w1},{path:"edit/:id",component:k1,props:!0},{path:"",component:A1},{path:"schedule-programs/:id",component:B$,props:!0},{path:"view/:id",component:lS,props:!0}]},{path:"program-templates",children:[{path:"add",component:nv},{path:"edit/:id",component:Qv,props:!0},{path:"",component:gg},{path:"view/:id",component:Zg,props:!0}]}]},ot=vt({history:gt("/"),linkActiveClass:"active",routes:[{...po},{path:"/administrator",redirect:"/"},{...nS}]});ot.beforeEach(async n=>{_t().clear();var T=n.meta;const V=["/accounts/login","/accounts/loginRedirect","/accounts/logout","/accounts/register"],_=T.requiresAuth&&!V.includes(n.path),H=he(),P=H.user;if(_&&!P)return H.returnUrl=n.fullPath,{path:"/accounts/login",query:{returnUrl:encodeURIComponent(n.fullPath)}};var J=n.meta.roles;if(J&&!H.user.roles.some(j=>J.includes(j)))return alert("You are not authorized to acccess this page."),{path:"/accounts/login/",query:{returnUrl:encodeURIComponent(n.fullPath)}}});const rS={props:{uid:{type:String,required:!0},urlViewDeposit:{type:String,required:!1},urlViewWithdraw:{type:String,required:!1},urlViewManualModeOfPayment:{type:String,required:!1}},data(){return{messages:[],count:0}},created(){},async mounted(){await this.connectNotificationHub()},methods:{async connectNotificationHub(){const n=this,T=new bt().withUrl("https://sonyfastpoc.azurewebsites.net//notificationHub").withAutomaticReconnect().build();T.on("onNotificationCreated",function(V){let _=V.content;V.notificationEntityClassText==="Deposit"&&(_+="<br/>",_+=`<a href="${n.urlViewDeposit}${V.referenceId}">Click ${V.notificationEntityClassText} here</a>`),V.notificationEntityClassText==="Withdraw"&&(_+="<br/>",_+=`<a href="${n.urlViewWithdraw}${V.referenceId}">Click ${V.notificationEntityClassText} here</a>`),V.notificationEntityClassText==="ManualModeOfPayment"&&(_+="<br/>",_+=`<a href="${n.urlViewManualModeOfPayment}${V.referenceId}">Click ${V.notificationEntityClassText} here</a>`),V.iconClass;let H="secondary";switch(V.notificationType){case 1:H="success";break;case 3:H="info";break;case 3:H="success";break;case 4:H="info";break;case 5:H="warning";break;case 6:H="error";break}n.$toast[H](V.subject,_,{timeOut:1e4});const P=V.subject,x={body:_,icon:"/img/192x102.png"};new Notification(P,x)}),T.on("jobUpdated",function(V){n.$bus.$emit("event:job-updated",V)}),await T.start().then(function(){}).catch(function(V){})}}};function iS(n,f,T,V,_,H){return t(),s("div")}const dS=Ve(rS,[["render",iS],["__scopeId","data-v-5b4a9fa2"]]),uS={class:"navbar bg-dark bg-gradient shadow flex-grow-0","data-bs-theme":"dark"},cS={class:"container"},mS={class:"col-md"},fS={class:"navbar-brand mb-0 ms-1 align-middle"},pS={class:"col-md-auto"},vS={class:"d-flex flex-row align-items-center justify-content-end"},gS={__name:"_pageHeader",props:{pageIcon:{type:String,required:!0},pageTitle:{type:String,required:!0},headerBreak:{type:String,required:!1,default:""}},setup(n){return(f,T)=>(t(),ve(ye,null,{default:R(()=>[e("nav",uS,[e("div",cS,[e("div",mS,[De(f.$slots,"title",{},()=>[e("a",fS,[e("i",{class:te([n.pageIcon,"me-1 me-lg-2"])},null,2),e("span",null,u(n.pageTitle),1)])],!0)]),e("div",pS,[e("div",vS,[De(f.$slots,"default",{},void 0,!0)])])])])]),_:3}))}},bS=Ve(gS,[["__scopeId","data-v-eb40af38"]]),yS={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},$S=["innerHTML"],wS={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},hS={__name:"_pageMessages",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(n){return(f,T)=>(t(),ve(ye,null,{default:R(()=>[De(f.$slots,"default",{},()=>[n.errorMessage?(t(),s("div",yS,[T[0]||(T[0]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Q("Error ")],-1)),e("div",{innerHTML:n.errorMessage},null,8,$S)])):E("",!0),n.vuelidate&&n.vuelidate.$error?(t(),s("div",wS,[T[1]||(T[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Q("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(U,null,q(n.vuelidate.$errors,V=>(t(),s("li",{key:V.$uid},[V.$validator==="$each"?(t(),s(U,{key:0},[Q(" Check errors in '"+u(V.$property)+"' ",1)],64)):(t(),s(U,{key:1},[Q(u(V.$message),1)],64))]))),128))])])):E("",!0)])]),_:3}))}},_S={class:"py-3 container flex-grow-1 overflow-y-auto"},kS={__name:"_pageBody",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(n){return(f,T)=>{const V=se("PageMessages");return t(),ve(ye,null,{default:R(()=>[e("div",_S,[z(V,{errorMessage:n.errorMessage,vuelidate:n.vuelidate},null,8,["errorMessage","vuelidate"]),De(f.$slots,"default")])]),_:3})}}},SS={props:{filter:Object,search:Function,noRecords:String,showPerPage:Boolean,busy:Boolean},data(){return{}},created(){},methods:{async changePagination(){const n=this;n.busy||(document.activeElement&&document.activeElement.blur(),await n.search(1))},async moveFirst(){const n=this;if(n.busy)return;n.filter.pageIndex!==1&&(document.activeElement&&document.activeElement.blur(),await n.search(1))},async moveLast(){const n=this;if(n.busy)return;const f=n.filter;f.pageIndex!==f.totalPages&&(document.activeElement&&document.activeElement.blur(),await n.search(f.totalPages))},async move(n){const f=this;if(f.busy)return;const T=f.filter,V=T.pageIndex+n;V>=0&&V<=T.totalPages&&(document.activeElement&&document.activeElement.blur(),await f.search(V))}}},TS={class:"mt-2"},IS={key:0,class:"row row-cols-1 row-cols-sm-2 align-items-center w-100 gy-2 gx-0"},MS={key:0,class:"col-sm order-2 order-sm-1"},xS={class:"d-flex align-items-center small justify-content-center justify-content-sm-start"},CS={class:"me-1 fw-bold"},VS={class:"fw-bold"},PS={class:"ms-1"},OS={class:"col-sm-auto ms-auto order-1 order-sm-2"},AS={class:"pagination m-0 ms-1 justify-content-center justify-content-sm-end"},US={key:0,class:"page-item"},LS={key:1,class:"page-item"},HS={key:2,class:"page-item"},DS={class:"page-item active"},ES={class:"page-link"},qS={key:3,class:"page-item"},BS={key:4,class:"page-item"},NS={key:5,class:"page-item"},RS={key:1,class:"text-info font-weight-bold text-center"},FS={key:0},zS={key:1};function GS(n,f,T,V,_,H){return t(),s("div",TS,[T.filter.items.length?(t(),s("div",IS,[T.showPerPage?(t(),s("div",MS,[e("div",xS,[e("div",null,[e("span",CS,u(T.filter.totalCount),1),f[8]||(f[8]=Q("records in ")),e("span",VS,u(T.filter.totalPages),1),f[9]||(f[9]=Q(" page(s) "))]),e("div",PS,[N(e("select",{"onUpdate:modelValue":f[0]||(f[0]=P=>T.filter.pageSize=P),onChange:f[1]||(f[1]=(...P)=>H.changePagination&&H.changePagination(...P)),class:"form-select form-select-sm me-1"},f[10]||(f[10]=[Qe('<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="5">5</option><option value="10">10</option><option value="15">15</option><option value="25">25</option><option value="50">50</option><option value="100">100</option>',9)]),544),[[ge,T.filter.pageSize]])]),f[11]||(f[11]=e("div",{class:"ms-1"},"per page",-1))])])):E("",!0),e("div",OS,[e("ul",AS,[T.filter.pageIndex!==1?(t(),s("li",US,[e("button",{class:"page-link","aria-label":"Previous",onClick:f[2]||(f[2]=(...P)=>H.moveFirst&&H.moveFirst(...P))},f[12]||(f[12]=[e("span",{class:"fas fa-fw fa-backward-step"},null,-1)]))])):E("",!0),T.filter.pageIndex>2?(t(),s("li",LS,[e("button",{class:"page-link",onClick:f[3]||(f[3]=P=>H.move(-2))},u(T.filter.pageIndex-2),1)])):E("",!0),T.filter.pageIndex>1?(t(),s("li",HS,[e("button",{class:"page-link",onClick:f[4]||(f[4]=P=>H.move(-1))},u(T.filter.pageIndex-1),1)])):E("",!0),e("li",DS,[e("span",ES,u(T.filter.pageIndex),1)]),T.filter.pageIndex<T.filter.totalPages?(t(),s("li",qS,[e("button",{class:"page-link",onClick:f[5]||(f[5]=P=>H.move(1))},u(T.filter.pageIndex+1),1)])):E("",!0),T.filter.pageIndex<T.filter.totalPages-1?(t(),s("li",BS,[e("button",{class:"page-link",onClick:f[6]||(f[6]=P=>H.move(2))},u(T.filter.pageIndex+2),1)])):E("",!0),T.filter.pageIndex<T.filter.totalPages?(t(),s("li",NS,[e("button",{class:"page-link","aria-label":"Next",onClick:f[7]||(f[7]=(...P)=>H.moveLast&&H.moveLast(...P))},f[13]||(f[13]=[e("span",{class:"fas fa-fw fa-forward-step"},null,-1)]))])):E("",!0)])])])):(t(),s("div",RS,[T.noRecords?(t(),s("div",FS,u(T.noRecords),1)):(t(),s("div",zS,"No record(s) found."))]))])}const jS=Ve(SS,[["render",GS]]),YS={props:{filter:Object,field:String,showSort:Boolean,enabled:Boolean},data(){return{}},mounted(){},methods:{currentSortField(){return this.filter.sortField===this.field},sortUp(){return this.filter.sortOrder===1},click(){let n=this;if(!n.enabled)return;let f=n.filter;f.sortField===n.field?f.sortOrder===0?f.sortField=null:f.sortOrder=f.sortOrder===0?1:0:(f.sortField=n.field,f.sortOrder=1),n.$emit("search")}}},WS={class:"align-self-center"};function KS(n,f,T,V,_,H){return t(),s("div",{onClick:f[0]||(f[0]=(...P)=>H.click&&H.click(...P)),class:"d-flex flex-row justify-content-start align-content-center",style:dt({cursor:T.enabled?"pointer":""})},[De(n.$slots,"default"),e("span",WS,[T.showSort?(t(),s("span",{key:0,class:te([{"fa-sort text-gray-500":!H.currentSortField(),"fa-sort-up":H.currentSortField()&&H.sortUp(),"fa-sort-down":H.currentSortField()&&!H.sortUp()},"fas fa-fw mr-1"])},null,2)):E("",!0)])],4)}const QS=Ve(YS,[["render",KS]]),JS={props:{items:Array,header:Object,getRowNumber:Function,setSelected:Function,isSelected:Function,tableCss:String,rowCss:String},data(){return{}},mounted(){},methods:{onSelectedRow(n){const f=this;f.setSelected(n),f.$emit("onSelectedRow",n)}}},XS={class:"table-responsive m-0"},ZS=["href"],e0={key:1},t0=["onClick"],s0={class:"form-group row no-gutters"},o0={class:"col-5 col-form-label"},a0={class:"col align-self-center"},l0=["href"],n0={key:1};function r0(n,f,T,V,_,H){return t(),s("div",null,[e("div",XS,[e("table",{class:te(["table table-hover d-none d-md-table card",T.tableCss])},[e("thead",null,[De(n.$slots,"header",{},()=>[f[0]||(f[0]=e("th",null,"#",-1)),(t(!0),s(U,null,q(T.header.columns,P=>(t(),s("th",null,u(P.title),1))),256))],!0)]),e("tbody",null,[(t(!0),s(U,null,q(T.items,(P,J)=>De(n.$slots,"table-row",{key:`row1-${P[T.header.key]}`,item:P,index:J},()=>[e("td",null,u(T.getRowNumber(J)),1),(t(!0),s(U,null,q(T.header.columns,j=>(t(),s("td",null,[j.href?(t(),s("a",{key:0,href:j.href(P[T.header.key]),class:"font-weight-bold"},u(P[j.field]),9,ZS)):(t(),s("span",e0,u(P[j.field]),1))]))),256))],!0)),128))])],2)]),e("div",{class:te(["d-block d-md-none",T.rowCss])},[(t(!0),s(U,null,q(T.items,(P,J)=>(t(),s("div",{key:`row2-${P[T.header.key]}`,onClick:j=>H.onSelectedRow(P),class:"border"},[e("div",{class:te(["p-2",{"b-left":T.isSelected(P)}])},[De(n.$slots,"table-list",{item:P,index:J},()=>[(t(!0),s(U,null,q(T.header.columns,j=>(t(),s("div",s0,[e("label",o0,u(j.title),1),e("div",a0,[j.href?(t(),s("a",{key:0,href:j.href(P[T.header.key]),class:"font-weight-bold"},u(P[j.field]),9,l0)):(t(),s("span",n0,u(P[j.field]),1))])]))),256))],!0)],2)],8,t0))),128))],2)])}const i0=Ve(JS,[["render",r0],["__scopeId","data-v-65929213"]]),Pe=yt(ht);Pe.use($t());Pe.use(wt);Pe.use(ot);Pe.component("m-notification",dS);Pe.component("m-pagination",jS);Pe.component("sort-field",QS);Pe.component("table-list",i0);Pe.component("Toasts",Ia);Pe.component("PageHeader",bS);Pe.component("PageMessages",hS);Pe.component("PageBody",kS);const d0="https://sonyfastpoc.azurewebsites.net/",u0="Arcadian-FAST",c0=void 0,m0={API_URL:d0,appName:u0,tenantId:c0};Pe.provide("$config",m0);Pe.provide("$bus",et);Pe.mount("#app");
