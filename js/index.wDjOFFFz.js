import{o as t,c as ve,r as te,d as We,h as rt,u as Ke,a as de,L as Re,e as Fe,b as s,f as e,g as F,w as z,i as K,t as m,F as A,j as N,k as H,l as me,m as Qe,n as Ce,p as it,q as ze,s as Je,P as Ge,v as be,x as se,y as ae,z as Te,T as $e,A as vt,B as o,C as R,D as X,E as dt,G as le,H as gt,I as ut,J as ke,K as Ae,M as Me,N as Be,O as ge,Q as Ue,R as Se,S as _e,U as Ne,V as Ee,W as nt,X as bt,Y as yt,Z as $t,_ as qe,$ as wt,a0 as ht}from"./vendor-CGMnXvqM-chunk.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))V(S);new MutationObserver(S=>{for(const L of S)if(L.type==="childList")for(const P of L.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&V(P)}).observe(document,{childList:!0,subtree:!0});function I(S){const L={};return S.integrity&&(L.integrity=S.integrity),S.referrerPolicy&&(L.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?L.credentials="include":S.crossOrigin==="anonymous"?L.credentials="omit":L.credentials="same-origin",L}function V(S){if(S.ep)return;S.ep=!0;const L=I(S);fetch(S.href,L)}})();const _t={__name:"App",setup(a){return(g,I)=>{const V=te("router-view");return t(),ve(V)}}},kt=We({id:"alert",state:()=>({alert:null}),actions:{success(a){this.alert={message:a,type:"alert-success"}},error(a){this.alert={message:a,type:"alert-danger"}},clear(){this.alert=null}}});function Xe(){const a=Z=>{var x;let B=Z,U=B.response,O="";if(!B.response)return Z.message;if(U.status===500){if(typeof U.data=="string")return U.data;if(U.data.content)return U.data.content;if(U.data.detail)return U.data.detail}if(U.status===401){const u=`${window.location.pathname}${window.location.search}`;O=`You are not authorized or your session timed out. Please click <a href='${`/accounts/login/?returnUrl=${encodeURIComponent(u)}`}'>here</a> to login.`}else if(U.status===400){let u=B.response.data.errors;O=B.response.data.title||B.response.data,u&&(O+="<ul>");for(let J in u){let Q=u[J];for(let c in u[J]){let y=Q[c];O+=`<li>${y}</li>`}}u&&(O+="</ul>"),O||(O=B.message),O&&O.content&&(O=O.content)}else U.status===404?O=((x=U==null?void 0:U.data)==null?void 0:x.title)||(U==null?void 0:U.data)||"Record not found.":typeof U.data=="string"&&(O=B.message,O===""&&(O=`Error <b>Http ${U.status}</b>.<br/>Please contact the System Administrator.`));return O},g=Z=>JSON.parse(JSON.stringify(Z)),I=Z=>{if(typeof Z!="number")return Z;var B=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2});return B.format(Z)},V=(Z,B,U)=>{const x={value:B,expiry:new Date().getTime()+U};debugger;localStorage.setItem(Z,JSON.stringify(x))},S=Z=>{debugger;const B=localStorage.getItem(Z);if(!B)return null;const U=JSON.parse(B);return new Date().getTime()>U.expiry?(localStorage.removeItem(Z),null):U.value},L="pageSelectedTabStorageKey";return{getErrorMessageAsHtml:a,clone:g,toCurrency:I,moment:rt,localStorageSetWithExpiry:V,localStorageGetWithExpiry:S,setPageTab:(Z,B)=>{var U=localStorage.getItem(L);U?U=JSON.parse(U):U={},U[Z]=B,localStorage.setItem(L,JSON.stringify(U))},getPageTab:Z=>{var B=localStorage.getItem(L);return B?B=JSON.parse(B):B={},B[Z]},createHlsStream:(Z,B,U)=>{var O=new Hls({autoStartLoad:U??!0});return O.on(Hls.Events.MEDIA_ATTACHED,function(){}),O.on(Hls.Events.MANIFEST_PARSED,function(x,u){console.log("manifest loaded, found "+u.levels.length+" quality level")}),O.on(Hls.Events.ERROR,function(x,u){if(u.fatal)switch(u.type){case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),O.recoverMediaError();break;case Hls.ErrorTypes.NETWORK_ERROR:console.error("fatal network error encountered",u);break;default:O.destroy();break}}),O.loadSource(B),O.attachMedia(Z),O},isValidTime:Z=>/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/.test(Z),generateReturnUrl:()=>{const Z=Ke();let B=Z.path;return Z.query.returnUrl&&(B=Z.query.returnUrl),B=`?returnUrl=${encodeURIComponent(B)}`,B}}}const St=Xe(),ct=JSON.parse(localStorage.getItem("user"))||{},Tt=St.moment.utc(ct.exp*1e3),It=Tt.isAfter()?ct:null,he=We({id:"auth",state:()=>({user:It,returnUrl:null}),actions:{async login(a){try{this.user=a,localStorage.setItem("user",JSON.stringify(a))}catch(g){debugger;alert(g)}},logout(){this.user=null,localStorage.removeItem("user"),ot.push("/accounts/login")},logoutWithRedirect(){this.user=null,localStorage.removeItem("user")}}}),Mt="vue-3-pinia-registration-login-example-users";JSON.parse(localStorage.getItem(Mt));const xt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://sonyfastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AUTH_POST_LOGOUT_URI:"https://lively-bay-00480981e.5.azurestaticapps.net/",VITE_AUTH_REDIRECT_URI:"window.location.origin + '/accounts/loginRedirect'"},Ye=xt,Ze=We("msal",()=>{const a=de({auth:{clientId:Ye.VITE_AUTH_CLIENT_ID,authority:Ye.VITE_AUTH_AUTHORITY_URL,postLogoutUri:Ye.VITE_AUTH_POST_LOGOUT_URI},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1,secureCookies:!1},system:{loggerOptions:{logLevel:Re.Verbose,loggerCallback:(V,S,L)=>{if(!L)switch(V){case Re.Error:console.error(S);return;case Re.Info:console.info(S);return;case Re.Verbose:console.debug(S);return;case Re.Warning:console.warn(S);return}},piiLoggingEnabled:!1}}}),g=de("");return{msalConfig:a,accessToken:g,setAccessToken:V=>{g.value=V}}}),et={$on:(...a)=>Fe.on(...a),$once:(...a)=>Fe.once(...a),$off:(...a)=>Fe.off(...a),$emit:(...a)=>Fe.emit(...a)};function Ct(){const a=(L,P,W,Y)=>{et.$emit("toast-message",{title:L,message:P,type:W,options:Y})};return{success:(L,P,W={})=>{a(L,P,"success",W)},warning:(L,P,W={})=>{a(L,P,"warning",W)},info:(L,P,W={})=>{a(L,P,"info",W)},error:(L,P,W={})=>{a(L,P,"danger",W)}}}const Ve=(a,g)=>{const I=a.__vccOpts||a;for(const[V,S]of g)I[V]=S;return I},Vt={data(){return{notifications:[],messages:[]}},async created(){const a=this;a.$bus.$on("event:notification-received",()=>{a.getUnreadNotifications()}),a.$bus.$on("event:notification-marked-as-read",g=>{a.notifications.some(V=>V.notificationId===g)&&a.getUnreadNotifications()}),a.$bus.$on("event:notification-removed",g=>{a.notifications.some(V=>V.notificationId===g)&&a.getUnreadNotifications()}),a.$bus.$on("event:chat-marked-as-read",a.onChatMarkedAsRead),a.$bus.$on("event:chat-message-received",a.onChatMessageReceived)},async mounted(){const a=this,g=a.$refs.notifications,I=a.$refs.messages;g&&g.offsetParent,I&&I.offsetParent&&await a.getUnreadChats()},methods:{async logout(){const a=this;try{await a.$util.axios.post("/api/accounts/logout").then(g=>{const I="/";a.$toast.warning("Logout","You have logged out of the system.",{timeOut:5e3,async onClose(){a.$util.href(I)}})})}catch(g){a.$util.handleError(g)}},async onChatMarkedAsRead(a){let g=this,I=g.messages.find(V=>V.chatId===a);if(I){let V=g.messages.indexOf(I);g.messages.splice(V,1)}},async onChatMessageReceived(a){let g=this,I=g.messages.find(S=>S.chatId===a.chatId);if(I)I.lastMessageText=a.content;else{var V={chatId:a.chatId,isRead:!1,lastDateSent:a.dateSent,lastMessageText:a.content,senderFirstLastName:`${a.sender.firstName} ${a.sender.lastName}`,senderInitials:a.sender.initials,senderProfilePicture32:a.sender.profilePicture32,urlPicture:g.$util.getProfilePictureUrl(a.sender.profilePicture32,a.sender.initials)};g.messages.push(V)}},async getUnreadNotifications(){const a=this;try{await a.$util.axios.get("api/accounts/unread-notifications").then(g=>{a.notifications=g.data})}catch(g){a.$util.handleError(g)}},async getUnreadChats(){const a=this;try{await a.$util.axios.get("api/accounts/unread-chats").then(g=>{a.messages=g.data;for(let I in a.messages){let V=a.messages[I];a.$set(V,"urlPicture",a.$util.getProfilePictureUrl(V.senderProfilePicture32,V.senderInitials))}})}catch(g){a.$util.handleError(g)}},viewNotification(a){this.$bus.$emit("event:open-notification",a)},viewChat(a){this.$bus.$emit("event:open-chat",a)},showHiddenElements(){let g=this.$el.getElementsByClassName("initialHidden");for(let I=0;I<g.length;I++)g[I].classList.remove("invisible")}}},Pt={mixins:[Vt],props:{uid:String,appName:{type:String,required:!0,default:"SCH2"},urlProfilePicture:String,menus:Array},components:{},data(){const g=he().user;return{user:g,username:g?g.nameFull:"Guest"}},async mounted(){},methods:{isActive(a){return window.location.href.indexOf(a)>-1},async openModalSearchUser747(a){this.$refs.refModalSearchUser747.open(a)}}},Ot={class:"sticky-top navbar navbar-expand-sm navbar-dark bg-primary bg-gradient shadow-sm py-2","aria-label":"Offcanvas navbar large"},At={class:"container-md"},Ut={class:"navbar-collapse collapse",id:"navbarSideCollapse"},Lt={class:"navbar-nav"},Dt={class:"nav-item dropdown"},Ht={class:"dropdown-menu","aria-labelledby":"dropdown01"},Et={class:"nav-item dropdown"},qt={class:"dropdown-menu","aria-labelledby":"dropdown01"},Bt={class:"navbar-nav ms-auto"},Nt={class:"nav-item dropdown"},Rt={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Ft={class:"d-inline d-sm-none d-md-inline"},zt={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Gt={class:"text-capitalize"};function jt(a,g,I,V,S,L){const P=te("router-link");return t(),s("nav",Ot,[e("div",At,[F(P,{class:"navbar-brand",to:"/member"},{default:z(()=>[K(m(I.appName),1)]),_:1}),g[14]||(g[14]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSideCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",Ut,[e("ul",Lt,[e("li",Dt,[g[3]||(g[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Social")])],-1)),e("ul",Ht,[e("li",null,[F(P,{class:"dropdown-item",to:"/member/announcements"},{default:z(()=>g[0]||(g[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),K(" Announcements ")])),_:1})]),e("li",null,[F(P,{class:"dropdown-item",to:"/member/posts"},{default:z(()=>g[1]||(g[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),K(" Posts ")])),_:1})]),e("li",null,[F(P,{class:"dropdown-item",to:"/member/yellow-pages"},{default:z(()=>g[2]||(g[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),K(" Yellow Pages ")])),_:1})])])]),e("li",Et,[g[5]||(g[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Home Owners")])],-1)),e("ul",qt,[e("li",null,[F(P,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:z(()=>g[4]||(g[4]=[K(" Property Monthly Dues ")])),_:1})])])])]),e("ul",Bt,[e("li",Nt,[e("a",Rt,[e("span",null,[g[6]||(g[6]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Ft,m(S.username),1)])]),e("ul",zt,[g[9]||(g[9]=e("li",null,[e("h6",{class:"dropdown-header"},"Settings")],-1)),g[10]||(g[10]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Profile ")],-1)),g[11]||(g[11]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Theme ")],-1)),g[12]||(g[12]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),S.user&&S.user.roles.length>1?(t(!0),s(A,{key:0},N(S.user.roles,W=>(t(),s("li",null,[F(P,{to:`/${W.toLowerCase()}`,class:"dropdown-item"},{default:z(()=>[e("span",Gt,m(W),1)]),_:2},1032,["to"])]))),256)):H("",!0),e("li",null,[F(P,{to:"/",class:"dropdown-item"},{default:z(()=>g[7]||(g[7]=[K(" Main ")])),_:1})]),g[13]||(g[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[F(P,{to:"/account/logout",class:"dropdown-item"},{default:z(()=>g[8]||(g[8]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),K("Logout ")])),_:1})])])])])])])])}const Yt=Ve(Pt,[["render",jt]]),Wt={props:{appName:{type:String,required:!1}},data(){return{busy:!1,enums:{orderStatuses:[{id:1,name:"Requested"},{id:2,name:"Placed"},{id:3,name:"Accepted"},{id:4,name:"Processed"},{id:5,name:"Delivered"},{id:6,name:"Completed"},{id:7,name:"Cancelled"}],promotionType:[{id:1,name:"Discounts"},{id:2,name:"Shipping"}],promotionProductApplicability:[{id:1,name:"All Products"},{id:2,name:"Specific Products"}],promotionOfferType:[{id:1,name:"No Code"},{id:2,name:"Generic Code"}],shipmentType:[{id:1,name:"Pickup"},{id:2,name:"Delivery"}]}}},async created(){},mounted(){this.showHiddenElements()},methods:{scrollIntoView(){const a=document.getElementById("top");a&&a.scrollIntoView({behavior:"smooth"})},showHiddenElements(){let a=this;if(!a.$el.getElementsByClassName)return;let g=a.$el.getElementsByClassName("initialHidden");for(let I=0;I<g.length;I++){let V=g[I];V.classList.remove("invisible"),V.classList.remove("d-none")}},close(){const a=this,g=document.referrer.toLowerCase();g&&g.includes("/account/login")?a.$router.go(-2):a.$router.go(-1)},toggle(a){const g=this;g.toggles[a]=!g.toggles[a],localStorage.setItem(g.togglesKey,JSON.stringify(g.toggles))}}},Kt={mixins:[Wt],props:{uid:String},data(){return{copyright:`2020-${new Date().getFullYear()} HOAMS - UbePages`}},computed:{},async created(){},async mounted(){},methods:{isActive(a){return window.location.href.indexOf(a)>-1}}},Qt={class:"footer sticky-bottom"},Jt={class:"d-none d-sm-block navbar navbar-dark bg-primary bg-gradient py-1"},Xt={class:"container-md"},Zt={class:"navbar-text small p-0"},es={class:"d-block d-sm-none navbar navbar-expand navbar-dark bg-primary bg-gradient py-1"},ts={class:"container-md"},ss={class:"navbar-nav nav-fill w-100"},os={class:"nav-item dropup"},as={class:"dropdown-menu","aria-labelledby":"dropdown01"},ls={class:"nav-item dropup"},ns={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"};function rs(a,g,I,V,S,L){const P=te("router-link");return t(),s("footer",Qt,[e("div",Jt,[e("div",Xt,[e("span",Zt,"©"+m(S.copyright),1)])]),e("nav",es,[e("div",ts,[e("ul",ss,[e("li",os,[g[3]||(g[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group"})])],-1)),e("ul",as,[e("li",null,[F(P,{class:"dropdown-item",to:"/member/announcements"},{default:z(()=>g[0]||(g[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),K(" Announcements ")])),_:1})]),e("li",null,[F(P,{class:"dropdown-item",to:"/member/posts"},{default:z(()=>g[1]||(g[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),K(" Posts ")])),_:1})]),e("li",null,[F(P,{class:"dropdown-item",to:"/member/yellow-pages"},{default:z(()=>g[2]||(g[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),K(" Yellow Pages ")])),_:1})])])]),e("li",ls,[g[5]||(g[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user"})])],-1)),e("ul",ns,[e("li",null,[F(P,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:z(()=>g[4]||(g[4]=[K(" Property Monthly Dues ")])),_:1})])])])])])])])}const is=Ve(Kt,[["render",rs]]),ds={name:"AdminLayout",components:{TopNav:Yt,BottomNav:is},inject:["$config"],mounted(){const g=this.$config;document.title=`Account - ${g.appName}`}},us={class:"d-flex flex-column vh-100"};function cs(a,g,I,V,S,L){const P=te("Toasts"),W=te("router-view");return t(),s("div",us,[F(P),F(W,{class:"flex-grow-1 mb-2"})])}const ms=Ve(ds,[["render",cs]]),fs={__name:"index",setup(a){return he().user,me(()=>{}),(I,V)=>(t(),s("div",null,V[0]||(V[0]=[Qe('<div class="mt-2 pb-2 shadow-sm"><div class="container-md"><div class="row align-items-center"><div class="col-md-auto"><h1><i class="fas fa-fw fa-dashboard me-1"></i>Dashboard </h1></div><div class="col-md"></div></div></div></div><div class="mt-2 container-md"> Dashboard contents here </div>',2)])))}},ps={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://sonyfastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AUTH_POST_LOGOUT_URI:"https://lively-bay-00480981e.5.azurestaticapps.net/",VITE_AUTH_REDIRECT_URI:"window.location.origin + '/accounts/loginRedirect'"},vs=ps;function gs(){Ce("$config");const a=vs.VITE_API_URL,g=it.create({baseURL:a});return ze.configure({template:'<div class="bar pt-1 bg-light" role="bar"><div class="peg1"></div></div><div class="spinner" role="spinner"><div class="fas fa-fw fa-spin fa-arrows-rotate text-white"></div></div>'}),g.interceptors.request.use(I=>{ze.start();const{user:V}=he();return V&&V.token&&(I.headers?(I.headers.Authorization||(I.headers.Authorization=`Bearer ${V.token}`),I.headers["Access-Control-Allow-Origin"]||(I.headers["Access-Control-Allow-Origin"]="*")):I.headers={Authorization:`Bearer ${V.token}`,"Access-Control-Allow-Origin":"*"}),I}),g.interceptors.response.use(I=>(ze.done(),I),I=>{throw ze.done(),I}),g}function we(a){if(!a.appTitle)throw Error("App Title is required.");if(!a.pageTitle)throw Error("Page Title is required.");const g=Ke(),I=Je(),V=gs(),S=Xe(),L=Ct(),W=he().user,Y=()=>W&&W.roles&&W.roles.includes("System"),D=()=>W&&W.roles&&W.roles.includes("administrator"),G=()=>W&&W.roles&&W.roles.includes("employee"),Z=()=>W&&W.roles&&W.roles.includes("Member"),B=async()=>{const j=document.referrer.toLowerCase();j&&j.includes("/accounts/login")?await I.go(-2):await I.go(-1)},U=j=>{var i;const f=g.path,M=(i=g.query)==null?void 0:i.returnUrl;M&&!(f.startsWith(M)||M.startsWith(f))?I.push(M):I.push(j)},O=a.appTitle,x=a.pageTitle,u=de(!1),J=de(new Map),Q=de(""),c=de(""),y=de("");return{appTitle:O,pageTitle:x,busy:u,validations:J,infoMessage:Q,warningMessage:c,errorMessage:y,router:I,route:g,axios:V,utils:S,toasts:L,close:B,closeWithReturnUrl:U,generateReturnUrl:S.generateReturnUrl,security:{userId:W?W.userId:"",isSystem:Y(),isAdministrator:D(),isEmployee:G(),isMember:Z()}}}const bs={class:"h-100 d-flex align-items-center justify-content-center"},ys={class:"form-signin w-100 m-auto"},$s={class:"h3 mb-3 fw-normal"},ws={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},hs=["innerHTML"],_s={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},ks={__name:"login",props:{urlReturn:{type:String,required:!1}},setup(a){Ce("$config");const g=he(),I=Ze(),V=new Ge(I.msalConfig),S=be({username:"",password:""}),L={username:{required:se.withMessage("Username is required.",ae),$autoDirty:!0,$lazy:!0},password:{required:se.withMessage("Password is required.",ae),$autoDirty:!0,$lazy:!0}},P=Te(L,S),{appTitle:W,pageTitle:Y,busy:D,isDirty:G,validations:Z,infoMessage:B,warningMessage:U,errorMessage:O,router:x,route:u,axios:J,utils:Q,toasts:c,close:y,security:j}=we({appTitle:"Sony FAST POC",pageTitle:"Sign On"}),f={redirectUri:window.location.origin+"/accounts/login"};me(async()=>{await V.initialize();try{const d=await V.ssoSilent(f);if(d){await i(d.account);return}}catch(d){d.errorCode!=="login_required"&&c.error("Error while Signing In",d)}await V.handleRedirectPromise().then(async d=>{if(d){const r=V.getAllAccounts();if(r.length===0){await V.loginRedirect(f);return}const p=r[0];await i(p);return}else{c.info("SignIn","No recent session. Please sign in using your AD Account.");return}}).catch(d=>{debugger;c.error("Error while Signing In",d),console.log(d)})});const M=async()=>{var d={account:V.getActiveAccount(),scopes:[]};await V.acquireTokenSilent(d).then(r=>{const l=r.account.idToken,b=vt(l);b.token=r.accessToken,console.log(r),b.roles||(b.roles=[]),b.userId=b.sub,g.login(b);var n=u.query.returnUrl;n?x.push(decodeURIComponent(n)):b.roles.length===1?x.push(`/${b.roles[0].toLowerCase()}`):x.push("/")}).catch(r=>{console.error(`error during acquireTokenSilent: ${r}`)})},i=async d=>{V.setActiveAccount(d),c.success("SignIn","Sign in successful.",{onClose:async()=>{await M()}})},h=async()=>{const d=V.getAllAccounts();if(d.length===0){await V.loginRedirect(f);return}const r=d[0];await i(r)};return(d,r)=>(t(),ve($e,null,{default:z(()=>[e("div",bs,[e("main",ys,[e("div",null,[e("h1",$s,m(o(W)),1),e("div",null,[o(O)?(t(),s("div",ws,[r[1]||(r[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(O)},null,8,hs)])):H("",!0),o(P).$error?(t(),s("div",_s,[r[2]||(r[2]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(P).$errors,p=>(t(),s("li",{key:p.$uid},m(p.$message),1))),128))])])):H("",!0)]),e("button",{onClick:r[0]||(r[0]=p=>h()),class:"btn btn-primary w-100 py-2"}," Single Sign On ")])])])]),_:1}))}},Ss=Ve(ks,[["__scopeId","data-v-ed219a0e"]]),Ts={__name:"loginRedirect",setup(a){const g=useMsal(),I=new Ge(g.msalConfig);debugger;return me(async()=>{debugger;await I.initialize(),await I.handleRedirectPromise()}),(V,S)=>(t(),ve($e,null,{default:z(()=>S[0]||(S[0]=[e("div",null," Login successful, redirecting... ",-1)])),_:1}))}},Is={class:"h-100 d-flex align-items-center justify-content-center"},Ms={__name:"logout",setup(a){const g=he();return g.user,me(async()=>{g.logoutWithRedirect()}),(I,V)=>(t(),s("div",Is,V[0]||(V[0]=[e("div",{class:"card"},[e("div",{class:"card-header"}," Sign-Out "),e("div",{class:"card-body"},[K(" You have logged out from HOA MS."),e("br"),K(" Click "),e("a",{href:"/",class:"d-inline"},"here"),K(" to go back to home page. ")])],-1)])))}},xs={class:"h-100 d-flex align-items-center justify-content-center"},Cs={class:"card m-3"},Vs={class:"card-header"},Ps={class:"card-body"},Os={class:"m-2"},As={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Us=["innerHTML"],Ls={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Ds={class:"row row-cols-1 row-cols-sm-3"},Hs={class:"col-sm"},Es={class:"form-group"},qs={key:0,class:"d-block invalid-feedback"},Bs={class:"col-sm"},Ns={class:"form-group"},Rs={key:0,class:"d-block invalid-feedback"},Fs={class:"col-sm"},zs={class:"form-group"},Gs={key:0,class:"d-block invalid-feedback"},js={class:"row row-cols-1 row-cols-sm-3"},Ys={class:"col"},Ws={class:"form-group"},Ks={key:0,class:"d-block invalid-feedback"},Qs={class:"col"},Js={class:"form-group"},Xs={key:0,class:"d-block invalid-feedback"},Zs={class:"row row-cols-1 row-cols-sm-3"},eo={class:"col-sm"},to={class:"form-group"},so={key:0,class:"d-block invalid-feedback"},oo={class:"col-sm"},ao={class:"form-group"},lo={key:0,class:"d-block invalid-feedback"},no={class:"mt-2 row row-cols-1 row-cols-sm-3 g-2"},ro={class:"col"},io=["disabled"],uo={class:"col"},co={class:"col"},mo={__name:"register",props:{urlReturn:{type:String,required:!1}},setup(a){const g=be({firstName:"",middleName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),I=(j,f)=>j===f.password,V={firstName:{required:se.withMessage("First name is required.",ae),$autoDirty:!0,$lazy:!0},middleName:{required:se.withMessage("Middle name is required.",ae),$autoDirty:!0,$lazy:!0},lastName:{required:se.withMessage("Last name is required.",ae),$autoDirty:!0,$lazy:!0},phoneNumber:{required:se.withMessage("Phone number is required.",ae),$autoDirty:!0,$lazy:!0},email:{required:se.withMessage("Email is required.",ae),$autoDirty:!0,$lazy:!0},password:{required:se.withMessage("Password is required.",ae),$autoDirty:!0,$lazy:!0},confirmPassword:{required:se.withMessage("Confirm password is required.",ae),confirmSamePassword:se.withMessage("Password and confirm passwrod are different.",I),$autoDirty:!0,$lazy:!0}},S=Te(V,g),{appTitle:L,pageTitle:P,busy:W,isDirty:Y,validations:D,infoMessage:G,warningMessage:Z,errorMessage:B,router:U,axios:O,utils:x,toasts:u,close:J,security:Q}=we({appTitle:"HOA MS",pageTitle:"Register User"}),c=Ce("$config");me(()=>{});const y=async()=>{const j=g;if(W.value)return;if(!await S.value.$validate()){window.scrollTo(0,0);return}B.value=null;try{W.value=!0;const M=x.clone(j);M.tenantid=c.tenantId;debugger;await O({method:"post",url:"/api/v1/accounts/register",data:M}).then(i=>{u.success("Register","Registration was successfull.",{onClose:async()=>{await U.push("/accounts/login")}})})}catch(M){B.value=x.getErrorMessageAsHtml(M),window.scrollTo(0,0)}finally{W.value=!1}};return(j,f)=>{const M=te("router-link");return t(),ve($e,null,{default:z(()=>[e("div",xs,[e("div",Cs,[e("h4",Vs,m(o(P)),1),e("div",Ps,[e("div",Os,[o(B)?(t(),s("div",As,[f[8]||(f[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(B)},null,8,Us)])):H("",!0),o(S).$error?(t(),s("div",Ls,[f[9]||(f[9]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(S).$errors,i=>(t(),s("li",{key:i.$uid},m(i.$message),1))),128))])])):H("",!0)]),e("div",Ds,[e("div",Hs,[e("div",Es,[f[10]||(f[10]=e("label",null,"First Name",-1)),R(e("input",{"onUpdate:modelValue":f[0]||(f[0]=i=>g.firstName=i),type:"text",class:"form-control"},null,512),[[X,g.firstName]]),o(S).firstName.$error?(t(),s("div",qs,[(t(!0),s(A,null,N(o(S).firstName.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])]),e("div",Bs,[e("div",Ns,[f[11]||(f[11]=e("label",null,"Middle Name",-1)),R(e("input",{"onUpdate:modelValue":f[1]||(f[1]=i=>g.middleName=i),type:"text",class:"form-control"},null,512),[[X,g.middleName]]),o(S).middleName.$error?(t(),s("div",Rs,[(t(!0),s(A,null,N(o(S).middleName.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])]),e("div",Fs,[e("div",zs,[f[12]||(f[12]=e("label",null,"Last Name",-1)),R(e("input",{"onUpdate:modelValue":f[2]||(f[2]=i=>g.lastName=i),type:"text",class:"form-control"},null,512),[[X,g.lastName]]),o(S).lastName.$error?(t(),s("div",Gs,[(t(!0),s(A,null,N(o(S).lastName.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])])]),e("div",js,[e("div",Ys,[e("div",Ws,[f[13]||(f[13]=e("label",null,"Phone Number",-1)),R(e("input",{"onUpdate:modelValue":f[3]||(f[3]=i=>g.phoneNumber=i),type:"tel",class:"form-control"},null,512),[[X,g.phoneNumber]]),o(S).phoneNumber.$error?(t(),s("div",Ks,[(t(!0),s(A,null,N(o(S).phoneNumber.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])]),e("div",Qs,[e("div",Js,[f[14]||(f[14]=e("label",null,"Email",-1)),R(e("input",{"onUpdate:modelValue":f[4]||(f[4]=i=>g.email=i),type:"email",class:"form-control"},null,512),[[X,g.email]]),o(S).email.$error?(t(),s("div",Xs,[(t(!0),s(A,null,N(o(S).email.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])])]),e("div",Zs,[e("div",eo,[e("div",to,[f[15]||(f[15]=e("label",null,"Password",-1)),R(e("input",{"onUpdate:modelValue":f[5]||(f[5]=i=>g.password=i),type:"password",class:"form-control"},null,512),[[X,g.password]]),o(S).password.$error?(t(),s("div",so,[(t(!0),s(A,null,N(o(S).password.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])]),e("div",oo,[e("div",ao,[f[16]||(f[16]=e("label",null,"Confirm Password",-1)),R(e("input",{"onUpdate:modelValue":f[6]||(f[6]=i=>g.confirmPassword=i),type:"password",class:"form-control"},null,512),[[X,g.confirmPassword]]),o(S).confirmPassword.$error?(t(),s("div",lo,[(t(!0),s(A,null,N(o(S).confirmPassword.$errors,i=>(t(),s("div",{key:i.$uid},m(i.$message),1))),128))])):H("",!0)])])]),e("div",no,[e("div",ro,[e("button",{disabled:o(S).$dirty&&o(S).$invalid,onClick:f[7]||(f[7]=i=>y()),class:"btn btn-primary w-100"},f[17]||(f[17]=[e("span",{class:"fas fa-fw fa-save me-1"},null,-1),K("Register ")]),8,io)]),e("div",uo,[F(M,{to:"/",class:"btn btn-outline-primary w-100"},{default:z(()=>f[18]||(f[18]=[K("Home")])),_:1})]),e("div",co,[F(M,{to:"/accounts/login",class:"btn btn-outline-primary w-100"},{default:z(()=>f[19]||(f[19]=[K("Login")])),_:1})])])])])])]),_:1})}}},fo={path:"/accounts",component:ms,props:!1,meta:{},children:[{path:"",component:fs},{path:"login",component:Ss},{path:"loginRedirect",component:Ts},{path:"logout",component:Ms},{path:"register",component:mo}]};function tt(){const a=Je(),g=Y=>window.location.href.indexOf(Y)>-1,I=Y=>localStorage.getItem("data-bs-theme")||Y,V=Y=>{document.documentElement.setAttribute("data-bs-theme",Y),localStorage.setItem("data-bs-theme",Y)},S=async()=>await it.get("https://bootswatch.com/api/5.json").then(Y=>Y.data),L=Y=>{const D=document.querySelector("link[href*='https://cdn.jsdelivr.net/npm/bootswatch']");D&&Y?(D.setAttribute("href",Y),localStorage.setItem("bootswatch-theme",Y)):alert("cannot query css link")},P=Y=>{W(),a.push(Y)},W=()=>{if(screen.width<576){const D=document.getElementById("navbarCollapse");if(D){const G=dt.getInstance(D);G&&G.hide()}}};return{isActive:g,getCurrentBsTheme:I,changeBsTheme:V,getBootswatch:S,changeTheme:L,navigate:P,collapseNavbar:W}}const po={class:"sticky-top navbar navbar-expand-sm bg-primary","data-bs-theme":"dark"},vo={class:"container-md"},go={class:"navbar-collapse collapse",id:"navbarCollapse"},bo={class:"navbar-nav"},yo={class:"nav-item"},$o={class:"nav-item dropdown"},wo={class:"dropdown-menu","aria-labelledby":"dropdown01"},ho={class:"nav-item"},_o={class:"nav-item dropdown"},ko={class:"dropdown-menu","aria-labelledby":"dropdown01"},So={class:"navbar-nav ms-auto"},To={class:"nav-item dropdown"},Io={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Mo=["onClick"],xo={class:"nav-item dropdown"},Co={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Vo={class:"d-sm-none d-xl-inline"},Po={key:0},Oo={key:1},Ao={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Uo={key:0},Lo={key:1},Do={__name:"topNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(a){const g=Ze(),{isActive:I,getCurrentBsTheme:V,changeBsTheme:S,getBootswatch:L,changeTheme:P,navigate:W,collapseNavbar:Y}=tt(),D=he(),G=D.user,Z=be({user:G,username:G?G.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});me(async()=>{const x=Z;x.bootswatch=await L();const u=V(x.bsTheme);debugger;u&&(x.bsTheme=u,S(x.bsTheme));const J=localStorage.getItem("bootswatch-theme");J&&(x.currentTheme=J,P(J))});const B=x=>{P(x),Z.currentTheme=x,Y()},U=x=>{S(x),Z.bsTheme=x,Y()},O=async()=>{D.logoutWithRedirect();const x=new Ge(g.msalConfig);await x.initialize();const u={mainWindowRedirectUri:"/"};await x.logoutPopup(u)};return(x,u)=>{const J=te("router-link");return t(),ve($e,null,{default:z(()=>[e("nav",po,[e("div",vo,[F(J,{class:"navbar-brand",to:"/administrator"},{default:z(()=>[K(m(a.appName),1)]),_:1}),u[18]||(u[18]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",go,[e("ul",bo,[e("li",yo,[F(J,{to:"/videos",onClick:o(Y),class:"nav-link"},{default:z(()=>u[3]||(u[3]=[e("span",{class:"fas fa-fw fa-video me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Videos ",-1)])),_:1},8,["onClick"])]),e("li",$o,[u[6]||(u[6]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-warehouse me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Sources ")],-1)),e("ul",wo,[e("li",null,[F(J,{to:"/source-groups",onClick:o(Y),class:"dropdown-item"},{default:z(()=>u[4]||(u[4]=[K(" Groups ")])),_:1},8,["onClick"])]),e("li",null,[F(J,{to:"/source-locations",onClick:o(Y),class:"dropdown-item"},{default:z(()=>u[5]||(u[5]=[K(" Locations ")])),_:1},8,["onClick"])])])]),e("li",ho,[F(J,{to:"/vod-sources",onClick:o(Y),class:"nav-link"},{default:z(()=>u[7]||(u[7]=[e("span",{class:"fas fa-fw fa-tags me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Video on Demand (VOD) ",-1)])),_:1},8,["onClick"])]),e("li",_o,[u[10]||(u[10]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-microphone-lines me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Channel Assembly ")],-1)),e("ul",ko,[e("li",null,[F(J,{to:"/program-templates",onClick:o(Y),class:"dropdown-item"},{default:z(()=>u[8]||(u[8]=[K(" Program Templates ")])),_:1},8,["onClick"])]),e("li",null,[F(J,{to:"/channels",onClick:o(Y),class:"dropdown-item"},{default:z(()=>u[9]||(u[9]=[K(" Channels ")])),_:1},8,["onClick"])])])])]),e("ul",So,[e("li",To,[u[14]||(u[14]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-wand-sparkles me-1"}),e("span",{class:"d-sm-none d-xl-inline"},"Themes")],-1)),e("ul",Io,[e("li",null,[Z.bsTheme==="dark"?(t(),s("button",{key:0,onClick:u[0]||(u[0]=Q=>U("light")),class:"dropdown-item"},u[11]||(u[11]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),K("Dark Mode ")]))):(t(),s("button",{key:1,onClick:u[1]||(u[1]=Q=>U("dark")),class:"dropdown-item"},u[12]||(u[12]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),K("Light Mode ")])))]),u[13]||(u[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),(t(!0),s(A,null,N(Z.bootswatch.themes,Q=>(t(),s("li",null,[e("button",{onClick:c=>B(Q.cssCdn),class:le(["dropdown-item",{active:Z.currentTheme===Q.cssCdn}])},m(Q.name),11,Mo)]))),256))])]),e("li",xo,[e("a",Co,[e("span",null,[u[15]||(u[15]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Vo,[o(G)?(t(),s("span",Po,m(o(G).name),1)):(t(),s("span",Oo," Guest "))])])]),e("ul",Ao,[o(G)?(t(),s("li",Uo,[e("button",{onClick:u[2]||(u[2]=Q=>O()),class:"dropdown-item"},u[16]||(u[16]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),K("Logout ")]))])):(t(),s("li",Lo,[F(J,{to:"/accounts/login",class:"dropdown-item"},{default:z(()=>u[17]||(u[17]=[e("span",{class:"fas fa-fw fa-sign-in me-1"},null,-1),K("Login ")])),_:1})]))])])])])])])]),_:1})}}},Ho={id:"sideNav",class:"collapse collapse-horizontal show"},Eo={class:"d-flex flex-column bg-dark min-vh-100 overflow-y-auto"},qo={class:"navbar bg-primary bg-gradient shadow-sm","data-bs-theme":"dark"},Bo={class:"navbar-brand me-0 mb-1 px-2"},No={class:"d-none d-sm-inline"},Ro={class:"nav nav-pills flex-column px-1 mt-2",role:"tablist"},Fo={class:"nav-item dropdown"},zo={class:"dropdown-menu dropdown-menu-end w-100","aria-labelledby":"dropdown01"},Go={class:"nav-item dropdown"},jo={class:"dropdown-menu dropdown-menu-end w-100","aria-labelledby":"dropdown01"},Yo={class:"nav-item dropdown"},Wo={class:"dropdown-menu dropdown-menu-end w-100","aria-labelledby":"dropdown01"},Ko={class:"nav-item dropdown"},Qo={class:"dropdown-menu dropdown-menu-end w-100","aria-labelledby":"dropdown01"},Jo=["onClick"],Xo={class:"nav nav-pills flex-column mt-auto px-1 mb-3",role:"tablist"},Zo={class:"nav-item dropdown"},ea={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},ta={class:"d-none d-sm-inline"},sa={key:0},oa={key:1},aa={class:"dropdown-menu dropdown-menu-end w-100 position-absolute","aria-labelledby":"dropdown01"},la={key:0},na={key:1},ra={key:0,class:"fas fa-fw fa-angle-double-left"},ia={key:1,class:"fas fa-fw fa-angle-double-right"},da={__name:"sideNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(a){const g=Ze(),I=Ke(),V=Je(),S=he(),L=S.user,{isActive:P,getCurrentBsTheme:W,changeBsTheme:Y,getBootswatch:D,changeTheme:G,navigate:Z,collapseNavbar:B}=tt(),U=be({user:L,username:L?L.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});me(async()=>{const M=U;M.bootswatch=await D();const i=W(M.bsTheme);i&&(M.bsTheme=i,Y(M.bsTheme));const h=localStorage.getItem("bootswatch-theme");h&&(M.currentTheme=h,G(h)),Q();const d=document.getElementById("sideNav");d&&(J.value?d.classList.add("show"):d.classList.remove("show"))});const O=M=>{G(M),U.currentTheme=M},x=M=>{Y(M),U.bsTheme=M},u=async()=>{S.logoutWithRedirect();const M=new Ge(g.msalConfig);await M.initialize();const i={mainWindowRedirectUri:window.location.origin};await M.logoutRedirect(i)},J=de(!0),Q=()=>{const M=localStorage.getItem("show-sideNav")||"true";J.value=M==="true"},c=()=>{localStorage.setItem("show-sideNav",J.value),dt.getInstance("#sideNav").toggle()},y=()=>{J.value=!J.value,c()},j=M=>{var i=I.path.startsWith(M);return i?"active":""},f=async(M,i)=>{const h=gt.getInstance(`#${i}`);h&&h.hide(),await V.push(M)};return(M,i)=>{const h=te("router-link");return t(),s("div",null,[e("div",Ho,[e("div",Eo,[e("nav",qo,[F(h,{to:"/",class:"text-decoration-none w-100 text-center"},{default:z(()=>[e("h1",Bo,[i[9]||(i[9]=e("span",{class:"fas fa-fw fa-home d-inline d-md-none"},null,-1)),e("span",No,m(a.appName),1)])]),_:1})]),e("ul",Ro,[e("li",Fo,[e("a",{class:le([j("/source-"),"nav-link dropdown-toggle"]),href:"#",id:"sourcesDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},i[10]||(i[10]=[e("span",{class:"fas fa-fw fa-warehouse"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Sources",-1)]),2),e("ul",zo,[e("li",null,[e("button",{onClick:i[0]||(i[0]=d=>f("/source-groups","sourcesDropdown")),class:le([j("/source-groups"),"dropdown-item"]),role:"button"},i[11]||(i[11]=[e("span",{class:"fas fa-fw fa-warehouse"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Groups",-1)]),2),e("button",{onClick:i[1]||(i[1]=d=>f("/source-locations","sourcesDropdown")),class:le([j("/source-locations"),"dropdown-item"]),role:"button"},i[12]||(i[12]=[e("span",{class:"fas fa-fw fa-building"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Locations",-1)]),2)])])]),e("li",Go,[e("a",{class:le([[j("/videos"),j("/vod-sources")],"nav-link dropdown-toggle"]),href:"#",id:"assetsDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},i[13]||(i[13]=[e("span",{class:"fas fa-fw fa-photo-video"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Asset Library",-1)]),2),e("ul",jo,[e("li",null,[e("button",{onClick:i[2]||(i[2]=d=>f("/videos","assetsDropdown")),class:le([j("/videos"),"dropdown-item"]),role:"button"},i[14]||(i[14]=[e("span",{class:"fas fa-fw fa-video"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Videos",-1)]),2),e("button",{onClick:i[3]||(i[3]=d=>f("/vod-sources","assetsDropdown")),class:le([j("/vod-sources"),"dropdown-item"]),role:"button"},i[15]||(i[15]=[e("span",{class:"fas fa-fw fa-tags"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"VOD",-1)]),2)])])]),e("li",Yo,[e("a",{class:le([[j("/program-templates"),j("/channels")],"nav-link dropdown-toggle"]),href:"#",id:"assemblyDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},i[16]||(i[16]=[e("span",{class:"fas fa-fw fa-industry"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Channel Assembly",-1)]),2),e("ul",Wo,[e("li",null,[e("button",{onClick:i[4]||(i[4]=d=>f("/program-templates","assemblyDropdown")),class:le([j("/program-templates"),"dropdown-item"]),role:"button"},i[17]||(i[17]=[e("span",{class:"fas fa-fw fa-file-video"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Program Templates",-1)]),2),e("button",{onClick:i[5]||(i[5]=d=>f("/channels","assemblyDropdown")),class:le([j("/channels"),"dropdown-item"]),role:"button"},i[18]||(i[18]=[e("span",{class:"fas fa-fw fa-tv"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Channels",-1)]),2)])])]),e("li",Ko,[i[22]||(i[22]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-wand-sparkles"}),e("span",{class:"d-none d-sm-inline ms-1"},"Themes")],-1)),e("ul",Qo,[e("li",null,[U.bsTheme==="dark"?(t(),s("button",{key:0,onClick:i[6]||(i[6]=d=>x("light")),class:"dropdown-item"},i[19]||(i[19]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),K("Dark Mode ")]))):(t(),s("button",{key:1,onClick:i[7]||(i[7]=d=>x("dark")),class:"dropdown-item"},i[20]||(i[20]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),K("Light Mode ")])))]),i[21]||(i[21]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),(t(!0),s(A,null,N(U.bootswatch.themes,d=>(t(),s("li",null,[e("button",{onClick:r=>O(d.cssCdn),class:le(["dropdown-item",{active:U.currentTheme===d.cssCdn}])},m(d.name),11,Jo)]))),256))])])]),e("ul",Xo,[e("li",Zo,[e("a",ea,[e("span",null,[i[23]||(i[23]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",ta,[o(L)?(t(),s("span",sa,m(o(L).name),1)):(t(),s("span",oa," Guest "))])])]),e("ul",aa,[o(L)?(t(),s("li",la,[e("button",{onClick:i[8]||(i[8]=d=>u()),class:"dropdown-item"},i[24]||(i[24]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),K("Logout ")]))])):(t(),s("li",na,[F(h,{to:"/accounts/login",class:"dropdown-item"},{default:z(()=>i[25]||(i[25]=[e("span",{class:"fas fa-fw fa-sign-in me-1"},null,-1),K("Login ")])),_:1})]))])])])])]),e("button",{id:"sideNavToggler",onClick:y,"data-bs-target":"#sideNav","data-bs-toggle":"collapse",class:"d-none btn btn-sm btn-warning fixed-bottom z-3 p-0",style:{width:"2rem",height:"2rem"}},[J.value?(t(),s("span",ra)):(t(),s("span",ia))])])}}},ua={class:"footer sticky-bottom"},ca={class:"d-sm-block navbar navbar-dark bg-dark bg-gradient1 py-1"},ma={class:"container-md"},fa={class:"navbar-text small p-0"},pa={__name:"bottomNav",props:{appName:{type:String,default:"SCH2"}},setup(a){tt();const g=Ce("$config"),V=he().user;let L=new Date().getFullYear();const P=be({user:V,username:V?V.nameFull:"Guest",copyright:`2020-${L} ${g.appName}`});return me(async()=>{}),(W,Y)=>(t(),s("footer",ua,[e("div",ca,[e("div",ma,[e("span",fa,"©"+m(P.copyright),1)])])]))}},va={props:{showProgress:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},maxMessages:{type:Number,default:5},timeOut:{type:Number,default:3e3},closeable:{type:Boolean,default:!0}},data(){return{messages:[],count:0}},created(){et.$on("toast-message",this.handleMessageEvent)},methods:{handleMessageEvent(a){a.message&&this.addMessage(a.title,a.message,a.type,a.options)},async addMessage(a,g,I,V={}){var S={id:this.count++,title:a,message:g,type:I,showProgress:this.showProgress,timeOut:this.timeOut,closeable:this.closeable,rtl:this.rtl,progress:0,paused:!1,animationFrame:null};S=Object.assign({},S,V),this.messages.unshift(S),this.messages.length>this.maxMessages&&this.messages.splice(this.maxMessages),S.timeOut>0&&await this.startTimeout(S)},async startTimeout(a,g=0){const I=this,V=performance.now(),S=async()=>{a.animationFrame=requestAnimationFrame(async L=>{const P=L+g-V;if(!I.exists(a)||a.paused){cancelAnimationFrame(a.animationFrame);return}else if(P<a.timeOut){const W=P/a.timeOut;a.progress=W,await S()}else{a.progress=1,cancelAnimationFrame(a.animationFrame),I.remove(a);return}})};await S()},pauseProgress(a){a.timeOut<=0||(a.paused=!0)},async resumeProgress(a){a.timeOut<=0||(a.paused=!1,await this.startTimeout(a,a.timeOut*a.progress))},getCurrentProgress(a){return Math.round(a.progress*100)===100?100:a.progress*100},getIconClass(a){const g=a.type;let I="";switch(g){case"success":I="fas fa-fw fa-circle-check";break;case"info":I="fas fa-fw fa-circle-info";break;case"warning":I="fas fa-fw fa-circle-exclamation";break;case"danger":I="fas fa-fw fa-triangle-exclamation";break}let V=I;return a.rtl?"icon-right "+V:"icon-left "+V},async remove(a){const g=this.messages.findIndex(I=>I.id===a.id);this.messages.splice(g,1),typeof a.onClose=="function"&&await a.onClose()},exists(a){return this.messages.findIndex(I=>I.id===a.id)!==-1}}},ga={"aria-live":"polite","aria-atomic":"true",class:"position-static"},ba=["onMouseover","onMouseout"],ya={class:"me-auto text-white"},$a=["onClick"],wa={class:"toast-body"},ha=["innerHTML"],_a={key:0,class:"progress m-1",style:{height:"4px"}};function ka(a,g,I,V,S,L){return t(),ve($e,null,{default:z(()=>[e("div",ga,[F(ke,{class:"toast-container top-0 end-0 p-3",name:"toast",tag:"div",appear:""},{default:z(()=>[(t(!0),s(A,null,N(S.messages,P=>(t(),s("div",{key:P.id,class:le(["toast show mb-2 ms-auto",`border-${P.type}`]),role:"alert","aria-live":"assertive","aria-atomic":"true",onMouseover:W=>L.pauseProgress(P),onMouseout:W=>L.resumeProgress(P)},[e("div",{class:le(["toast-header",`bg-${P.type}`])},[e("strong",ya,[e("i",{class:le([L.getIconClass(P),"me-1"])},null,2),K(m(P.title),1)]),P.closeable?(t(),s("button",{key:0,type:"button",class:"mr-2 mb-1 btn-close","data-dismiss":"toast","aria-label":"Close",onClick:W=>L.remove(P)},g[0]||(g[0]=[e("span",{"aria-hidden":"true"},null,-1)]),8,$a)):H("",!0)],2),e("div",wa,[e("div",{innerHTML:P.message},null,8,ha)]),P.timeOut>0&&P.showProgress?(t(),s("div",_a,[e("div",{class:le(`bg-${P.type}`),style:ut({width:L.getCurrentProgress(P)+"%"})},null,6)])):H("",!0)],42,ba))),128))]),_:1})])]),_:1})}const Sa=Ve(va,[["render",ka],["__scopeId","data-v-5272bd9a"]]),Ta={name:"AdminLayout",components:{TopNav:Do,SideNav:da,BottomNav:pa},inject:["$config"],mounted(){this.$config,document.title="Administrator"}},Ia={class:"d-flex flex-row flex-nowrap vh-100"};function Ma(a,g,I,V,S,L){const P=te("Toasts"),W=te("SideNav"),Y=te("router-view");return t(),s("div",Ia,[F(P),F(W),F(Y,{class:"d-flex flex-column w-100 h-100"})])}const xa=Ve(Ta,[["render",Ma]]),Ca={class:"mt-2 container overflow-y-auto"},Va={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Pa=["innerHTML"],Oa={class:"row mb-3"},Aa={class:"col-xl-4"},Ua={class:""},La=["id"],Da={key:1,class:"card card-header bg-warning-subtle mb-2"},Ha={class:"col-xl-8 overflow-x-auto mt-2 mt-xl-0"},Ea={class:"d-flex flex-column align-items-start"},qa=["src"],Ba={class:""},Na={class:"d-flex flex-row"},Ra={class:"me-2 px-2 border-end border-secondary",style:{width:"10rem"}},Fa={class:"text-center"},za=["src"],Ga={class:"text-end"},ja={class:"text-wrap text-truncate"},Ya={class:"overflow-y-auto"},Wa={class:"badge bg-info me-2"},Ka={key:0,class:"badge bg-warning mb-1"},Qa={__name:"Index",props:{urlViewChannel:{type:String,default:"/channels/view"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,isDirty:S,validations:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,generateReturnUrl:O,security:x}=we({appTitle:"ARC AIO",pageTitle:"Dashboard"});Ce("$config"),he().user;const J=be({item:null});de("805630ed-f288-4f2f-83a4-6c71312f6970"),de(),me(async()=>{await y()}),Ae(()=>{J.item.forEach(M=>{M.hls&&(M.hls.stopLoad(),M.hls.destroy())})});const Q=async()=>{const M=J;if(!V.value)try{V.value=!0;const i="/api/v1/channels/epg/";M.item=[],await G.get(i).then(h=>{M.item=h.data}),M.item.forEach(h=>{j(h)})}catch(i){Y.value=Z.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{V.value=!1}},c=async()=>{if(confirm("Are you sure you want to Reset All Data?"))try{await G.get("/api/v1/channels/reset/").then(h=>{B.success("Reset All Data","Reset data was successful.")})}catch(i){Y.value=Z.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{V.value=!1}},y=async()=>{await Q()},j=M=>{if(M.manifestUrl&&Hls.isSupported()){f(M);var i=document.getElementById(`video-${M.id}`);if(!i)return;M.hls&&(M.hsl.stopLoad(),M.hls.destroy());let h=M.manifestUrl;M.hls=Z.createHlsStream(i,h);return}},f=M=>{M.outputs&&M.outputs.forEach(h=>{if(h.hls){debugger;h.hls.detachMedia(),h.hls.destroy(),delete h.hls}h.playbackConfigurations.forEach(d=>{if(d.hls){debugger;d.hls.detachMedia(),d.hls.destroy(),delete d.hls}})})};return(M,i)=>{const h=te("PageHeader"),d=te("router-link");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(h,{"page-icon":"fas fa-fw fa-dashboard",pageTitle:o(I)},{default:z(()=>[e("div",null,[e("button",{onClick:i[0]||(i[0]=r=>c()),class:"ms-2 btn btn-danger"},i[2]||(i[2]=[e("span",{class:"fas fa-fw fa-recycle me-1"},null,-1),K("Reset All Data ")])),e("button",{onClick:i[1]||(i[1]=r=>y()),class:"ms-2 btn btn-secondary"},i[3]||(i[3]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)]))])]),_:1},8,["pageTitle"]),e("div",Ca,[o(Y)?(t(),s("div",Va,[i[4]||(i[4]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:JSON.stringify(o(Y))},null,8,Pa)])):H("",!0),(t(!0),s(A,null,N(J.item,r=>(t(),s("div",null,[e("div",Oa,[e("div",Aa,[e("div",Ua,[r.manifestUrl?(t(),s("video",{key:0,id:`video-${r.id}`,controls:"",autoplay:"",class:"card-img-top object-fit-scale align-middle border"},null,8,La)):(t(),s("div",Da," Channel not yet published "))])]),e("div",Ha,[e("div",Ea,[e("div",null,[e("h4",null,[e("img",{src:r.logo,class:"img-fluid me-2",style:{height:"3rem"}},null,8,qa),F(d,{to:`${a.urlViewChannel}/${r.id}/${o(O)()}`},{default:z(()=>[K(m(r.title),1)]),_:2},1032,["to"])])]),e("div",Ba,[e("div",Na,[(t(!0),s(A,null,N(r.programs,p=>(t(),s("div",Ra,[e("div",Fa,[e("img",{src:p.image,class:"img-fluid border",style:{height:"64px"}},null,8,za)]),e("div",Ga,m(o(Z).moment(p.since).format("hh:mm a"))+"-"+m(o(Z).moment(p.till).format("hh:mm a")),1),e("div",ja,m(p.title),1),e("div",Ya,[(t(!0),s(A,null,N(p.genres,l=>(t(),s("span",Wa,m(l),1))),256))]),o(Z).moment().isAfter(p.since)&&o(Z).moment().isBefore(p.till)?(t(),s("span",Ka,"Now Playing")):H("",!0)]))),256))])])])])])]))),256))])])]),_:1})}}};function Le(a){if(!a.cacheKey)throw Error("Cache Key required.");if(!a.baseUrl)throw Error("Base Url required.");const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,closeWithReturnUrl:B,generateReturnUrl:U,security:O}=we({appTitle:a.appTitle,pageTitle:a.pageTitle}),x=JSON.parse(JSON.stringify(a.filter));x.pageIndex=x.pageIndex||1,x.pageSize=x.pageSize||5,x.sortField=x.sortField||"",x.sortOrder=x.sortOrder||1,x.updateUrl=x.updateUrl||!1,x.items=x.items||[],x.query=x.query||{},x.query.criteria=x.query.criteria||"";const u=de(x),J=()=>{var r;if(V.value){console.log("Paginated search is currently busy.");return}const i=JSON.parse(localStorage.getItem(a.cacheKey))||{},h=new URLSearchParams(window.location.search),d=u.value;d.query.criteria=h.get("c")||i.criteria||d.query.criteria||"",d.pageIndex=parseInt(h.get("p"),10)||i.pageIndex||d.pageIndex||1,d.pageSize=parseInt(h.get("s"),10)||i.pageSize||d.pageSize||5,d.sortField=h.get("sf")||i.sortField||d.sortField||"",d.sortOrder=parseInt(h.get("so"),10)||i.sortOrder||d.sortOrder||1,d.visible=i.visible||d.visible,(r=a.initializeFilter)==null||r.call(a,u,a.cacheKey)},Q=()=>{if(a.getQuery)return a.getQuery(u.value);{const i=u.value;return["?c=",encodeURIComponent(i.query.criteria),"&p=",i.pageIndex,"&s=",i.pageSize,"&sf=",i.sortField,"&so=",i.sortOrder].join("")}},c=()=>{if(a.saveQuery)a.saveQuery(u.value,a.cacheKey);else{const i=u.value;localStorage.setItem(a.cacheKey,JSON.stringify({criteria:i.query.criteria,pageIndex:i.pageIndex,pageSize:i.pageSize,sortField:i.sortField,sortOrder:i.sortOrder,visible:i.visible}))}};return{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,closeWithReturnUrl:B,generateReturnUrl:U,security:O,filter:u,initializeFilter:J,getQuery:Q,saveQuery:c,search:async i=>{var d;let h=u.value;if(V.value){console.log("Paginated search is currently busy.");return}i>0&&(h.pageIndex=i);try{V.value=!0,P.value="";const r=Q();h.selected=null,await Y(`${a.baseUrl}/${r}`).then(async p=>{var b;Array.isArray(p.data)?h.items=p.data:h=Object.assign(h,p.data);let l=location.pathname;l.endsWith("/")?l+=r:l+="/"+r,h.updateUrl&&window.history.replaceState(r,`${g}-search`,l),h.items.forEach(n=>{n.expand=!1}),c(),(b=a.successAction)==null||b.call(a,u.value)})}catch(r){if(localStorage.removeItem(a.cacheKey),a.failAction)a.failAction(r);else{const p=D.getErrorMessageAsHtml(r);P.value=p,G.error("Error Occured",p)}}finally{V.value=!1,(d=a.finalAction)==null||d.call(a)}},getRowNumber:i=>{const h=u.value;return(h.pageIndex-1)*h.pageSize+(i+1)},setSelected:i=>{const h=u.value;h.selected&&i&&h.selected===i?h.selected=null:(h.selected&&(h.selected.expand=!1),h.selected=i,h.selected.expand=!0)},isSelected:i=>{const h=u.value;return i===null||h.selected===null?!1:i===h.selected}}}const Ja=["disabled"],Xa={class:"row row-cols-1 row-cols-sm-3"},Za={class:"col"},el={class:"form-floating mb-2"},tl={key:0,class:"d-block invalid-feedback"},sl={class:"col"},ol={class:"form-floating"},al={class:"col"},ll={class:"form-floating"},nl={class:"col"},rl={class:"form-floating mb-2"},il={class:"row row-cols-1 row-cols-sm-2"},dl={class:"col"},ul={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border g-2"},cl={class:"col"},ml={class:"form-check"},fl=["onUpdate:modelValue","id"],pl=["for"],vl={class:"col"},gl={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border g-2"},bl={class:"col"},yl={class:"form-check"},$l=["onUpdate:modelValue","id"],wl=["for"],hl={class:"table-responsive mt-2"},_l={class:"text-end"},kl={class:"table table-sm mb-0 mt-2"},Sl={class:"align-middle"},Tl={class:"text-center"},Il=["onUpdate:modelValue"],Ml=["onUpdate:modelValue"],xl=["onUpdate:modelValue"],Cl={class:"text-start"},Vl=["onClick"],Pl={__name:"add",props:{urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Video"}),U=a,O=be({lookups:{genres:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}]},durationTime:"00:00:00",item:{title:"Video # ",description:null,durationInMillis:12e4,dateReleased:D.moment().format("YYYY-MM-DD"),formats:[]}}),x={item:{title:{title:se.withMessage("Title is required.",ae),$autoDirty:!0,$lazy:!0},durationInMillis:{title:se.withMessage("Duration is required.",ae),$autoDirty:!0,$lazy:!0},dateReleased:{title:se.withMessage("Date Released is required.",ae),$autoDirty:!0,$lazy:!0}}},u=Te(x,O),J=Me(()=>{const f=D.moment;if(O.durationTime&&O.durationTime!=="00:00:00"&&D.isValidTime(O.durationTime)){const M=f().startOf("day"),i=M.format("YYYY-MM-DD ")+O.durationTime,d=f(i).subtract(M);return O.item.durationInMillis=d.valueOf(),O.item.durationInMillis}return 0});me(async()=>{await c()});const Q=async()=>{const f=O;if(V.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const i=D.clone(f.item);i.durationInMillis=J.value;const h=D.moment(f.item.dateReleased).utc(!0).format();i.dateReleased=h;const d=O.lookups.genres.filter(p=>p.selected).map(p=>p.id);i.genres=d;const r=O.lookups.categories.filter(p=>p.selected).map(p=>p.id);i.categories=r;debugger;await Y.post("/api/v1/videos/",i).then(p=>{G.success("Add Video","Video added",{onClose:async()=>{const l=`${U.urlView}/${p.data}`;await W.push(l)}})})}catch(i){P.value=D.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{V.value=!1}},c=async()=>{try{await Y.get("/api/v1/lookups/video-genres/").then(f=>{const i=f.data.filter(h=>h.id!==0);O.lookups.genres=i})}catch(f){P.value=D.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},y=()=>{const f={format:"HLS",serverUrl:"https://media-tailor-input.s3.us-west-2.amazonaws.com",path:"/sony-poc/vod-1/bbb_2mins.m3u8"};O.item.formats.push(f)},j=f=>{O.item.formats.splice(f,1)};return(f,M)=>{const i=te("router-link"),h=te("PageHeader"),d=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(h,{"page-icon":"fas fa-fw fa-video",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:M[0]||(M[0]=r=>Q()),class:"btn btn-primary"},M[6]||(M[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Ja),F(i,{to:U.urlMain,class:"btn btn-secondary ms-2"},{default:z(()=>M[7]||(M[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(d,{errorMessage:o(P),vuelidate:o(u)},{default:z(()=>[e("div",null,[e("div",Xa,[e("div",Za,[e("div",el,[R(e("input",{"onUpdate:modelValue":M[1]||(M[1]=r=>O.item.title=r),id:"name",class:"form-control",placeholder:"Title"},null,512),[[X,O.item.title]]),M[8]||(M[8]=e("label",{for:"title",class:""},"Title",-1)),o(u).item.title.$error?(t(),s("div",tl,[(t(!0),s(A,null,N(o(u).item.title.$errors,r=>(t(),s("div",{key:r.$uid},m(r.$message),1))),128))])):H("",!0)])]),e("div",sl,[e("div",ol,[R(e("input",{"onUpdate:modelValue":M[2]||(M[2]=r=>O.item.dateReleased=r),type:"date",step:"1",id:"dateReleased",class:"form-control"},null,512),[[X,O.item.dateReleased]]),M[9]||(M[9]=e("label",{for:"dateReleased",class:""},"Date Released",-1))])]),e("div",al,[e("div",ll,[R(e("input",{"onUpdate:modelValue":M[3]||(M[3]=r=>O.durationTime=r),type:"time",step:"1",id:"durationTime",class:"form-control"},null,512),[[X,O.durationTime]]),M[10]||(M[10]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",nl,[e("div",rl,[R(e("textarea",{"onUpdate:modelValue":M[4]||(M[4]=r=>O.item.description=r),id:"name",class:"form-control",placeholder:"Description",style:{height:"5rem"}},null,512),[[X,O.item.description]]),M[11]||(M[11]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",il,[e("div",dl,[M[12]||(M[12]=e("h5",null,"Genres",-1)),e("div",ul,[(t(!0),s(A,null,N(O.lookups.genres,r=>(t(),s("div",cl,[e("div",ml,[R(e("input",{"onUpdate:modelValue":p=>r.selected=p,class:"form-check-input",type:"checkbox",id:r.name},null,8,fl),[[Be,r.selected]]),e("label",{class:"form-check-label",for:r.name},m(r.name),9,pl)])]))),256))])]),e("div",vl,[M[13]||(M[13]=e("h5",null,"Categories",-1)),e("div",gl,[(t(!0),s(A,null,N(O.lookups.categories,r=>(t(),s("div",bl,[e("div",yl,[R(e("input",{"onUpdate:modelValue":p=>r.selected=p,class:"form-check-input",type:"checkbox",id:r.name},null,8,$l),[[Be,r.selected]]),e("label",{class:"form-check-label",for:r.name},m(r.name),9,wl)])]))),256))])])]),e("div",hl,[e("div",_l,[e("button",{onClick:M[5]||(M[5]=r=>y()),class:"btn btn-outline-primary btn-sm"},M[14]||(M[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",kl,[M[17]||(M[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(O.item.formats,(r,p)=>(t(),s("tr",Sl,[e("td",Tl,m(p+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":l=>r.format=l,class:"form-control"},M[15]||(M[15]=[e("option",{value:"HLS"},"HLS",-1),e("option",{value:"HLS"},"DASH",-1)]),8,Il),[[ge,r.format]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":l=>r.serverUrl=l,type:"text",class:"form-control"},null,8,Ml),[[X,r.serverUrl]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":l=>r.path=l,type:"text",class:"form-control"},null,8,xl),[[X,r.path]])]),e("td",Cl,[e("button",{onClick:l=>j(p),class:"btn btn-outline-warning btn-sm"},M[16]||(M[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Vl)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Ol=["disabled"],Al={class:"row row-cols-1 row-cols-sm-3"},Ul={class:"col"},Ll={class:"form-floating mb-2"},Dl={key:0,class:"d-block invalid-feedback"},Hl={class:"col"},El={class:"form-floating"},ql={class:"col"},Bl={class:"form-floating"},Nl={class:"col"},Rl={class:"form-floating mb-2"},Fl={class:"col"},zl={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4"},Gl={class:"col"},jl={class:"form-check"},Yl=["onUpdate:modelValue","id"],Wl=["for"],Kl={class:"col"},Ql={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4"},Jl={class:"col"},Xl={class:"form-check"},Zl=["onUpdate:modelValue","id"],en=["for"],tn={class:"table-responsive mt-2"},sn={class:"text-end"},on={class:"table table-sm mb-0 mt-2 border"},an={class:"align-middle"},ln={class:"text-center"},nn=["onUpdate:modelValue"],rn=["value"],dn=["onUpdate:modelValue"],un=["onUpdate:modelValue"],cn={class:"text-end"},mn=["onClick"],fn={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Edit Video"}),U=a,O=be({lookups:{genres:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}],formats:[]},durationTime:"00:00:00",item:{title:null,description:null,rawBaseUrl:null,rawPath:null,hlsBaseUrl:null,hlsPath:null,durationInMillis:null,formats:[]}}),x={item:{title:{title:se.withMessage("title is required.",ae),$autoDirty:!0,$lazy:!0},durationInMillis:{title:se.withMessage("durationInMillis is required.",ae),$autoDirty:!0,$lazy:!0},dateReleased:{title:se.withMessage("Date Released is required.",ae),$autoDirty:!0,$lazy:!0}}},u=Te(x,O),J=Me(()=>{const i=D.moment;if(O.durationTime&&O.durationTime!=="00:00:00"&&D.isValidTime(O.durationTime)){const h=i().startOf("day"),d=h.format("YYYY-MM-DD ")+O.durationTime,p=i(d).subtract(h);return O.item.durationInMillis=p.valueOf(),O.item.durationInMillis}return 0});me(async()=>{await c(),await y(),await Q()});const Q=async()=>{try{await Y.get(`/api/v1/videos/${U.id}/`).then(i=>{O.item=i.data;const h=D.moment(O.item.dateReleased).format("YYYY-MM-DD");O.item.dateReleased=h;const d=O.lookups.genres,r=O.item.genres.map(b=>b.genre);d.forEach(b=>{b.selected=r.includes(b.id)});const p=O.lookups.categories,l=O.item.categories.map(b=>b.category);p.forEach(b=>{b.selected=l.includes(b.id)})})}catch(i){P.value=D.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{}},c=async()=>{try{await Y.get("/api/v1/lookups/video-genres/").then(i=>{const d=i.data.filter(r=>r.id!==0);O.lookups.genres=d})}catch(i){P.value=D.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{}},y=async()=>{try{await Y.get("/api/v1/lookups/video-formats/").then(i=>{const d=i.data.filter(r=>r.id!==0);O.lookups.formats=d})}catch(i){P.value=D.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{}},j=async()=>{const i=O;if(V.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const d=D.clone(i.item);d.durationInMillis=J.value;const r=D.moment(i.item.dateReleased).utc(!0).format();d.dateReleased=r;const p=O.lookups.genres.filter(b=>b.selected).map(b=>b.id);d.genres=p;const l=O.lookups.categories.filter(b=>b.selected).map(b=>b.id);d.categories=l;debugger;await Y.put("/api/v1/videos/",d).then(b=>{G.success("Edit Video","Video edited.",{onClose:async()=>{const n=`${U.urlView}/${U.id}`;await W.push(n)}})})}catch(d){P.value=D.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{V.value=!1}},f=()=>{const i={format:"HLS",serverUrl:"https://media-tailor-input.s3.us-west-2.amazonaws.com",path:"/sony-poc/vod-1/bbb_2mins.m3u8"};O.item.formats.push(i)},M=i=>{O.item.formats.splice(i,1)};return(i,h)=>{const d=te("router-link"),r=te("PageHeader"),p=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(r,{"page-icon":"fas fa-fw fa-video",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:h[0]||(h[0]=l=>j()),class:"btn btn-primary"},h[6]||(h[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Ol),e("button",{onClick:Q,class:"btn btn-secondary ms-2"},h[7]||(h[7]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(d,{to:`${a.urlView}/${a.id}`,class:"btn btn-secondary ms-2"},{default:z(()=>h[8]||(h[8]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(p,{errorMessage:o(P),vuelidate:o(u)},{default:z(()=>[e("div",null,[e("div",Al,[e("div",Ul,[e("div",Ll,[R(e("input",{"onUpdate:modelValue":h[1]||(h[1]=l=>O.item.title=l),id:"name",class:"form-control",placeholder:"Title"},null,512),[[X,O.item.title]]),h[9]||(h[9]=e("label",{for:"title",class:""},"Title",-1)),o(u).item.title.$error?(t(),s("div",Dl,[(t(!0),s(A,null,N(o(u).item.title.$errors,l=>(t(),s("div",{key:l.$uid},m(l.$message),1))),128))])):H("",!0)])]),e("div",Hl,[e("div",El,[R(e("input",{"onUpdate:modelValue":h[2]||(h[2]=l=>O.item.dateReleased=l),type:"date",step:"1",id:"dateReleased",class:"form-control"},null,512),[[X,O.item.dateReleased]]),h[10]||(h[10]=e("label",{for:"dateReleased",class:""},"Duration Time",-1))])]),e("div",ql,[e("div",Bl,[R(e("input",{"onUpdate:modelValue":h[3]||(h[3]=l=>O.durationTime=l),type:"time",step:"1",id:"durationTime",class:"form-control"},null,512),[[X,O.durationTime]]),h[11]||(h[11]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",Nl,[e("div",Rl,[R(e("textarea",{"onUpdate:modelValue":h[4]||(h[4]=l=>O.item.description=l),id:"name",class:"form-control",placeholder:"Description",style:{height:"5rem"}},null,512),[[X,O.item.description]]),h[12]||(h[12]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",Fl,[h[13]||(h[13]=e("b",null,"Genres",-1)),e("div",zl,[(t(!0),s(A,null,N(O.lookups.genres,l=>(t(),s("div",Gl,[e("div",jl,[R(e("input",{"onUpdate:modelValue":b=>l.selected=b,class:"form-check-input",type:"checkbox",id:l.name},null,8,Yl),[[Be,l.selected]]),e("label",{class:"form-check-label",for:l.name},m(l.name),9,Wl)])]))),256))])]),e("div",Kl,[h[14]||(h[14]=e("b",null,"Categories",-1)),e("div",Ql,[(t(!0),s(A,null,N(O.lookups.categories,l=>(t(),s("div",Jl,[e("div",Xl,[R(e("input",{"onUpdate:modelValue":b=>l.selected=b,class:"form-check-input",type:"checkbox",id:l.name},null,8,Zl),[[Be,l.selected]]),e("label",{class:"form-check-label",for:l.name},m(l.name),9,en)])]))),256))])]),e("div",tn,[e("div",sn,[e("button",{onClick:h[5]||(h[5]=l=>f()),class:"btn btn-outline-primary btn-sm"},h[15]||(h[15]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",on,[h[17]||(h[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(O.item.formats,(l,b)=>(t(),s("tr",an,[e("td",ln,m(b+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":n=>l.format=n,class:"form-control"},[(t(!0),s(A,null,N(O.lookups.formats,n=>(t(),s("option",{value:n.id},m(n.name),9,rn))),256))],8,nn),[[ge,l.format]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":n=>l.serverUrl=n,type:"text",class:"form-control"},null,8,dn),[[X,l.serverUrl]])]),e("td",null,[R(e("input",{"onUpdate:modelValue":n=>l.path=n,type:"text",class:"form-control"},null,8,un),[[X,l.path]])]),e("td",cn,[e("button",{onClick:n=>M(b),class:"btn btn-outline-warning btn-sm"},h[16]||(h[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,mn)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},pn={class:"ms-2"},vn={class:"input-group"},gn=["value"],bn={class:"ms-1"},yn={class:"input-group"},$n={class:"ms-1"},wn={class:"input-group"},hn={class:"table-responsive border shadow-sm"},_n={class:"table table-hover mb-0"},kn=["textContent"],Sn={class:"d-flex flex-row justify-content-start"},Tn={class:"mt-1"},In=["src"],Mn={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},xn={class:"ms-2"},Cn={key:0},Vn={class:"badge bg-primary me-1"},Pn={key:1},On={class:"badge bg-info me-1"},An={class:"text-center"},Un={class:"text-end"},Ln=["onClick"],Dn={key:0,class:"fas fa-fw fa-chevron-circle-up"},Hn={key:1,class:"fas fa-fw fa-chevron-circle-down"},En={key:0},qn={colspan:"999"},Bn={class:""},Nn={class:"d-flex flex-column flex-lg-row justify-content-between g-2"},Rn={class:"col mb-2"},Fn={class:"col col-lg-auto mx-lg-5 px-lg-5 mb-2"},zn={class:"col col-lg-auto mb-2"},Gn={key:0},jn={class:"badge bg-secondary me-1"},Yn="/api/v1/videos/search",Wn={__name:"index",props:{urlAdd:{type:String,default:"/videos/add"},urlView:{type:String,default:"/videos/view"}},setup(a){Ce("$config");const I=he().user,{appTitle:V,pageTitle:S,busy:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,security:O,filter:x,initializeFilter:u,getQuery:J,saveQuery:Q,search:c,getRowNumber:y,setSelected:j,isSelected:f}=Le({appTitle:"Arcadian-FAST",pageTitle:"Videos",cacheKey:`${I==null?void 0:I.userId}/videos/search`,baseUrl:Yn,filter:{updateUrl:!0,lookups:{genres:[]},query:{genre:0,category:0}},initializeFilter:(i,h)=>{const d=i.value,r=new URLSearchParams(window.location.search),p=JSON.parse(localStorage.getItem(h))||{};d.query.genre=r.get("genre")||p.genre||d.query.genre||0,d.query.category=r.get("category")||p.category||d.query.category||0},getQuery:i=>["?c=",encodeURIComponent(i.query.criteria),"&p=",i.pageIndex,"&s=",i.pageSize,"&sf=",i.sortField,"&so=",i.sortOrder,"&genre=",i.query.genre,"&category=",i.query.category].join(""),saveQuery:(i,h)=>{localStorage.setItem(h,JSON.stringify({criteria:i.query.criteria,pageIndex:i.pageIndex,pageSize:i.pageSize,sortField:i.sortField,sortOrder:i.sortOrder,visible:i.visible,genre:i.query.genre,category:i.query.category}))}});me(async()=>{u(),await M(),await c()});const M=async()=>{try{await G.get("/api/v1/lookups/video-genres/").then(i=>{const h=i.data;x.value.lookups.genres=h})}catch(i){Y.value=Z.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{}};return(i,h)=>{const d=te("router-link"),r=te("PageHeader"),p=te("m-pagination"),l=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(r,{"page-icon":"fas fa-fw fa-video",pageTitle:o(S)},{default:z(()=>[F(d,{to:a.urlAdd,class:"btn btn-primary"},{default:z(()=>h[5]||(h[5]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",pn,[e("div",vn,[h[6]||(h[6]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),R(e("select",{"onUpdate:modelValue":h[0]||(h[0]=b=>o(x).query.genre=b),class:"form-select"},[(t(!0),s(A,null,N(o(x).lookups.genres,b=>(t(),s("option",{value:b.id},m(b.name),9,gn))),256))],512),[[ge,o(x).query.genre]])])]),e("div",bn,[e("div",yn,[h[8]||(h[8]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),R(e("select",{"onUpdate:modelValue":h[1]||(h[1]=b=>o(x).query.category=b),class:"form-select"},h[7]||(h[7]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[ge,o(x).query.category]])])]),e("div",$n,[e("div",wn,[R(e("input",{"onUpdate:modelValue":h[2]||(h[2]=b=>o(x).query.criteria=b),onKeyup:h[3]||(h[3]=Ue(b=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[X,o(x).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:h[4]||(h[4]=b=>o(c)(1))},h[9]||(h[9]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(l,{errorMessage:o(Y)},{default:z(()=>[e("div",hn,[e("table",_n,[h[14]||(h[14]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title"),e("th",{class:"text-center"},"Duration"),e("th")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(x).items,(b,n)=>(t(),s(A,{key:b.videoId},[e("tr",null,[e("td",{textContent:m(o(y)(n)),class:"text-center"},null,8,kn),e("td",null,[e("div",Sn,[e("div",null,[b.thumbnails.length>0?(t(!0),s(A,{key:0},N(b.thumbnails,v=>(t(),s("div",Tn,[e("img",{src:v.url,class:"img-fuild border",width:"128"},null,8,In)]))),256)):(t(),s("img",Mn))]),e("div",xn,[F(d,{to:`${a.urlView}/${b.videoId}`,class:"d-inline-block text-truncate link-offset-2"},{default:z(()=>[K(m(b.title),1)]),_:2},1032,["to"]),e("div",null,[b.categories.length>0?(t(),s("div",Cn,[(t(!0),s(A,null,N(b.categories,v=>(t(),s("span",Vn,m(v.categoryName),1))),256))])):H("",!0),b.genres.length>0?(t(),s("div",Pn,[(t(!0),s(A,null,N(b.genres,v=>(t(),s("span",On,m(v.genreName),1))),256))])):H("",!0)])])])]),e("td",An,m(o(Z).moment.utc(b.durationInMillis).format("HH:mm:ss")),1),e("td",Un,[e("button",{onClick:v=>b.expand=!b.expand,class:le([[b.expand?"btn-primary":"btn-outline-primary"],"btn btn-sm"])},[b.expand?(t(),s("span",Dn)):(t(),s("span",Hn))],10,Ln)])]),b.expand?(t(),s("tr",En,[h[13]||(h[13]=e("td",null,null,-1)),e("td",qn,[e("div",Bn,[e("div",Nn,[e("div",Rn,[h[10]||(h[10]=e("label",{class:"form-label"},"Description",-1)),e("div",null,m(b.description),1)]),e("div",Fn,[h[11]||(h[11]=e("h6",{class:"fw-bold"},"Date Released",-1)),e("div",null,m(o(rt).utc(b.dateReleased).format("l")),1)]),e("div",zn,[h[12]||(h[12]=e("h6",{class:"fw-bold"},"Formats",-1)),b.formats.length>0?(t(),s("div",Gn,[(t(!0),s(A,null,N(b.formats,v=>(t(),s("span",jn,m(v.formatName),1))),256))])):H("",!0)])])])])])):H("",!0)],64))),128))]),_:1},512),[[Se,o(x).items.length>0]])])]),F(p,{filter:o(x),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Kn={key:0},Qn={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},Jn={class:"nav-item",role:"presentation"},Xn={class:"nav-item",role:"presentation"},Zn={class:"nav-item",role:"presentation"},er={class:"nav-item",role:"presentation"},tr={class:"tab-content",id:"myTabContent"},sr={class:"mt-2"},or={class:"row row-cols-1 row-cols-sm-2"},ar={class:"col"},lr=["id"],nr={class:"col"},rr={class:"col"},ir={class:"form-floating mb-2"},dr={class:"row row-cols-1 row-cols-sm-2"},ur={class:"col"},cr={class:"form-floating mb-2"},mr={class:"col"},fr={class:"form-floating mb-2"},pr={class:"col"},vr={class:"form-floating mb-2"},gr={class:"mt-1"},br={class:"badge bg-info me-1"},yr={class:"badge bg-primary me-1"},$r={class:"mt-2"},wr={class:"table-responsive border"},hr={class:"table table-hover mb-0"},_r={class:"table-group-divider"},kr={class:"align-middle"},Sr={class:"text-center"},Tr={class:"mt-2"},Ir={class:"text-end"},Mr={class:"table-responsive border mt-2"},xr={class:"table table-hover mb-0 caption-top"},Cr={class:"mt-2"},Vr={class:"table-responsive"},Pr={class:"table table-hover mb-0 caption-top"},Or={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/videos"},urlEdit:{type:String,default:"/videos/edit"},urlAddVodSource:{type:String,default:"/vod-sources/add"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(a){const g=a,{appTitle:I,pageTitle:V,busy:S,isDirty:L,validations:P,infoMessage:W,warningMessage:Y,errorMessage:D,router:G,axios:Z,utils:B,toasts:U,close:O,closeWithReturnUrl:x,generateReturnUrl:u,security:J}=we({appTitle:"Arcadian-FAST",pageTitle:"View Video"});Ce("$config");const Q=he();Q.user;const c=be({user:Q.user,item:null,hls:null}),y=de();me(async()=>{await i(),y.value=B.getPageTab("video")||"information-tab"}),Ae(()=>{c.hls&&(c.hls.stopLoad(),c.hls.destroy())});const j=p=>{B.setPageTab("video",p),y.value=p},f=p=>p!==y.value?"":"active",M=p=>p!==y.value?"":"show active",i=async()=>{const p=c;if(!S.value)try{S.value=!0,D.value="",c.item=null;const l=`/api/v1/videos/${g.id}/`;await Z.get(l).then(b=>{p.item=b.data,p.item.duration=B.moment.utc(p.item.durationInMillis).format("HH:mm:ss"),p.item.dateReleased=B.moment.utc(p.item.dateReleased).format("ll")}),d()}catch(l){D.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{S.value=!1}},h=async()=>{await i()},d=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?"),c.hls&&c.hls.destroy();const l=`video-${c.item.videoId}`;var p=document.getElementById(l);const b=c.item.formats.find(v=>v.formatName==="HLS"),n=b.serverUrl+b.path;c.hls=B.createHlsStream(p,n,!1),c.hls.startLoad(-1)}},r=async()=>{if(!S.value)try{S.value=!0,D.value="";const p=`/api/v1/videos/${g.id}/get-blank-frames/`;await Z.post(p).then(l=>{}),S.value=!1,await h()}catch(p){D.value=B.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{S.value=!1}};return(p,l)=>{const b=te("router-link"),n=te("PageHeader"),v=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(n,{"page-icon":"fas fa-fw fa-video",pageTitle:o(V)},{default:z(()=>[F(b,{to:`${a.urlEdit}/${a.id}`,class:"btn btn-primary ms-1"},{default:z(()=>l[11]||(l[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:l[0]||(l[0]=w=>h()),class:"ms-2 btn btn-secondary"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:l[1]||(l[1]=w=>o(x)(g.urlMain)),class:"btn btn-secondary ms-1"},l[13]||(l[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(v,{errorMessage:o(D)},{default:z(()=>[c.item?(t(),s("div",Kn,[e("div",null,[e("ul",Qn,[e("li",Jn,[e("button",{onClick:l[2]||(l[2]=w=>j("information-tab")),class:le([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Xn,[e("button",{onClick:l[3]||(l[3]=w=>j("formats-tab")),class:le([f("formats-tab"),"nav-link"]),id:"formats-tab","data-bs-toggle":"tab","data-bs-target":"#formats",type:"button",role:"tab","aria-controls":"formats","aria-selected":"false"}," Formats ",2)]),e("li",Zn,[e("button",{onClick:l[4]||(l[4]=w=>j("blankFrames-tab")),class:le([f("blankFrames-tab"),"nav-link"]),id:"blankFrames-tab","data-bs-toggle":"tab","data-bs-target":"#blankFrames",type:"button",role:"tab","aria-controls":"blankFrames","aria-selected":"false"}," Blank Frames ",2)]),e("li",er,[e("button",{onClick:l[5]||(l[5]=w=>j("vodSources-tab")),class:le([f("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)])]),e("div",tr,[e("div",{class:le([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",sr,[e("div",or,[e("div",ar,[e("video",{id:`video-${c.item.videoId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,lr)]),e("div",nr,[e("div",rr,[e("div",ir,[R(e("input",{"onUpdate:modelValue":l[6]||(l[6]=w=>c.item.title=w),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[X,c.item.title]]),l[14]||(l[14]=e("label",{for:"title"},"Title",-1))])]),e("div",dr,[e("div",ur,[e("div",cr,[R(e("input",{"onUpdate:modelValue":l[7]||(l[7]=w=>c.item.dateReleased=w),type:"text",class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},null,512),[[X,c.item.dateReleased]]),l[15]||(l[15]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",mr,[e("div",fr,[R(e("input",{"onUpdate:modelValue":l[8]||(l[8]=w=>c.item.duration=w),type:"text",class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},null,512),[[X,c.item.duration]]),l[16]||(l[16]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",pr,[e("div",vr,[R(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=w=>c.item.description=w),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[X,c.item.description]]),l[17]||(l[17]=e("label",{for:"description"},"Description",-1))])]),e("div",gr,[(t(!0),s(A,null,N(c.item.genres,w=>(t(),s("span",br,m(w.genreName),1))),256)),(t(!0),s(A,null,N(c.item.categories,w=>(t(),s("span",yr,m(w.categoryName),1))),256))])])])])],2),e("div",{class:le([M("formats-tab"),"tab-pane fade"]),id:"formats",role:"tabpanel","aria-labelledby":"formats-tab"},[e("div",$r,[e("div",wr,[e("table",hr,[l[18]||(l[18]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",_r,[(t(!0),s(A,null,N(c.item.formats,(w,k)=>(t(),s("tr",kr,[e("td",Sr,m(k+1),1),e("td",null,m(w.formatName),1),e("td",null,m(w.serverUrl),1),e("td",null,m(w.path),1)]))),256))])])])])],2),e("div",{class:le([M("blankFrames-tab"),"tab-pane fade"]),id:"blankFrames",role:"tabpanel","aria-labelledby":"blankFrames-tab"},[e("div",Tr,[e("div",null,[e("div",Ir,[e("button",{onClick:l[10]||(l[10]=w=>r()),class:"btn btn-outline-primary btn-sm"},l[19]||(l[19]=[e("span",{class:"fas fa-fw fa-gear me-1"},null,-1),K("Process ")]))]),e("div",Mr,[e("table",xr,[l[20]||(l[20]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Start"),e("th",null,"End"),e("th",null,"Duration")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.blankFrames,(w,k)=>(t(),s("tr",{key:w.videoBlankFrameId},[e("td",null,m(k+1),1),e("td",null,m(o(B).moment.utc(w.startInMillis).format("HH:mm:ss")),1),e("td",null,m(o(B).moment.utc(w.endInMillis).format("HH:mm:ss")),1),e("td",null,m(o(B).moment.utc(w.durationInMillis).format("HH:mm:ss")),1)]))),128))]),_:1},512),[[Se,c.item.blankFrames.length>0]])])])])])],2),e("div",{class:le([M("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",Cr,[e("div",Vr,[e("table",Pr,[l[21]||(l[21]=e("caption",null,"VOD Sources",-1)),l[22]||(l[22]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.vodSources,(w,k)=>(t(),s("tr",{key:w.vodSourceId},[e("td",null,m(k+1),1),e("td",null,[F(b,{to:`${g.urlViewVodSource}/${encodeURIComponent(w.vodSourceId)}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(w.name),1)]),_:2},1032,["to"])])]))),128))]),_:1},512),[[Se,c.item.vodSources.length>0]])])])])],2)])])])):H("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Ar=["disabled"],Ur={class:"form-floating mb-2"},Lr={key:0,class:"d-block invalid-feedback"},Dr={__name:"add",props:{urlView:{type:String,default:"/source-groups/view"},urlMain:{type:String,default:"/source-groups"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Source Group"}),U=a,O=be({lookups:{},item:{name:null}}),x={item:{name:{required:se.withMessage("name is required.",ae),$autoDirty:!0,$lazy:!0}}},u=Te(x,O);me(async()=>{});const J=async()=>{const Q=O;if(V.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const y=D.clone(Q.item);await Y.post("/api/v1/sourcegroups/",y).then(j=>{G.success("Add Source Group","Source group added.",{onClose:async()=>{const f=`${U.urlView}/${j.data}`;await W.push(f)}})})}catch(y){P.value=D.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{V.value=!1}};return(Q,c)=>{const y=te("router-link"),j=te("PageHeader"),f=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(j,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:c[0]||(c[0]=M=>J()),class:"btn btn-primary"},c[2]||(c[2]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Ar),F(y,{to:U.urlMain,class:"btn btn-secondary ms-2"},{default:z(()=>c[3]||(c[3]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(f,{errorMessage:o(P),vuelidate:o(u)},{default:z(()=>[e("div",null,[e("div",Ur,[R(e("input",{"onUpdate:modelValue":c[1]||(c[1]=M=>O.item.name=M),type:"text",class:"form-control",id:"name",placeholder:"Name"},null,512),[[X,O.item.name]]),c[4]||(c[4]=e("label",{for:"name"},"Name",-1)),o(u).item.name.$error?(t(),s("div",Lr,[(t(!0),s(A,null,N(o(u).item.name.$errors,M=>(t(),s("div",{key:M.$uid},m(M.$message),1))),128))])):H("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Hr={key:0,class:"d-flex justify-content-end"},Er=["disabled"],qr={key:0},Br={class:"row row-cols-1 row-cols-sm-2"},Nr={class:"col"},Rr={class:"form-floating mb-2"},Fr={key:0,class:"d-block invalid-feedback"},zr={class:"col"},Gr={class:"form-floating mb-2"},jr={key:0,class:"d-block invalid-feedback"},Yr={class:"row row-cols-sm-2"},Wr={class:"col"},Kr={class:"form-floating mb-2"},Qr={class:"form-floating mb-2"},Jr={key:0,class:"d-block invalid-feedback"},Xr={class:"form-floating mb-2"},Zr={key:0,class:"d-block invalid-feedback"},ei={class:"col"},ti={class:"form-floating mb-2"},st={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,required:!0}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"ARC CMS",pageTitle:"Edit Movie"}),U=a,O=be({editorElementId:"editor",htmlContent:"",item:null}),x={item:{title:{required:se.withMessage("Title is required.",ae),$autoDirty:!0,$lazy:!0},eidr:{required:se.withMessage("eidr is required.",ae),$autoDirty:!0,$lazy:!0},eidrPrefix:{required:se.withMessage("eidrPrefix is required.",ae),$autoDirty:!0,$lazy:!0}},htmlContent:{required:se.withMessage("Content is required.",ae),$autoDirty:!0,$lazy:!0}},u=Te(x,O);me(async()=>{await c()});const J=()=>{const j=O;var f=document.getElementById(j.editorElementId);f.innerHTML=j.htmlContent},Q=j=>{const f=O;f.htmlContent=j.target.innerHTML;var M=document.getElementById(f.editorElementId);M.value=f.htmlContent},c=async()=>{const j=O;if(!V.value)try{V.value=!0,O.item=null,await Y.get(`/api/v1/movies/${U.id}`).then(f=>{j.item=f.data,j.htmlContent=j.item.description}),J()}catch(f){P.value=D.getErrorMessageAsHtml(f)}finally{V.value=!1}},y=async()=>{const j=O;if(V.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const M=D.clone(j.item);M.description=j.htmlContent,await Y.put("/api/v1/movies",M).then(i=>{G.success("Edit Movie","Movie edited",{onClose:async()=>{const h=`${U.urlView}/${U.id}`;await W.push(h)}})})}catch(M){P.value=D.getErrorMessageAsHtml(M),window.scrollTo(0,0)}finally{V.value=!1}};return(j,f)=>{const M=te("router-link"),i=te("PageHeader"),h=te("PageBody");return t(),s("div",null,[F(i,{"page-icon":"fas fa-fw fa-film",pageTitle:o(I),"header-break":"row row-cols-2 row-cols-sm-2"},{default:z(()=>[O.item?(t(),s("div",Hr,[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:f[0]||(f[0]=d=>y()),class:"btn btn-primary"},f[7]||(f[7]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Er),e("button",{onClick:c,class:"ms-2 btn btn-secondary"},f[8]||(f[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(M,{to:`${U.urlView}/${U.id}`,class:"ms-1 btn btn-secondary"},{default:z(()=>f[9]||(f[9]=[e("i",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])])):H("",!0)]),_:1},8,["pageTitle"]),F(h,{errorMessage:o(P),vuelidate:o(u)},{default:z(()=>[O.item?(t(),s("div",qr,[e("div",Br,[e("div",Nr,[e("div",Rr,[R(e("input",{"onUpdate:modelValue":f[1]||(f[1]=d=>O.item.eidrPrefix=d),type:"text",class:"form-control",id:"eidrPrefix",placeholder:"Eidr Prefix"},null,512),[[X,O.item.eidrPrefix]]),f[10]||(f[10]=e("label",{for:"title"},"Eidr Prefix",-1)),o(u).item.eidrPrefix.$error?(t(),s("div",Fr,[(t(!0),s(A,null,N(o(u).item.eidrPrefix.$errors,d=>(t(),s("div",{key:d.$uid},m(d.$message),1))),128))])):H("",!0)])]),e("div",zr,[e("div",Gr,[R(e("input",{"onUpdate:modelValue":f[2]||(f[2]=d=>O.item.eidr=d),type:"text",class:"form-control",id:"eidr",placeholder:"Eidr"},null,512),[[X,O.item.eidr]]),f[11]||(f[11]=e("label",{for:"title"},"Eidr",-1)),o(u).item.eidr.$error?(t(),s("div",jr,[(t(!0),s(A,null,N(o(u).item.eidr.$errors,d=>(t(),s("div",{key:d.$uid},m(d.$message),1))),128))])):H("",!0)])])]),e("div",Yr,[e("div",Wr,[e("div",Kr,[R(e("input",{"onUpdate:modelValue":f[3]||(f[3]=d=>O.item.releaseYear=d),type:"number",class:"form-control",id:"releaseYear",placeholder:"Release Year"},null,512),[[X,O.item.releaseYear]]),f[12]||(f[12]=e("label",{for:"title"},"Release Year",-1))])]),e("div",null,[e("div",Qr,[R(e("input",{"onUpdate:modelValue":f[4]||(f[4]=d=>O.item.title=d),type:"text",class:"form-control",id:"title",placeholder:"Title"},null,512),[[X,O.item.title]]),f[13]||(f[13]=e("label",{for:"title"},"Title",-1)),o(u).item.title.$error?(t(),s("div",Jr,[(t(!0),s(A,null,N(o(u).item.title.$errors,d=>(t(),s("div",{key:d.$uid},m(d.$message),1))),128))])):H("",!0)])])]),e("div",null,[e("div",Xr,[e("div",{id:"editor",name:"editor",contenteditable:"true",role:"textbox",class:"form-control",spellcheck:"true",style:{"min-height":"100px",height:"auto",overflow:"auto","user-select":"text","white-space":"pre-wrap","word-break":"break-word"},onInput:f[5]||(f[5]=d=>Q(d))},null,32),f[14]||(f[14]=e("label",{for:"editor"},"Content",-1)),o(u).htmlContent.$error?(t(),s("div",Zr,[(t(!0),s(A,null,N(o(u).htmlContent.$errors,d=>(t(),s("div",{key:d.$uid},m(d.$message),1))),128))])):H("",!0)])]),e("div",ei,[e("div",ti,[R(e("textarea",{"onUpdate:modelValue":f[6]||(f[6]=d=>O.item.metadata=d),rows:"4",class:"form-control",id:"metadata",placeholder:"Metadata",style:{height:"125px"}},null,512),[[X,O.item.metadata]]),f[15]||(f[15]=e("label",{for:"title"},"Metadata",-1))])])])):H("",!0)]),_:1},8,["errorMessage","vuelidate"])])}}},si={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function oi(a,g,I,V,S,L){const P=te("Page");return t(),ve(P,{id:I.id,urlView:I.urlView},null,8,["id","urlView"])}const ai=Ve(si,[["render",oi]]),li={class:"ms-2"},ni={class:"input-group"},ri={class:"table-responsive border shadow-sm"},ii={class:"table table-hover mb-0"},di=["textContent"],ui={key:0,class:"fas fa-fw fa-check-circle text-success"},ci="/api/v1/sourcegroups/search",mi={__name:"index",props:{urlAdd:{type:String,default:"/source-groups/add"},urlView:{type:String,default:"/source-groups/view"}},setup(a){Ce("$config");const I=he().user,{appTitle:V,pageTitle:S,busy:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,security:O,filter:x,initializeFilter:u,getQuery:J,saveQuery:Q,search:c,getRowNumber:y,setSelected:j,isSelected:f}=Le({appTitle:"Arcadian-FAST",pageTitle:"Source Groups",cacheKey:`${I==null?void 0:I.userId}/source-groups/search`,baseUrl:ci,filter:{updateUrl:!0}});return me(async()=>{u(),await c()}),(M,i)=>{const h=te("router-link"),d=te("PageHeader"),r=te("m-pagination"),p=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(d,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(S)},{default:z(()=>[F(h,{to:a.urlAdd,class:"btn btn-primary"},{default:z(()=>i[3]||(i[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",li,[e("div",ni,[R(e("input",{"onUpdate:modelValue":i[0]||(i[0]=l=>o(x).query.criteria=l),onKeyup:i[1]||(i[1]=Ue(l=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria..."},null,544),[[X,o(x).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:i[2]||(i[2]=l=>o(c)(1))},i[4]||(i[4]=[e("span",{class:"fas fa-fw fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(p,{errorMessage:o(Y)},{default:z(()=>[e("div",ri,[e("table",ii,[i[5]||(i[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",null,"# of Channel Outputs"),e("th",null,"# of Package Configurations")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(x).items,(l,b)=>(t(),s("tr",{key:l.sourceGroupId},[e("td",{textContent:m(o(y)(b)),class:"text-center"},null,8,di),e("td",null,[F(h,{to:`${a.urlView}/${l.sourceGroupId}`,class:"d-inline-block text-truncate link-offset-2"},{default:z(()=>[l.arn?(t(),s("span",ui)):H("",!0),K(" "+m(l.name),1)]),_:2},1032,["to"])]),e("td",null,m(l.channelOutputs),1),e("td",null,m(l.packageConfigurations),1)]))),128))]),_:1},512),[[Se,o(x).items.length>0]])])]),F(r,{filter:o(x),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},fi={key:0},pi={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},vi={class:"nav-item",role:"presentation"},gi={class:"nav-item",role:"presentation"},bi={class:"nav-item",role:"presentation"},yi={class:"tab-content",id:"myTabContent"},$i={class:"mt-2"},wi={class:"form-floating mb-2"},hi={class:"mt-2"},_i={class:"table-responsive border"},ki={class:"table table-hover mb-0"},Si={class:"mt-2"},Ti={class:"table-responsive border"},Ii={class:"table table-hover mb-0"},Mi={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-groups"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(a){const g=a,{appTitle:I,pageTitle:V,busy:S,isDirty:L,validations:P,infoMessage:W,warningMessage:Y,errorMessage:D,router:G,axios:Z,utils:B,toasts:U,close:O,closeWithReturnUrl:x,generateReturnUrl:u,security:J}=we({appTitle:"Arcadian-FAST",pageTitle:"View Source Group"});Ce("$config");const Q=he();Q.user;const c=be({user:Q.user,item:null}),y=de();me(async()=>{await i(),y.value=B.getPageTab("sourceGroup")||"information-tab"});const j=r=>{B.setPageTab("sourceGroup",r),y.value=r},f=r=>r!==y.value?"":"active",M=r=>r!==y.value?"":"show active",i=async()=>{const r=c;if(!S.value)try{S.value=!0,D.value="",c.item=null;const p=`/api/v1/sourcegroups/${g.id}/`;await Z.get(p).then(l=>{r.item=l.data})}catch(p){D.value=B.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{S.value=!1}},h=async()=>{if(!S.value)try{S.value=!0,D.value="";const r=`/api/v1/sourcegroups/${g.id}/`;await Z.delete(r).then(p=>{U.success("Delete Source Group","Source group was deleted.",{onClose:async()=>{const l=`${g.urlMain}/`;await G.push(l)}})})}catch(r){D.value=B.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{S.value=!1}},d=async()=>{await i()};return(r,p)=>{const l=te("PageHeader"),b=te("router-link"),n=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(l,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(V)},{default:z(()=>[e("button",{onClick:p[0]||(p[0]=v=>h()),class:"ms-1 btn btn-warning"},p[7]||(p[7]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)])),e("button",{onClick:p[1]||(p[1]=v=>d()),class:"ms-2 btn btn-secondary"},p[8]||(p[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:p[2]||(p[2]=v=>o(x)(g.urlMain)),class:"btn btn-secondary ms-1"},p[9]||(p[9]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(n,{errorMessage:o(D)},{default:z(()=>[c.item?(t(),s("div",fi,[e("div",null,[e("ul",pi,[e("li",vi,[e("button",{onClick:p[3]||(p[3]=v=>j("information-tab")),class:le([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",gi,[e("button",{onClick:p[4]||(p[4]=v=>j("channelOutputs-tab")),class:le([f("channelOutputs-tab"),"nav-link"]),id:"channelOutputs-tab","data-bs-toggle":"tab","data-bs-target":"#channelOutputs",type:"button",role:"tab","aria-controls":"channelOutputs","aria-selected":"false"}," Channel Outputs ",2)]),e("li",bi,[e("button",{onClick:p[5]||(p[5]=v=>j("packageConfigurations-tab")),class:le([f("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)])]),e("div",yi,[e("div",{class:le([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",$i,[e("div",wi,[R(e("input",{"onUpdate:modelValue":p[6]||(p[6]=v=>c.item.name=v),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[X,c.item.name]]),p[10]||(p[10]=e("label",{for:"name"},"Name",-1))])])],2),e("div",{class:le([M("channelOutputs-tab"),"tab-pane fade"]),id:"channelOutputs",role:"tabpanel","aria-labelledby":"channelOutputs-tab"},[e("div",hi,[e("div",_i,[e("table",ki,[p[11]||(p[11]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Output Type")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.channelOutputs,(v,w)=>(t(),s("tr",{key:v.channelOutputId},[e("td",null,m(w+1),1),e("td",null,[F(b,{to:`${a.urlViewChannel}/${v.channelId}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(v.manifestName),1)]),_:2},1032,["to"])]),e("td",null,m(v.outputType),1)]))),128))]),_:1},512),[[Se,c.item.channelOutputs.length>0]])])])])],2),e("div",{class:le([M("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",Si,[e("div",Ti,[e("table",Ii,[p[12]||(p[12]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"VOD Source"),e("th",null,"Path"),e("th",null,"Type")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.packageConfigurations,(v,w)=>(t(),s("tr",{key:v.packageConfigurationId},[e("td",null,m(w+1),1),e("td",null,[F(b,{to:`${a.urlViewVodSource}/${v.vodSourceId}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(v.vodSource.name),1)]),_:2},1032,["to"])]),e("td",null,m(v.path),1),e("td",null,m(v.type),1)]))),128))]),_:1},512),[[Se,c.item.packageConfigurations.length>0]])])])])],2)])])])):H("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},xi=["disabled"],Ci={class:"form-floating mb-2"},Vi={key:0,class:"d-block invalid-feedback"},Pi={class:"form-floating mb-2"},Oi={key:0,class:"d-block invalid-feedback"},Ai={__name:"add",props:{urlView:{type:String,default:"/source-locations/view"},urlMain:{type:String,default:"/source-locations"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Source Location"}),U=a,O=be({lookups:{},item:{name:null,httpConfigurationBaseUrl:null}}),x={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},httpConfigurationBaseUrl:{required:se.withMessage("HTTP Configuration Base Url is required.",ae),$autoDirty:!0,$lazy:!0}}},u=Te(x,O);me(async()=>{});const J=async()=>{const Q=O;if(V.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const y=D.clone(Q.item);await Y.post("/api/v1/sourcelocations/",y).then(j=>{G.success("Add Source Location","Source location added.",{onClose:async()=>{const f=`${U.urlView}/${j.data}`;await W.push(f)}})})}catch(y){P.value=D.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{V.value=!1}};return(Q,c)=>{const y=te("router-link"),j=te("PageHeader"),f=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(j,{"page-icon":"fas fa-fw fa-building",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:c[0]||(c[0]=M=>J()),class:"btn btn-primary"},c[3]||(c[3]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,xi),F(y,{to:U.urlMain,class:"btn btn-secondary ms-2"},{default:z(()=>c[4]||(c[4]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(f,{errorMessage:o(P),vuelidate:o(u)},{default:z(()=>[e("div",null,[e("div",Ci,[R(e("input",{"onUpdate:modelValue":c[1]||(c[1]=M=>O.item.name=M),type:"text",class:"form-control",id:"name",placeholder:"Name"},null,512),[[X,O.item.name]]),c[5]||(c[5]=e("label",{for:"name"},"Name",-1)),o(u).item.name.$error?(t(),s("div",Vi,[(t(!0),s(A,null,N(o(u).item.name.$errors,M=>(t(),s("div",{key:M.$uid},m(M.$message),1))),128))])):H("",!0)]),e("div",Pi,[R(e("textarea",{"onUpdate:modelValue":c[2]||(c[2]=M=>O.item.httpConfigurationBaseUrl=M),type:"text",class:"form-control",id:"httpConfigurationBaseUrl",placeholder:"HTTP Configuration Base Url",style:{height:"8rem"}},null,512),[[X,O.item.httpConfigurationBaseUrl]]),c[6]||(c[6]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1)),o(u).item.httpConfigurationBaseUrl.$error?(t(),s("div",Oi,[(t(!0),s(A,null,N(o(u).item.httpConfigurationBaseUrl.$errors,M=>(t(),s("div",{key:M.$uid},m(M.$message),1))),128))])):H("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Ui={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function Li(a,g,I,V,S,L){const P=te("Page");return t(),ve(P,{id:I.id,urlView:I.urlView},null,8,["id","urlView"])}const Di=Ve(Ui,[["render",Li]]),Hi={class:"ms-1"},Ei={class:"input-group"},qi={class:"table-responsive border shadow-sm"},Bi={class:"table table-hover mb-0"},Ni={class:"text-center"},Ri=["textContent"],Fi={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},zi={class:"text-center"},Gi=["onUpdate:modelValue"],ji="/api/v1/sourcelocations/search",Yi={__name:"index",props:{urlAdd:{type:String,default:"/source-locations/add"},urlView:{type:String,default:"/source-locations/view"}},setup(a){Ce("$config");const I=he().user,{appTitle:V,pageTitle:S,busy:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,security:O,filter:x,initializeFilter:u,getQuery:J,saveQuery:Q,search:c,getRowNumber:y,setSelected:j,isSelected:f}=Le({appTitle:"Arcadian-FAST",pageTitle:"Source Locations",cacheKey:`${I==null?void 0:I.userId}/source-locations/search`,baseUrl:ji,filter:{updateUrl:!0}}),M=Me(()=>{const d=x.value;return d&&d.items?d.items.filter(l=>l.selected):null});me(async()=>{u(),await c()});const i=async()=>{if(!(M.length<=0||!confirm("The selected Source Location(s) will be submitted to AWS MediaTailer. Are you sure you want to publish the selected Source Location(s)?"))&&!L.value){Y.value=null;try{L.value=!0;const p={sourceLocationIds:M.value.map(l=>l.sourceLocationId)};await G.post("/api/v1/sourceLocations/publish/",p).then(l=>{B.success("Publish Source Location(s)","Source Location(s) was published.",{async onClose(){}})}),L.value=!1,await c()}catch(r){Y.value=Z.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{L.value=!1}}},h=async()=>{if(!(M.length<=0||!confirm("The selected Source Location(s) will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected Source Location(s)?"))&&!L.value){Y.value=null;try{L.value=!0;const p={sourceLocationIds:M.value.map(l=>l.sourceLocationId)};await G.post("/api/v1/sourceLocations/unpublish/",p).then(l=>{B.success("Unpublish Source Location(s)","Source Location(s) was inpublished.",{async onClose(){}})}),L.value=!1,await c()}catch(r){Y.value=Z.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{L.value=!1}}};return(d,r)=>{const p=te("router-link"),l=te("PageHeader"),b=te("m-pagination"),n=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(l,{"page-icon":"fas fa-fw fa-building",pageTitle:o(S)},{default:z(()=>[F(p,{to:a.urlAdd,class:"btn btn-primary ms-2"},{default:z(()=>r[3]||(r[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Hi,[e("div",Ei,[R(e("input",{"onUpdate:modelValue":r[0]||(r[0]=v=>o(x).query.criteria=v),onKeyup:r[1]||(r[1]=Ue(v=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[X,o(x).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:r[2]||(r[2]=v=>o(c)(1))},r[4]||(r[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(n,{errorMessage:o(Y)},{default:z(()=>[e("div",qi,[e("table",Bi,[e("thead",null,[e("tr",null,[r[7]||(r[7]=e("td",{class:"text-center"},"#",-1)),r[8]||(r[8]=e("th",null,"Name",-1)),r[9]||(r[9]=e("th",null,"HTTP Configuration Base Url",-1)),e("td",Ni,[M.value.length?(t(),s(A,{key:0},[e("button",{onClick:i,class:"btn btn-primary btn-sm"},r[5]||(r[5]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:h,class:"btn btn-warning btn-sm ms-1"},r[6]||(r[6]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):H("",!0)])])]),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(x).items,(v,w)=>(t(),s("tr",{key:v.sourceLocationId},[e("td",{textContent:m(o(y)(w)),class:"text-center"},null,8,Ri),e("td",null,[F(p,{to:`${a.urlView}/${v.sourceLocationId}`,class:"d-inline-block text-truncate link-offset-2"},{default:z(()=>[v.arn?(t(),s("i",Fi)):H("",!0),e("span",null,m(v.name),1)]),_:2},1032,["to"])]),e("td",null,m(v.httpConfigurationBaseUrl),1),e("td",zi,[R(e("input",{"onUpdate:modelValue":k=>v.selected=k,type:"checkbox",class:"form-check-input"},null,8,Gi),[[Be,v.selected]])])]))),128))]),_:1},512),[[Se,o(x).items.length>0]])])]),F(b,{filter:o(x),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Wi={key:0},Ki={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},Qi={class:"nav-item",role:"presentation"},Ji={class:"nav-item",role:"presentation"},Xi={class:"nav-item",role:"presentation"},Zi={class:"tab-content",id:"myTabContent"},ed={class:"mt-2"},td={class:"col"},sd={class:"form-floating mb-2"},od={class:"col"},ad={class:"form-floating mb-2"},ld={class:"mt-2"},nd={class:"table-responsive border"},rd={class:"table table-hover mb-0"},id={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},dd={class:"mt-2"},ud={class:"table-responsive border"},cd={class:"table table-hover mb-0"},md={key:0,class:"fas fa-fw fa-check-circle text-success"},fd={class:"badge bg-info"},pd={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-locations"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(a){const g=a,{appTitle:I,pageTitle:V,busy:S,isDirty:L,validations:P,infoMessage:W,warningMessage:Y,errorMessage:D,router:G,axios:Z,utils:B,toasts:U,close:O,closeWithReturnUrl:x,generateReturnUrl:u,security:J}=we({appTitle:"Arcadian-FAST",pageTitle:"View Source Location"});Ce("$config");const Q=he();Q.user;const c=be({user:Q.user,item:null}),y=de();me(async()=>{await i(),y.value=B.getPageTab("sourceLocation")||"information-tab"});const j=p=>{B.setPageTab("sourceLocation",p),y.value=p},f=p=>p!==y.value?"":"active",M=p=>p!==y.value?"":"show active",i=async()=>{const p=c;if(!S.value)try{S.value=!0,D.value="",c.item=null;const l=`/api/v1/sourcelocations/${g.id}/`;await Z.get(l).then(b=>{p.item=b.data})}catch(l){D.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{S.value=!1}},h=async()=>{await i()},d=async()=>{if(confirm("Source Location will be submitted to AWS MediaTailer. Are you sure you want to publish the Source Location?")&&!S.value){D.value=null;try{S.value=!0;const l={sourceLocationIds:[g.id]};await Z.post("/api/v1/sourcelocations/publish/",l).then(b=>{U.success("Publish Source Location","Source Location was published.",{async onClose(){}})}),S.value=!1,await h()}catch(l){D.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{S.value=!1}}},r=async()=>{if(confirm("Source Location will be removed to AWS MediaTailer. Are you sure you want to remove the Source Location?")&&!S.value){D.value=null;try{S.value=!0;const l={sourceLocationIds:[g.id]};await Z.post("/api/v1/sourcelocations/unpublish/",l).then(b=>{U.warning("Remove Source Location","Source Location was removed.",{async onClose(){}})}),S.value=!1,await h()}catch(l){D.value=B.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{S.value=!1}}};return(p,l)=>{const b=te("PageHeader"),n=te("router-link"),v=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(b,{"page-icon":"fas fa-fw fa-building",pageTitle:o(V)},{default:z(()=>[c.item?(t(),s(A,{key:0},[c.item.arn?(t(),s("button",{key:0,onClick:l[0]||(l[0]=w=>r()),class:"ms-1 btn btn-warning"},l[9]||(l[9]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:l[1]||(l[1]=w=>d()),class:"ms-1 btn btn-primary"},l[10]||(l[10]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):H("",!0),e("button",{onClick:l[2]||(l[2]=w=>h()),class:"ms-2 btn btn-secondary"},l[11]||(l[11]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:l[3]||(l[3]=w=>o(x)(g.urlMain)),class:"btn btn-secondary ms-1"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(v,{errorMessage:o(D)},{default:z(()=>[c.item?(t(),s("div",Wi,[e("div",null,[e("ul",Ki,[e("li",Qi,[e("button",{onClick:l[4]||(l[4]=w=>j("information-tab")),class:le([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Ji,[e("button",{onClick:l[5]||(l[5]=w=>j("vodSources-tab")),class:le([f("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)]),e("li",Xi,[e("button",{onClick:l[6]||(l[6]=w=>j("programs-tab")),class:le([f("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",Zi,[e("div",{class:le([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",ed,[e("div",td,[e("div",sd,[R(e("input",{"onUpdate:modelValue":l[7]||(l[7]=w=>c.item.name=w),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[X,c.item.name]]),l[13]||(l[13]=e("label",{for:"name"},"Name",-1))])]),e("div",od,[e("div",ad,[R(e("input",{"onUpdate:modelValue":l[8]||(l[8]=w=>c.item.httpConfigurationBaseUrl=w),type:"text",class:"form-control-plaintext",id:"httpConfigurationBaseUrl",readonly:""},null,512),[[X,c.item.httpConfigurationBaseUrl]]),l[14]||(l[14]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1))])])])],2),e("div",{class:le([M("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",ld,[e("div",nd,[e("table",rd,[l[15]||(l[15]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Video")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.vodSources,(w,k)=>(t(),s("tr",{key:w.vodSourceId},[e("td",null,m(k+1),1),e("td",null,[w.arn?(t(),s("span",id)):H("",!0),F(n,{to:`${g.urlViewVodSource}/${encodeURIComponent(w.vodSourceId)}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(w.name),1)]),_:2},1032,["to"])]),e("td",null,[F(n,{to:`${g.urlViewVideo}/${encodeURIComponent(w.video.videoId)}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(w.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",null,m(o(B).moment.utc(w.video.durationInMillis).format("HH:mm:ss")),1)])])]))),128))]),_:1},512),[[Se,c.item.vodSources.length>0]])])])])],2),e("div",{class:le([M("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",dd,[e("div",ud,[e("table",cd,[l[17]||(l[17]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Channel"),e("th",null,"Name"),e("th",null,"Date Scheduled Start")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.programs,(w,k)=>(t(),s("tr",{key:w.programId},[e("td",null,m(k+1),1),e("td",null,[F(n,{to:`${g.urlViewChannel}/${encodeURIComponent(w.channel.channelId)}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(w.channel.name),1)]),_:2},1032,["to"])]),e("td",null,[w.arn?(t(),s("span",md)):H("",!0),K(" "+m(w.name)+" ",1),e("div",null," Start: "+m(o(B).moment.utc(w.startOffsetMillis).format("HH:mm:ss")),1),e("div",null," End: "+m(o(B).moment.utc(w.endOffsetMillis).format("HH:mm:ss")),1)]),e("td",null,[K(m(o(B).moment(w.dateScheduledStart).calendar())+" ",1),e("div",null,[e("span",fd,m(o(B).moment(w.dateScheduledStart).fromNow()),1)])]),l[16]||(l[16]=e("td",null,null,-1))]))),128))]),_:1},512),[[Se,c.item.programs.length>0]])])])])],2)])])])):H("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},vd=["id"],gd={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},bd={class:"modal-content"},yd={class:"modal-header"},$d={class:"modal-title"},wd={class:"modal-body p-1"},hd={class:"row row-cols-1 row-cols-sm-3"},_d={class:"col"},kd={class:"form-floating mb-2"},Sd=["value"],Td={class:"col"},Id={class:"form-floating mb-2"},Md=["value"],xd={class:"col"},Cd={class:"input-group mb-2"},Vd={class:"form-floating"},Pd={class:"row row-cols-1 row-cols-sm-2"},Od={class:"col-sm-4"},Ad={class:"card"},Ud={key:0,class:"mt-2"},Ld={class:"col"},Dd={class:"form-floating mb-2"},Hd={class:"col ms-2 my-2"},Ed={class:"badge bg-info me-1"},qd={class:"badge bg-primary me-1"},Bd={class:"row row-cols-1 row-cols-sm-2"},Nd={class:"col"},Rd={class:"form-floating mb-2"},Fd={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},zd={class:"col"},Gd={class:"form-floating mb-2"},jd={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Yd={class:"col"},Wd={class:"form-floating mb-2"},Kd={class:"col-sm-8"},Qd={class:"table-responsive border shadow-sm"},Jd={class:"table table-sm table-hover mb-0 overflow-auto"},Xd=["textContent"],Zd={class:"d-flex flex-row justify-content-start"},eu={class:"mt-1"},tu=["src"],su={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},ou={class:"ms-2"},au=["onClick"],lu={class:"modal-footer"},nu="/api/v1/videos/search",mt={__name:"_selectVideo",emits:["close"],setup(a,{expose:g,emit:I}){const S=he().user,{appTitle:L,pageTitle:P,busy:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,security:x,filter:u,initializeFilter:J,getQuery:Q,saveQuery:c,search:y,getRowNumber:j,setSelected:f,isSelected:M}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select Video",cacheKey:`${S==null?void 0:S.userId}/videos/select`,baseUrl:nu,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null}},initializeFilter:(k,$)=>{const E=k.value,_=new URLSearchParams(window.location.search),C=JSON.parse(localStorage.getItem($))||{};E.query.genre=_.get("genre")||C.genre||E.query.genre||0,E.query.category=_.get("category")||C.category||E.query.category||0},getQuery:k=>["?c=",encodeURIComponent(k.query.criteria),"&p=",k.pageIndex,"&s=",k.pageSize,"&sf=",k.sortField,"&so=",k.sortOrder,"&genre=",k.query.genreId,"&category=",k.query.categoryId,"&sourceLocationId=",k.query.sourceLocationId].join(""),saveQuery:(k,$)=>{localStorage.setItem($,JSON.stringify({criteria:k.query.criteria,pageIndex:k.pageIndex,pageSize:k.pageSize,sortField:k.sortField,sortOrder:k.sortOrder,visible:k.visible,genre:k.query.genre,category:k.query.category}))}}),i=I,h=de("modalSelectVideo"),d=be({video:null,hls:null});me(async()=>{J(),await r()}),Ae(()=>{d.hls&&(d.hls.stopLoad(),d.hls.destroy())});const r=async()=>{await b(),await n()},p=async k=>{u.value.query.sourceLocationId=k,G.value="",await y();var $=document.getElementById(h.value),E=_e.getOrCreateInstance($);E.show()},l=async()=>{var k=document.getElementById(h.value),$=_e.getOrCreateInstance(k);$.hide(),d.hls&&(d.hls.stopLoad(),d.hls.destroy()),i("close",d.video)},b=async k=>{try{const E=await B.get("/api/v1/lookups/video-categories/").then(_=>_.data);u.value.lookups.categories=E}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},n=async k=>{try{const E=await B.get("/api/v1/lookups/video-genres/").then(_=>_.data);u.value.lookups.genres=E}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},v=k=>{d.video=k,w()},w=()=>{if(Hls.isSupported()){d.hls&&(d.hls.stopLoad(),d.hls.destroy());var k=document.getElementById("video-select-preview");const E=d.video.formats.find(C=>C.formatName==="HLS"),_=E.serverUrl+E.path;d.hls=U.createHlsStream(k,_)}};return g({open:p,close:l}),(k,$)=>{const E=te("m-pagination"),_=te("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:h.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",gd,[e("div",bd,[e("div",yd,[e("h5",$d,[$[10]||($[10]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),K(m(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:$[0]||($[0]=C=>l()),"aria-label":"Close"})]),e("div",wd,[F(_,{errorMessage:o(G)},{default:z(()=>[e("div",hd,[e("div",_d,[e("div",kd,[R(e("select",{"onUpdate:modelValue":$[1]||($[1]=C=>o(u).query.categoryId=C),class:"form-select",id:"category"},[(t(!0),s(A,null,N(o(u).lookups.categories,C=>(t(),s("option",{value:C.id},m(C.name),9,Sd))),256))],512),[[ge,o(u).query.categoryId]]),$[11]||($[11]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",Td,[e("div",Id,[R(e("select",{"onUpdate:modelValue":$[2]||($[2]=C=>o(u).query.genreId=C),class:"form-select",id:"genre"},[(t(!0),s(A,null,N(o(u).lookups.genres,C=>(t(),s("option",{value:C.id},m(C.name),9,Md))),256))],512),[[ge,o(u).query.genreId]]),$[12]||($[12]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",xd,[e("div",Cd,[e("div",Vd,[R(e("input",{"onUpdate:modelValue":$[3]||($[3]=C=>o(u).query.criteria=C),onKeyup:$[4]||($[4]=Ue(C=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[X,o(u).query.criteria]]),$[13]||($[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:$[5]||($[5]=C=>o(y)(1))},$[14]||($[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",Pd,[e("div",Od,[e("div",Ad,[$[19]||($[19]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),d.video?(t(),s("div",Ud,[e("div",Ld,[e("div",Dd,[R(e("input",{"onUpdate:modelValue":$[6]||($[6]=C=>d.video.title=C),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[X,d.video.title]]),$[15]||($[15]=e("label",{for:"title"},"Title",-1))])]),e("div",Hd,[e("div",null,[(t(!0),s(A,null,N(d.video.genres,C=>(t(),s("span",Ed,m(C.genreName),1))),256)),(t(!0),s(A,null,N(d.video.categories,C=>(t(),s("span",qd,m(C.categoryName),1))),256))])]),e("div",Bd,[e("div",Nd,[e("div",Rd,[e("div",Fd,m(o(U).moment(d.video.dateReleased).calendar()),1),$[16]||($[16]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",zd,[e("div",Gd,[e("div",jd,m(o(U).moment.utc(d.video.durationInMillis).format("HH:mm:ss")),1),$[17]||($[17]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Yd,[e("div",Wd,[R(e("textarea",{"onUpdate:modelValue":$[7]||($[7]=C=>d.video.description=C),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[X,d.video.description]]),$[18]||($[18]=e("label",{for:"description"},"Description",-1))])])])):H("",!0)])]),e("div",Kd,[e("div",Qd,[e("table",Jd,[$[20]||($[20]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(u).items,(C,re)=>(t(),s("tr",{key:C.videoId},[e("td",{textContent:m(o(j)(re)),class:"text-center"},null,8,Xd),e("td",null,[e("div",Zd,[e("div",null,[C.thumbnails.length>0?(t(!0),s(A,{key:0},N(C.thumbnails,fe=>(t(),s("div",eu,[e("img",{src:fe.url,class:"img-fuild border",width:"128"},null,8,tu)]))),256)):(t(),s("img",su))]),e("div",ou,[e("a",{onClick:fe=>v(C),class:"text-wrap link-offset-2",role:"button"},m(C.title),9,au)])])])]))),128))]),_:1},512),[[Se,o(u).items.length>0]])])]),F(E,{filter:o(u),search:o(y),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",lu,[e("button",{onClick:$[8]||($[8]=C=>l()),class:"btn btn-primary",type:"button"},$[21]||($[21]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:$[9]||($[9]=C=>l()),class:"btn btn-secondary ms-1"},$[22]||($[22]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,vd)}}},ru=["disabled"],iu={class:"col"},du={class:"form-floating mb-2"},uu={key:0,class:"d-block invalid-feedback"},cu={class:"row row-cols-1 row-cols-sm-2"},mu={class:"col"},fu={class:"form-floating mb-2"},pu=["value"],vu={key:0,class:"d-block invalid-feedback"},gu={class:"col"},bu={class:"input-group mb-2"},yu={class:"form-floating"},$u={id:"video",class:"form-control",placeholder:"Title"},wu={key:0},hu={class:"d-flex flex-row justify-content-start"},_u={key:0,class:"d-inline invalid-feedback"},ku={class:"table-responsive border mt-1"},Su={class:"table mb-0 caption-top"},Tu={class:"align-middle"},Iu=["onUpdate:modelValue"],Mu=["value"],xu=["onUpdate:modelValue"],Cu=["value"],Vu=["onClick"],Pu={__name:"add",props:{videoId:{type:String},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,route:Y,axios:D,utils:G,toasts:Z,close:B,closeWithReturnUrl:U,security:O}=we({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source"}),x=a,u=be({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:"vod_",videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),J=de(),Q=(b,n,v)=>b.length>0,c={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},videoId:{required:se.withMessage("Video is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("Source Locaton is required.",ae),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:se.withMessage("PackageConfigurations is required.",Q),$each:se.forEach({path:{required:se.withMessage("Path is required.",ae)},sourceGroupId:{required:se.withMessage("Source Group is required.",ae)}}),$autoDirty:!0,$lazy:!0}}},y=Te(c,u);me(async()=>{if(await j(),await f(),Y.query.videoId)debugger});const j=async()=>{try{await D.get("/api/v1/sourcegroups/lookup/").then(n=>{u.lookups.sourceGroups=n.data})}catch(b){P.value=G.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},f=async()=>{try{if(await D.get("/api/v1/sourcelocations/lookup/").then(n=>{u.lookups.sourceLocations=n.data}),u.lookups.sourceLocations.length===1){const n=u.lookups.sourceLocations[0];u.selected.sourceLocation=n,await M()}}catch(b){P.value=G.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},M=async()=>{const b=u.selected.sourceLocation;u.item.sourceLocationId=b.id},i=async()=>{u.item.videoId=u.selected.video.videoId,await h(u.item.videoId)},h=async b=>{try{const n=`/api/v1/videos/${b}/formats`;await D.get(n).then(v=>{u.selected.video.formats=v.data})}catch(n){P.value=G.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{}},d=async()=>{const b=u;if(V.value)return;if(!await y.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const v=G.clone(b.item),w=b.item.packageConfigurations.filter(k=>k.selectedFormat&&k.sourceGroupId);w.forEach(k=>{const $=k.selectedFormat;k.path=$.path,k.format=$.format,delete k.selectedFormat}),v.packageConfigurations=w,delete v.video,await D.post("/api/v1/vodSources/",v).then(k=>{debugger;Z.success("Add VOD Source","VOD source added",{onClose:async()=>{const $=`${x.urlView}/${k.data}`;await W.push($)}})})}catch(v){P.value=G.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{V.value=!1}},r=()=>{const b={sourceGroupId:null,selectedFormat:null},n=u.selected.video;if(n){const v=n.formats.find(w=>w.formatName==="HLS");b.path=`${v.serverUrl}${v.path}`}u.item.packageConfigurations.push(b)},p=b=>{u.item.packageConfigurations.splice(b,1)},l=async b=>{b&&(u.selected.video=b,await i())};return(b,n)=>{const v=te("PageHeader"),w=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(v,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(y).$dirty&&o(y).$invalid,onClick:n[0]||(n[0]=k=>d()),class:"btn btn-primary"},n[6]||(n[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,ru),e("button",{onClick:n[1]||(n[1]=k=>o(U)(x.urlMain)),class:"btn btn-secondary ms-1"},n[7]||(n[7]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(w,{errorMessage:o(P),vuelidate:o(y)},{default:z(()=>[e("div",null,[e("div",iu,[e("div",du,[R(e("input",{"onUpdate:modelValue":n[2]||(n[2]=k=>u.item.name=k),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,u.item.name]]),n[8]||(n[8]=e("label",{for:"name",class:""},"Name",-1)),o(y).item.name.$error?(t(),s("div",uu,[(t(!0),s(A,null,N(o(y).item.name.$errors,k=>(t(),s("div",{key:k.$uid},m(k.$message),1))),128))])):H("",!0)])]),e("div",cu,[e("div",mu,[e("div",fu,[R(e("select",{"onUpdate:modelValue":n[3]||(n[3]=k=>u.selected.sourceLocation=k),onChange:n[4]||(n[4]=k=>M()),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,N(u.lookups.sourceLocations,k=>(t(),s("option",{value:k},m(k.name),9,pu))),256))],544),[[ge,u.selected.sourceLocation]]),n[9]||(n[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(y).item.sourceLocationId.$error?(t(),s("div",vu,[(t(!0),s(A,null,N(o(y).item.sourceLocationId.$errors,k=>(t(),s("div",{key:k.$uid},m(k.$message),1))),128))])):H("",!0)])]),e("div",gu,[e("div",bu,[e("div",yu,[e("div",$u,[u.selected.video?(t(),s(A,{key:0},[K(m(o(G).moment.utc(u.selected.video.durationInMillis).format("HH:mm:ss"))+" - "+m(u.selected.video.title),1)],64)):H("",!0)]),n[10]||(n[10]=e("label",{for:"video",class:""},"Video",-1))]),e("button",{onClick:n[5]||(n[5]=k=>J.value.open(u.selected.sourceLocation.id)),class:"btn btn-primary",type:"button"},n[11]||(n[11]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),u.item.videoId?(t(),s("div",wu,[e("div",hu,[e("fieldset",null,[e("legend",null,[n[13]||(n[13]=K(" Package Configurations ")),o(y).item.packageConfigurations.$error?(t(),s("span",_u,n[12]||(n[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):H("",!0)])]),e("div",{class:"ms-2"},[e("button",{onClick:r,class:"btn btn-outline-primary"},n[14]||(n[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",ku,[e("table",Su,[n[16]||(n[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Type"),e("th",null,"Source Group"),e("th")])],-1)),e("tbody",Tu,[(t(!0),s(A,null,N(u.item.packageConfigurations,(k,$)=>(t(),s("tr",null,[e("td",null,m($+1),1),e("td",null,[R(e("select",{"onUpdate:modelValue":E=>k.selectedFormat=E,class:"form-select",id:"videoId"},[(t(!0),s(A,null,N(u.selected.video.formats,E=>(t(),s("option",{value:E},m(E.path),9,Mu))),256))],8,Iu),[[ge,k.selectedFormat]]),o(y).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},N(o(y).item.packageConfigurations.$each.$response.$errors[$].path,E=>(t(),s("div",{key:E,class:"d-block invalid-feedback"},m(E.$message),1))),128)):H("",!0)]),e("td",null,[k.selectedFormat?(t(),s(A,{key:0},[K(m(k.selectedFormat.formatName),1)],64)):H("",!0)]),e("td",null,[e("div",null,[R(e("select",{"onUpdate:modelValue":E=>k.sourceGroupId=E,class:"form-select",id:"sourceGroupId"},[(t(!0),s(A,null,N(u.lookups.sourceGroups,E=>(t(),s("option",{value:E.id},m(E.name),9,Cu))),256))],8,xu),[[ge,k.sourceGroupId]]),o(y).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},N(o(y).item.packageConfigurations.$each.$response.$errors[$].path,E=>(t(),s("div",{key:E,class:"d-block invalid-feedback"},m(E.$message),1))),128)):H("",!0)])]),e("td",null,[e("button",{onClick:E=>p($),class:"btn btn-outline-warning"},n[15]||(n[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Vu)])]))),256))])])])])):H("",!0)])]),_:1},8,["errorMessage","vuelidate"]),F(mt,{ref_key:"modalSelectVideo",ref:J,onClose:l},null,512)])]),_:1})}}},Ou=["disabled"],Au={key:0},Uu={class:"col"},Lu={class:"form-floating mb-2"},Du={key:0,class:"d-block invalid-feedback"},Hu={class:"row row-cols-1 row-cols-sm-2"},Eu={class:"col"},qu={class:"form-floating mb-2"},Bu=["value"],Nu={key:0,class:"d-block invalid-feedback"},Ru={class:"col"},Fu={class:"col"},zu=["disabled"],Gu={class:"form-floating"},ju={id:"video",class:"form-control",placeholder:"Title"},Yu={key:0},Wu={class:"d-flex flex-row justify-content-between mt-3"},Ku={key:0,class:"d-inline invalid-feedback"},Qu={class:"table-responsive border mt-1"},Ju={class:"table mb-0 caption-top"},Xu={class:"input-group mb-1"},Zu=["onUpdate:modelValue"],ec=["onUpdate:modelValue"],tc=["value"],sc=["onUpdate:modelValue"],oc=["onClick"],ac={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Edit VOD Source"}),U=a,O=de(),x=be({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),u=(b,n,v)=>b.length>0,J={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},videoId:{required:se.withMessage("Video is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("Source Locaton is required.",ae),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:se.withMessage("PackageConfigurations is required.",u),$each:se.forEach({path:{required:se.withMessage("Path is required.",ae)},sourceGroupId:{required:se.withMessage("Source Group is required.",ae)}})}}},Q=Te(J,x);me(async()=>{await c(),await f(),await M()});const c=async()=>{await y(),await j()},y=async()=>{const b=x;if(!V.value)try{V.value=!0,P.value="",x.item=null;const n=`/api/v1/vodsources/${U.id}/`;await Y.get(n).then(v=>{b.item=v.data;const w=b.item,k=D.moment.utc(b.item.video.durationInMillis).format("HH:mm:ss");w.video.duration=k})}catch(n){P.value=D.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{V.value=!1}},j=async()=>{const b=x;if(!V.value)try{V.value=!0,P.value="";const n=`/api/v1/videos/${b.item.videoId}/`;await Y.get(n).then(v=>{b.selected.video=v.data})}catch(n){P.value=D.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{V.value=!1}},f=async()=>{try{await Y.get("/api/v1/sourcegroups/lookup/").then(n=>{x.lookups.sourceGroups=n.data})}catch(b){P.value=D.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},M=async()=>{try{if(await Y.get("/api/v1/sourcelocations/lookup/").then(n=>{x.lookups.sourceLocations=n.data}),x.lookups.sourceLocations.length>0){const n=x.lookups.sourceLocations.find(v=>v.id===x.item.sourceLocationId);x.selected.sourceLocation=n}}catch(b){P.value=D.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},i=async()=>{x.item.videoId=x.selected.video.videoId,await h(x.item.videoId)},h=async b=>{try{const n=`/api/v1/videos/${b}/formats`;await Y.get(n).then(v=>{x.selected.video.formats=v.data;debugger})}catch(n){P.value=D.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{}},d=async()=>{const b=x;if(V.value)return;if(!await Q.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const v=D.clone(b.item);delete v.video,delete v.programs,delete v.sourceLocation,await Y.put("/api/v1/vodsources/",v).then(w=>{G.success("Edit VOD Source","VOD source edited.",{onClose:async()=>{const k=`${U.urlView}/${U.id}`;await W.push(k)}})})}catch(v){P.value=D.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{V.value=!1}},r=()=>{debugger;const b={path:"",sourceGroupId:null,type:"HLS"},n=x.selected.video;if(n){const v=n.formats.find(w=>w.formatName==="HLS");b.path=`${v.path}`}x.item.packageConfigurations.push(b)},p=b=>{x.item.packageConfigurations.splice(b,1)},l=async b=>{b&&(x.selected.video=b,x.item.packageConfigurations=[],await i())};return(b,n)=>{const v=te("router-link"),w=te("PageHeader"),k=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(w,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(Q).$dirty&&o(Q).$invalid,onClick:n[0]||(n[0]=$=>d()),class:"btn btn-primary"},n[5]||(n[5]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Ou),e("button",{onClick:n[1]||(n[1]=$=>c()),class:"btn btn-secondary ms-2"},n[6]||(n[6]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(v,{to:`${a.urlView}/${a.id}`,class:"btn btn-secondary ms-1"},{default:z(()=>n[7]||(n[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(k,{errorMessage:o(P),vuelidate:o(Q)},{default:z(()=>[x.item?(t(),s("div",Au,[e("div",Uu,[e("div",Lu,[R(e("input",{"onUpdate:modelValue":n[2]||(n[2]=$=>x.item.name=$),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,x.item.name]]),n[8]||(n[8]=e("label",{for:"name",class:""},"Name",-1)),o(Q).item.name.$error?(t(),s("div",Du,[(t(!0),s(A,null,N(o(Q).item.name.$errors,$=>(t(),s("div",{key:$.$uid},m($.$message),1))),128))])):H("",!0)])]),e("div",Hu,[e("div",Eu,[e("div",qu,[R(e("select",{"onUpdate:modelValue":n[3]||(n[3]=$=>x.selected.sourceLocation=$),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,N(x.lookups.sourceLocations,$=>(t(),s("option",{value:$},m($.name),9,Bu))),256))],512),[[ge,x.selected.sourceLocation]]),n[9]||(n[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(Q).item.sourceLocationId.$error?(t(),s("div",Nu,[(t(!0),s(A,null,N(o(Q).item.sourceLocationId.$errors,$=>(t(),s("div",{key:$.$uid},m($.$message),1))),128))])):H("",!0)])]),e("div",Ru,[e("div",Fu,[e("div",{class:"input-group mb-2",disabled:x.item.packageConfigurations.length>0},[e("div",Gu,[e("div",ju,[x.selected.video?(t(),s(A,{key:0},[K(m(x.selected.video.title),1)],64)):H("",!0)]),n[10]||(n[10]=e("label",{for:"video",class:""},"Video",-1))]),e("button",{onClick:n[4]||(n[4]=$=>O.value.open(x.selected.sourceLocation.id)),class:"btn btn-primary",type:"button"},n[11]||(n[11]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))],8,zu)])])]),x.item.videoId?(t(),s("div",Yu,[e("div",Wu,[e("div",null,[e("h5",null,[n[13]||(n[13]=K(" Package Configurations ")),o(Q).item.packageConfigurations.$error?(t(),s("span",Ku,n[12]||(n[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):H("",!0)])]),e("button",{onClick:r,class:"btn btn-outline-primary"},n[14]||(n[14]=[e("span",{class:"fas fa-fw fa-plus me-1"},null,-1),K("Package Configuration ")]))]),e("div",Qu,[e("table",Ju,[n[17]||(n[17]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(x.item.packageConfigurations,($,E)=>(t(),s("tr",null,[e("td",null,m(E+1),1),e("td",null,[e("div",Xu,[R(e("input",{"onUpdate:modelValue":_=>$.path=_,type:"text",class:"form-control",placeholder:"Enter Relative Path, e.g. '/my/path/index.m3u8'"},null,8,Zu),[[X,$.path]])]),o(Q).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},N(o(Q).item.packageConfigurations.$each.$response.$errors[E].path,_=>(t(),s("div",{key:_,class:"d-block invalid-feedback"},m(_.$message),1))),128)):H("",!0)]),e("td",null,[e("div",null,[R(e("select",{"onUpdate:modelValue":_=>$.sourceGroupId=_,class:"form-select",id:"sourceGroupId"},[(t(!0),s(A,null,N(x.lookups.sourceGroups,_=>(t(),s("option",{value:_.id},m(_.name),9,tc))),256))],8,ec),[[ge,$.sourceGroupId]]),o(Q).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},N(o(Q).item.packageConfigurations.$each.$response.$errors[E].path,_=>(t(),s("div",{key:_,class:"d-block invalid-feedback"},m(_.$message),1))),128)):H("",!0)])]),e("td",null,[R(e("select",{"onUpdate:modelValue":_=>$.type=_,class:"form-select",id:"type"},n[15]||(n[15]=[e("option",{value:"HLS"}," HLS ",-1),e("option",{value:"DASH"}," DASH ",-1)]),8,sc),[[ge,$.type]])]),e("td",null,[e("button",{onClick:_=>p(E),class:"btn btn-outline-warning"},n[16]||(n[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,oc)])]))),256))])])])])):H("",!0)])):H("",!0)]),_:1},8,["errorMessage","vuelidate"]),F(mt,{ref_key:"modalSelectVideo",ref:O,onClose:l},null,512)])]),_:1})}}},lc={class:"ms-2"},nc={class:"input-group"},rc=["value"],ic={class:"ms-1"},dc={class:"input-group"},uc=["value"],cc={class:"ms-1"},mc={class:"input-group"},fc={class:"ms-1"},pc={class:"input-group"},vc={class:"table-responsive border shadow-sm"},gc={class:"table table-hover mb-0"},bc={class:"text-center"},yc=["textContent"],$c={class:"d-flex flex-row justify-content-start"},wc={class:"mt-1"},hc=["src"],_c={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},kc={class:"ms-2"},Sc={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Tc={class:"badge bg-primary me-1"},Ic={key:0},Mc={class:"badge bg-info me-1"},xc={class:"d-flex flex-row justify-content-start"},Cc={class:"ms-2"},Vc={class:"small"},Pc={class:"badge bg-secondary me-1"},Oc={class:"text-center"},Ac=["onUpdate:modelValue"],Uc="/api/v1/vodsources/search",Lc={__name:"index",props:{urlAdd:{type:String,default:"/vod-sources/add"},urlView:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"}},setup(a){Ce("$config");const I=he().user,{appTitle:V,pageTitle:S,busy:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,closeWithReturnUrl:O,generateReturnUrl:x,security:u,filter:J,initializeFilter:Q,getQuery:c,saveQuery:y,search:j,getRowNumber:f,setSelected:M,isSelected:i}=Le({appTitle:"Arcadian-FAST",pageTitle:"VOD Sources",cacheKey:`${I==null?void 0:I.userId}/vod-sources/search`,baseUrl:Uc,filter:{updateUrl:!0,lookups:{sourceLocations:[],genres:[]},query:{type:0,sourceLocationId:""}},initializeFilter:(n,v)=>{const w=n.value,k=new URLSearchParams(window.location.search),$=JSON.parse(localStorage.getItem(v))||{};w.query.category=k.get("category")||$.category||w.query.category||0,w.query.genre=k.get("genre")||$.genre||w.query.genre||0,w.query.sourceLocationId=k.get("slid")||$.sourceLocationId||w.query.sourceLocationId||""},getQuery:n=>["?c=",encodeURIComponent(n.query.criteria),"&p=",n.pageIndex,"&s=",n.pageSize,"&sf=",n.sortField,"&so=",n.sortOrder,"&category=",n.query.category,"&genre=",n.query.genre,"&slid=",n.query.sourceLocationId].join(""),saveQuery:(n,v)=>{localStorage.setItem(v,JSON.stringify({criteria:n.query.criteria,pageIndex:n.pageIndex,pageSize:n.pageSize,sortField:n.sortField,sortOrder:n.sortOrder,visible:n.visible,category:n.query.category,genre:n.query.genre,sourceLocationId:n.query.sourceLocationId}))}}),h=Me(()=>{const n=J.value;return n&&n.items?n.items.filter(k=>k.selected):[]});me(async()=>{Q(),await l(),await b(),await j()});const d=async()=>{if(!(h.length<=0||!confirm("The selected VODs will be submitted to AWS MediaTailer. Are you sure you want to publish the selected VODs?"))&&!L.value){Y.value=null;try{L.value=!0;const w={vodSourceIds:h.value.map(k=>k.vodSourceId)};await G.post("/api/v1/vodsources/publish/",w).then(k=>{B.success("Publish VODs","VODs was published.",{async onClose(){}})}),L.value=!1,await j()}catch(v){Y.value=Z.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{L.value=!1}}},r=async()=>{if(!(h.length<=0||!confirm("The selected VODs will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected VODs?"))&&!L.value){Y.value=null;try{L.value=!0;const w={vodSourceIds:h.value.map(k=>k.vodSourceId)};await G.post("/api/v1/vodsources/unpublish/",w).then(k=>{B.success("Unpublish VODs","VODs was inpublished.",{async onClose(){}})}),L.value=!1,await j()}catch(v){Y.value=Z.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{L.value=!1}}},p=()=>{const n=J.value.items;if(n.length<1)return;const v=!n[0].selected;J.value.items.forEach(w=>{w.selected=v})},l=async()=>{try{await G.get("/api/v1/sourcelocations/lookup/").then(v=>{J.value.lookups.sourceLocations=v.data})}catch(n){Y.value=Z.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{}},b=async()=>{try{await G.get("/api/v1/lookups/video-genres/").then(n=>{const v=n.data;J.value.lookups.genres=v})}catch(n){Y.value=Z.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{}};return de(!1),(n,v)=>{const w=te("router-link"),k=te("PageHeader"),$=te("m-pagination"),E=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(k,{"page-icon":"fas fa-fw fa-tags",pageTitle:o(S)},{default:z(()=>[F(w,{to:a.urlAdd,class:"btn btn-primary"},{default:z(()=>v[6]||(v[6]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",lc,[e("div",nc,[v[8]||(v[8]=e("span",{class:"input-group-text fw-bold"},"Source",-1)),R(e("select",{"onUpdate:modelValue":v[0]||(v[0]=_=>o(J).query.sourceLocationId=_),class:"form-select"},[v[7]||(v[7]=e("option",{value:""},"All",-1)),(t(!0),s(A,null,N(o(J).lookups.sourceLocations,_=>(t(),s("option",{value:_.id},m(_.name),9,rc))),256))],512),[[ge,o(J).query.sourceLocationId]])])]),e("div",ic,[e("div",dc,[v[9]||(v[9]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),R(e("select",{"onUpdate:modelValue":v[1]||(v[1]=_=>o(J).query.genre=_),class:"form-select"},[(t(!0),s(A,null,N(o(J).lookups.genres,_=>(t(),s("option",{value:_.id},m(_.name),9,uc))),256))],512),[[ge,o(J).query.genre]])])]),e("div",cc,[e("div",mc,[v[11]||(v[11]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),R(e("select",{"onUpdate:modelValue":v[2]||(v[2]=_=>o(J).query.category=_),class:"form-select"},v[10]||(v[10]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[ge,o(J).query.category]])])]),e("div",fc,[e("div",pc,[R(e("input",{"onUpdate:modelValue":v[3]||(v[3]=_=>o(J).query.criteria=_),onKeyup:v[4]||(v[4]=Ue(_=>o(j)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[X,o(J).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:v[5]||(v[5]=_=>o(j)(1))},v[12]||(v[12]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(E,{errorMessage:o(Y)},{default:z(()=>[e("div",vc,[e("table",gc,[e("thead",null,[e("tr",null,[v[16]||(v[16]=e("td",{class:"text-center"},"#",-1)),v[17]||(v[17]=e("th",null,"Name",-1)),v[18]||(v[18]=e("th",null,"Video Title",-1)),e("th",bc,[h.value.length?(t(),s(A,{key:0},[e("button",{onClick:d,class:"btn btn-sm btn-primary"},v[13]||(v[13]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:r,class:"btn btn-sm btn-warning ms-1"},v[14]||(v[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):H("",!0),e("button",{onClick:p,class:"btn btn-sm btn-outline-primary ms-2"},v[15]||(v[15]=[e("span",{class:"fas fa-fw fa-check-double"},null,-1)]))])])]),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(J).items,(_,C)=>(t(),s("tr",{key:_.vodSourceId},[e("td",{textContent:m(o(f)(C)),class:"text-center"},null,8,yc),e("td",null,[e("div",$c,[e("div",null,[_.video.thumbnails.length>0?(t(!0),s(A,{key:0},N(_.video.thumbnails,re=>(t(),s("div",wc,[e("img",{src:re.url,class:"img-fuild border",width:"128"},null,8,hc)]))),256)):(t(),s("img",_c))]),e("div",kc,[F(w,{to:`${a.urlView}/${_.vodSourceId}`,class:"d-inline-block text-truncate link-offset-2"},{default:z(()=>[_.arn?(t(),s("span",Sc)):H("",!0),K(m(_.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(A,null,N(_.video.categories,re=>(t(),s("div",null,[e("span",Tc,m(re.categoryName),1)]))),256)),_.video.genres.length>0?(t(),s("div",Ic,[(t(!0),s(A,null,N(_.video.genres,re=>(t(),s("span",Mc,m(re.genreName),1))),256))])):H("",!0)])])])]),e("td",null,[e("div",xc,[e("div",Cc,[F(w,{to:`${a.urlViewVideo}/${encodeURIComponent(_.video.videoId)}/${o(x)()}`,class:"link-offset-2"},{default:z(()=>[K(m(_.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",Vc,m(o(Z).moment.utc(_.video.durationInMillis).format("HH:mm:ss")),1)]),_.video.formats.length>0?(t(!0),s(A,{key:0},N(_.video.formats,re=>(t(),s("span",Pc,m(re.formatName),1))),256)):H("",!0)])])]),e("td",Oc,[R(e("input",{"onUpdate:modelValue":re=>_.selected=re,type:"checkbox",class:"form-check-input"},null,8,Ac),[[Be,_.selected]])])]))),128))]),_:1},512),[[Se,o(J).items.length>0]])])]),F($,{filter:o(J),search:o(j),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Dc=["id"],Hc={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Ec={class:"modal-content"},qc={class:"modal-header"},Bc={class:"modal-title"},Nc={class:"modal-body"},Rc={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Fc=["innerHTML"],zc={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Gc={class:"container"},jc={class:"col"},Yc={class:"form-floating mb-2"},Wc=["value"],Kc={key:0,class:"d-block invalid-feedback"},Qc={class:"col"},Jc={class:"form-floating mb-2"},Xc={key:0,class:"d-block invalid-feedback"},Zc={class:"col"},em={class:"form-floating mb-2"},tm=["value"],sm={key:0,class:"d-block invalid-feedback"},om={class:"modal-footer"},am=["disabled"],lm={__name:"_addPackageConfiguration",emits:["refresh"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source Package Configuration"}),J=I;de();const Q=de("modalAddChannelOutput"),c=be({lookups:{sourceGroups:[],formats:[]},item:{sourceGroupId:null,vodSourceId:null,path:null,type:null}}),y={item:{sourceGroupId:{required:se.withMessage("Source Group is required.",ae),$autoDirty:!0,$lazy:!0},vodSourceId:{required:se.withMessage("VOD Source is required.",ae),$autoDirty:!0,$lazy:!0},path:{required:se.withMessage("Path is required.",ae),$autoDirty:!0,$lazy:!0},type:{required:se.withMessage("Type is required.",ae),$autoDirty:!0,$lazy:!0}}},j=Te(y,c);me(async()=>{j.value.$reset()});const f=async()=>{await M()},M=async()=>{try{await B.get("/api/v1/sourceGroups/lookup/").then(l=>{c.lookups.sourceGroups=l.data,c.lookups.sourceGroups.length===1&&(c.item.sourceGroupId=c.lookups.sourceGroups[0].id)})}catch(p){G.value=U.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}},i=async p=>{try{const l=`/api/v1/videos/${p}/formats/`;await B.get(l).then(b=>{c.lookups.formats=b.data})}catch(l){G.value=U.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},h=async(p,l)=>{const b=c;W.value.clear(),G.value="",b.lookups={sourceGroups:[],formats:[]},b.item={sourceGroupId:null,vodSourceId:p,path:null,type:null},await f(),await i(l),j.value.$reset();var n=document.getElementById(Q.value),v=_e.getOrCreateInstance(n);v.show()},d=async()=>{var p=document.getElementById(Q.value),l=_e.getOrCreateInstance(p);l.hide(),J("refresh")},r=async()=>{const p=c;if(L.value)return;const l=await j.value.$validate();debugger;if(!l){window.scrollTo(0,0);return}try{L.value=!0,G.value="";const b=p.item;await B.post("/api/v1/vodSources/package-configurations/",b).then(n=>{O.success("Add VOD Source Package Configuration","VOD Source package configuration added.")}),await d()}catch(b){G.value=U.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{L.value=!1}};return g({open:h,close:d}),(p,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:Q.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",Hc,[e("div",Ec,[e("div",qc,[e("h5",Bc,[l[5]||(l[5]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=b=>d()),"aria-label":"Close"})]),e("div",Nc,[o(G)?(t(),s("div",Rc,[l[6]||(l[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Fc)])):H("",!0),o(W).size>0?(t(),s("div",zc,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),b=>(t(),s("li",null,m(b),1))),256))])])):H("",!0),e("div",Gc,[e("div",jc,[e("div",Yc,[R(e("select",{"onUpdate:modelValue":l[1]||(l[1]=b=>c.item.sourceGroupId=b),class:"form-select",id:"sourceGroupId"},[(t(!0),s(A,null,N(c.lookups.sourceGroups,b=>(t(),s("option",{value:b.id},m(b.name),9,Wc))),256))],512),[[ge,c.item.sourceGroupId]]),l[8]||(l[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(j).item.sourceGroupId.$error?(t(),s("div",Kc,[(t(!0),s(A,null,N(o(j).item.sourceGroupId.$errors,b=>(t(),s("div",{key:b.$uid},m(b.$message),1))),128))])):H("",!0)])]),e("div",Qc,[e("div",Jc,[R(e("select",{"onUpdate:modelValue":l[2]||(l[2]=b=>c.item.type=b),class:"form-select",id:"type"},l[9]||(l[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),512),[[ge,c.item.type]]),l[10]||(l[10]=e("label",{for:"type",class:""},"Type",-1)),o(j).item.type.$error?(t(),s("div",Xc,[(t(!0),s(A,null,N(o(j).item.type.$errors,b=>(t(),s("div",{key:b.$uid},m(b.$message),1))),128))])):H("",!0)])]),e("div",Zc,[e("div",em,[R(e("select",{"onUpdate:modelValue":l[3]||(l[3]=b=>c.item.path=b),class:"form-control",id:"path"},[(t(!0),s(A,null,N(c.lookups.formats,b=>(t(),s("option",{value:b.path},m(b.path),9,tm))),256))],512),[[ge,c.item.path]]),l[11]||(l[11]=e("label",{for:"path",class:""},"Path",-1)),o(j).item.path.$error?(t(),s("div",sm,[(t(!0),s(A,null,N(o(j).item.path.$errors,b=>(t(),s("div",{key:b.$uid},m(b.$message),1))),128))])):H("",!0)])])])]),e("div",om,[e("button",{disabled:o(j).$dirty&&o(j).$invalid,onClick:l[4]||(l[4]=b=>r()),class:"btn btn-primary",type:"button"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,am),l[13]||(l[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,Dc))}},nm=["id"],rm={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},im={class:"modal-content"},dm={class:"modal-header"},um={class:"modal-title"},cm={class:"modal-body"},mm={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},fm=["innerHTML"],pm={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},vm={class:"container"},gm={class:"col"},bm={class:"form-floating mb-2"},ym={class:"col"},$m={class:"form-floating mb-2"},wm={key:0,class:"d-block invalid-feedback"},hm={class:"col"},_m={class:"form-floating mb-2"},km={key:0,class:"d-block invalid-feedback"},Sm={class:"col"},Tm={class:"form-floating mb-2"},Im={key:0,class:"d-block invalid-feedback"},Mm={class:"modal-footer"},xm=["disabled"],Cm={__name:"_addPlaybackConfiguration",emits:["refresh"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Vod Source Playback Configuration"}),J=I,Q=de(),c=de("modalAddPlaybackConfiguration"),y=be({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),j={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:se.withMessage("adDecisionServerUrl is required.",ae),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:se.withMessage("videoContentSourceUrl is required.",ae),$autoDirty:!0,$lazy:!0}}},f=Te(j,y);me(async()=>{f.value.$reset()});const M=async(d,r)=>{Q.value=d;const p=y;W.value.clear(),G.value="";const l=r,b=l.lastIndexOf("/"),n=l.substring(0,b),v="ad_campaign_"+l.substring(b+1).replace(".","_");p.item={name:v,originalVideoContentSourceUrl:r,videoContentSourceUrl:n,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},f.value.$reset();var w=document.getElementById(c.value),k=_e.getOrCreateInstance(w);k.show()},i=async()=>{var d=document.getElementById(c.value),r=_e.getOrCreateInstance(d);r.hide(),J("refresh")},h=async()=>{const d=y;if(L.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{L.value=!0,G.value="";const p=d.item;p.vodSourceId=Q.value,await B.post("/api/v1/playbackconfigurations/vodsource",p).then(l=>{O.success("Add Vod Source Playback Configuration","Vod Source playback configuration added.",{async onClose(){}})}),await i()}catch(p){G.value=U.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{L.value=!1}};return g({open:M,close:i}),(d,r)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",rm,[e("div",im,[e("div",dm,[e("h5",um,[r[6]||(r[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:r[0]||(r[0]=p=>i()),"aria-label":"Close"})]),e("div",cm,[o(G)?(t(),s("div",mm,[r[7]||(r[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,fm)])):H("",!0),o(W).size>0?(t(),s("div",pm,[r[8]||(r[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),p=>(t(),s("li",null,m(p),1))),256))])])):H("",!0),e("div",vm,[e("div",gm,[e("div",bm,[R(e("input",{"onUpdate:modelValue":r[1]||(r[1]=p=>y.item.originalVideoContentSourceUrl=p),id:"originalVideoContentSourceUrl",class:"form-control",placeholder:"originalVideoContentSourceUrl",disabled:""},null,512),[[X,y.item.originalVideoContentSourceUrl]]),r[9]||(r[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",ym,[e("div",$m,[R(e("input",{"onUpdate:modelValue":r[2]||(r[2]=p=>y.item.name=p),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,y.item.name]]),r[10]||(r[10]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",wm,[(t(!0),s(A,null,N(o(f).item.name.$errors,p=>(t(),s("div",{key:p.$uid},m(p.$message),1))),128))])):H("",!0)])]),e("div",hm,[e("div",_m,[R(e("input",{"onUpdate:modelValue":r[3]||(r[3]=p=>y.item.videoContentSourceUrl=p),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[X,y.item.videoContentSourceUrl]]),r[11]||(r[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),r[12]||(r[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(f).item.videoContentSourceUrl.$error?(t(),s("div",km,[(t(!0),s(A,null,N(o(f).item.videoContentSourceUrl.$errors,p=>(t(),s("div",{key:p.$uid},m(p.$message),1))),128))])):H("",!0)])]),e("div",Sm,[e("div",Tm,[R(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=p=>y.item.adDecisionServerUrl=p),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[X,y.item.adDecisionServerUrl]]),r[13]||(r[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(f).item.adDecisionServerUrl.$error?(t(),s("div",Im,[(t(!0),s(A,null,N(o(f).item.adDecisionServerUrl.$errors,p=>(t(),s("div",{key:p.$uid},m(p.$message),1))),128))])):H("",!0)])])])]),e("div",Mm,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:r[5]||(r[5]=p=>h()),class:"btn btn-primary",type:"button"},r[14]||(r[14]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,xm),r[15]||(r[15]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,nm))}},Vm={key:0},Pm={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},Om={class:"nav-item",role:"presentation"},Am={class:"nav-item",role:"presentation"},Um={class:"nav-item",role:"presentation"},Lm={class:"nav-item",role:"presentation"},Dm={class:"nav-item",role:"presentation"},Hm={class:"tab-content",id:"myTabContent"},Em={class:"mt-2"},qm={class:"row row-cols-1 row-cols-sm-2"},Bm={class:"col"},Nm=["id"],Rm={class:"col"},Fm={class:"col"},zm={class:"form-floating mb-2"},Gm={class:"mt-2"},jm={class:"row row-cols-sm-2"},Ym={class:"col"},Wm={class:"form-floating mb-2"},Km={class:"form-control-plaintext"},Qm={class:"col"},Jm={class:"form-floating mb-2"},Xm={class:"mt-1"},Zm={class:"badge bg-info me-1"},ef={class:"badge bg-primary me-1"},tf={class:"badge bg-info me-1"},sf={class:"table-responsive border mt-1"},of={class:"table table-hover mb-0"},af={class:"table-group-divider"},lf={class:"align-middle"},nf={class:"text-center"},rf={class:"text-truncate text-wrap"},df={class:"text-truncate text-wrap"},uf={class:"mt-2"},cf={class:"mt-2 text-end"},mf={class:"table-responsive border mt-2"},ff={class:"table table-hover mb-0 caption-top"},pf={class:"text-end"},vf=["onClick"],gf={class:"mt-2"},bf={class:"mt-1"},yf=["id"],$f={class:"text-end"},wf={__name:"view",props:{id:{type:String,required:!0},urlEdit:{type:String,default:"/vod-sources/edit"},urlMain:{type:String,default:"/vod-sources"},urlViewVideo:{type:String,default:"/videos/view"}},setup(a){const g=a,{appTitle:I,pageTitle:V,busy:S,isDirty:L,validations:P,infoMessage:W,warningMessage:Y,errorMessage:D,router:G,axios:Z,utils:B,toasts:U,close:O,closeWithReturnUrl:x,generateReturnUrl:u,security:J}=we({appTitle:"Arcadian-FAST",pageTitle:"View VOD Source"});Ce("$config");const Q=he();Q.user;const c=be({user:Q.user,item:null,hls:null}),y=de();de(null);const j=de();me(async()=>{await h();const v=B.getPageTab("vodSource")||"information-tab";f(v)}),Ae(()=>{c.hls&&(c.hls.stopLoad(),c.hls.destroy())});const f=v=>{B.setPageTab("vodSource",v),y.value=v},M=v=>v!==y.value?"":"active",i=v=>v!==y.value?"":"show active",h=async()=>{const v=c;if(!S.value)try{S.value=!0,D.value="",c.item=null;const w=`/api/v1/vodsources/${g.id}/`;await Z.get(w).then(k=>{v.item=k.data;const $=v.item,E=B.moment.utc(v.item.video.durationInMillis).format("HH:mm:ss");$.video.duration=E}),n()}catch(w){D.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{S.value=!1}},d=async()=>{await h()},r=()=>{j.value.open(c.item.vodSourceId,c.item.videoId)},p=async()=>{if(confirm("VOD will be submitted to AWS MediaTailer. Are you sure you want to publish the VOD?")&&!S.value){D.value=null;try{S.value=!0;const w={vodSourceIds:[g.id]};await Z.post("/api/v1/vodsources/publish/",w).then(k=>{U.success("Publish VOD","VOD was published.",{async onClose(){}})}),S.value=!1,await d()}catch(w){D.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{S.value=!1}}},l=async()=>{if(confirm("VOD will be removed to AWS MediaTailer. Are you sure you want to remove the VOD?")&&!S.value){D.value=null;try{S.value=!0;const w={vodSourceIds:[g.id]};await Z.post("/api/v1/vodsources/unpublish/",w).then(k=>{U.warning("Remove VOD","VOD was removed.",{async onClose(){}})}),S.value=!1,await d()}catch(w){D.value=B.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{S.value=!1}}},b=async v=>{if(confirm("Are you sure you want to remove the VOD Package configuration?")&&!S.value){D.value=null;try{S.value=!0,await Z.delete(`/api/v1/vodSources/package-configurations/${v}/`).then(k=>{U.warning("Remove VOD Source Package Configuration","VOD Source package configuration was removed.")}),S.value=!1,await d()}catch(k){D.value=B.getErrorMessageAsHtml(k),window.scrollTo(0,0)}finally{S.value=!1}}},n=()=>{if(Hls.isSupported()){c.hls&&(c.hls.stopLoad(),c.hls.destroy());const v=`video-${c.item.vodSourceId}`,w=document.getElementById(v),k=c.item.video.formats.find(E=>E.formatName==="HLS"),$=`${k.serverUrl}${k.path}`;c.hls=B.createHlsStream(w,$)}};return(v,w)=>{const k=te("router-link"),$=te("PageHeader"),E=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F($,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(V)},{default:z(()=>[c.item?(t(),s(A,{key:0},[c.item.arn?(t(),s("button",{key:0,onClick:w[0]||(w[0]=_=>l()),class:"ms-1 btn btn-warning"},w[14]||(w[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:w[1]||(w[1]=_=>p()),class:"ms-1 btn btn-primary"},w[15]||(w[15]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):H("",!0),F(k,{to:`${a.urlEdit}/${a.id}`,class:"ms-2 btn btn-primary"},{default:z(()=>w[16]||(w[16]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:w[2]||(w[2]=_=>d()),class:"ms-2 btn btn-secondary"},w[17]||(w[17]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:w[3]||(w[3]=_=>o(x)(g.urlMain)),class:"btn btn-secondary ms-1"},w[18]||(w[18]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(E,{errorMessage:o(D)},{default:z(()=>[c.item?(t(),s("div",Vm,[e("div",null,[e("ul",Pm,[e("li",Om,[e("button",{onClick:w[4]||(w[4]=_=>f("information-tab")),class:le([M("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Am,[e("button",{onClick:w[5]||(w[5]=_=>f("packageConfigurations-tab")),class:le([M("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)]),e("li",Um,[e("button",{onClick:w[6]||(w[6]=_=>f("channels-tab")),class:le([M("channels-tab"),"nav-link"]),id:"channels-tab","data-bs-toggle":"tab","data-bs-target":"#channels",type:"button",role:"tab","aria-controls":"channels","aria-selected":"false"},w[19]||(w[19]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),K("Channels ")]),2)]),e("li",Lm,[e("button",{onClick:w[7]||(w[7]=_=>f("programs-tab")),class:le([M("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},w[20]||(w[20]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),K("Programs ")]),2)]),e("li",Dm,[e("button",{onClick:w[8]||(w[8]=_=>f("programTemplates-tab")),class:le([M("programTemplates-tab"),"nav-link"]),id:"programTemplates-tab","data-bs-toggle":"tab","data-bs-target":"#programTemplates",type:"button",role:"tab","aria-controls":"programTemplates","aria-selected":"false"},w[21]||(w[21]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),K("Program Templates ")]),2)])]),e("div",Hm,[e("div",{class:le([i("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Em,[e("div",qm,[e("div",Bm,[e("video",{id:`video-${c.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,Nm)]),e("div",Rm,[e("div",Fm,[e("div",zm,[R(e("input",{"onUpdate:modelValue":w[9]||(w[9]=_=>c.item.name=_),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[X,c.item.name]]),w[22]||(w[22]=e("label",{for:"name"},"Name",-1))])]),e("div",Gm,[w[26]||(w[26]=e("b",null," Video Information ",-1)),e("div",null,[e("div",jm,[e("div",Ym,[e("div",Wm,[e("div",Km,[F(k,{to:`${a.urlViewVideo}/${c.item.video.videoId}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(c.item.video.title),1)]),_:1},8,["to"])]),w[23]||(w[23]=e("label",{for:"title"},"Title",-1))])]),e("div",Qm,[e("div",Jm,[R(e("input",{"onUpdate:modelValue":w[10]||(w[10]=_=>c.item.video.duration=_),type:"text",class:"form-control-plaintext",id:"duration",readonly:""},null,512),[[X,c.item.video.duration]]),w[24]||(w[24]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Xm,[(t(!0),s(A,null,N(c.item.video.genres,_=>(t(),s("span",Zm,m(_.genreName),1))),256)),(t(!0),s(A,null,N(c.item.video.categories,_=>(t(),s("span",ef,m(_.categoryName),1))),256)),(t(!0),s(A,null,N(c.item.video.categories,_=>(t(),s("span",tf,m(_.categoryName),1))),256))]),e("div",sf,[e("table",of,[w[25]||(w[25]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",af,[(t(!0),s(A,null,N(c.item.video.formats,(_,C)=>(t(),s("tr",lf,[e("td",nf,m(C+1),1),e("td",null,m(_.formatName),1),e("td",null,[e("div",rf,m(_.serverUrl),1)]),e("td",null,[e("div",df,m(_.path),1)])]))),256))])])])])])])])])],2),e("div",{class:le([i("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",uf,[e("div",cf,[e("button",{onClick:w[11]||(w[11]=_=>r()),class:"btn btn-outline-primary btn-sm"},w[27]||(w[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",mf,[e("table",ff,[w[29]||(w[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.packageConfigurations,(_,C)=>(t(),s("tr",{key:_.packageConfigurationId,class:"align-middle"},[e("td",null,m(C+1),1),e("td",null,m(_.path),1),e("td",null,m(_.sourceGroup.name),1),e("td",null,m(_.type),1),e("td",pf,[e("button",{onClick:re=>b(_.packageConfigurationId),class:"btn btn-outline-warning btn-sm"},w[28]||(w[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,vf)])]))),128))]),_:1},512),[[Se,c.item.packageConfigurations.length>0]])])])])],2),e("div",{class:le([i("viewStream-tab"),"tab-pane fade"]),id:"viewStream",role:"tabpanel","aria-labelledby":"viewStream-tab"},[e("div",gf,[e("div",bf,[e("video",{id:`video-${c.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,yf),e("div",$f,[e("button",{onClick:w[12]||(w[12]=_=>c.hls.startLoad(-1)),class:"btn btn-outline-info btn-sm"},w[30]||(w[30]=[e("span",{class:"fas fa-fw fa-cloud-download"},null,-1)]))])])])],2),e("div",{class:le([i("channels-tab"),"tab-pane fade"]),id:"channels",role:"tabpanel","aria-labelledby":"channels-tab"},w[31]||(w[31]=[e("div",{class:"mt-2"}," TODO: List of Channels using this as filler slate ",-1)]),2),e("div",{class:le([i("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},w[32]||(w[32]=[e("div",{class:"mt-2"}," TODO: List of Programs using this as VOD source ",-1)]),2),e("div",{class:le([i("programTemplates-tab"),"tab-pane fade"]),id:"programTemplates",role:"tabpanel","aria-labelledby":"programTemplates-tab"},w[33]||(w[33]=[e("div",{class:"mt-2"}," TODO: List of Program Templates using this as VOD source ",-1)]),2)])])])):H("",!0)]),_:1},8,["errorMessage"]),F(lm,{ref_key:"modalAddPackageConfiguration",ref:j,onRefresh:d},null,512),F(Cm,{ref:"modalAddPlaybackConfiguration",onRefresh:w[13]||(w[13]=_=>d())},null,512)])]),_:1})}}},hf=["id"],_f={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},kf={class:"modal-content"},Sf={class:"modal-header"},Tf={class:"modal-title"},If={class:"modal-body p-1"},Mf={class:"row row-cols-1 row-cols-sm-3"},xf={class:"col"},Cf={class:"form-floating mb-2"},Vf=["value"],Pf={class:"col"},Of={class:"form-floating mb-2"},Af=["value"],Uf={class:"col"},Lf={class:"input-group mb-2"},Df={class:"form-floating"},Hf={class:"row row-cols-1 row-cols-sm-2 g-2"},Ef={class:"col-sm-4"},qf={class:"card"},Bf={key:0,class:"mt-2"},Nf={class:"col"},Rf={class:"form-floating mb-2"},Ff={class:"col ms-2 my-2"},zf={class:"badge bg-info me-1"},Gf={class:"badge bg-primary me-1"},jf={class:"row row-cols-1 row-cols-sm-2"},Yf={class:"col"},Wf={class:"form-floating mb-2"},Kf={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Qf={class:"col"},Jf={class:"form-floating mb-2"},Xf={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Zf={class:"col"},ep={class:"form-floating mb-2"},tp={class:"col-sm-8"},sp={class:"table-responsive border shadow-sm"},op={class:"table table-sm table-hover mb-0 overflow-auto"},ap=["textContent"],lp={class:"d-flex flex-row justify-content-start"},np={class:"mt-1"},rp=["src"],ip={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},dp={class:"ms-2"},up=["onClick"],cp={class:"modal-footer"},mp="/api/v1/vodSources/search",ft={__name:"_selectVodSource",emits:["close"],setup(a,{expose:g,emit:I}){const S=he().user,{appTitle:L,pageTitle:P,busy:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,security:x,filter:u,initializeFilter:J,getQuery:Q,saveQuery:c,search:y,getRowNumber:j,setSelected:f,isSelected:M}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select VOD Source",cacheKey:`${S==null?void 0:S.userId}/vodsources/select`,baseUrl:mp,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null}},initializeFilter:(k,$)=>{const E=k.value,_=new URLSearchParams(window.location.search),C=JSON.parse(localStorage.getItem($))||{};E.query.genre=_.get("genre")||C.genre||E.query.genre||0,E.query.category=_.get("category")||C.category||E.query.category||0},getQuery:k=>["?c=",encodeURIComponent(k.query.criteria),"&p=",k.pageIndex,"&s=",k.pageSize,"&sf=",k.sortField,"&so=",k.sortOrder,"&genre=",k.query.genreId,"&category=",k.query.categoryId,"&sourceLocationId=",k.query.sourceLocationId,"&withArn=true"].join(""),saveQuery:(k,$)=>{localStorage.setItem($,JSON.stringify({criteria:k.query.criteria,pageIndex:k.pageIndex,pageSize:k.pageSize,sortField:k.sortField,sortOrder:k.sortOrder,visible:k.visible,genre:k.query.genre,category:k.query.category}))}}),i=I,h=de("modalSelectVodSource"),d=be({vodSource:null,hls:null});me(async()=>{J(),await r()}),Ae(()=>{d.hls&&(d.hls.stopLoad(),d.hls.destroy())});const r=async()=>{await b(),await n()},p=async k=>{u.value.query.sourceLocationId=k,G.value="",await y();var $=document.getElementById(h.value),E=_e.getOrCreateInstance($);E.show()},l=async()=>{var k=document.getElementById(h.value),$=_e.getOrCreateInstance(k);$.hide(),d.hls&&(d.hls.stopLoad(),d.hls.destroy()),i("close",d.vodSource)},b=async k=>{try{const E=await B.get("/api/v1/lookups/video-categories/").then(_=>_.data);u.value.lookups.categories=E}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},n=async k=>{try{const E=await B.get("/api/v1/lookups/video-genres/").then(_=>_.data);u.value.lookups.genres=E}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},v=k=>{d.vodSource=k,w()},w=()=>{if(Hls.isSupported()){d.hls&&(d.hls.stopLoad(),d.hls.destroy());var k=document.getElementById("video-select-preview");const E=d.vodSource.video.formats.find(C=>C.formatName==="HLS"),_=E.serverUrl+E.path;d.hls=U.createHlsStream(k,_)}};return g({open:p,close:l}),(k,$)=>{const E=te("m-pagination"),_=te("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:h.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",_f,[e("div",kf,[e("div",Sf,[e("h5",Tf,[$[10]||($[10]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:$[0]||($[0]=C=>l()),"aria-label":"Close"})]),e("div",If,[F(_,{errorMessage:o(G)},{default:z(()=>[e("div",Mf,[e("div",xf,[e("div",Cf,[R(e("select",{"onUpdate:modelValue":$[1]||($[1]=C=>o(u).query.categoryId=C),class:"form-select",id:"category"},[(t(!0),s(A,null,N(o(u).lookups.categories,C=>(t(),s("option",{value:C.id},m(C.name),9,Vf))),256))],512),[[ge,o(u).query.categoryId]]),$[11]||($[11]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",Pf,[e("div",Of,[R(e("select",{"onUpdate:modelValue":$[2]||($[2]=C=>o(u).query.genreId=C),class:"form-select",id:"genre"},[(t(!0),s(A,null,N(o(u).lookups.genres,C=>(t(),s("option",{value:C.id},m(C.name),9,Af))),256))],512),[[ge,o(u).query.genreId]]),$[12]||($[12]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",Uf,[e("div",Lf,[e("div",Df,[R(e("input",{"onUpdate:modelValue":$[3]||($[3]=C=>o(u).query.criteria=C),onKeyup:$[4]||($[4]=Ue(C=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[X,o(u).query.criteria]]),$[13]||($[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:$[5]||($[5]=C=>o(y)(1))},$[14]||($[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",Hf,[e("div",Ef,[e("div",qf,[$[19]||($[19]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),d.vodSource?(t(),s("div",Bf,[e("div",Nf,[e("div",Rf,[R(e("input",{"onUpdate:modelValue":$[6]||($[6]=C=>d.vodSource.video.title=C),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[X,d.vodSource.video.title]]),$[15]||($[15]=e("label",{for:"title"},"Title",-1))])]),e("div",Ff,[e("div",null,[(t(!0),s(A,null,N(d.vodSource.video.genres,C=>(t(),s("span",zf,m(C.genreName),1))),256)),(t(!0),s(A,null,N(d.vodSource.video.categories,C=>(t(),s("span",Gf,m(C.categoryName),1))),256))])]),e("div",jf,[e("div",Yf,[e("div",Wf,[e("div",Kf,m(o(U).moment(d.vodSource.video.dateReleased).calendar()),1),$[16]||($[16]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Qf,[e("div",Jf,[e("div",Xf,m(o(U).moment.utc(d.vodSource.video.durationInMillis).format("HH:mm:ss")),1),$[17]||($[17]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Zf,[e("div",ep,[R(e("textarea",{"onUpdate:modelValue":$[7]||($[7]=C=>d.vodSource.video.description=C),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[X,d.vodSource.video.description]]),$[18]||($[18]=e("label",{for:"description"},"Description",-1))])])])):H("",!0)])]),e("div",tp,[e("div",sp,[e("table",op,[$[20]||($[20]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(u).items,(C,re)=>(t(),s("tr",{key:C.videoId},[e("td",{textContent:m(o(j)(re)),class:"text-center"},null,8,ap),e("td",null,[e("div",lp,[e("div",null,[C.video.thumbnails.length>0?(t(!0),s(A,{key:0},N(C.video.thumbnails,fe=>(t(),s("div",np,[e("img",{src:fe.url,class:"img-fuild border",width:"128"},null,8,rp)]))),256)):(t(),s("img",ip))]),e("div",dp,[e("a",{onClick:fe=>v(C),class:"text-wrap link-offset-2",role:"button"},m(C.name),9,up)])])])]))),128))]),_:1},512),[[Se,o(u).items.length>0]])])]),F(E,{filter:o(u),search:o(y),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",cp,[e("button",{onClick:$[8]||($[8]=C=>l()),class:"btn btn-primary",type:"button"},$[21]||($[21]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:$[9]||($[9]=C=>l()),class:"btn btn-secondary ms-1"},$[22]||($[22]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,hf)}}},fp=["disabled"],pp={class:"container1"},vp={class:"row"},gp={class:"col-12 col-lg-6"},bp={class:"col"},yp={class:"form-floating mb-2"},$p=["value"],wp={key:0,class:"d-block invalid-feedback"},hp={class:"col"},_p={class:"input-group mb-2"},kp={class:"form-floating"},Sp={id:"selectedVodSource",class:"form-control",placeholder:"Title"},Tp={class:"col-12 col-lg-6"},Ip={class:"col"},Mp={class:"form-floating mb-2"},xp={key:0,class:"d-block invalid-feedback"},Cp={class:"row row-cols-1 row-cols-sm-3 mt-2"},Vp={class:"col"},Pp={class:"form-floating mb-2"},Op={key:0},Ap={key:1},Up={key:2},Lp={key:3,class:"d-block invalid-feedback"},Dp={class:"col"},Hp={class:"form-floating mb-2"},Ep={key:0},qp={key:1},Bp={key:2,class:"d-block invalid-feedback"},Np={class:"col"},Rp={class:"form-floating mb-2"},Fp={key:0,class:"mt-3"},zp={class:"table-responsive border mt-1"},Gp={class:"table table-borderless table-sm mb-0 align-middle"},jp={class:"text-center"},Yp=["onUpdate:modelValue","onChange"],Wp={key:0},Kp=["onUpdate:modelValue","onChange"],Qp={class:"text-start"},Jp=["onClick"],Xp={class:"col mt-2"},Zp={class:"row row-cols-1 row-cols-sm-2"},ev={class:"col"},tv={class:"form-floating mb-2"},sv={class:"col"},ov={class:"form-floating mb-2"},av={__name:"add",props:{urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Program Template"}),U=a,O=de(),x=be({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{vodSource:null},startOffsetTime:"00:00:00",endOffsetTime:"00:00:00",item:{name:"program_template_",sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},hls:null}),u={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("sourceLocationId is required.",ae),$autoDirty:!0,$lazy:!0},vodSourceId:{required:se.withMessage("vodSourceId is required.",ae),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:se.withMessage("startOffsetMillis is required.",ae),minValue:Ne(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:se.withMessage("endOffsetMillis is required.",ae),minValue:Ne(0),$autoDirty:!0,$lazy:!0}}},J=Te(u,x),Q=Me(()=>{const _=D.moment;if(x.startOffsetTime&&x.startOffsetTime!=="00:00:00"&&D.isValidTime(x.startOffsetTime)){const C=_().startOf("day"),re=C.format("YYYY-MM-DD ")+x.startOffsetTime,ee=_(re).subtract(C);return x.item.startOffsetMillis=ee.valueOf(),x.item.startOffsetMillis}return 0}),c=Me(()=>{const _=D.moment;if(x.endOffsetTime&&x.endOffsetTime!=="00:00:00"&&D.isValidTime(x.endOffsetTime)){const C=_().startOf("day"),re=C.format("YYYY-MM-DD ")+x.endOffsetTime,ee=_(re).subtract(C);return x.item.endOffsetMillis=ee.valueOf(),x.item.endOffsetMillis}return 0}),y=Me(()=>x.item.endOffsetMillis-x.item.startOffsetMillis),j=Me(()=>D.moment.utc(y.value).format("HH:mm:ss")),f=Me(()=>{const _=x.item.adBreaks;return _&&_.length>0?_.reduce((re,fe,ee)=>re+fe.durationInMillis,0):0}),M=Me(()=>{const _=y.value+f.value;return D.moment.utc(_).format("HH:mm:ss")}),i=Me(()=>D.moment.utc(f.value).format("HH:mm:ss"));me(async()=>{await h()}),Ae(()=>{x.hls&&(x.hls.stopLoad(),x.hls.destroy())});const h=async()=>{await d(),await l()},d=async()=>{try{await Y.get("/api/v1/sourcelocations/lookup/").then(C=>{x.lookups.sourceLocations=C.data,x.lookups.sourceLocations.length===1&&(x.item.sourceLocationId=x.lookups.sourceLocations[0].id)}),x.item.sourceLocationId&&await r(x.item.sourceLocationId)}catch(_){P.value=D.getErrorMessageAsHtml(_),window.scrollTo(0,0)}finally{}},r=async _=>{try{const C=`/api/v1/vodSources/lookup/source-location/${_}/?category=3`;await Y.get(C).then(re=>{x.lookups.vodSources=re.data})}catch(C){P.value=D.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{}},p=async _=>{try{let C=`/api/v1/vodSources/${_}/blank-frames`;const re=await Y.get(C).then(fe=>fe.data);x.item.adBreaks=[],re&&re.length>0&&(x.item.adBreaks=re.map(fe=>{const ee=(fe.endInMillis-fe.startInMillis)/2+fe.startInMillis;return{offsetTime:D.moment.utc(ee).format("HH:mm:ss"),offsetMillis:ee,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch(C){P.value=D.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{}},l=async()=>{try{await Y.get("/api/v1/sourcelocations/lookup/").then(C=>{x.lookups.adBreakSourceLocations=C.data})}catch(_){P.value=D.getErrorMessageAsHtml(_),window.scrollTo(0,0)}finally{}},b=()=>{const _={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};x.item.adBreaks.push(_)},n=_=>{x.item.adBreaks.splice(_,1)},v=_=>{const C=D.moment,re=C().startOf("day"),fe=re.format("YYYY-MM-DD ")+_.offsetTime,T=C(fe).subtract(re);_.offsetMillis=T.valueOf()},w=_=>{const C=D.moment,re=C().startOf("day"),fe=re.format("YYYY-MM-DD ")+_.durationTime,T=C(fe).subtract(re);_.durationInMillis=T.valueOf()},k=async()=>{const _=x;if(V.value)return;if(!await J.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const re=D.clone(_.item),fe=re.adBreaks.filter(ee=>ee.durationInMillis>0);re.adBreaks=fe,await Y.post("/api/v1/programtemplates/",re).then(ee=>{G.success("Add Program Template","Program template added.",{onClose:async()=>{const T=`${U.urlView}/${ee.data}`;await W.push(T)}})})}catch(re){P.value=D.getErrorMessageAsHtml(re),window.scrollTo(0,0)}finally{V.value=!1}},$=async _=>{_&&(x.selected.vodSource=_,x.item.vodSourceId=_.vodSourceId,x.endOffsetTime=D.moment.utc(_.video.durationInMillis).format("HH:mm:ss"),await p(_.vodSourceId),E())},E=()=>{if(Hls.isSupported()){x.hls&&(x.hls.stopLoad(),x.hls.destroy());var _=document.getElementById("video-add-program-template");const re=x.selected.vodSource.video.formats.find(ee=>ee.formatName==="HLS"),fe=re.serverUrl+re.path;x.hls=D.createHlsStream(_,fe)}};return(_,C)=>{const re=te("router-link"),fe=te("PageHeader"),ee=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(fe,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(J).$dirty&&o(J).$invalid,onClick:C[0]||(C[0]=T=>k()),class:"btn btn-primary"},C[10]||(C[10]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,fp),F(re,{to:U.urlMain,class:"btn btn-secondary ms-2"},{default:z(()=>C[11]||(C[11]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(ee,{errorMessage:o(P),vuelidate:o(J)},{default:z(()=>[e("div",null,[e("div",pp,[e("div",vp,[e("div",gp,[e("div",bp,[e("div",yp,[R(e("select",{"onUpdate:modelValue":C[1]||(C[1]=T=>x.item.sourceLocationId=T),onChange:C[2]||(C[2]=T=>r(x.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,N(x.lookups.sourceLocations,T=>(t(),s("option",{value:T.id},m(T.name),9,$p))),256))],544),[[ge,x.item.sourceLocationId]]),C[12]||(C[12]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(J).item.sourceLocationId.$error?(t(),s("div",wp,[(t(!0),s(A,null,N(o(J).item.sourceLocationId.$errors,T=>(t(),s("div",{key:T.$uid},m(T.$message),1))),128))])):H("",!0)])]),e("div",hp,[e("div",_p,[e("div",kp,[e("div",Sp,[x.selected.vodSource?(t(),s(A,{key:0},[K(" ["+m(o(D).moment.utc(x.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+m(x.selected.vodSource.name),1)],64)):H("",!0)]),C[13]||(C[13]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),e("button",{onClick:C[3]||(C[3]=T=>O.value.open(x.sourceLocationId)),class:"btn btn-primary",type:"button"},C[14]||(C[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),C[15]||(C[15]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program-template",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Tp,[e("div",Ip,[e("div",Mp,[R(e("input",{"onUpdate:modelValue":C[4]||(C[4]=T=>x.item.name=T),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,x.item.name]]),C[16]||(C[16]=e("label",{for:"name",class:""},"Name",-1)),o(J).item.name.$error?(t(),s("div",xp,[(t(!0),s(A,null,N(o(J).item.name.$errors,T=>(t(),s("div",{key:T.$uid},m(T.$message),1))),128))])):H("",!0)])]),e("div",Cp,[e("div",Vp,[e("div",null,[e("div",Pp,[R(e("input",{"onUpdate:modelValue":C[5]||(C[5]=T=>x.startOffsetTime=T),type:"time",step:"1",id:"startOffsetTime",class:"form-control"},null,512),[[X,x.startOffsetTime]]),C[17]||(C[17]=e("label",{for:"startOffsetTime",class:""}," Start OffSet Time ",-1))]),Q.value>0&&Q.value<3e4?(t(),s("div",Op,C[18]||(C[18]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):H("",!0),Q.value>c.value&&c.value>0?(t(),s("div",Ap,C[19]||(C[19]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):H("",!0),x.selected.vodSource&&Q.value>=x.selected.vodSource.durationInMillis?(t(),s("div",Up,C[20]||(C[20]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):H("",!0),o(J).item.startOffsetMillis.$error?(t(),s("div",Lp,[(t(!0),s(A,null,N(o(J).item.startOffsetMillis.$errors,T=>(t(),s("div",{key:T.$uid},m(T.$message),1))),128))])):H("",!0)])]),e("div",Dp,[e("div",null,[e("div",Hp,[R(e("input",{"onUpdate:modelValue":C[6]||(C[6]=T=>x.endOffsetTime=T),type:"time",step:"1",id:"endOffsetTime",class:"form-control"},null,512),[[X,x.endOffsetTime]]),C[21]||(C[21]=e("label",{for:"endOffsetTime",class:""}," End OffSet Time ",-1))]),c.value>0&&c.value<3e4?(t(),s("div",Ep,C[22]||(C[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):H("",!0),x.selected.vodSource&&c.value>x.selected.vodSource.durationInMillis?(t(),s("div",qp,C[23]||(C[23]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):H("",!0),o(J).item.endOffsetMillis.$error?(t(),s("div",Bp,[(t(!0),s(A,null,N(o(J).item.endOffsetMillis.$errors,T=>(t(),s("div",{key:T.$uid},m(T.$message),1))),128))])):H("",!0)])]),e("div",Np,[e("div",Rp,[R(e("input",{"onUpdate:modelValue":C[7]||(C[7]=T=>j.value=T),type:"text",class:"form-control",id:"durationTime",readonly:""},null,512),[[X,j.value]]),C[24]||(C[24]=e("label",{for:"durationTime"},"Clip",-1))])])]),x.item.vodSourceId?(t(),s("div",Fp,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[C[26]||(C[26]=e("div",{class:"fw-bold small"}," Ad Break ",-1)),e("div",null,[e("button",{onClick:b,class:"btn btn-outline-primary btn-sm"},C[25]||(C[25]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",zp,[e("table",Gp,[C[29]||(C[29]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(x.item.adBreaks,(T,ue)=>(t(),s("tr",null,[e("td",jp,m(ue+1),1),e("td",null,[R(e("input",{"onUpdate:modelValue":oe=>T.offsetTime=oe,onChange:oe=>v(T),type:"time",step:"1",class:"form-control"},null,40,Yp),[[X,T.offsetTime]]),T.offsetMillis>=x.selected.vodSource.durationInMillis?(t(),s("div",Wp,C[27]||(C[27]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):H("",!0)]),e("td",null,[R(e("input",{"onUpdate:modelValue":oe=>T.durationTime=oe,onChange:oe=>w(T),type:"time",step:"1",class:"form-control"},null,40,Kp),[[X,T.durationTime]])]),e("td",Qp,[e("button",{onClick:oe=>n(ue),class:"btn btn-outline-warning btn-sm"},C[28]||(C[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Jp)])]))),256))])]),C[30]||(C[30]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),K(" Vod source will be defined in Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):H("",!0),e("div",Xp,[C[33]||(C[33]=e("div",{class:"fw-bold small"}," Duration ",-1)),e("div",Zp,[e("div",ev,[e("div",tv,[R(e("input",{"onUpdate:modelValue":C[8]||(C[8]=T=>i.value=T),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[X,i.value]]),C[31]||(C[31]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",sv,[e("div",ov,[R(e("input",{"onUpdate:modelValue":C[9]||(C[9]=T=>M.value=T),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[X,M.value]]),C[32]||(C[32]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"]),F(ft,{ref_key:"modalSelectVodSource",ref:O,onClose:$},null,512)])]),_:1})}}},lv=["disabled"],nv={class:"container1"},rv={class:"row"},iv={class:"col-12 col-lg-6"},dv={class:"col"},uv={class:"form-floating mb-2"},cv=["value"],mv={key:0,class:"d-block invalid-feedback"},fv={class:"col"},pv={class:"input-group mb-2"},vv={class:"form-floating"},gv={id:"selectedVodSource",class:"form-control",placeholder:"Title"},bv={class:"col-12 col-lg-6"},yv={class:"col"},$v={class:"form-floating mb-2"},wv={key:0,class:"d-block invalid-feedback"},hv={class:"row row-cols- row-cols-sm-3"},_v={class:"col"},kv={class:"form-floating mb-2"},Sv={key:0},Tv={key:1},Iv={key:2},Mv={key:3,class:"d-block invalid-feedback"},xv={class:"col"},Cv={class:"form-floating"},Vv={key:0},Pv={key:1},Ov={key:2,class:"d-block invalid-feedback"},Av={class:"col"},Uv={class:"form-floating mb-2"},Lv={key:0,class:"mt-2"},Dv={class:"table-responsive border mt-1"},Hv={class:"table table-borderless table-sm mb-0 align-middle"},Ev=["onUpdate:modelValue","onChange"],qv={key:0},Bv=["onUpdate:modelValue","onChange"],Nv=["onClick"],Rv={class:"col mt-2"},Fv={class:"row row-cols-1 row-cols-sm-2"},zv={class:"col"},Gv={class:"form-floating mb-2"},jv={class:"col"},Yv={class:"form-floating mb-2"},Wv={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,closeWithReturnUrl:B,security:U}=we({appTitle:"Arcadian-FAST",pageTitle:"Edit Program Template"}),O=a,x=de(),u=be({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{sourceLocation:null,vodSource:null},startOffsetTime:"00:00:00",endOffsetTime:"00:00:00",item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),J={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("sourceLocationId is required.",ae),$autoDirty:!0,$lazy:!0},vodSourceId:{required:se.withMessage("vodSourceId is required.",ae),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:se.withMessage("startOffsetMillis is required.",ae),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:se.withMessage("endOffsetMillis is required.",ae),$autoDirty:!0,$lazy:!0}}},Q=Te(J,u),c=Me(()=>{if(u.startOffsetTime&&u.startOffsetTime!=="00:00:00"&&D.isValidTime(u.startOffsetTime)){const ee=D.moment,T=ee().startOf("day"),oe=ee(u.startOffsetTime,"hh:mm:ss").diff(T);return u.item.startOffsetMillis=oe.valueOf(),u.item.startOffsetMillis}return 0}),y=Me(()=>{if(u.endOffsetTime&&u.endOffsetTime!=="00:00:00"&&D.isValidTime(u.endOffsetTime)){const ee=D.moment,T=ee().startOf("day"),oe=ee(u.endOffsetTime,"hh:mm:ss").diff(T);return u.item.endOffsetMillis=oe.valueOf(),u.item.endOffsetMillis}return 0}),j=Me(()=>u.item.endOffsetMillis-u.item.startOffsetMillis),f=Me(()=>D.moment.utc(j.value).format("HH:mm:ss")),M=Me(()=>{const ee=u.item.adBreaks;return ee&&ee.length>0?ee.reduce((ue,oe,ne)=>ue+oe.durationInMillis,0):0}),i=Me(()=>{const ee=j.value+M.value;return D.moment.utc(ee).format("HH:mm:ss")}),h=Me(()=>D.moment.utc(M.value).format("HH:mm:ss"));me(async()=>{await d()});const d=async()=>{await r(),await p(),await l()},r=async()=>{try{const ee=`/api/v1/programtemplates/${O.id}/`;await Y.get(ee).then(T=>{u.item=T.data}),u.startOffsetTime=D.moment.utc(u.item.startOffsetMillis).format("HH:mm:ss"),u.endOffsetTime=D.moment.utc(u.item.endOffsetMillis).format("HH:mm:ss"),u.item.adBreaks.forEach(T=>{T.offsetTime=D.moment.utc(T.offsetMillis).format("HH:mm:ss"),T.durationTime=D.moment.utc(T.durationInMillis).format("HH:mm:ss")})}catch(ee){P.value=D.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},p=async()=>{try{const ee=`/api/v1/vodSources/${u.item.vodSourceId}/`;await Y.get(ee).then(T=>{u.selected.vodSource=T.data}),re()}catch(ee){P.value=D.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},l=async()=>{await b()},b=async()=>{try{await Y.get("/api/v1/sourcelocations/lookup/").then(T=>{u.lookups.sourceLocations=T.data}),u.item.sourceLocationId&&await n(u.item.sourceLocationId)}catch(ee){P.value=D.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},n=async ee=>{try{const T=`/api/v1/vodSources/lookup/source-location/${ee}/?type=3`;await Y.get(T).then(ue=>{u.lookups.vodSources=ue.data})}catch(T){P.value=D.getErrorMessageAsHtml(T),window.scrollTo(0,0)}finally{}},v=async()=>{const ee=u.selected.vodSource;ee&&(u.startOffsetTime=D.moment.utc(0).format("HH:mm:ss"),u.endOffsetTime=D.moment.utc(ee.video.durationInMillis).format("HH:mm:ss"),u.item.vodSourceId=ee.vodSourceId)},w=()=>{const ee={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};u.item.adBreaks.push(ee)},k=ee=>{u.item.adBreaks.splice(ee,1)},$=ee=>{const T=D.moment,ue=T().startOf("day"),oe=ue.format("YYYY-MM-DD ")+ee.offsetTime,pe=T(oe).subtract(ue);ee.offsetMillis=pe.valueOf()},E=ee=>{const T=D.moment,ue=T().startOf("day"),oe=ue.format("YYYY-MM-DD ")+ee.durationTime,pe=T(oe).subtract(ue);ee.durationInMillis=pe.valueOf()},_=async()=>{const ee=u;if(V.value)return;if(!await Q.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const ue=D.clone(ee.item);debugger;ue.startOffsetMillis=c.value,ue.endOffsetMillis=y.value,await Y.put("/api/v1/programtemplates/",ue).then(oe=>{G.success("Edit Program Template","Program template edit.",{onClose:async()=>{const ne=`${O.urlView}/${O.id}`;await W.push(ne)}})})}catch(ue){P.value=D.getErrorMessageAsHtml(ue),window.scrollTo(0,0)}finally{V.value=!1}},C=async ee=>{if(ee){u.selected.vodSource=ee,u.item.vodSourceId=ee.vodSourceId,v();debugger;await fe(ee.vodSourceId),re()}},re=()=>{if(Hls.isSupported()){u.hls&&(u.hls.stopLoad(),u.hls.destroy());var ee=document.getElementById("video-edit-program-template");const ue=u.selected.vodSource.video.formats.find(ne=>ne.formatName==="HLS"),oe=ue.serverUrl+ue.path;u.hls=D.createHlsStream(ee,oe)}},fe=async ee=>{try{let T=`/api/v1/vodSources/${ee}/blank-frames`;const ue=await Y.get(T).then(oe=>oe.data);u.item.adBreaks=[],ue&&ue.length>0&&(u.item.adBreaks=ue.map(oe=>{const ne=(oe.endInMillis-oe.startInMillis)/2+oe.startInMillis;return{offsetTime:D.moment.utc(ne).format("HH:mm:ss"),offsetMillis:ne,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch(T){P.value=D.getErrorMessageAsHtml(T),window.scrollTo(0,0)}finally{}};return(ee,T)=>{const ue=te("PageHeader"),oe=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(ue,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(Q).$dirty&&o(Q).$invalid,onClick:T[0]||(T[0]=ne=>_()),class:"btn btn-primary"},T[12]||(T[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,lv),e("button",{onClick:T[1]||(T[1]=ne=>d()),class:"btn btn-secondary ms-2"},T[13]||(T[13]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:T[2]||(T[2]=ne=>o(B)(O.urlMain)),class:"btn btn-secondary ms-1"},T[14]||(T[14]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(oe,{errorMessage:o(P),vuelidate:o(Q)},{default:z(()=>[e("div",null,[e("div",nv,[e("div",rv,[e("div",iv,[e("div",dv,[e("div",uv,[R(e("select",{"onUpdate:modelValue":T[3]||(T[3]=ne=>u.item.sourceLocationId=ne),onChange:T[4]||(T[4]=ne=>n(u.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,N(u.lookups.sourceLocations,ne=>(t(),s("option",{value:ne.id},m(ne.name),9,cv))),256))],544),[[ge,u.item.sourceLocationId]]),T[15]||(T[15]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(Q).item.sourceLocationId.$error?(t(),s("div",mv,[(t(!0),s(A,null,N(o(Q).item.sourceLocationId.$errors,ne=>(t(),s("div",{key:ne.$uid},m(ne.$message),1))),128))])):H("",!0)])]),e("div",fv,[e("div",pv,[e("div",vv,[e("div",gv,[u.selected.vodSource?(t(),s(A,{key:0},[K(" ["+m(o(D).moment.utc(u.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+m(u.selected.vodSource.name),1)],64)):H("",!0)]),T[16]||(T[16]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),e("button",{onClick:T[5]||(T[5]=ne=>x.value.open(u.sourceLocationId)),class:"btn btn-primary",type:"button"},T[17]||(T[17]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),T[18]||(T[18]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-edit-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",bv,[e("div",yv,[e("div",$v,[R(e("input",{"onUpdate:modelValue":T[6]||(T[6]=ne=>u.item.name=ne),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,u.item.name]]),T[19]||(T[19]=e("label",{for:"name",class:""},"Name",-1)),o(Q).item.name.$error?(t(),s("div",wv,[(t(!0),s(A,null,N(o(Q).item.name.$errors,ne=>(t(),s("div",{key:ne.$uid},m(ne.$message),1))),128))])):H("",!0)])]),e("div",hv,[e("div",_v,[e("div",kv,[R(e("input",{"onUpdate:modelValue":T[7]||(T[7]=ne=>u.startOffsetTime=ne),type:"time",step:"1",id:"startOffsetTime",class:"form-control"},null,512),[[X,u.startOffsetTime]]),T[20]||(T[20]=e("label",{for:"startOffsetTime",class:""},"Start OffSet Time",-1))]),c.value>0&&c.value<3e4?(t(),s("div",Sv,T[21]||(T[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):H("",!0),c.value>y.value&&y.value>0?(t(),s("div",Tv,T[22]||(T[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):H("",!0),u.selected.vodSource&&c.value>=u.selected.vodSource.durationInMillis?(t(),s("div",Iv,T[23]||(T[23]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):H("",!0),o(Q).item.startOffsetMillis.$error?(t(),s("div",Mv,[(t(!0),s(A,null,N(o(Q).item.startOffsetMillis.$errors,ne=>(t(),s("div",{key:ne.$uid},m(ne.$message),1))),128))])):H("",!0)]),e("div",xv,[e("div",Cv,[R(e("input",{"onUpdate:modelValue":T[8]||(T[8]=ne=>u.endOffsetTime=ne),type:"time",step:"1",id:"endOffsetTime",class:"form-control"},null,512),[[X,u.endOffsetTime]]),T[24]||(T[24]=e("label",{for:"endOffsetTime",class:""},"End OffSet Time",-1))]),y.value>0&&y.value<3e4?(t(),s("div",Vv,T[25]||(T[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):H("",!0),u.selected.vodSource&&y.value>u.selected.vodSource.durationInMillis?(t(),s("div",Pv,T[26]||(T[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):H("",!0),o(Q).item.endOffsetMillis.$error?(t(),s("div",Ov,[(t(!0),s(A,null,N(o(Q).item.endOffsetMillis.$errors,ne=>(t(),s("div",{key:ne.$uid},m(ne.$message),1))),128))])):H("",!0)]),e("div",Av,[e("div",Uv,[R(e("input",{"onUpdate:modelValue":T[9]||(T[9]=ne=>f.value=ne),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[X,f.value]]),T[27]||(T[27]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),u.selected.vodSource?(t(),s("div",Lv,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[T[29]||(T[29]=e("b",null," Ad Break ",-1)),e("div",null,[e("button",{onClick:w,class:"btn btn-outline-primary btn-sm"},T[28]||(T[28]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",Dv,[e("table",Hv,[T[32]||(T[32]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(u.item.adBreaks,(ne,pe)=>(t(),s("tr",null,[e("td",null,m(pe+1),1),e("td",null,[R(e("input",{"onUpdate:modelValue":xe=>ne.offsetTime=xe,onChange:xe=>$(ne),type:"time",step:"1",class:"form-control"},null,40,Ev),[[X,ne.offsetTime]]),ne.offsetMillis>=u.selected.vodSource.durationInMillis?(t(),s("div",qv,T[30]||(T[30]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):H("",!0)]),e("td",null,[R(e("input",{"onUpdate:modelValue":xe=>ne.durationTime=xe,onChange:xe=>E(ne),type:"time",step:"1",class:"form-control"},null,40,Bv),[[X,ne.durationTime]])]),e("td",null,[e("button",{onClick:xe=>k(pe),class:"btn btn-outline-warning btn-sm"},T[31]||(T[31]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Nv)])]))),256))])]),T[33]||(T[33]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),K(" Vod source will be defined in Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):H("",!0),e("div",Rv,[T[36]||(T[36]=e("b",null," Duration ",-1)),e("div",Fv,[e("div",zv,[e("div",Gv,[R(e("input",{"onUpdate:modelValue":T[10]||(T[10]=ne=>h.value=ne),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[X,h.value]]),T[34]||(T[34]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",jv,[e("div",Yv,[R(e("input",{"onUpdate:modelValue":T[11]||(T[11]=ne=>i.value=ne),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[X,i.value]]),T[35]||(T[35]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"]),F(ft,{ref_key:"modalSelectVodSource",ref:x,onClose:C},null,512)])]),_:1})}}},Kv={class:"ms-1"},Qv={class:"input-group"},Jv={class:"table-responsive border shadow-sm"},Xv={class:"table table-hover mb-0"},Zv=["textContent"],eg={class:"d-flex flex-row"},tg={class:""},sg={class:"mb-1"},og=["src"],ag={class:"ms-2"},lg={key:0,class:"fas fa-fw fa-check-circle text-success"},ng={class:"text-wrap text-truncate",style:{width:"20px !important"}},rg={class:"badge bg-primary me-1"},ig={key:0},dg={class:"badge bg-info me-1"},ug={class:"text-end me-0 me-sm-5"},cg={class:"text-center"},mg={class:"mt-1"},fg="/api/v1/programTemplates/search",pg={__name:"index",props:{urlAdd:{type:String,default:"/program-templates/add"},urlView:{type:String,default:"/program-templates/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(a){Ce("$config");const I=he().user,{appTitle:V,pageTitle:S,busy:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,generateReturnUrl:O,security:x,filter:u,initializeFilter:J,getQuery:Q,saveQuery:c,search:y,getRowNumber:j,setSelected:f,isSelected:M}=Le({appTitle:"Arcadian-FAST",pageTitle:"Program Templates",cacheKey:`${I==null?void 0:I.userId}/program-templates/search`,baseUrl:fg,filter:{updateUrl:!0}});return me(async()=>{J(),await y()}),(i,h)=>{const d=te("router-link"),r=te("PageHeader"),p=te("m-pagination"),l=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(r,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(S)},{default:z(()=>[F(d,{to:a.urlAdd,class:"btn btn-primary"},{default:z(()=>h[3]||(h[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Kv,[e("div",Qv,[R(e("input",{"onUpdate:modelValue":h[0]||(h[0]=b=>o(u).query.criteria=b),onKeyup:h[1]||(h[1]=Ue(b=>o(y)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[X,o(u).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:h[2]||(h[2]=b=>o(y)(1))},h[4]||(h[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(l,{errorMessage:o(Y)},{default:z(()=>[e("div",Jv,[e("table",Xv,[h[5]||(h[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th",null,"Source")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(u).items,(b,n)=>(t(),s("tr",{key:b.programTemplateId},[e("td",{textContent:m(o(j)(n)),class:"text-center"},null,8,Zv),e("td",null,[e("div",eg,[e("div",tg,[b.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},N(b.vodSource.video.thumbnails,v=>(t(),s("div",sg,[e("img",{src:v.url,class:"img-fuild border",width:"128"},null,8,og)]))),256)):H("",!0)]),e("div",ag,[F(d,{to:`${a.urlView}/${b.programTemplateId}`,class:"d-inline-block text-truncate link-offset-2"},{default:z(()=>[b.arn?(t(),s("span",lg)):H("",!0),e("span",ng,m(b.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(A,null,N(b.vodSource.video.categories,v=>(t(),s("div",null,[e("span",rg,m(v.categoryName),1)]))),256)),b.vodSource.video.genres.length>0?(t(),s("div",ig,[(t(!0),s(A,null,N(b.vodSource.video.genres,v=>(t(),s("span",dg,m(v.genreName),1))),256))])):H("",!0)])])])]),e("td",ug,m(o(Z).moment.utc(b.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",cg,m(b.adBreaks.length),1),e("td",null,[e("div",null,[F(d,{to:`${a.urlViewSourceLocation}/${b.sourceLocationId}/${o(O)()}`,class:"link-offset-2"},{default:z(()=>[K(m(b.sourceLocation.name),1)]),_:2},1032,["to"])]),e("div",mg,[F(d,{to:`${a.urlViewVodSource}/${b.vodSourceId}/${o(O)()}`,class:"link-offset-2"},{default:z(()=>[K(m(b.vodSource.name),1)]),_:2},1032,["to"])])])]))),128))]),_:1},512),[[Se,o(u).items.length>0]])])]),F(p,{filter:o(u),search:o(y),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},vg={key:0},gg={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},bg={class:"nav-item",role:"presentation"},yg={class:"nav-item",role:"presentation"},$g={class:"nav-item d-none",role:"presentation"},wg={class:"tab-content",id:"myTabContent"},hg={class:"mt-2"},_g={class:""},kg={class:"row row-cols-1 row-cols-lg-2"},Sg={class:"col"},Tg={class:"col"},Ig={class:"form-floating mb-2"},Mg={id:"sourceLocation",class:"form-control-plaintext"},xg={class:"col"},Cg={class:"form-floating mb-2"},Vg={id:"vodSource",class:"form-control-plaintext"},Pg={class:"col"},Og={class:"col"},Ag={class:"form-floating mb-2"},Ug={class:"row row-cols-1 row-cols-sm-3"},Lg={class:"col"},Dg={class:"form-floating mb-2"},Hg={class:"col"},Eg={class:"form-floating mb-2"},qg={class:"col"},Bg={class:"form-floating mb-2"},Ng={class:"row row-cols-1 row-cols-sm-3"},Rg={class:"col"},Fg={class:"form-floating mb-2"},zg={class:"col"},Gg={class:"form-floating mb-2"},jg={class:"mt-2"},Yg={class:"table-responsive"},Wg={class:"table table-hover mb-0"},Kg={class:"text-center"},Qg={class:"mt-2"},Jg={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/program-templates"},urlEdit:{type:String,default:"/program-templates/edit"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(a){const g=a,{appTitle:I,pageTitle:V,busy:S,isDirty:L,validations:P,infoMessage:W,warningMessage:Y,errorMessage:D,router:G,axios:Z,utils:B,toasts:U,close:O,closeWithReturnUrl:x,generateReturnUrl:u,security:J}=we({appTitle:"Arcadian-FAST",pageTitle:"View Program Template"});Ce("$config");const Q=he();Q.user;const c=be({user:Q.user,item:null,hls:null}),y=de();me(async()=>{await i(),y.value=B.getPageTab("programTemplate")||"information-tab"});const j=r=>{B.setPageTab("programTemplate",r),y.value=r},f=r=>r!==y.value?"":"active",M=r=>r!==y.value?"":"show active",i=async()=>{const r=c;if(!S.value)try{S.value=!0,D.value="",c.item=null;const p=`/api/v1/programTemplates/${g.id}/`;await Z.get(p).then(l=>{r.item=l.data;const b=r.item;b.startOffsetTime=B.moment.utc(b.startOffsetMillis).format("HH:mm:ss"),b.endOffsetTime=B.moment.utc(b.endOffsetMillis).format("HH:mm:ss"),b.durationTime=B.moment.utc(b.durationInMillis).format("HH:mm:ss"),b.adBreaksDurationTime=B.moment.utc(b.adBreaksDurationInMillis).format("HH:mm:ss"),b.totalProgramTemplateDurationTime=B.moment.utc(b.totalProgramTemplateDurationInMillis).format("HH:mm:ss");const n=b.vodSource.video,v=n.durationInMillis;n.durationInMillis=B.moment.utc(v).format("HH:mm:ss")}),c.item.vodSource&&await d(c.item.vodSourceId)}catch(p){D.value=B.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{S.value=!1}},h=async()=>{await i()},d=async r=>{try{let p=`/api/v1/vodSources/${r}/hls`;const l=await Z.get(p).then(n=>n.data);c.hls&&c.hls.destroy();const b=document.getElementById("video-view-program-template");c.hls=B.createHlsStream(b,l,"Previewing VOD.")}catch(p){D.value=B.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}};return(r,p)=>{const l=te("router-link"),b=te("PageHeader"),n=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(b,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(V)},{default:z(()=>[F(l,{to:`${a.urlEdit}/${a.id}/${o(u)()}`,class:"ms-2 btn btn-primary"},{default:z(()=>p[11]||(p[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:p[0]||(p[0]=v=>h()),class:"ms-2 btn btn-secondary"},p[12]||(p[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:p[1]||(p[1]=v=>o(x)(g.urlMain)),class:"btn btn-secondary ms-1"},p[13]||(p[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(n,{errorMessage:o(D)},{default:z(()=>[c.item?(t(),s("div",vg,[e("div",null,[e("ul",gg,[e("li",bg,[e("button",{onClick:p[2]||(p[2]=v=>j("information-tab")),class:le([f("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",yg,[e("button",{onClick:p[3]||(p[3]=v=>j("adBreaks-tab")),class:le([f("adBreaks-tab"),"nav-link"]),id:"adBreaks-tab","data-bs-toggle":"tab","data-bs-target":"#adBreaks",type:"button",role:"tab","aria-controls":"adBreaks","aria-selected":"false"}," Ad Breaks ",2)]),e("li",$g,[e("button",{onClick:p[4]||(p[4]=v=>j("programs-tab")),class:le([f("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",wg,[e("div",{class:le([M("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",hg,[e("div",_g,[e("div",kg,[e("div",Sg,[e("div",Tg,[e("div",Ig,[e("div",Mg,[F(l,{to:`${a.urlViewSourceLocation}/${c.item.sourceLocationId}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(c.item.sourceLocation.name),1)]),_:1},8,["to"])]),p[14]||(p[14]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",xg,[e("div",Cg,[e("div",Vg,[F(l,{to:`${a.urlViewVodSource}/${c.item.vodSourceId}/${o(u)()}`,class:"link-offset-2"},{default:z(()=>[K(m(c.item.vodSource.name),1)]),_:1},8,["to"])]),p[15]||(p[15]=e("label",{for:"vodSource",class:""},"VOD Name",-1))])]),p[16]||(p[16]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-view-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",Pg,[e("div",Og,[e("div",Ag,[R(e("input",{"onUpdate:modelValue":p[5]||(p[5]=v=>c.item.name=v),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[X,c.item.name]]),p[17]||(p[17]=e("label",{for:"name",class:""},"Name",-1))])]),e("div",Ug,[e("div",Lg,[e("div",Dg,[R(e("input",{"onUpdate:modelValue":p[6]||(p[6]=v=>c.item.startOffsetTime=v),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[X,c.item.startOffsetTime]]),p[18]||(p[18]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",Hg,[e("div",Eg,[R(e("input",{"onUpdate:modelValue":p[7]||(p[7]=v=>c.item.endOffsetTime=v),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[X,c.item.endOffsetTime]]),p[19]||(p[19]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",qg,[e("div",Bg,[R(e("input",{"onUpdate:modelValue":p[8]||(p[8]=v=>c.item.durationTime=v),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[X,c.item.durationTime]]),p[20]||(p[20]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",Ng,[e("div",Rg,[e("div",Fg,[R(e("input",{"onUpdate:modelValue":p[9]||(p[9]=v=>c.item.adBreaksDurationTime=v),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[X,c.item.adBreaksDurationTime]]),p[21]||(p[21]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks",-1))])]),e("div",zg,[e("div",Gg,[R(e("input",{"onUpdate:modelValue":p[10]||(p[10]=v=>c.item.totalProgramTemplateDurationTime=v),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[X,c.item.totalProgramTemplateDurationTime]]),p[22]||(p[22]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])])])])])])])],2),e("div",{class:le([M("adBreaks-tab"),"tab-pane fade"]),id:"adBreaks",role:"tabpanel","aria-labelledby":"adBreaks-tab"},[e("div",jg,[e("div",Yg,[e("table",Wg,[p[23]||(p[23]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Offset"),e("th",null,"Duration")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.adBreaks,(v,w)=>(t(),s("tr",{key:v.programTemplateAdBreakId},[e("td",Kg,m(w+1),1),e("td",null,m(o(B).moment.utc(v.offsetMillis).format("HH:mm:ss")),1),e("td",null,m(o(B).moment.utc(v.durationInMillis).format("HH:mm:ss")),1)]))),128))]),_:1},512),[[Se,c.item.adBreaks.length>0]])])])])],2),e("div",{class:le([M("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",Qg,[e("pre",null,m(c.item.programs),1)])],2)])])])):H("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Xg=["disabled"],Zg={class:"row row-cols-1 row-cols-sm-3"},e1={class:"col-sm-6"},t1={class:"form-floating mb-2"},s1={key:0,class:"d-block invalid-feedback"},o1={class:"col-sm-3"},a1={class:"form-floating mb-2"},l1={key:0,class:"d-block invalid-feedback"},n1={class:"col-sm-3"},r1={class:"form-floating mb-2"},i1={key:0,class:"d-block invalid-feedback"},d1={class:"row row-cols-1 row-cols-sm-2"},u1={class:"col"},c1={class:"form-floating mb-2"},m1=["value"],f1={key:0,class:"d-block invalid-feedback"},p1={class:"col"},v1={class:"form-floating mb-2"},g1=["value"],b1={key:0,class:"d-block invalid-feedback"},y1={__name:"add",props:{urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Channel"}),U=a,O=be({lookups:{sourceLocations:[],vodSources:[]},item:{name:"",tier:"STANDARD",playbackMode:"LINEAR",fillerSlateSourceLocationId:null,fillerSlateVodSourceId:null,policy:null}}),x={item:{name:{title:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},tier:{title:se.withMessage("Tier is required.",ae),$autoDirty:!0,$lazy:!0},playbackMode:{title:se.withMessage("PlaybackMode is required.",ae),$autoDirty:!0,$lazy:!0},fillerSlateSourceLocationId:{title:se.withMessage("Filler Slate Source Location is required.",ae),$autoDirty:!0,$lazy:!0},fillerSlateVodSourceId:{title:se.withMessage("Filler Slate Vod Source is required.",ae),$autoDirty:!0,$lazy:!0},policy:{title:se.withMessage("Policy is required.",ae),$autoDirty:!0,$lazy:!0}}},u=Te(x,O);me(async()=>{await J()});const J=async()=>{try{await Y.get("/api/v1/sourcelocations/lookup/").then(M=>{O.lookups.sourceLocations=M.data,O.lookups.sourceLocations.length===1&&(O.item.fillerSlateSourceLocationId=O.lookups.sourceLocations[0].id)}),O.item.fillerSlateSourceLocationId&&await c(O.item.fillerSlateSourceLocationId)}catch(f){P.value=D.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},Q=async()=>{O.item.fillerSlateVodSourceId=null,await c(O.item.fillerSlateSourceLocationId)},c=async f=>{try{let M=`/api/v1/vodSources/lookup/source-location/${f}/?category=2`;await Y.get(M).then(i=>{O.lookups.vodSources=i.data})}catch(M){P.value=D.getErrorMessageAsHtml(M),window.scrollTo(0,0)}finally{}},y=()=>{if(O.item.name){const f=`{"Version":"2012-10-17","Statement": [{"Sid":"AllowAnonymous","Effect":"Allow","Principal":"*","Action":"mediatailor:GetManifest","Resource":"arn:aws:mediatailor:us-west-2:799350865909:channel/${O.item.name}"}]}`;O.item.policy=f}else O.item.policy=null},j=async()=>{const f=O;if(V.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{V.value=!0,P.value="";const i=D.clone(f.item);await Y.post("/api/v1/channels/",i).then(h=>{G.success("Add Channel","Channel added.",{onClose:async()=>{const d=`${U.urlView}/${h.data}`;await W.push(d)}})})}catch(i){P.value=D.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{V.value=!1}};return(f,M)=>{const i=te("router-link"),h=te("PageHeader"),d=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(h,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(I)},{default:z(()=>[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:M[0]||(M[0]=r=>j()),class:"btn btn-primary"},M[8]||(M[8]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Xg),F(i,{to:U.urlMain,class:"btn btn-secondary ms-2"},{default:z(()=>M[9]||(M[9]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(d,{errorMessage:o(P),vuelidate:o(u)},{default:z(()=>[e("div",null,[e("div",Zg,[e("div",e1,[e("div",t1,[R(e("input",{"onUpdate:modelValue":M[1]||(M[1]=r=>O.item.name=r),onChange:M[2]||(M[2]=r=>y()),id:"name",class:"form-control",placeholder:"name"},null,544),[[X,O.item.name]]),M[10]||(M[10]=e("label",{for:"name",class:""},"Name",-1)),o(u).item.name.$error?(t(),s("div",s1,[(t(!0),s(A,null,N(o(u).item.name.$errors,r=>(t(),s("div",{key:r.$uid},m(r.$message),1))),128))])):H("",!0)])]),e("div",o1,[e("div",a1,[R(e("input",{"onUpdate:modelValue":M[3]||(M[3]=r=>O.item.tier=r),id:"tier",class:"form-control",placeholder:"tier",readonly:""},null,512),[[X,O.item.tier]]),M[11]||(M[11]=e("label",{for:"tier",class:""},"Tier",-1)),o(u).item.tier.$error?(t(),s("div",l1,[(t(!0),s(A,null,N(o(u).item.tier.$errors,r=>(t(),s("div",{key:r.$uid},m(r.$message),1))),128))])):H("",!0)])]),e("div",n1,[e("div",r1,[R(e("input",{"onUpdate:modelValue":M[4]||(M[4]=r=>O.item.playbackMode=r),id:"playbackMode",class:"form-control",placeholder:"playbackMode",readonly:""},null,512),[[X,O.item.playbackMode]]),M[12]||(M[12]=e("label",{for:"playbackMode",class:""},"PlaybackMode",-1)),o(u).item.playbackMode.$error?(t(),s("div",i1,[(t(!0),s(A,null,N(o(u).item.playbackMode.$errors,r=>(t(),s("div",{key:r.$uid},m(r.$message),1))),128))])):H("",!0)])])]),M[15]||(M[15]=e("div",{class:"mt-2"},[e("h5",null,"Filler Slate")],-1)),e("div",d1,[e("div",u1,[e("div",c1,[R(e("select",{"onUpdate:modelValue":M[5]||(M[5]=r=>O.item.fillerSlateSourceLocationId=r),onChange:M[6]||(M[6]=r=>Q()),class:"form-select",id:"fillerSlateSourceLocationId"},[(t(!0),s(A,null,N(O.lookups.sourceLocations,r=>(t(),s("option",{value:r.id},m(r.name),9,m1))),256))],544),[[ge,O.item.fillerSlateSourceLocationId]]),M[13]||(M[13]=e("label",{for:"fillerSlateSourceLocationId",class:""},"Source Location",-1)),o(u).item.fillerSlateSourceLocationId.$error?(t(),s("div",f1,[(t(!0),s(A,null,N(o(u).item.fillerSlateSourceLocationId.$errors,r=>(t(),s("div",{key:r.$uid},m(r.$message),1))),128))])):H("",!0)])]),e("div",p1,[e("div",v1,[R(e("select",{"onUpdate:modelValue":M[7]||(M[7]=r=>O.item.fillerSlateVodSourceId=r),class:"form-select",id:"fillerSlateVodSourceId"},[(t(!0),s(A,null,N(O.lookups.vodSources,r=>(t(),s("option",{value:r.id},m(r.name),9,g1))),256))],512),[[ge,O.item.fillerSlateVodSourceId]]),M[14]||(M[14]=e("label",{for:"fillerSlateVodSourceId",class:""},"VOD Source",-1)),o(u).item.fillerSlateVodSourceId.$error?(t(),s("div",b1,[(t(!0),s(A,null,N(o(u).item.fillerSlateVodSourceId.$errors,r=>(t(),s("div",{key:r.$uid},m(r.$message),1))),128))])):H("",!0)])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},$1={components:{Page:st},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function w1(a,g,I,V,S,L){const P=te("Page");return t(),ve(P,{id:I.id,urlView:I.urlView},null,8,["id","urlView"])}const h1=Ve($1,[["render",w1]]),_1={class:"ms-1"},k1={class:"input-group"},S1={class:"table-responsive border shadow-sm"},T1={class:"table table-hover mb-0"},I1=["textContent"],M1={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},x1={key:0,class:"badge text-bg-success"},C1={key:1,class:"badge text-bg-secondary"},V1="/api/v1/channels/search",P1={__name:"index",props:{urlAdd:{type:String,default:"/channels/add"},urlView:{type:String,default:"/channels/view"}},setup(a){Ce("$config");const I=he().user,{appTitle:V,pageTitle:S,busy:L,infoMessage:P,warningMessage:W,errorMessage:Y,router:D,axios:G,utils:Z,toasts:B,close:U,security:O,filter:x,initializeFilter:u,getQuery:J,saveQuery:Q,search:c,getRowNumber:y,setSelected:j,isSelected:f}=Le({appTitle:"ARC CMS",pageTitle:"Channels",cacheKey:`${I==null?void 0:I.userId}/Channels/search`,baseUrl:V1,filter:{updateUrl:!0}});return me(async()=>{u(),await c()}),(M,i)=>{const h=te("router-link"),d=te("PageHeader"),r=te("m-pagination"),p=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(d,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(S)},{default:z(()=>[F(h,{to:a.urlAdd,class:"btn btn-primary"},{default:z(()=>i[3]||(i[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",_1,[e("div",k1,[R(e("input",{"onUpdate:modelValue":i[0]||(i[0]=l=>o(x).query.criteria=l),onKeyup:i[1]||(i[1]=Ue(l=>o(c)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[X,o(x).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:i[2]||(i[2]=l=>o(c)(1))},i[4]||(i[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(p,{errorMessage:o(Y)},{default:z(()=>[e("div",S1,[e("table",T1,[i[5]||(i[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",null,"Playback Mode"),e("th",null,"Tier")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(x).items,(l,b)=>(t(),s("tr",{key:l.channelId},[e("td",{textContent:m(o(y)(b)),class:"text-center"},null,8,I1),e("td",null,[F(h,{to:`${a.urlView}/${l.channelId}`,class:"d-inline-block text-truncate link-offset-2"},{default:z(()=>[l.arn?(t(),s("span",M1)):H("",!0),K(m(l.name),1)]),_:2},1032,["to"]),e("div",null,[l.state==="RUNNING"?(t(),s("span",x1,m(l.state),1)):l.state==="STOPPED"?(t(),s("span",C1,m(l.state),1)):H("",!0)])]),e("td",null,m(l.playbackMode),1),e("td",null,m(l.tier),1)]))),128))]),_:1},512),[[Se,o(x).items.length>0]])])]),F(r,{filter:o(x),search:o(c),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},O1=["id"],A1={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},U1={class:"modal-content"},L1={class:"modal-header"},D1={class:"modal-title"},H1={class:"modal-body p-1"},E1={class:"row row-cols-1 row-cols-sm-2 g-2"},q1={class:"col-sm-4"},B1={class:"card"},N1={key:0,class:"mt-2"},R1={class:"col"},F1={class:"form-floating mb-2"},z1={class:"col ms-2 my-2"},G1={class:"badge bg-info me-1"},j1={class:"badge bg-primary me-1"},Y1={class:"row row-cols-1 row-cols-sm-2"},W1={class:"col"},K1={class:"form-floating mb-2"},Q1={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},J1={class:"col"},X1={class:"form-floating mb-2"},Z1={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},eb={class:"col"},tb={class:"form-floating mb-2"},sb={class:"col-sm-8"},ob={class:"col"},ab={class:"input-group mb-2"},lb={class:"form-floating"},nb={class:"table-responsive border shadow-sm"},rb={class:"table table-sm table-hover mb-0 overflow-auto"},ib=["textContent"],db={class:"d-flex flex-row justify-content-start"},ub={class:"mt-1"},cb=["src"],mb={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},fb={class:"ms-2"},pb=["onClick"],vb={class:"modal-footer"},gb="/api/v1/programtemplates/search",bb={__name:"_selectProgramTemplate",emits:["close"],setup(a,{expose:g,emit:I}){const S=he().user,{appTitle:L,pageTitle:P,busy:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,security:x,filter:u,initializeFilter:J,getQuery:Q,saveQuery:c,search:y,getRowNumber:j,setSelected:f,isSelected:M}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${S==null?void 0:S.userId}/program-templates/select`,baseUrl:gb,filter:{updateUrl:!0,lookups:{genres:[]},query:{}}}),i=I,h=de("modalSelectProgramTemplate"),d=be({programTemplate:null,hls:null});me(async()=>{J(),await r()}),Ae(()=>{d.hls&&(d.hls.stopLoad(),d.hls.destroy())});const r=async()=>{await b(),await n()},p=async w=>{u.value.query.sourceLocationId=w,G.value="",await y();var k=document.getElementById(h.value),$=_e.getOrCreateInstance(k);$.show()},l=async()=>{var w=document.getElementById(h.value),k=_e.getOrCreateInstance(w);k.hide(),d.hls&&(d.hls.stopLoad(),d.hls.destroy()),i("close",d.programTemplate)},b=async w=>{try{const $=await B.get("/api/v1/lookups/video-categories/").then(E=>E.data);u.value.lookups.categories=$}catch(k){G.value=U.getErrorMessageAsHtml(k),window.scrollTo(0,0)}finally{}},n=async w=>{try{const $=await B.get("/api/v1/lookups/video-genres/").then(E=>E.data);u.value.lookups.genres=$}catch(k){G.value=U.getErrorMessageAsHtml(k),window.scrollTo(0,0)}finally{}},v=w=>{d.programTemplate=w,l()};return g({open:p,close:l}),(w,k)=>{const $=te("m-pagination"),E=te("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:h.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",A1,[e("div",U1,[e("div",L1,[e("h5",D1,[k[8]||(k[8]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),K(m(o(P)),1)]),e("button",{type:"button",class:"btn-close",onClick:k[0]||(k[0]=_=>l()),"aria-label":"Close"})]),e("div",H1,[F(E,{errorMessage:o(G)},{default:z(()=>[e("div",E1,[e("div",q1,[e("div",B1,[k[13]||(k[13]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),d.programTemplate?(t(),s("div",N1,[e("div",R1,[e("div",F1,[R(e("input",{"onUpdate:modelValue":k[1]||(k[1]=_=>d.programTemplate.vodSource.video.title=_),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[X,d.programTemplate.vodSource.video.title]]),k[9]||(k[9]=e("label",{for:"title"},"Title",-1))])]),e("div",z1,[e("div",null,[(t(!0),s(A,null,N(d.programTemplate.vodSource.video.genres,_=>(t(),s("span",G1,m(_.genreName),1))),256)),(t(!0),s(A,null,N(d.programTemplate.vodSource.video.categories,_=>(t(),s("span",j1,m(_.categoryName),1))),256))])]),e("div",Y1,[e("div",W1,[e("div",K1,[e("div",Q1,m(o(U).moment(d.programTemplate.vodSource.video.dateReleased).calendar()),1),k[10]||(k[10]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",J1,[e("div",X1,[e("div",Z1,m(o(U).moment.utc(d.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),k[11]||(k[11]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",eb,[e("div",tb,[R(e("textarea",{"onUpdate:modelValue":k[2]||(k[2]=_=>d.programTemplate.vodSource.video.description=_),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[X,d.programTemplate.vodSource.video.description]]),k[12]||(k[12]=e("label",{for:"description"},"Description",-1))])])])):H("",!0)])]),e("div",sb,[e("div",ob,[e("div",ab,[e("div",lb,[R(e("input",{"onUpdate:modelValue":k[3]||(k[3]=_=>o(u).query.criteria=_),onKeyup:k[4]||(k[4]=Ue(_=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[X,o(u).query.criteria]]),k[14]||(k[14]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:k[5]||(k[5]=_=>o(y)(1))},k[15]||(k[15]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",nb,[e("table",rb,[k[16]||(k[16]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(u).items,(_,C)=>(t(),s("tr",{key:_.videoId},[e("td",{textContent:m(o(j)(C)),class:"text-center"},null,8,ib),e("td",null,[e("div",db,[e("div",null,[_.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},N(_.vodSource.video.thumbnails,re=>(t(),s("div",ub,[e("img",{src:re.url,class:"img-fuild border",width:"128"},null,8,cb)]))),256)):(t(),s("img",mb))]),e("div",fb,[e("a",{onClick:re=>v(_),class:"text-wrap link-offset-2",role:"button"},m(_.name),9,pb)])])])]))),128))]),_:1},512),[[Se,o(u).items.length>0]])])]),F($,{filter:o(u),search:o(y),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",vb,[e("button",{onClick:k[6]||(k[6]=_=>l()),class:"btn btn-primary",type:"button"},k[17]||(k[17]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:k[7]||(k[7]=_=>l()),class:"btn btn-secondary ms-1"},k[18]||(k[18]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,O1)}}},yb={key:0,class:"modal-content"},$b={class:"modal-header"},wb={class:"modal-title"},hb={class:"modal-body1"},_b={class:"row row-cols-1 row-cols-sm-2 g-2"},kb={class:"card"},Sb={key:0,class:"mt-2"},Tb={class:"col"},Ib={class:"form-floating mb-2"},Mb={class:"col ms-2 my-2"},xb={class:"badge bg-info me-1"},Cb={class:"badge bg-primary me-1"},Vb={class:"row row-cols-1 row-cols-sm-2"},Pb={class:"col"},Ob={class:"form-floating mb-2"},Ab={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Ub={class:"col"},Lb={class:"form-floating mb-2"},Db={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Hb={class:"col"},Eb={class:"form-floating mb-2"},qb={class:"col"},Bb={class:"input-group mb-2"},Nb={class:"form-floating"},Rb={class:"table-responsive border shadow-sm"},Fb={class:"table table-sm table-hover mb-0 overflow-auto"},zb=["textContent"],Gb={class:"d-flex flex-row justify-content-start"},jb={class:"mt-1"},Yb=["src"],Wb={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Kb={class:"ms-2"},Qb=["onClick"],Jb={class:"modal-footer"},Xb="/api/v1/programtemplates/search",Zb={__name:"_selectProgramTemplateInline",props:{isOpen:{type:Boolean,required:!0}},emits:["close"],setup(a,{expose:g,emit:I}){const S=he().user,{appTitle:L,pageTitle:P,busy:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,security:x,filter:u,initializeFilter:J,getQuery:Q,saveQuery:c,search:y,getRowNumber:j,setSelected:f,isSelected:M}=Le({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${S==null?void 0:S.userId}/program-templates/select`,baseUrl:Xb,filter:{updateUrl:!0,lookups:{genres:[]},query:{}},getQuery:k=>["?c=",encodeURIComponent(k.query.criteria),"&p=",k.pageIndex,"&s=",k.pageSize,"&sf=",k.sortField,"&so=",k.sortOrder,"&withArn=true"].join(""),successAction:()=>{d.programTemplate&&(d.programTemplate=null)}}),i=a,h=I;de("modalSelectProgramTemplateInline");const d=be({programTemplate:null,hls:null});me(async()=>{J(),await r()}),Ae(()=>{d.hls&&(d.hls.stopLoad(),d.hls.destroy())});const r=async()=>{await b(),await n()},p=async k=>{u.value.query.sourceLocationId=k,G.value="",await y(),i.isOpen=!0},l=async()=>{d.hls&&(d.hls.stopLoad(),d.hls.destroy()),h("close",d.programTemplate),i.isOpen=!1},b=async k=>{try{const E=await B.get("/api/v1/lookups/video-categories/").then(_=>_.data);u.value.lookups.categories=E}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},n=async k=>{try{const E=await B.get("/api/v1/lookups/video-genres/").then(_=>_.data);u.value.lookups.genres=E}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},v=k=>{d.programTemplate=k,w()},w=()=>{if(Hls.isSupported()){d.hls&&(d.hls.stopLoad(),d.hls.destroy());var k=document.getElementById("video-select-preview");const E=d.programTemplate.vodSource.video.formats.find(C=>C.formatName==="HLS"),_=E.serverUrl+E.path;d.hls=U.createHlsStream(k,_)}};return g({open:p,close:l}),(k,$)=>{const E=te("m-pagination"),_=te("PageBody");return t(),ve($e,null,{default:z(()=>[a.isOpen?(t(),s("div",yb,[e("div",$b,[e("h6",wb,[$[7]||($[7]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),K(m(o(P)),1)])]),e("div",hb,[F(_,{errorMessage:o(G)},{default:z(()=>[e("div",_b,[e("div",{class:le([d.programTemplate?"col-sm-4":"d-none"])},[e("div",kb,[$[12]||($[12]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),d.programTemplate?(t(),s("div",Sb,[e("div",Tb,[e("div",Ib,[R(e("input",{"onUpdate:modelValue":$[0]||($[0]=C=>d.programTemplate.vodSource.video.title=C),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[X,d.programTemplate.vodSource.video.title]]),$[8]||($[8]=e("label",{for:"title"},"Title",-1))])]),e("div",Mb,[e("div",null,[(t(!0),s(A,null,N(d.programTemplate.vodSource.video.genres,C=>(t(),s("span",xb,m(C.genreName),1))),256)),(t(!0),s(A,null,N(d.programTemplate.vodSource.video.categories,C=>(t(),s("span",Cb,m(C.categoryName),1))),256))])]),e("div",Vb,[e("div",Pb,[e("div",Ob,[e("div",Ab,m(o(U).moment(d.programTemplate.vodSource.video.dateReleased).calendar()),1),$[9]||($[9]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Ub,[e("div",Lb,[e("div",Db,m(o(U).moment.utc(d.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),$[10]||($[10]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Hb,[e("div",Eb,[R(e("textarea",{"onUpdate:modelValue":$[1]||($[1]=C=>d.programTemplate.vodSource.video.description=C),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[X,d.programTemplate.vodSource.video.description]]),$[11]||($[11]=e("label",{for:"description"},"Description",-1))])])])):H("",!0)])],2),e("div",{class:le([d.programTemplate?"col-sm-8":"col-sm-12"])},[e("div",qb,[e("div",Bb,[e("div",Nb,[R(e("input",{"onUpdate:modelValue":$[2]||($[2]=C=>o(u).query.criteria=C),onKeyup:$[3]||($[3]=Ue(C=>o(y)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[X,o(u).query.criteria]]),$[13]||($[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:$[4]||($[4]=C=>o(y)(1))},$[14]||($[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",Rb,[e("table",Fb,[$[15]||($[15]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(o(u).items,(C,re)=>(t(),s("tr",{key:C.videoId},[e("td",{textContent:m(o(j)(re)),class:"text-center"},null,8,zb),e("td",null,[e("div",Gb,[e("div",null,[C.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},N(C.vodSource.video.thumbnails,fe=>(t(),s("div",jb,[e("img",{src:fe.url,class:"img-fuild border",width:"128"},null,8,Yb)]))),256)):(t(),s("img",Wb))]),e("div",Kb,[e("a",{onClick:fe=>v(C),class:"text-wrap link-offset-2",role:"button"},m(C.name),9,Qb)])])])]))),128))]),_:1},512),[[Se,o(u).items.length>0]])])]),F(E,{filter:o(u),search:o(y),showPerPage:!0},null,8,["filter","search"])],2)])]),_:1},8,["errorMessage"])]),e("div",Jb,[e("button",{onClick:$[5]||($[5]=C=>l()),class:"btn btn-primary",type:"button"},$[16]||($[16]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:$[6]||($[6]=C=>l(!1)),class:"btn btn-secondary ms-1"},$[17]||($[17]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])):H("",!0)]),_:1})}}},ey=["id"],ty={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},sy={class:"modal-content"},oy={class:"modal-header"},ay={class:"modal-title"},ly={class:"modal-body"},ny={key:0},ry={class:"row row-cols-1 row-cols-sm-3"},iy={class:"col-sm-3"},dy={class:"form-floating mb-2"},uy={key:0,class:"d-block invalid-feedback"},cy={class:"col-sm-3"},my={class:"form-floating mb-2"},fy={key:0,class:"d-block invalid-feedback"},py={class:"col-sm-6"},vy={class:"input-group mb-2"},gy={class:"form-floating"},by={id:"programTemplateId",class:"form-control",placeholder:"Title"},yy={key:0,class:"d-block invalid-feedback"},$y={key:0},wy={class:"row row-cols-1 row-cols-sm-2"},hy={class:"col"},_y={class:"row row-cols-1"},ky={class:"col"},Sy={class:"form-floating mb-2"},Ty={class:"col"},Iy={class:"form-floating mb-2"},My={class:"row row-cols-1 row-cols-sm-3"},xy={class:"col"},Cy={class:"form-floating mb-2"},Vy={class:"col"},Py={class:"form-floating mb-2"},Oy={class:"col"},Ay={class:"form-floating mb-2"},Uy={class:"row row-cols-1 row-cols-sm-3"},Ly={class:"col"},Dy={class:"form-floating mb-2"},Hy={class:"col"},Ey={class:"form-floating mb-2"},qy={key:1},By={class:"table-responsive border mt-1"},Ny={class:"table table-sm mb-0"},Ry=["onUpdate:modelValue","onChange"],Fy=["value"],zy={key:0,class:"modal-footer"},Gy=["disabled"],jy={__name:"_addProgram",emits:["onClose"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),J=I,Q=de(),c=de(),y=de(),j=de("modalAddProgramFromTemplate"),f=be({eventId:null,lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},selected:{programTemplate:null,channel:null},item:{programTemplateId:null,name:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),M=(ee,T,ue)=>ee.length<=0?!0:ee.every(ne=>ne.vodSourceId),i={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},programTemplateId:{required:se.withMessage("Program Template is required.",ae),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:se.withMessage("Date Scheduled Start is required.",ae),$autoDirty:!0,$lazy:!0},adBreaks:{adBreaksRequired:se.withMessage("Ad Break is not properly configured.",M),$each:se.forEach({vodSourceId:{required:se.withMessage("Vod Source is required.",ae)}})}}},h=Te(i,f);me(async()=>{h.value.$reset()});const d=async(ee,T,ue)=>{y.value=ee;const oe=f;W.value.clear(),G.value="";const ne=U.moment(ue),xe=ne.format("YYYY-MM-DD HH:mm"),ce=ne.format("YYYYMMDD_HHmm")+"_PRG_";oe.eventId=T,oe.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},oe.selected={programTemplate:null},oe.item={programTemplateId:null,name:ce,dateScheduledStart:xe,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await l(),h.value.$reset();var q=document.getElementById(j.value),ye=_e.getOrCreateInstance(q);ye.show()},r=async ee=>{if(!ee){J("onClose",{eventId:f.eventId},ee);var T=document.getElementById(j.value),ue=_e.getOrCreateInstance(T);ue.hide();return}if(!await h.value.$validate()){window.scrollTo(0,0);return}const ne=f,pe=U.moment(ne.item.dateScheduledStart).utc(!0).format(),xe=U.moment(ne.item.dateScheduledStart).add(ne.selected.programTemplate.totalProgramTemplateDurationInMillis,"milliseconds").utc(!0).format();f.item={eventId:ne.eventId,programTemplateId:ne.selected.programTemplate.programTemplateId,channelId:y.value,name:ne.item.name,dateScheduledStart:pe,dateScheduledEnd:xe,adBreaks:ne.selected.programTemplate.adBreaks.map(ce=>({sourceLocationId:ce.sourceLocationId,vodSourceId:ce.vodSourceId,offsetMillis:ce.offsetMillis,durationInMillis:ce.durationInMillis}))},await B.post("/api/v1/programs/",f.item).then(ce=>{O.success("Add New Program",`Program [${f.item.name}] was added to this channel.`),J("onClose",f.item,ee);var q=document.getElementById(j.value),ye=_e.getOrCreateInstance(q);ye.hide()},ce=>{G.value=U.getErrorMessageAsHtml(ce)})},p=async()=>{await r(!0)},l=async()=>{await k(),await b(),await n()},b=async()=>{try{const ee=`/api/v1/channelOutputs/get-by-channel/${y.value}`;await B.get(ee).then(T=>{f.lookups.channelOutputs=T.data}),f.item.programTemplateId&&await v()}catch(ee){G.value=U.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},n=async()=>{try{const ee=`/api/v1/programTemplates/lookup/by-channel/${y.value}`;await B.get(ee).then(T=>{f.lookups.programTemplates=T.data,f.lookups.programTemplates.length===1&&(f.item.programTemplateId=f.lookups.programTemplates[0].id)}),f.item.programTemplateId&&await v(f.item.programTemplateId)}catch(ee){G.value=U.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},v=async ee=>{await w(ee)},w=async ee=>{try{const T=`/api/v1/programTemplates/${ee}/`;await B.get(T).then(ne=>{f.selected.programTemplate=ne.data;const pe=f.selected.programTemplate;pe.startOffsetTime=U.moment.utc(pe.startOffsetMillis).format("HH:mm:ss"),pe.endOffsetTime=U.moment.utc(pe.endOffsetMillis).format("HH:mm:ss"),pe.durationTime=U.moment.utc(pe.durationInMillis).format("HH:mm:ss"),pe.adBreaksDurationTime=U.moment.utc(pe.adBreaksDurationInMillis).format("HH:mm:ss"),pe.totalProgramTemplateDurationTime=U.moment.utc(pe.totalProgramTemplateDurationInMillis).format("HH:mm:ss"),pe.adBreaks.forEach(xe=>{xe.vodSourceId=null}),f.item.programTemplateId=pe.programTemplateId,f.item.adBreaks=pe.adBreaks});const ue=f,oe=ue.lookups.channelOutputs[0].outputType;await E(ue.selected.programTemplate.sourceLocationId,oe)}catch(T){G.value=U.getErrorMessageAsHtml(T),window.scrollTo(0,0)}finally{}},k=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(T=>{f.lookups.sourceLocations=T.data,f.lookups.sourceLocations.length===1&&(f.item.sourceLocationId=f.lookups.sourceLocations[0].id)}),f.item.sourceLocationId&&await $(f.item.sourceLocationId)}catch(ee){G.value=U.getErrorMessageAsHtml(ee),window.scrollTo(0,0)}finally{}},$=async ee=>{try{let T=`/api/v1/vodSources/lookup/source-location/${ee}`;await B.get(T).then(ue=>{f.lookups.vodSources=ue.data})}catch(T){G.value=U.getErrorMessageAsHtml(T),window.scrollTo(0,0)}finally{}},E=async(ee,T)=>{try{let ue=`/api/v1/vodsources/lookup/source-location/${ee}/output-type/${T}`;await B.get(ue).then(oe=>{f.lookups.adBreakVodSources=oe.data})}catch(ue){G.value=U.getErrorMessageAsHtml(ue),window.scrollTo(0,0)}finally{}},_=ee=>{const T=f.lookups.adBreakVodSources.find(ue=>ue.id==ee.vodSourceId);ee.sourceLocationId=T.sourceLocationId},C=async ee=>{fe.value=!1,ee&&(await v(ee.programTemplateId),re())},re=()=>{if(Hls.isSupported()){f.hls&&(f.hls.stopLoad(),f.hls.destroy());var ee=document.getElementById("video-add-program");const ue=f.selected.programTemplate.vodSource.video.formats.find(ne=>ne.formatName==="HLS"),oe=ue.serverUrl+ue.path;f.hls=U.createHlsStream(ee,oe)}},fe=de(!1);return g({open:d,close:r}),(ee,T)=>{const ue=te("PageMessages");return t(),ve($e,null,{default:z(()=>[e("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:j.value,tabindex:"-1","aria-hidden":"true"},[e("div",ty,[e("div",sy,[e("div",oy,[e("h5",ay,[T[13]||(T[13]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=oe=>r(!1)),"aria-label":"Close"})]),e("div",ly,[F(ue,{errorMessage:o(G),vuelidate:o(h)},null,8,["errorMessage","vuelidate"]),F(Zb,{ref_key:"modalSelectProgramTemplateInline",ref:c,isOpen:fe.value,onClose:C},null,8,["isOpen"]),fe.value?H("",!0):(t(),s("div",ny,[e("div",ry,[e("div",iy,[e("div",dy,[R(e("input",{"onUpdate:modelValue":T[1]||(T[1]=oe=>f.item.name=oe),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,f.item.name]]),T[14]||(T[14]=e("label",{for:"name",class:""},"Name",-1)),o(h).item.name.$error?(t(),s("div",uy,[(t(!0),s(A,null,N(o(h).item.name.$errors,oe=>(t(),s("div",{key:oe.$uid},m(oe.$message),1))),128))])):H("",!0)])]),e("div",cy,[e("div",my,[R(e("input",{"onUpdate:modelValue":T[2]||(T[2]=oe=>f.item.dateScheduledStart=oe),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[X,f.item.dateScheduledStart]]),T[15]||(T[15]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(h).item.dateScheduledStart.$error?(t(),s("div",fy,[(t(!0),s(A,null,N(o(h).item.dateScheduledStart.$errors,oe=>(t(),s("div",{key:oe.$uid},m(oe.$message),1))),128))])):H("",!0)])]),e("div",py,[e("div",vy,[e("div",gy,[e("div",by,[f.selected.programTemplate?(t(),s(A,{key:0},[K(m(f.selected.programTemplate.name),1)],64)):H("",!0)]),T[16]||(T[16]=e("label",{for:"programTemplateId",class:""},"Program Template",-1))]),e("button",{onClick:T[3]||(T[3]=oe=>fe.value=!fe.value),class:"btn btn-primary",type:"button"},T[17]||(T[17]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))]),o(h).item.programTemplateId.$error?(t(),s("div",yy,[(t(!0),s(A,null,N(o(h).item.programTemplateId.$errors,oe=>(t(),s("div",{key:oe.$uid},m(oe.$message),1))),128))])):H("",!0)])]),f.selected.programTemplate?(t(),s("div",$y,[e("div",wy,[T[25]||(T[25]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1)),e("div",hy,[e("div",_y,[f.selected.programTemplate?(t(),s(A,{key:0},[e("div",ky,[e("div",Sy,[R(e("input",{"onUpdate:modelValue":T[4]||(T[4]=oe=>f.selected.programTemplate.sourceLocation.name=oe),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[X,f.selected.programTemplate.sourceLocation.name]]),T[18]||(T[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1))])]),e("div",Ty,[e("div",Iy,[R(e("input",{"onUpdate:modelValue":T[5]||(T[5]=oe=>f.selected.programTemplate.vodSource.name=oe),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[X,f.selected.programTemplate.vodSource.name]]),T[19]||(T[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1))])])],64)):H("",!0)]),e("div",My,[e("div",xy,[e("div",Cy,[R(e("input",{"onUpdate:modelValue":T[6]||(T[6]=oe=>f.selected.programTemplate.startOffsetTime=oe),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[X,f.selected.programTemplate.startOffsetTime]]),T[20]||(T[20]=e("label",{for:"startOffsetTime"},"Total Program Duration",-1))])]),e("div",Vy,[e("div",Py,[R(e("input",{"onUpdate:modelValue":T[7]||(T[7]=oe=>f.selected.programTemplate.endOffsetTime=oe),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[X,f.selected.programTemplate.endOffsetTime]]),T[21]||(T[21]=e("label",{for:"endOffsetTime"},"End Offset",-1))])]),e("div",Oy,[e("div",Ay,[R(e("input",{"onUpdate:modelValue":T[8]||(T[8]=oe=>f.selected.programTemplate.durationTime=oe),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[X,f.selected.programTemplate.durationTime]]),T[22]||(T[22]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),e("div",Uy,[e("div",Ly,[e("div",Dy,[R(e("input",{"onUpdate:modelValue":T[9]||(T[9]=oe=>f.selected.programTemplate.adBreaksDurationTime=oe),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[X,f.selected.programTemplate.adBreaksDurationTime]]),T[23]||(T[23]=e("label",{for:"adBreaksDurationTime"},"Ad Breaks Total Duration",-1))])]),e("div",Hy,[e("div",Ey,[R(e("input",{"onUpdate:modelValue":T[10]||(T[10]=oe=>f.selected.programTemplate.totalProgramTemplateDurationTime=oe),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[X,f.selected.programTemplate.totalProgramTemplateDurationTime]]),T[24]||(T[24]=e("label",{for:"totalProgramTemplateDurationTime"},"Program Total Duration",-1))])])])])])])):H("",!0),f.selected.programTemplate&&f.selected.programTemplate.adBreaks.length>0?(t(),s("div",qy,[T[27]||(T[27]=e("div",{class:"d-flex flex-row justify-content-between"},[e("b",null," Ad Break ")],-1)),e("div",By,[e("table",Ny,[T[26]||(T[26]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(f.item.adBreaks,(oe,ne)=>(t(),s("tr",null,[e("td",null,m(ne+1),1),e("td",null,m(o(U).moment.utc(oe.offsetMillis).format("HH:mm:ss")),1),e("td",null,m(o(U).moment.utc(oe.durationInMillis).format("HH:mm:ss")),1),e("td",null,[f.lookups.adBreakVodSources.length>0?(t(),s(A,{key:0},[R(e("select",{"onUpdate:modelValue":pe=>oe.vodSourceId=pe,onChange:pe=>_(oe),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(A,null,N(f.lookups.adBreakVodSources,pe=>(t(),s(A,null,[pe.durationInMillis===oe.durationInMillis?(t(),s("option",{key:0,value:pe.id}," ["+m(o(U).moment.utc(pe.durationInMillis).format("HH:mm:ss"))+"] "+m(pe.name),9,Fy)):H("",!0)],64))),256))],40,Ry),[[ge,oe.vodSourceId]]),o(h).item.adBreaks.$each.$response?(t(!0),s(A,{key:0},N(o(h).item.adBreaks.$each.$response.$errors[ne].vodSourceId,pe=>(t(),s("div",{key:pe,class:"d-block invalid-feedback"},m(pe.$message),1))),128)):H("",!0)],64)):H("",!0)])]))),256))])])])])):H("",!0)]))]),fe.value?H("",!0):(t(),s("div",zy,[e("button",{disabled:o(h).$dirty&&o(h).$invalid,onClick:T[11]||(T[11]=oe=>p()),class:"btn btn-primary",type:"button"},T[28]||(T[28]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Gy),e("button",{onClick:T[12]||(T[12]=oe=>r(!1)),class:"btn btn-secondary ms-1"},T[29]||(T[29]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))]))])]),F(bb,{ref_key:"modalSelectProgramTemplate",ref:Q,onClose:C},null,512)],8,ey)]),_:1})}}},Yy=["id"],Wy={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Ky={class:"modal-content"},Qy={class:"modal-header"},Jy={class:"modal-title"},Xy={class:"modal-body"},Zy={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},e$=["innerHTML"],t$={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},s$={key:2,class:"container"},o$={class:"row row-cols-1 row-cols-sm-2"},a$={class:"col"},l$={class:"form-floating mb-2"},n$={class:"col"},r$={class:"form-floating mb-2"},i$={class:"row row-cols-1 row-cols-sm-3 mt-2"},d$={class:"col"},u$={class:"form-floating mb-2"},c$={class:"col"},m$={class:"form-floating mb-2"},f$={key:0,class:"d-block invalid-feedback"},p$={class:"col"},v$={class:"form-floating mb-2"},g$={key:0,class:"d-block invalid-feedback"},b$={class:"row row-cols-1 row-cols-sm-3"},y$={class:"col"},$$={class:"form-floating mb-2"},w$={class:"col"},h$={class:"form-floating mb-2"},_$={class:"col"},k$={class:"form-floating mb-2"},S$={class:"row row-cols-1 row-cols-sm-3"},T$={class:"col"},I$={class:"form-floating mb-2"},M$={class:"col"},x$={class:"form-floating mb-2"},C$={key:0,class:"col"},V$={class:"form-floating mb-2"},P$={key:0},O$={class:"table-responsive border mt-1"},A$={class:"table mb-0"},U$=["onUpdate:modelValue","onChange"],L$=["value"],D$={class:"modal-footer"},H$=["disabled"],pt={__name:"_editProgram",emits:["onClose"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Edit Program"}),J=I,Q=de(),c=de("modalEditProgram"),y=be({lookups:{adBreakSourceLocations:[],adBreakVodSources:[]},item:{programTemplateId:null,name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),j={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:se.withMessage("Date Scheduled Start is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("sourceLocationId is required.",ae),$autoDirty:!0,$lazy:!0},vodSourceId:{required:se.withMessage("vodSourceId is required.",ae),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:se.withMessage("startOffsetMillis is required.",ae),minValue:Ne(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:se.withMessage("endOffsetMillis is required.",ae),minValue:Ne(0),$autoDirty:!0,$lazy:!0}}},f=Te(j,y);me(async()=>{f.value.$reset()});const M=async(b,n)=>{Q.value=b;const v=y;W.value.clear(),G.value="",v.lookups={adBreakSourceLocations:[],adBreakVodSources:[]},v.item=null,await d(),await r(),f.value.$reset();var w=document.getElementById(c.value),k=_e.getOrCreateInstance(w);k.show()},i=async b=>{if(!b){J("onClose",b);var k=document.getElementById(c.value),$=_e.getOrCreateInstance(k);$.hide();return}const n=y,v=U.moment(n.item.dateScheduledStart).utc(!0).format(),w={programId:Q.value,name:n.item.name,dateScheduledStart:v,adBreaks:n.item.adBreaks.map(E=>({sourceLocationId:E.sourceLocationId,vodSourceId:E.vodSourceId,offsetMillis:E.offsetMillis,durationInMillis:E.durationInMillis}))};try{await B.put("/api/v1/programs/",w).then(_=>{O.success("Edit Program","Program was edited.")})}catch(E){G.value=U.getErrorMessageAsHtml(E),window.scrollTo(0,0);return}finally{}J("onClose",b);var k=document.getElementById(c.value),$=_e.getOrCreateInstance(k);$.hide()},h=async()=>{await i(!0)},d=async()=>{try{const b=`/api/v1/programs/${Q.value}/`;await B.get(b).then(w=>{y.item=w.data;const k=y.item,_=U.moment.utc(k.dateScheduledStart).format("YYYY-MM-DD HH:mm");y.item.dateScheduledStart=_,k.startOffsetTime=U.moment.utc(k.startOffsetMillis).format("HH:mm:ss"),k.endOffsetTime=U.moment.utc(k.endOffsetMillis).format("HH:mm:ss"),k.durationTime=U.moment.utc(k.durationInMillis).format("HH:mm:ss"),k.adBreaksDurationTime=U.moment.utc(k.adBreaksDurationInMillis).format("HH:mm:ss"),k.totalProgramTemplateDurationTime=U.moment.utc(k.totalProgramTemplateDurationInMillis).format("HH:mm:ss")});const n=y,v=n.item.channel.outputs[0].outputType;await p(n.item.sourceLocationId,v)}catch(b){G.value=U.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{}},r=async()=>{},p=async(b,n)=>{try{let v=`/api/v1/vodsources/lookup/source-location/${b}/output-type/${n}`;await B.get(v).then(w=>{y.lookups.adBreakVodSources=w.data})}catch(v){G.value=U.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{}},l=b=>{const n=y.lookups.adBreakVodSources.find(v=>v.id==b.vodSourceId);b.sourceLocationId=n.sourceLocationId};return g({open:M,close:i}),(b,n)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",Wy,[e("div",Ky,[e("div",Qy,[e("h5",Jy,[n[14]||(n[14]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:n[0]||(n[0]=v=>i(!1)),"aria-label":"Close"})]),e("div",Xy,[o(G)?(t(),s("div",Zy,[n[15]||(n[15]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,e$)])):H("",!0),o(W).size>0?(t(),s("div",t$,[n[16]||(n[16]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),v=>(t(),s("li",null,m(v),1))),256))])])):H("",!0),y.item?(t(),s("div",s$,[e("div",o$,[e("div",a$,[e("div",l$,[y.item.sourceLocation?R((t(),s("input",{key:0,"onUpdate:modelValue":n[1]||(n[1]=v=>y.item.sourceLocation.name=v),id:"sourceLocation",class:"form-control-plaintext",readonly:""},null,512)),[[X,y.item.sourceLocation.name]]):H("",!0),n[17]||(n[17]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",n$,[e("div",r$,[y.item.vodSource?R((t(),s("input",{key:0,"onUpdate:modelValue":n[2]||(n[2]=v=>y.item.vodSource.name=v),id:"vodSource",class:"form-control-plaintext",readonly:""},null,512)),[[X,y.item.vodSource.name]]):H("",!0),n[18]||(n[18]=e("label",{for:"vodSource",class:""},"VOD Source",-1))])])]),e("div",i$,[e("div",d$,[e("div",u$,[y.item.relativeProgram?R((t(),s("input",{key:0,"onUpdate:modelValue":n[3]||(n[3]=v=>y.item.relativeProgram.name=v),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512)),[[X,y.item.relativeProgram.name]]):H("",!0),n[19]||(n[19]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])]),e("div",c$,[e("div",m$,[R(e("input",{"onUpdate:modelValue":n[4]||(n[4]=v=>y.item.name=v),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,y.item.name]]),n[20]||(n[20]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",f$,[(t(!0),s(A,null,N(o(f).item.name.$errors,v=>(t(),s("div",{key:v.$uid},m(v.$message),1))),128))])):H("",!0)])]),e("div",p$,[e("div",v$,[R(e("input",{"onUpdate:modelValue":n[5]||(n[5]=v=>y.item.dateScheduledStart=v),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[X,y.item.dateScheduledStart]]),n[21]||(n[21]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(f).item.dateScheduledStart.$error?(t(),s("div",g$,[(t(!0),s(A,null,N(o(f).item.dateScheduledStart.$errors,v=>(t(),s("div",{key:v.$uid},m(v.$message),1))),128))])):H("",!0)])])]),e("div",null,[e("div",b$,[e("div",y$,[e("div",$$,[R(e("input",{"onUpdate:modelValue":n[6]||(n[6]=v=>y.item.startOffsetTime=v),id:"startOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[X,y.item.startOffsetTime]]),n[22]||(n[22]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",w$,[e("div",h$,[R(e("input",{"onUpdate:modelValue":n[7]||(n[7]=v=>y.item.endOffsetTime=v),id:"endOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[X,y.item.endOffsetTime]]),n[23]||(n[23]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",_$,[e("div",k$,[R(e("input",{"onUpdate:modelValue":n[8]||(n[8]=v=>y.item.durationTime=v),id:"durationTime",class:"form-control-plaintext",readonly:""},null,512),[[X,y.item.durationTime]]),n[24]||(n[24]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",S$,[e("div",T$,[e("div",I$,[R(e("input",{"onUpdate:modelValue":n[9]||(n[9]=v=>y.item.adBreaksDurationTime=v),id:"adBreaksDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[X,y.item.adBreaksDurationTime]]),n[25]||(n[25]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks Duration",-1))])]),e("div",M$,[e("div",x$,[R(e("input",{"onUpdate:modelValue":n[10]||(n[10]=v=>y.item.totalProgramTemplateDurationTime=v),id:"totalProgramTemplateDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[X,y.item.totalProgramTemplateDurationTime]]),n[26]||(n[26]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])]),y.item.relativeProgram?(t(),s("div",C$,[e("div",V$,[R(e("input",{"onUpdate:modelValue":n[11]||(n[11]=v=>y.item.relativeProgram.name=v),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512),[[X,y.item.relativeProgram.name]]),n[27]||(n[27]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])])):H("",!0)])]),n[30]||(n[30]=e("hr",null,null,-1)),y.item?(t(),s("div",P$,[n[29]||(n[29]=e("div",{class:"d-flex flex-row justify-content-between"},[e("fieldset",null,[e("legend",null," Ad Breaks ")])],-1)),e("div",O$,[e("table",A$,[n[28]||(n[28]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(y.item.adBreaks,(v,w)=>(t(),s("tr",null,[e("td",null,m(w+1),1),e("td",null,m(o(U).moment.utc(v.offsetMillis).format("HH:mm:ss")),1),e("td",null,m(o(U).moment.utc(v.durationInMillis).format("HH:mm:ss")),1),e("td",null,[R(e("select",{"onUpdate:modelValue":k=>v.vodSourceId=k,onChange:k=>l(v),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(A,null,N(y.lookups.adBreakVodSources,k=>(t(),s(A,null,[k.durationInMillis===v.durationInMillis?(t(),s("option",{key:0,value:k.id}," ["+m(o(U).moment.utc(k.durationInMillis).format("HH:mm:ss"))+"] "+m(k.name),9,L$)):H("",!0)],64))),256))],40,U$),[[ge,v.vodSourceId]])])]))),256))])])])])):H("",!0)])):H("",!0)]),e("div",D$,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:n[12]||(n[12]=v=>h()),class:"btn btn-primary ms-2",type:"button"},n[31]||(n[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,H$),e("button",{onClick:n[13]||(n[13]=v=>i(!1)),class:"btn btn-secondary ms-1"},n[32]||(n[32]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Yy))}},E$={__name:"index",props:{id:{type:String,required:!0},urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(a){const{appTitle:g,pageTitle:I,busy:V,infoMessage:S,warningMessage:L,errorMessage:P,router:W,axios:Y,utils:D,toasts:G,close:Z,security:B}=we({appTitle:"Arcadian-FAST",pageTitle:"Schedule Channel Programs"}),U=a,O=de(null),x=de(null),u=de(null),J={viewType:"Week",cellDuration:15,startDate:Ee.DayPilot.Date.today(),onTimeRangeSelected:d=>{var r=d.control;const p={start:d.start,end:d.end,id:Ee.DayPilot.guid(),text:"NEW",tags:{type:"new"}};r.events.add(p);var l=r.events.find(p.id);M(l)},onBeforeEventRender:d=>{if(d.data.barColor="green",!!d.data.tags)switch(d.data.tags.type){case"new":d.data.barColor="yellow";break;case"business":d.data.barColor="red";break;case"personal":d.data.barColor="greem";break;case"vacation":d.data.barColor="black";break;default:d.data.barColor="orange";break}},eventDeleteHandling:"Disabled",onEventMoved:async d=>{const r=d.newStart.value,p=d.e.id(),l=D.moment(r).utc(!0).format();try{let b="/api/v1/programs/scheduled-date-start";const n={programId:p,dateScheduledStart:l};await Y.put(b,n).then(v=>{G.success("Program date scheduled start was edited.")})}catch(b){P.value=D.getErrorMessageAsHtml(b),window.scrollTo(0,0);return}finally{}await j()},onEventResized:()=>{console.log("Event resized")},onEventClicked:async d=>{var r=d.e.id();h(r)},contextMenu:new Ee.DayPilot.Menu([{text:"Clone",onClick:async d=>{const r=d.source.id();try{let p=`/api/v1/programs/${r}/clone`;await Y.post(p).then(l=>{G.success("Clone Program","Program was cloned.")})}catch(p){P.value=D.getErrorMessageAsHtml(p),window.scrollTo(0,0);return}finally{await j()}}},{text:"Delete",onClick:async d=>{if(!confirm("Do you want to remove this program?"))return;const p=d.source.id();try{let l=`/api/v1/programs/${p}/`;await Y.delete(l).then(b=>{G.success("Delete Program","Program was deleted.")}),O.value.control.events.remove(d.source)}catch(l){P.value=D.getErrorMessageAsHtml(l),window.scrollTo(0,0);return}finally{await j()}}}])},Q=de([]),c=()=>{O.value.control.update({events:Q.value})},y=be({lookups:{visibilityTypes:[]},editorElementId:"editor",item:{userId:null,givenName:null,surname:null,displayName:null,email:null,mobilePhone:null,jobTitle:null}});me(async()=>{await j()});const j=async()=>{await f(),await c()},f=async()=>{const d=y;if(!V.value)try{V.value=!0,P.value="";const r=`/api/v1/channels/${U.id}/`;await Y.get(r).then(p=>{d.item=p.data;const l=d.item.outputs,b=d.item.programs.map(n=>{let v=`${n.name}`,w=`[${n.name}]`;return n.relativeProgram&&(w+=` => [${n.relativeProgram.name}]`),{start:D.moment.utc(n.dateScheduledStart).format(),end:D.moment.utc(n.dateScheduledEnd).format(),id:n.programId,text:v,toolTip:w}});Q.value=b})}catch(r){P.value=D.getErrorMessageAsHtml(r),window.scrollTo(0,0)}finally{V.value=!1}},M=d=>{x.value.open(U.id,d.id(),d.start().value)},i=async(d,r)=>{var p=O.value,l=p.control.events.find(d.eventId);if(!r&&l){O.value.control.events.remove(l);return}p.control.events.find($=>$.text()==d.name)&&(alert("Program already exists in this channel. Removing in the calendar."),O.value.control.events.remove(l));const n=D.moment(d.dateScheduledStart).utc(!0).format(),v=D.moment(d.dateScheduledEnd).utc(!0).format(),w=new Ee.DayPilot.Date(n),k=new Ee.DayPilot.Date(v);l.text(d.name),l.start(new Ee.DayPilot.Date(w)),l.end(new Ee.DayPilot.Date(k)),l.data.tags.program=d,l.commit(),O.value.control.update(),await j()},h=(d,r)=>{u.value.open(d,r)};return(d,r)=>{const p=te("router-link"),l=te("PageHeader"),b=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(l,{"page-icon":"fas fa-fw fa-calendar-plus",pageTitle:o(I)},{default:z(()=>[e("button",{onClick:r[0]||(r[0]=n=>j()),class:"btn btn-secondary ms-1"},r[1]||(r[1]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(p,{to:`${a.urlView}/${a.id}`,class:"btn btn-secondary ms-1"},{default:z(()=>r[2]||(r[2]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(b,{errorMessage:o(P)},{default:z(()=>[e("div",null,[F(o(Ee.DayPilotCalendar),{id:"dp",config:J,ref_key:"calendarRef",ref:O},null,512),F(jy,{ref_key:"modalAddProgram",ref:x,onOnClose:i},null,512),F(pt,{ref_key:"modalEditProgram",ref:u,onOnClose:j},null,512)])]),_:1},8,["errorMessage"])])]),_:1})}}},q$=["id"],B$={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},N$={class:"modal-content"},R$={class:"modal-header"},F$={class:"modal-title"},z$={class:"modal-body"},G$={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},j$=["innerHTML"],Y$={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},W$={class:"container"},K$={class:"row row-cols-1 row-cols-sm-3"},Q$={class:"col"},J$={class:"form-floating mb-2"},X$=["disabled"],Z$=["value"],ew={class:"col"},tw={class:"form-floating mb-2"},sw={key:0,class:"d-block invalid-feedback"},ow={class:"col"},aw={class:"form-floating mb-2"},lw={key:0,class:"d-block invalid-feedback"},nw={class:"row row-cols-sm-2"},rw={class:"col"},iw={class:"form-floating mb-2"},dw=["value"],uw={key:0,class:"d-block invalid-feedback"},cw={class:"col"},mw={class:"form-floating mb-2"},fw=["value"],pw={key:0,class:"d-block invalid-feedback"},vw={class:"col"},gw={class:"input-group mb-1"},bw={class:"form-floating"},yw={key:0,class:"input-group-text"},$w={key:0},ww={key:1},hw={key:2},_w={key:3,class:"d-block invalid-feedback"},kw={class:"col"},Sw={class:"input-group mb-1"},Tw={class:"form-floating"},Iw={key:0,class:"input-group-text"},Mw={key:0},xw={key:1},Cw={key:2,class:"d-block invalid-feedback"},Vw={class:"table-responsive border mt-1"},Pw={class:"table"},Ow={class:"input-group mb-1"},Aw=["onUpdate:modelValue"],Uw={key:0,class:"input-group-text"},Lw=["onUpdate:modelValue"],Dw=["value"],Hw=["onUpdate:modelValue"],Ew=["value"],qw=["onClick"],Bw={class:"modal-footer"},Nw=["disabled"],Rw={__name:"_addProgram",emits:["refresh"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),J=I,Q=de(),c=de("modalAddProgram"),y=be({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},item:{name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),j={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:se.withMessage("Date Scheduled Start is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("sourceLocationId is required.",ae),$autoDirty:!0,$lazy:!0},vodSourceId:{required:se.withMessage("vodSourceId is required.",ae),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:se.withMessage("startOffsetMillis is required.",ae),minValue:Ne(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:se.withMessage("endOffsetMillis is required.",ae),minValue:Ne(0),$autoDirty:!0,$lazy:!0}}},f=Te(j,y);me(async()=>{f.value.$reset()});const M=async $=>{Q.value=$;const E=y;W.value.clear(),G.value="";const _=U.moment().local().add(2,"m"),re=_.format("YYYY-MM-DD HH:mm"),fe=_.format("YYYY_MM_DD")+"_PROGRAM_";E.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},E.item={name:fe,relativeProgramId:null,dateScheduledStart:re,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await d(),f.value.$reset();var ee=document.getElementById(c.value),T=_e.getOrCreateInstance(ee);T.show()},i=async()=>{var $=document.getElementById(c.value),E=_e.getOrCreateInstance($);E.hide(),J("refresh")},h=async()=>{const $=y;if(L.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{L.value=!0,G.value="";const C=$.item;delete C.vodSource,C.channelId=Q.value;var _=C.dateScheduledStart;C.dateScheduledStart=U.moment(_).utc().format(),await B.post("/api/v1/programs/",C).then(re=>{O.success("Add Program","Program added to Channel",{async onClose(){}})}),await i()}catch(C){G.value=U.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{L.value=!1}},d=async()=>{await r(),await l(),await n()},r=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(E=>{y.lookups.sourceLocations=E.data,y.lookups.sourceLocations.length===1&&(y.item.sourceLocationId=y.lookups.sourceLocations[0].id)}),y.item.sourceLocationId&&await p(y.item.sourceLocationId)}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},p=async $=>{try{let E=`/api/v1/vodSources/lookup/source-location/${$}`;await B.get(E).then(_=>{y.lookups.vodSources=_.data})}catch(E){G.value=U.getErrorMessageAsHtml(E),window.scrollTo(0,0)}finally{}},l=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(E=>{y.lookups.adBreakSourceLocations=E.data})}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},b=async $=>{try{let E=`/api/v1/vodSources/lookup/source-location/${$}`;await B.get(E).then(_=>{y.lookups.adBreakVodSources=_.data})}catch(E){G.value=U.getErrorMessageAsHtml(E),window.scrollTo(0,0)}finally{}},n=async()=>{try{const $=`/api/v1/programs/lookup/?channelId=${Q.value}`;await B.get($).then(E=>{if(y.lookups.channelPrograms=E.data,y.lookups.channelPrograms.length===1){const C=y.lookups.channelPrograms[0];y.item.relativeProgramId=C.id}})}catch($){G.value=U.getErrorMessageAsHtml($),window.scrollTo(0,0)}finally{}},v=()=>{const $={offsetMillis:0,sourceLocationId:null,vodSourceId:null},E=y.item.adBreaks.length;if(E>0){const _=y.item.adBreaks[E-1];$.offsetMillis=_.offsetMillis+1e4}y.item.adBreaks.push($)},w=$=>{y.item.adBreaks.splice($,1)},k=()=>{const $=y.item.vodSource;y.item.vodSourceId=$.id};return g({open:M,close:i}),($,E)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",B$,[e("div",N$,[e("div",R$,[e("h5",F$,[E[12]||(E[12]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:E[0]||(E[0]=_=>i()),"aria-label":"Close"})]),e("div",z$,[o(G)?(t(),s("div",G$,[E[13]||(E[13]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,j$)])):H("",!0),o(W).size>0?(t(),s("div",Y$,[E[14]||(E[14]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),_=>(t(),s("li",null,m(_),1))),256))])])):H("",!0),e("div",W$,[e("div",K$,[e("div",Q$,[e("div",J$,[R(e("select",{"onUpdate:modelValue":E[1]||(E[1]=_=>y.item.relativeProgramId=_),class:"form-select",id:"sourceLocationId",disabled:y.lookups.channelPrograms.length<=0},[(t(!0),s(A,null,N(y.lookups.channelPrograms,_=>(t(),s("option",{value:_.id},m(_.name),9,Z$))),256))],8,X$),[[ge,y.item.relativeProgramId]]),E[15]||(E[15]=e("label",{for:"relativeProgramId",class:""},"Relative Program",-1))])]),e("div",ew,[e("div",tw,[R(e("input",{"onUpdate:modelValue":E[2]||(E[2]=_=>y.item.name=_),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,y.item.name]]),E[16]||(E[16]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",sw,[(t(!0),s(A,null,N(o(f).item.name.$errors,_=>(t(),s("div",{key:_.$uid},m(_.$message),1))),128))])):H("",!0)])]),e("div",ow,[e("div",aw,[R(e("input",{"onUpdate:modelValue":E[3]||(E[3]=_=>y.item.dateScheduledStart=_),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[X,y.item.dateScheduledStart]]),E[17]||(E[17]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(f).item.dateScheduledStart.$error?(t(),s("div",lw,[(t(!0),s(A,null,N(o(f).item.dateScheduledStart.$errors,_=>(t(),s("div",{key:_.$uid},m(_.$message),1))),128))])):H("",!0)])])]),e("div",nw,[e("div",rw,[e("div",iw,[R(e("select",{"onUpdate:modelValue":E[4]||(E[4]=_=>y.item.sourceLocationId=_),onChange:E[5]||(E[5]=_=>p(y.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,N(y.lookups.sourceLocations,_=>(t(),s("option",{value:_.id},m(_.name),9,dw))),256))],544),[[ge,y.item.sourceLocationId]]),E[18]||(E[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(f).item.sourceLocationId.$error?(t(),s("div",uw,[(t(!0),s(A,null,N(o(f).item.sourceLocationId.$errors,_=>(t(),s("div",{key:_.$uid},m(_.$message),1))),128))])):H("",!0)])]),e("div",cw,[e("div",mw,[R(e("select",{"onUpdate:modelValue":E[6]||(E[6]=_=>y.item.vodSource=_),onChange:E[7]||(E[7]=_=>k()),class:"form-select",id:"vodSourceId"},[(t(!0),s(A,null,N(y.lookups.vodSources,_=>(t(),s("option",{value:_},m(_.name),9,fw))),256))],544),[[ge,y.item.vodSource]]),E[19]||(E[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(f).item.vodSourceId.$error?(t(),s("div",pw,[(t(!0),s(A,null,N(o(f).item.vodSourceId.$errors,_=>(t(),s("div",{key:_.$uid},m(_.$message),1))),128))])):H("",!0)])]),e("div",vw,[e("div",gw,[e("div",bw,[R(e("input",{"onUpdate:modelValue":E[8]||(E[8]=_=>y.item.startOffsetMillis=_),id:"startOffsetMillis",type:"number",class:"form-control",placeholder:"Start OffSet Millis"},null,512),[[X,y.item.startOffsetMillis]]),E[20]||(E[20]=e("label",{for:"startOffsetMillis",class:""},"Start OffSet Millis",-1))]),y.item.startOffsetMillis>0?(t(),s("span",yw,m(o(U).moment.utc(y.item.startOffsetMillis).format("HH:mm:ss")),1)):H("",!0)]),y.item.startOffsetMillis>0&&y.item.startOffsetMillis<3e4?(t(),s("div",$w,E[21]||(E[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):H("",!0),y.item.startOffsetMillis>y.item.endOffsetMillis&&y.item.endOffsetMillis>0?(t(),s("div",ww,E[22]||(E[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Exceeds End Offset Millis ",-1)]))):H("",!0),y.item.vodSource&&y.item.startOffsetMillis>y.item.vodSource.durationInMillis?(t(),s("div",hw,E[23]||(E[23]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Millis Exceeds VOD Source Duration ",-1)]))):H("",!0),o(f).item.startOffsetMillis.$error?(t(),s("div",_w,[(t(!0),s(A,null,N(o(f).item.startOffsetMillis.$errors,_=>(t(),s("div",{key:_.$uid},m(_.$message),1))),128))])):H("",!0)]),e("div",kw,[e("div",Sw,[e("div",Tw,[R(e("input",{"onUpdate:modelValue":E[9]||(E[9]=_=>y.item.endOffsetMillis=_),id:"endOffsetMillis",type:"number",class:"form-control",placeholder:"End OffSet Millis"},null,512),[[X,y.item.endOffsetMillis]]),E[24]||(E[24]=e("label",{for:"endOffsetMillis",class:""},"End OffSet Millis",-1))]),y.item.endOffsetMillis>0?(t(),s("span",Iw,m(o(U).moment.utc(y.item.endOffsetMillis).format("HH:mm:ss")),1)):H("",!0)]),y.item.endOffsetMillis>0&&y.item.endOffsetMillis<3e4?(t(),s("div",Mw,E[25]||(E[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):H("",!0),y.item.vodSource&&y.item.endOffsetMillis>y.item.vodSource.durationInMillis?(t(),s("div",xw,E[26]||(E[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Millis Exceeds VOD Source Duration ",-1)]))):H("",!0),o(f).item.endOffsetMillis.$error?(t(),s("div",Cw,[(t(!0),s(A,null,N(o(f).item.endOffsetMillis.$errors,_=>(t(),s("div",{key:_.$uid},m(_.$message),1))),128))])):H("",!0)])]),E[30]||(E[30]=e("hr",null,null,-1)),e("div",null,[e("div",{class:"d-flex flex-row justify-content-between"},[E[27]||(E[27]=e("fieldset",null,[e("legend",null," Ad Break ")],-1)),e("button",{onClick:v,class:"btn btn-outline-primary"}," Insert Ad Break ")]),e("div",Vw,[e("table",Pw,[E[29]||(E[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Millis"),e("th",null,"Source Location"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,N(y.item.adBreaks,(_,C)=>(t(),s("tr",null,[e("td",null,m(C+1),1),e("td",null,[e("div",Ow,[R(e("input",{"onUpdate:modelValue":re=>_.offsetMillis=re,type:"number",class:"form-control",placeholder:"Enter Offset Millis..."},null,8,Aw),[[X,_.offsetMillis]]),_.offsetMillis>0?(t(),s("span",Uw,m(o(U).moment.utc(_.offsetMillis).format("HH:mm:ss")),1)):H("",!0)])]),e("td",null,[R(e("select",{"onUpdate:modelValue":re=>_.sourceLocationId=re,onChange:E[10]||(E[10]=re=>b(y.item.sourceLocationId)),class:"form-select",id:"adBreakSourceLocationId"},[(t(!0),s(A,null,N(y.lookups.adBreakSourceLocations,re=>(t(),s("option",{value:re.id},m(re.name),9,Dw))),256))],40,Lw),[[ge,_.sourceLocationId]])]),e("td",null,[R(e("select",{"onUpdate:modelValue":re=>_.vodSourceId=re,class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(A,null,N(y.lookups.adBreakVodSources,re=>(t(),s("option",{value:re.id},m(re.name),9,Ew))),256))],8,Hw),[[ge,_.vodSourceId]])]),e("td",null,[e("button",{onClick:re=>w(C),class:"btn btn-outline-warning"},E[28]||(E[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,qw)])]))),256))])])])])])]),e("div",Bw,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:E[11]||(E[11]=_=>h()),class:"btn btn-primary",type:"button"},E[31]||(E[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Nw),E[32]||(E[32]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,q$))}},Fw=["id"],zw={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Gw={class:"modal-content"},jw={class:"modal-header"},Yw={class:"modal-title"},Ww={class:"modal-body"},Kw={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Qw=["innerHTML"],Jw={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Xw={class:"container"},Zw={class:"col"},eh={class:"form-floating mb-2"},th={class:"col"},sh={class:"form-floating mb-2"},oh={key:0,class:"d-block invalid-feedback"},ah={class:"col"},lh={class:"form-floating mb-2 d-none"},nh={key:0,class:"d-block invalid-feedback"},rh={class:"col"},ih={class:"form-floating mb-2"},dh={key:0,class:"d-block invalid-feedback"},uh={class:"modal-footer"},ch=["disabled"],mh={__name:"_addPlaybackConfiguration",emits:["refresh"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output Playback Configuration"}),J=I,Q=de(),c=de("modalAddPlaybackConfiguration"),y=be({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),j={item:{name:{required:se.withMessage("Name is required.",ae),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:se.withMessage("adDecisionServerUrl is required.",ae),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:se.withMessage("videoContentSourceUrl is required.",ae),$autoDirty:!0,$lazy:!0}}},f=Te(j,y);me(async()=>{f.value.$reset()});const M=async(d,r)=>{Q.value=d;const p=y;W.value.clear(),G.value="";const l=r;let b=l.lastIndexOf("/");const n=l.substring(0,b);let v=l.substring(b+1);b=v.lastIndexOf("."),v=v.substring(0,b)+"_ADCAMPAIGN_",p.item={name:v,originalVideoContentSourceUrl:r,videoContentSourceUrl:n,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},f.value.$reset();var w=document.getElementById(c.value),k=_e.getOrCreateInstance(w);k.show()},i=async()=>{var d=document.getElementById(c.value),r=_e.getOrCreateInstance(d);r.hide(),J("refresh")},h=async()=>{const d=y;if(L.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{L.value=!0,G.value="";const p=d.item;p.channelOutputId=Q.value,await B.put("/api/v1/channelOutputs/playback/",p).then(l=>{O.success("Add Channel Output Playback Configuration","Channel Output playback configuration added.",{async onClose(){}})}),await i()}catch(p){G.value=U.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{L.value=!1}};return g({open:M,close:i}),(d,r)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",zw,[e("div",Gw,[e("div",jw,[e("h5",Yw,[r[6]||(r[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:r[0]||(r[0]=p=>i()),"aria-label":"Close"})]),e("div",Ww,[o(G)?(t(),s("div",Kw,[r[7]||(r[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Qw)])):H("",!0),o(W).size>0?(t(),s("div",Jw,[r[8]||(r[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),p=>(t(),s("li",null,m(p),1))),256))])])):H("",!0),e("div",Xw,[e("div",Zw,[e("div",eh,[R(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=p=>y.item.originalVideoContentSourceUrl=p),id:"originalVideoContentSourceUrl",class:"form-control",style:{height:"5rem"},placeholder:"originalVideoContentSourceUrl",readonly:""},null,512),[[X,y.item.originalVideoContentSourceUrl]]),r[9]||(r[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",th,[e("div",sh,[R(e("input",{"onUpdate:modelValue":r[2]||(r[2]=p=>y.item.name=p),id:"name",class:"form-control",placeholder:"Name"},null,512),[[X,y.item.name]]),r[10]||(r[10]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",oh,[(t(!0),s(A,null,N(o(f).item.name.$errors,p=>(t(),s("div",{key:p.$uid},m(p.$message),1))),128))])):H("",!0)])]),e("div",ah,[e("div",lh,[R(e("input",{"onUpdate:modelValue":r[3]||(r[3]=p=>y.item.videoContentSourceUrl=p),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[X,y.item.videoContentSourceUrl]]),r[11]||(r[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),r[12]||(r[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(f).item.videoContentSourceUrl.$error?(t(),s("div",nh,[(t(!0),s(A,null,N(o(f).item.videoContentSourceUrl.$errors,p=>(t(),s("div",{key:p.$uid},m(p.$message),1))),128))])):H("",!0)])]),e("div",rh,[e("div",ih,[R(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=p=>y.item.adDecisionServerUrl=p),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[X,y.item.adDecisionServerUrl]]),r[13]||(r[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(f).item.adDecisionServerUrl.$error?(t(),s("div",dh,[(t(!0),s(A,null,N(o(f).item.adDecisionServerUrl.$errors,p=>(t(),s("div",{key:p.$uid},m(p.$message),1))),128))])):H("",!0),r[14]||(r[14]=Qe('<div class="mt-2 ms-3"><span class="fas fa-fw fa-info-circle text-info"></span><span class="small">Sample value for the Ad Decision Server Url</span><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/pg/vast.xml</textarea><label for="" class="">Sample VAST 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/rama/vast.xml</textarea><label for="" class="">Sample VAST 2</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&amp;iu=/124319096/external/ad_rule_samples&amp;ciu_szs=300x250&amp;ad_rule=1&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=vmap&amp;unviewed_position_start=1&amp;cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&amp;cmsid=496&amp;vid=short_onecue&amp;correlator=[avail.random]</textarea><label for="" class="">Sample VMAP 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_ad_samples&amp;sz=640x480&amp;cust_params=sample_ct%3Dlinear&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 2 (Linear)</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_preroll_skippable&amp;sz=640x480&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 3 (Skippable)</label></div></div>',1))])])])]),e("div",uh,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:r[5]||(r[5]=p=>h()),class:"btn btn-primary",type:"button"},r[15]||(r[15]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,ch),r[16]||(r[16]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,Fw))}},fh=["id"],ph={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},vh={class:"modal-content"},gh={class:"modal-header"},bh={class:"modal-title"},yh={class:"modal-body"},$h={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},wh=["innerHTML"],hh={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},_h={class:"container"},kh={class:"col"},Sh={class:"form-floating mb-2"},Th=["value"],Ih={key:0,class:"d-block invalid-feedback"},Mh={class:"col"},xh={class:"form-floating mb-2"},Ch={key:0,class:"d-block invalid-feedback"},Vh={class:"col"},Ph={class:"form-floating mb-2"},Oh={key:0,class:"d-block invalid-feedback"},Ah={class:"modal-footer"},Uh=["disabled"],Lh={__name:"_addChannelOutput",emits:["refresh"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output"}),J=I,Q=de(),c=de("modalAddChannelOutput"),y=be({lookups:{sourceGroups:[]},item:{sourceGroupId:null,manifestName:null,outputType:null}}),j={item:{sourceGroupId:{required:se.withMessage("Source Group is required.",ae),$autoDirty:!0,$lazy:!0},manifestName:{required:se.withMessage("Manifest Name is required.",ae),$autoDirty:!0,$lazy:!0},outputType:{required:se.withMessage("Output Type is required.",ae),$autoDirty:!0,$lazy:!0}}},f=Te(j,y);me(async()=>{f.value.$reset()});const M=async()=>{await i()},i=async()=>{try{await B.get("/api/v1/sourceGroups/lookup/").then(l=>{y.lookups.sourceGroups=l.data,y.lookups.sourceGroups.length===1&&(y.item.sourceGroupId=y.lookups.sourceGroups[0].id)})}catch(p){G.value=U.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{}},h=async p=>{Q.value=p;const l=y;W.value.clear(),G.value="",l.lookups={sourceGroups:[]},l.item={sourceGroupId:null,outputType:null},await M(),f.value.$reset();var b=document.getElementById(c.value),n=_e.getOrCreateInstance(b);n.show()},d=async()=>{var p=document.getElementById(c.value),l=_e.getOrCreateInstance(p);l.hide(),J("refresh")},r=async()=>{const p=y;if(L.value)return;if(!await f.value.$validate()){window.scrollTo(0,0);return}try{L.value=!0,G.value="";const b=p.item;b.channelId=Q.value,await B.post("/api/v1/channelOutputs",b).then(n=>{O.success("Add Channel Output","Channel output added.")}),await d()}catch(b){G.value=U.getErrorMessageAsHtml(b),window.scrollTo(0,0)}finally{L.value=!1}};return g({open:h,close:d}),(p,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:c.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",ph,[e("div",vh,[e("div",gh,[e("h5",bh,[l[4]||(l[4]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),l[5]||(l[5]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",yh,[o(G)?(t(),s("div",$h,[l[6]||(l[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,wh)])):H("",!0),o(W).size>0?(t(),s("div",hh,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),b=>(t(),s("li",null,m(b),1))),256))])])):H("",!0),e("div",_h,[e("div",kh,[e("div",Sh,[R(e("select",{"onUpdate:modelValue":l[0]||(l[0]=b=>y.item.sourceGroupId=b),class:"form-select",id:"sourceGroupId"},[(t(!0),s(A,null,N(y.lookups.sourceGroups,b=>(t(),s("option",{value:b.id},m(b.name),9,Th))),256))],512),[[ge,y.item.sourceGroupId]]),l[8]||(l[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(f).item.sourceGroupId.$error?(t(),s("div",Ih,[(t(!0),s(A,null,N(o(f).item.sourceGroupId.$errors,b=>(t(),s("div",{key:b.$uid},m(b.$message),1))),128))])):H("",!0)])]),e("div",Mh,[e("div",xh,[R(e("select",{"onUpdate:modelValue":l[1]||(l[1]=b=>y.item.outputType=b),class:"form-select",id:"outputType"},l[9]||(l[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),512),[[ge,y.item.outputType]]),l[10]||(l[10]=e("label",{for:"outputType",class:""},"Output Type",-1)),o(f).item.outputType.$error?(t(),s("div",Ch,[(t(!0),s(A,null,N(o(f).item.outputType.$errors,b=>(t(),s("div",{key:b.$uid},m(b.$message),1))),128))])):H("",!0)])]),e("div",Vh,[e("div",Ph,[R(e("input",{"onUpdate:modelValue":l[2]||(l[2]=b=>y.item.manifestName=b),class:"form-control",id:"manifestName"},null,512),[[X,y.item.manifestName]]),l[11]||(l[11]=e("label",{for:"manifestName",class:""},"Manifest Name",-1)),o(f).item.manifestName.$error?(t(),s("div",Oh,[(t(!0),s(A,null,N(o(f).item.manifestName.$errors,b=>(t(),s("div",{key:b.$uid},m(b.$message),1))),128))])):H("",!0)])])])]),e("div",Ah,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:l[3]||(l[3]=b=>r()),class:"btn btn-primary",type:"button"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Uh),l[13]||(l[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,fh))}},Dh=["id"],Hh={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Eh={class:"modal-content"},qh={class:"modal-header"},Bh={class:"modal-title"},Nh={class:"modal-body"},Rh={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Fh=["innerHTML"],zh={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Gh={class:"container"},jh={class:"col"},Yh={class:"form-floating mb-2"},Wh=["value"],Kh={key:0,class:"d-block invalid-feedback"},Qh={class:"col"},Jh={class:"form-floating mb-2"},Xh=["value"],Zh={key:0,class:"d-block invalid-feedback"},e_={class:"col"},t_={class:"card h-100"},s_=["id"],o_={class:"modal-footer"},a_=["disabled"],l_={__name:"_editFillerSlate",emits:["refresh"],setup(a,{expose:g,emit:I}){const{appTitle:V,pageTitle:S,busy:L,isDirty:P,validations:W,infoMessage:Y,warningMessage:D,errorMessage:G,router:Z,axios:B,utils:U,toasts:O,closeWithReturnUrl:x,security:u}=we({appTitle:"Arcadian-FAST",pageTitle:"Edit Filler Slate"}),J=I,Q=de("modalEditFillerSlate"),c=be({lookups:{sourceLocations:[],vodSources:[]},item:{channelId:null,sourceLocationId:null,vodSourceId:null},hls:null}),y={item:{channelId:{required:se.withMessage("channelId is required.",ae),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:se.withMessage("sourceLocationId is required.",ae),$autoDirty:!0,$lazy:!0},vodSourceId:{required:se.withMessage("vodSourceId is required.",ae),$autoDirty:!0,$lazy:!0}}},j=Te(y,c);me(async()=>{j.value.$reset()}),Ae(()=>{c.hls&&(c.hls.stopLoad(),c.hls.destroy())});const f=async()=>{await M()},M=async()=>{try{await B.get("/api/v1/sourcelocations/lookup/").then(v=>{c.lookups.sourceLocations=v.data}),c.item.sourceLocationId&&await i(c.item.sourceLocationId)}catch(n){G.value=U.getErrorMessageAsHtml(n),window.scrollTo(0,0)}finally{}},i=async n=>{try{let v=`/api/v1/vodSources/lookup/source-Location/${n}/?type=2`;await B.get(v).then(w=>{c.lookups.vodSources=w.data})}catch(v){G.value=U.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{}},h=async(n,v,w)=>{const k=c;W.value.clear(),G.value="",k.lookups={sourceLocations:[],vodSources:[]},k.item={channelId:n,sourceLocationId:v,vodSourceId:w},await f(),c.item.vodSourceId&&await b(c.item.vodSourceId),j.value.$reset();var $=document.getElementById(Q.value),E=_e.getOrCreateInstance($);E.show()},d=async()=>{var n=document.getElementById(Q.value),v=_e.getOrCreateInstance(n);v.hide(),c.hls&&(c.hls.stopLoad(),c.hls.destroy()),J("refresh")},r=async()=>{const n=c;if(L.value)return;if(!await j.value.$validate()){window.scrollTo(0,0);return}try{L.value=!0,G.value="";const w=n.item;await B.put("/api/v1/channels/filler-slate",w).then(k=>{O.success("Update Channel Filler Slate","Channel's Filler slate was updated.")}),await d()}catch(w){G.value=U.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{L.value=!1}},p=async()=>{c.item.vodSourceId=null,await i(c.item.sourceLocationId)},l=async()=>{await b(c.item.vodSourceId)},b=async n=>{try{let v=`/api/v1/vodSources/${n}/hls`;const w=await B.get(v).then($=>$.data);if(c.hls){c.hls.loadSource(w);return}const k=document.getElementById(`video-${c.item.channelId}`);c.hls=U.createHlsStream(k,w)}catch(v){G.value=U.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{}};return g({open:h,close:d}),(n,v)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:Q.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",Hh,[e("div",Eh,[e("div",qh,[e("h5",Bh,[v[6]||(v[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),K(m(o(S)),1)]),e("button",{type:"button",class:"btn-close",onClick:v[0]||(v[0]=w=>d()),"aria-label":"Close"})]),e("div",Nh,[o(G)?(t(),s("div",Rh,[v[7]||(v[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:o(G)},null,8,Fh)])):H("",!0),o(W).size>0?(t(),s("div",zh,[v[8]||(v[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(o(W).values(),w=>(t(),s("li",null,m(w),1))),256))])])):H("",!0),e("div",Gh,[e("div",jh,[e("div",Yh,[R(e("select",{"onUpdate:modelValue":v[1]||(v[1]=w=>c.item.sourceLocationId=w),onChange:v[2]||(v[2]=w=>p()),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,N(c.lookups.sourceLocations,w=>(t(),s("option",{value:w.id},m(w.name),9,Wh))),256))],544),[[ge,c.item.sourceLocationId]]),v[9]||(v[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(j).item.sourceLocationId.$error?(t(),s("div",Kh,[(t(!0),s(A,null,N(o(j).item.sourceLocationId.$errors,w=>(t(),s("div",{key:w.$uid},m(w.$message),1))),128))])):H("",!0)])]),e("div",Qh,[e("div",Jh,[R(e("select",{"onUpdate:modelValue":v[3]||(v[3]=w=>c.item.vodSourceId=w),onChange:l,class:"form-select",id:"vodSourceId"},[(t(!0),s(A,null,N(c.lookups.vodSources,w=>(t(),s("option",{value:w.id},m(w.name),9,Xh))),256))],544),[[ge,c.item.vodSourceId]]),v[10]||(v[10]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(j).item.vodSourceId.$error?(t(),s("div",Zh,[(t(!0),s(A,null,N(o(j).item.vodSourceId.$errors,w=>(t(),s("div",{key:w.$uid},m(w.$message),1))),128))])):H("",!0)])]),e("div",e_,[e("div",t_,[e("video",{id:`video-${c.item.channelId}`,controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,8,s_)])])])]),e("div",o_,[e("button",{disabled:o(j).$dirty&&o(j).$invalid,onClick:v[4]||(v[4]=w=>r()),class:"btn btn-primary",type:"button"},v[11]||(v[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,a_),e("button",{onClick:v[5]||(v[5]=w=>d()),class:"btn btn-secondary ms-1"},v[12]||(v[12]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Dh))}},n_={class:"my-2"},r_={class:""},i_={class:"form-floating mb-2"},d_={id:"vodSourceTitle",class:"form-control-plaintext"},u_={class:"row"},c_={class:"col-12 col-md-4"},m_={class:"form-floating mb-2"},f_={id:"vodSourceVideoTitle",class:"form-control-plaintext"},p_={class:"col-12 col-md-8"},v_={class:"form-floating mb-2"},g_={id:"vodSourceVideoDesc",class:"form-control-plaintext"},b_={class:"mt-2"},y_={class:"row row-cols-1 row-cols-sm-3"},$_={class:"col"},w_={class:"form-floating mb-2"},h_={id:"startOffsetMillis",class:"form-control-plaintext"},__={class:"col"},k_={class:"form-floating mb-2"},S_={id:"endOffsetMillis",class:"form-control-plaintext"},T_={class:"col"},I_={class:"form-floating mb-2"},M_={id:"durationInMillis",class:"form-control-plaintext"},x_={class:"row row-cols-1 row-cols-sm-3"},C_={class:"col"},V_={class:"form-floating mb-2"},P_={id:"adBreaksDurationInMillis",class:"form-control-plaintext"},O_={class:"col"},A_={class:"form-floating mb-2"},U_={id:"totalProgramTemplateDurationInMillis",class:"form-control-plaintext"},L_={class:"row row-cols-1 row-cols-sm-3"},D_={class:"col"},H_={class:"form-floating mb-2"},E_={id:"dateScheduledStart",class:"form-control-plaintext"},q_={class:"col"},B_={class:"form-floating mb-2"},N_={id:"dateScheduledEnd",class:"form-control-plaintext"},R_={key:0,class:"col"},F_={class:"form-floating mb-2"},z_={id:"relativeProgram",class:"form-control-plaintext"},G_={key:0,class:"mt-2"},j_={class:"table-responsive border"},Y_={class:"table table-sm table-bordered1 mb-0"},W_={class:"text-center me-1"},K_={class:"text-center"},Q_={class:"text-center"},J_={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},X_={key:1,class:"fas fa-fw fa-triangle-exclamation text-warning me-1"},Z_={__name:"_programDetail",props:{item:{type:Object,required:!0},urlViewVideo:{type:String,required:!0},urlViewVodSource:{type:String,required:!0}},setup(a){const g=a,{moment:I,generateReturnUrl:V}=Xe();return me(()=>{g.item.value}),(S,L)=>{const P=te("router-link");return t(),s("div",n_,[e("div",null,[L[1]||(L[1]=e("h5",null," VOD ",-1)),e("div",r_,[e("div",i_,[e("div",d_,[F(P,{to:`${a.urlViewVodSource}/${a.item.vodSourceId}/${o(V)()}`,class:"link-offset-2"},{default:z(()=>[K(m(a.item.vodSource.name),1)]),_:1},8,["to"])]),L[0]||(L[0]=e("label",{for:"vodSourceTitle"},"Title",-1))])])]),e("div",null,[L[4]||(L[4]=e("h5",null," Video ",-1)),e("div",u_,[e("div",c_,[e("div",m_,[e("div",f_,[F(P,{to:`${a.urlViewVideo}/${a.item.vodSource.video.videoId}/${o(V)()}`,class:"link-offset-2"},{default:z(()=>[K(m(a.item.vodSource.video.title),1)]),_:1},8,["to"])]),L[2]||(L[2]=e("label",{for:"vodSourceVideoTitle"},"Title",-1))])]),e("div",p_,[e("div",v_,[e("div",g_,m(a.item.vodSource.video.description),1),L[3]||(L[3]=e("label",{for:"vodSourceVideoDesc"},"Description",-1))])])])]),e("div",b_,[L[13]||(L[13]=e("h5",null," Schedule ",-1)),e("div",y_,[e("div",$_,[e("div",w_,[e("div",h_,m(o(I).utc(a.item.startOffsetMillis).format("HH:mm:ss")),1),L[5]||(L[5]=e("label",{for:"startOffsetMillis"},"Start Offset",-1))])]),e("div",__,[e("div",k_,[e("div",S_,m(o(I).utc(a.item.endOffsetMillis).format("HH:mm:ss")),1),L[6]||(L[6]=e("label",{for:"endOffsetMillis"},"End Offset",-1))])]),e("div",T_,[e("div",I_,[e("div",M_,m(o(I).utc(a.item.durationInMillis).format("HH:mm:ss")),1),L[7]||(L[7]=e("label",{for:"durationInMillis"},"Clip Duration",-1))])])]),e("div",x_,[e("div",C_,[e("div",V_,[e("div",P_,m(o(I).utc(a.item.adBreaksDurationInMillis).format("HH:mm:ss")),1),L[8]||(L[8]=e("label",{for:"adBreaksDurationInMillis"},"Total Ad Breaks Duration",-1))])]),e("div",O_,[e("div",A_,[e("div",U_,m(o(I).utc(a.item.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),L[9]||(L[9]=e("label",{for:"totalProgramTemplateDurationInMillis"},"Total Program Duration",-1))])])]),e("div",L_,[e("div",D_,[e("div",H_,[e("div",E_,m(o(I).utc(a.item.dateScheduledStart).format("lll")),1),L[10]||(L[10]=e("label",{for:"dateScheduledStart"},"Program Start",-1))])]),e("div",q_,[e("div",B_,[e("div",N_,m(o(I).utc(a.item.dateScheduledEnd).format("lll")),1),L[11]||(L[11]=e("label",{for:"dateScheduledEnd"},"Program End",-1))])]),a.item.relativeProgram?(t(),s("div",R_,[e("div",F_,[e("div",z_,m(a.item.relativeProgram.name),1),L[12]||(L[12]=e("label",{for:"relativeProgram"},"Relative Program",-1))])])):H("",!0)])]),a.item.adBreaks.length?(t(),s("div",G_,[L[15]||(L[15]=e("h5",null," Ad Breaks ",-1)),e("div",j_,[e("table",Y_,[e("tbody",null,[L[14]||(L[14]=e("tr",null,[e("th",{class:"text-center"},"#"),e("th",{class:"text-center"},"Offset"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center1"},"VOD")],-1)),(t(!0),s(A,null,N(a.item.adBreaks,(W,Y)=>(t(),s("tr",null,[e("td",W_,m(Y+1),1),e("td",K_,m(o(I).utc(W.offsetMillis).format("HH:mm:ss")),1),e("td",Q_,m(o(I).utc(W.durationInMillis).format("HH:mm:ss")),1),e("td",null,[F(P,{to:`${a.urlViewVodSource}/${W.vodSource.vodSourceId}/${o(V)()}`,class:"link-offset-2"},{default:z(()=>[W.vodSource.arn?(t(),s("span",J_)):(t(),s("span",X_)),K(" "+m(W.vodSource.name),1)]),_:2},1032,["to"])])]))),256))])])])])):H("",!0)])}}},e2={key:0,class:"dropdown"},t2={key:0,class:"fas fa-fw fa-play"},s2={key:1,class:"fas fa-fw fa-stop"},o2={class:"dropdown-menu"},a2={key:0},l2={key:1},n2={key:0},r2={class:"nav nav-tabs nav-fill",id:"myTab",role:"tablist"},i2={class:"nav-item",role:"presentation"},d2={class:"nav-item",role:"presentation"},u2={class:"nav-item",role:"presentation"},c2={class:"nav-item",role:"presentation"},m2={class:"nav-item",role:"presentation"},f2={class:"tab-content",id:"myTabContent"},p2={class:"mt-2"},v2={class:"row row-cols-1 row-cols-sm-3"},g2={class:"col"},b2={class:"form-floating mb-2"},y2={class:"col"},$2={class:"form-floating mb-2"},w2={class:"col"},h2={class:"form-floating mb-2"},_2={class:"d-flex flex-row justify-content-start align-items-center"},k2={key:0,class:"ms-2"},S2={class:"row row-cols-sm-2 mt-1"},T2={class:"col"},I2={class:"form-floating mb-2"},M2={class:"form-control-plaintext",readonly:""},x2={class:"col"},C2={class:"form-floating mb-2"},V2={class:"form-control-plaintext",readonly:""},P2={class:"mt-2"},O2={class:"d-flex flex-row justify-content-start align-items-center"},A2={class:"ms-2"},U2={key:0,class:"alert bg-warning mt-2"},L2={class:"table-responsive border mt-1"},D2={class:"table table-bordered1 mb-0"},H2={class:"badge bg-info"},E2={key:0,class:"text-wrap"},q2={key:1,class:"text-warning"},B2={key:0,class:"text-end"},N2={key:1,class:"text-end"},R2=["onClick"],F2={key:0},z2={colspan:"999"},G2={class:"d-flex flex-row justify-content-start align-items-center"},j2={class:"ms-2"},Y2={if:"item.playbackUrl"},W2=["onClick"],K2={key:0,class:"table-responsive mt-2"},Q2={class:"table table-borderless mb-0 table-sm"},J2={class:"align-middle1"},X2={class:"badge bg-success"},Z2={class:"border p-2 mt-2 overflow-auto",style:{width:"50rem"}},ek={class:"text-end"},tk=["onClick"],sk=["onClick"],ok={class:"mt-2"},ak={class:"table-responsive border"},lk={class:"table mb-0 table-sm table-bordered1"},nk={class:"align-middle1"},rk={class:"text-center me-1"},ik={class:"d-flex flex-row justify-content-start"},dk={class:""},uk={class:"mb-1"},ck=["src"],mk={class:"ms-2"},fk={key:0,class:"fas fa-fw fa-check-circle text-success"},pk={class:"fw-lighter small"},vk={class:"fw-lighter small"},gk={class:"text-center"},bk={class:"text-center"},yk={class:"text-end"},$k={class:"btn-group position-static"},wk=["onClick"],hk={key:0,class:"fas fa-fw fa-chevron-circle-up"},_k={key:1,class:"fas fa-fw fa-chevron-circle-down"},kk={class:"dropdown-menu"},Sk=["onClick"],Tk={key:0},Ik=["onClick"],Mk=["onClick"],xk=["onClick"],Ck={key:0},Vk={colspan:"999"},Pk={class:"text-end mt-2 d-none"},Ok={class:"mt-2"},Ak={class:"text-end mb-2"},Uk={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4",id:"masonry"},Lk={class:"col"},Dk={class:"card shadow-sm"},Hk=["id"],Ek={class:"p-1"},qk={class:"card-title1 text-center"},Bk={class:"col"},Nk={class:"card shadow-sm"},Rk=["id"],Fk={class:"p-1"},zk={class:"card-title1 text-center text-truncate"},Gk={class:"small1"},jk={class:"mt-2"},Yk={key:0,class:"fas fa-fw fa-check-circle text-success"},Wk={key:1,class:"fas fa-fw fa-times-circle text-warning"},Kk={key:0,class:"fas fa-fw fa-check-circle text-success"},Qk={key:1,class:"fas fa-fw fa-times-circle text-warning"},Jk={key:0,class:"fas fa-fw fa-check-circle text-success"},Xk={key:1,class:"fas fa-fw fa-times-circle text-warning"},Zk={key:0,class:"fas fa-fw fa-check text-warning"},e0={key:1,class:"fas fa-fw fa-circle-exclamation text-warning"},t0={key:0,class:"fas fa-fw fa-check-circle text-success"},s0={key:1,class:"fas fa-fw fa-times-circle text-warning"},o0={__name:"index",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/channels"},urlViewSourceGroup:{type:String,default:"/source-groups/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlSchedulePrograms:{type:String,default:"/channels/schedule-programs"}},setup(a){const g=a,{appTitle:I,pageTitle:V,busy:S,isDirty:L,validations:P,infoMessage:W,warningMessage:Y,errorMessage:D,router:G,axios:Z,utils:B,toasts:U,close:O,closeWithReturnUrl:x,generateReturnUrl:u,security:J}=we({appTitle:"Arcadian-FAST",pageTitle:"View Channel"});Ce("$config");const Q=he();Q.user;const c=be({user:Q.user,item:null}),y=de(null),j=de(null),f=de(null),M=de(null),i=de(null),h=de(),d=Me(()=>c.item&&c.item.state==="RUNNING");me(async()=>{await b();const ce=B.getPageTab("channel")||"information-tab";r(ce)}),Ae(()=>{xe()});const r=ce=>{B.setPageTab("channel",ce),h.value=ce,ce==="preview-tab"&&setTimeout(()=>{var q=document.getElementById("masonry");new nt(q,{})},2e3)},p=ce=>ce===h.value?"active":"",l=ce=>ce===h.value?"show active":"",b=async()=>{const ce=c;if(xe(),!S.value)try{S.value=!0,D.value="",c.item=null;const q=`/api/v1/channels/${g.id}/`;await Z.get(q).then(ye=>{ce.item=ye.data,ce.item.outputs.forEach(He=>{He.playbackConfigurations.forEach(ie=>{if(He.playbackUrl){const Oe=He.playbackUrl,Ie=Oe.lastIndexOf("/"),at=Oe.substring(0,Ie),je=Oe.substring(Ie+1),lt=ie.hlsConfigurationManifestEndpointPrefix;lt&&(ie.hlsPlaylist=lt+je)}})})})}catch(q){D.value=B.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{S.value=!1}},n=async()=>{await b()},v=async()=>{if(confirm("Channel will be submitted to AWS MediaTailer. Are you sure you want to publish the channel?")&&!S.value){D.value=null;try{S.value=!0,await Z.post(`/api/v1/channels/${g.id}/publish/`).then(q=>{U.success("Publish Channel","Channel was published.")}),S.value=!1,await n()}catch(q){D.value=B.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{S.value=!1}}},w=async()=>{if(confirm("Channel will be removed to AWS MediaTailer. Are you sure you want to remove the channel?")&&!S.value){D.value=null;try{S.value=!0,await Z.delete(`/api/v1/channels/${g.id}/unpublish/`).then(q=>{U.warning("Remove Channel","Channel was removed.")}),S.value=!1,await n()}catch(q){D.value=B.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{S.value=!1}}},k=()=>{y.value.open(g.id)},$=ce=>{ce.outputType==="HLS"&&j.value.open(ce.channelOutputId,ce.playbackUrl)},E=()=>{f.value.open(g.id)},_=ce=>{M.value.open(ce)},C=(ce,q)=>{i.value.open(g.id,ce,q)},re=async ce=>{if(confirm("Program will be deleted. Are you sure you want to delete the program?")&&!S.value){D.value=null;try{S.value=!0,await Z.delete(`/api/v1/programs/${ce}/`).then(ye=>{U.success("Delete Program","Program was deleted..",{async onClose(){}})}),S.value=!1,await n()}catch(ye){D.value=B.getErrorMessageAsHtml(ye),window.scrollTo(0,0)}finally{S.value=!1}}},fe=async ce=>{if(confirm("Channel output will be unpublished (if published) and will be deleted. Are you sure you want to delete this channel output?")&&!S.value){D.value=null;try{S.value=!0,await Z.delete(`/api/v1/channelOutputs/${ce}/`).then(ye=>{U.success("Delete Channel Output","Channel output was deleted..")}),S.value=!1,await n()}catch(ye){D.value=B.getErrorMessageAsHtml(ye),window.scrollTo(0,0)}finally{S.value=!1}}},ee=async ce=>{if(confirm("Program will be published to AWS MediaTailor. Are you sure you want to publish the program?")&&!S.value){D.value=null;try{S.value=!0,await Z.post(`/api/v1/programs/${ce}/publish/`).then(ye=>{U.success("Publish Program","Program was published..",{async onClose(){}})}),S.value=!1,await n()}catch(ye){D.value=B.getErrorMessageAsHtml(ye),window.scrollTo(0,0)}finally{S.value=!1}}},T=async ce=>{if(confirm("Program will be unpublished to AWS MediaTailor. Are you sure you want to unpublish the program?")&&!S.value){D.value=null;try{S.value=!0,await Z.delete(`/api/v1/programs/${ce}/unpublish/`).then(ye=>{U.success("Unpublish Program","Program was unpublished..",{async onClose(){}})}),S.value=!1,await n()}catch(ye){D.value=B.getErrorMessageAsHtml(ye),window.scrollTo(0,0)}finally{S.value=!1}}},ue=async ce=>{if(!S.value){D.value=null;try{S.value=!0,await Z.put(`/api/v1/channels/${g.id}/change-state/${ce}`).then(q=>{U.success("Update Channel state","Change state was updated")}),S.value=!1,ce==="STOPPED"&&h.value==="preview-tab"&&(xe(),r("information-tab")),await n()}catch(q){D.value=B.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{S.value=!1}}},oe=async ce=>{if(!S.value)try{S.value=!0,D.value="",await Z.post(`/api/v1/channelOutputs/${ce}/playback/publish/`).then(q=>{U.success("Publish Channel Output Playback Configuration","Channel Output playback configuration published.")}),S.value=!1,await n()}catch(q){D.value=B.getErrorMessageAsHtml(q),window.scrollTo(0,0)}finally{S.value=!1}},ne=async ce=>{if(confirm("Do you want to remove this Playback Configuration?")&&!S.value)try{S.value=!0,D.value="",await Z.delete(`/api/v1/channelOutputs/${ce}/playback/`).then(ye=>{U.warning("Delete Channel Output Playback Configuration","Channel Output playback configuration deleted.")}),S.value=!1,await n()}catch(ye){D.value=B.getErrorMessageAsHtml(ye),window.scrollTo(0,0)}finally{S.value=!1}},pe=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?");const ce=c.item.outputs;xe(),ce.forEach(q=>{var ye=document.getElementById(`video-${q.channelOutputId}`);q.hls&&q.hls.destroy(),q.hls=B.createHlsStream(ye,q.playbackUrl,"Main playlist started."),ye.play(),q.playbackConfigurations.forEach(De=>{if(De.hls&&De.hls.destroy(),De.arn){var He=document.getElementById(`video-${De.channelOutputPlaybackConfigurationId}`);try{De.hls=B.createHlsStream(He,De.hlsPlaylist,"Playback with Server-side Ad Insertion playlist started."),He.play()}catch(ie){U.error("Failed Stream SSAI Playlist",ie)}}})}),setTimeout(()=>{var q=document.getElementById("masonry");new nt(q,{})},2e3)}},xe=()=>{c.item&&c.item.outputs&&c.item.outputs.forEach(q=>{q.hls&&(q.hls.detachMedia(),q.hls.destroy(),delete q.hls),q.playbackConfigurations.forEach(ye=>{ye.hls&&(ye.hls.detachMedia(),ye.hls.destroy(),delete ye.hls)})})};return(ce,q)=>{const ye=te("router-link"),De=te("PageHeader"),He=te("PageBody");return t(),ve($e,null,{default:z(()=>[e("div",null,[F(De,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(V)},{default:z(()=>[c.item?(t(),s("div",e2,[e("button",{class:le([[d.value?"btn-success":"btn-secondary"],"btn dropdown-toggle"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[d.value?(t(),s("span",t2)):(t(),s("span",s2)),K(" "+m(c.item.state),1)],2),e("ul",o2,[c.item.arn?(t(),s("li",a2,[d.value?(t(),s("button",{key:0,onClick:q[0]||(q[0]=ie=>ue("STOPPED")),class:"dropdown-item"},q[20]||(q[20]=[e("span",{class:"fas fa-fw fa-stop me-1"},null,-1),K("Stop ")]))):(t(),s("button",{key:1,onClick:q[1]||(q[1]=ie=>ue("RUNNING")),class:"dropdown-item"},q[21]||(q[21]=[e("span",{class:"fas fa-fw fa-play me-1"},null,-1),K("Start ")])))])):H("",!0),d.value?H("",!0):(t(),s("li",l2,[c.item.arn?(t(),s("button",{key:0,onClick:q[2]||(q[2]=ie=>w()),class:"dropdown-item"},q[22]||(q[22]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),K("Unpublish ")]))):(t(),s("button",{key:1,onClick:q[3]||(q[3]=ie=>v()),class:"dropdown-item"},q[23]||(q[23]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),K("Publish ")])))])),c.item.arn?(t(),s(A,{key:2},[q[25]||(q[25]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("button",{onClick:q[4]||(q[4]=ie=>v()),class:"dropdown-item"},q[24]||(q[24]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),K("Republish ")]))])],64)):H("",!0)])])):H("",!0),F(ye,{to:`${a.urlSchedulePrograms}/${a.id}`,class:"ms-2 btn btn-primary"},{default:z(()=>q[26]||(q[26]=[e("span",{class:"fas fa-fw fa-calendar"},null,-1)])),_:1},8,["to"]),e("button",{onClick:q[5]||(q[5]=ie=>n()),class:"ms-2 btn btn-secondary"},q[27]||(q[27]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:q[6]||(q[6]=ie=>o(x)(g.urlMain)),class:"btn btn-secondary ms-1"},q[28]||(q[28]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(He,{errorMessage:o(D)},{default:z(()=>[c.item?(t(),s("div",n2,[e("ul",r2,[e("li",i2,[e("button",{onClick:q[7]||(q[7]=ie=>r("information-tab")),class:le([p("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"},q[29]||(q[29]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),K("Information ")]),2)]),e("li",d2,[e("button",{onClick:q[8]||(q[8]=ie=>r("outputPlayback-tab")),class:le([p("outputPlayback-tab"),"nav-link"]),id:"outputPlayback-tab","data-bs-toggle":"tab","data-bs-target":"#outputPlayback",type:"button",role:"tab","aria-controls":"outputPlayback","aria-selected":"false"},q[30]||(q[30]=[e("span",{class:"fas fa-fw fa-gears me-1"},null,-1),K("Output/Playback ")]),2)]),e("li",u2,[e("button",{onClick:q[9]||(q[9]=ie=>r("programs-tab")),class:le([p("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},q[31]||(q[31]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),K("Programs ")]),2)]),e("li",c2,[e("button",{onClick:q[10]||(q[10]=ie=>r("preview-tab")),class:le([[d.value?"":"disabled",p("preview-tab")],"nav-link"]),id:"preview-tab","data-bs-toggle":"tab","data-bs-target":"#preview",type:"button",role:"tab","aria-controls":"preview","aria-selected":"false"},q[32]||(q[32]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),K("Preview ")]),2)]),e("li",m2,[e("button",{onClick:q[11]||(q[11]=ie=>r("checklist-tab")),class:le([p("checklist-tab"),"nav-link"]),id:"checklist-tab","data-bs-toggle":"tab","data-bs-target":"#checklist",type:"button",role:"tab","aria-controls":"checklist","aria-selected":"false"},q[33]||(q[33]=[e("span",{class:"fas fa-fw fa-list-check me-1"},null,-1),K("Checklist ")]),2)])]),e("div",f2,[e("div",{class:le([l("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",p2,[e("div",v2,[e("div",g2,[e("div",b2,[R(e("input",{"onUpdate:modelValue":q[12]||(q[12]=ie=>c.item.name=ie),type:"text",class:"form-control-plaintext",id:"name",readonly:""},null,512),[[X,c.item.name]]),q[34]||(q[34]=e("label",{for:"name"},"Name",-1))])]),e("div",y2,[e("div",$2,[R(e("input",{"onUpdate:modelValue":q[13]||(q[13]=ie=>c.item.playbackMode=ie),type:"text",class:"form-control-plaintext",id:"playbackMode",readonly:""},null,512),[[X,c.item.playbackMode]]),q[35]||(q[35]=e("label",{for:"playbackMode"},"Playback Mode",-1))])]),e("div",w2,[e("div",h2,[R(e("input",{"onUpdate:modelValue":q[14]||(q[14]=ie=>c.item.tier=ie),type:"text",class:"form-control-plaintext",id:"tier",readonly:""},null,512),[[X,c.item.tier]]),q[36]||(q[36]=e("label",{for:"tier"},"Tier",-1))])])]),e("div",null,[e("div",_2,[q[38]||(q[38]=e("div",null,[e("h5",{class:"m-0"},"Filler Slate")],-1)),d.value?H("",!0):(t(),s("div",k2,[e("button",{onClick:q[15]||(q[15]=ie=>C(c.item.fillerSlateSourceLocation.sourceLocationId,c.item.fillerSlateVodSource.vodSourceId)),class:"btn btn-outline-primary btn-sm"},q[37]||(q[37]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)]))]))]),e("div",S2,[e("div",T2,[e("div",I2,[e("div",M2,[F(ye,{to:`${a.urlViewSourceLocation}/${c.item.fillerSlateSourceLocation.sourceLocationId}/${o(u)()}`,class:le([[c.item.fillerSlateSourceLocation.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName"},{default:z(()=>[K(m(c.item.fillerSlateSourceLocation.name),1)]),_:1},8,["to","class"])]),q[39]||(q[39]=e("label",{for:"fillerSlateSourceLocationName"},"Filler Slate Source LocationName",-1))])]),e("div",x2,[e("div",C2,[e("div",V2,[F(ye,{to:`${a.urlViewVodSource}/${c.item.fillerSlateVodSource.vodSourceId}/${o(u)()}`,class:le([[c.item.fillerSlateVodSource.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName",readonly:""},{default:z(()=>[K(m(c.item.fillerSlateVodSource.name),1)]),_:1},8,["to","class"])]),q[40]||(q[40]=e("label",{for:"fillerSlateVodSourceName"},"Filler Slate Vod SourceName",-1))])])])])])],2),e("div",{class:le([l("outputPlayback-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",P2,[e("div",null,[e("div",O2,[q[42]||(q[42]=e("div",null,[e("h5",{class:"m-0"},"Outputs")],-1)),e("div",A2,[e("button",{onClick:q[16]||(q[16]=ie=>E()),class:"btn btn-outline-primary btn-sm"},q[41]||(q[41]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),c.item.outputs.length<=0?(t(),s("div",U2,q[43]||(q[43]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),K("Channel Output is required ")]))):H("",!0),e("div",L2,[e("table",D2,[q[53]||(q[53]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Manifest"),e("th",null,"Source Group"),e("th",null,"Playback Url")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.outputs,(ie,Oe)=>(t(),s(A,{key:ie.channelOutputId},[e("tr",null,[e("td",null,m(Oe+1),1),e("td",null,[e("div",null,m(ie.manifestName),1),e("div",null,[e("span",H2,m(ie.outputType),1)])]),e("td",null,[e("div",null,[F(ye,{to:`${a.urlViewSourceGroup}/${ie.sourceGroupId}/${o(u)()}`,class:"link-offset-2",tag:"button"},{default:z(()=>[K(m(ie.sourceGroup.name),1)]),_:2},1032,["to"])])]),e("td",null,[ie.playbackUrl?(t(),s("div",E2,m(ie.playbackUrl),1)):(t(),s("div",q2,q[44]||(q[44]=[e("span",{class:"fas fa-fw fa-info-circle"},null,-1),K("Publish channel to get the playback url ")])))]),d.value?(t(),s("td",B2)):(t(),s("td",N2,[e("button",{onClick:Ie=>fe(ie.channelOutputId),class:"btn btn-outline-warning btn-sm"},q[45]||(q[45]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,R2)]))]),ie.playbackUrl?(t(),s("tr",F2,[q[50]||(q[50]=e("td",null,null,-1)),q[51]||(q[51]=e("td",null,null,-1)),q[52]||(q[52]=e("td",null,null,-1)),e("td",z2,[e("div",G2,[q[47]||(q[47]=e("h5",null,[K("Configuration "),e("sub",null,"(SSAI)")],-1)),e("div",j2,[e("div",Y2,[e("button",{onClick:Ie=>$(ie),class:"btn btn-outline-primary btn-sm"},q[46]||(q[46]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]),8,W2)])])]),ie.playbackConfigurations.length>0?(t(),s("div",K2,[e("table",Q2,[e("tbody",null,[(t(!0),s(A,null,N(ie.playbackConfigurations,(Ie,at)=>(t(),s("tr",J2,[e("td",null,m(at+1),1),e("td",null,[e("span",X2,m(Ie.name),1),e("div",Z2,[e("span",null,m(Ie.adDecisionServerUrl),1)])]),e("td",ek,[Ie.arn?H("",!0):(t(),s("button",{key:0,onClick:je=>oe(Ie.channelOutputPlaybackConfigurationId),class:"btn btn-outline-warning btn-sm ms-1"},q[48]||(q[48]=[e("span",{class:"fas fa-fw fa-link"},null,-1)]),8,tk)),e("button",{onClick:je=>ne(Ie.channelOutputPlaybackConfigurationId),class:"btn btn-outline-warning btn-sm ms-2"},q[49]||(q[49]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,sk)])]))),256))])])])):H("",!0)])])):H("",!0)],64))),128))]),_:1},512),[[Se,c.item.outputs.length>0]])])])])])],2),e("div",{class:le([l("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",ok,[e("div",ak,[e("table",lk,[q[60]||(q[60]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th")])],-1)),R(F(ke,{tag:"tbody",name:"list",class:"table-group-divider"},{default:z(()=>[(t(!0),s(A,null,N(c.item.programs,(ie,Oe)=>(t(),s(A,{key:ie.programId},[e("tr",nk,[e("td",rk,m(Oe+1),1),e("td",null,[e("div",ik,[e("div",dk,[ie.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},N(ie.vodSource.video.thumbnails,Ie=>(t(),s("div",uk,[e("img",{src:Ie.url,class:"img-fuild border",width:"128"},null,8,ck)]))),256)):H("",!0)]),e("div",mk,[e("div",null,[ie.arn?(t(),s("span",fk)):H("",!0),e("span",null,m(ie.name),1)]),e("div",null,[e("span",pk,m(o(B).moment.utc(ie.dateScheduledStart).calendar())+" (utc)",1)]),e("div",null,[e("span",vk,m(o(B).moment(ie.dateScheduledStart).calendar())+" (local)",1)])])])]),e("td",gk,m(o(B).moment.utc(ie.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",bk,m(ie.adBreaks.length),1),e("td",yk,[e("div",$k,[e("button",{onClick:Ie=>ie.expand=!ie.expand,type:"button",class:le([[ie.expand?"btn-secondary":"btn-outline-secondary"],"btn btn-sm"])},[ie.expand?(t(),s("span",hk)):(t(),s("span",_k))],10,wk),q[58]||(q[58]=e("button",{type:"button",class:"btn btn-secondary btn-sm dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"visually-hidden"},"Toggle Dropdown")],-1)),e("ul",kk,[e("li",null,[e("button",{onClick:Ie=>_(ie.programId),class:"dropdown-item"},q[54]||(q[54]=[e("span",{class:"fas fa-fw fa-edit me-1"},null,-1),K("Edit ")]),8,Sk)]),ie.arn?(t(),s("li",Tk,[e("button",{onClick:Ie=>T(ie.programId),class:"dropdown-item"},q[55]||(q[55]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),K("Unpublish ")]),8,Ik)])):(t(),s(A,{key:1},[e("li",null,[e("button",{onClick:Ie=>ee(ie.programId),class:"dropdown-item"},q[56]||(q[56]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),K("Publish ")]),8,Mk)]),e("li",null,[e("button",{onClick:Ie=>re(ie.programId),class:"dropdown-item"},q[57]||(q[57]=[e("span",{class:"fas fa-fw fa-trash me-1"},null,-1),K("Remove ")]),8,xk)])],64))])])])]),ie.expand?(t(),s("tr",Ck,[q[59]||(q[59]=e("td",null,null,-1)),e("td",Vk,[F(Z_,{item:ie,urlViewVideo:a.urlViewVideo,urlViewVodSource:a.urlViewVodSource},null,8,["item","urlViewVideo","urlViewVodSource"])])])):H("",!0)],64))),128))]),_:1},512),[[Se,c.item.programs.length>0]])])]),e("div",Pk,[e("button",{onClick:q[17]||(q[17]=ie=>k()),class:"btn btn-outline-primary"},q[61]||(q[61]=[e("span",{class:"fas fa-fw fa-plus me-1"},null,-1),K("Program ")]))])])],2),d.value?(t(),s("div",{key:0,class:le([l("preview-tab"),"tab-pane fade"]),id:"preview",role:"tabpanel","aria-labelledby":"preview-tab"},[e("div",Ok,[e("div",Ak,[c.item.outputs[0].hls?(t(),s("button",{key:1,onClick:q[19]||(q[19]=ie=>xe()),class:"btn btn-primary"},q[63]||(q[63]=[e("span",{class:"fas fa-fw fa-eye-slash"},null,-1)]))):(t(),s("button",{key:0,onClick:q[18]||(q[18]=ie=>pe()),class:"btn btn-primary"},q[62]||(q[62]=[e("span",{class:"fas fa-fw fa-eye"},null,-1)])))]),e("div",Uk,[(t(!0),s(A,null,N(c.item.outputs,ie=>(t(),s(A,null,[e("div",Lk,[e("div",Dk,[e("video",{id:`video-${ie.channelOutputId}`,controls:"",class:"card-img-top object-fit-cover shandow"},null,8,Hk),e("div",Ek,[e("div",qk,m(ie.manifestName),1)])])]),(t(!0),s(A,null,N(ie.playbackConfigurations,(Oe,Ie)=>(t(),s("div",Bk,[e("div",Nk,[e("video",{id:`video-${Oe.channelOutputPlaybackConfigurationId}`,controls:"",class:"card-img-top object-fit-cover"},null,8,Rk),e("div",Fk,[e("div",zk,[K(" #"+m(Ie+1)+" ",1),e("span",Gk,m(Oe.name),1)])])])]))),256))],64))),256))])])],2)):H("",!0),e("div",{class:le([l("checklist-tab"),"tab-pane fade"]),id:"checklist",role:"tabpanel","aria-labelledby":"checklist-tab"},[e("div",jk,[q[69]||(q[69]=K(" Checklist ")),e("ul",null,[e("li",null,[c.item.fillerSlateSourceLocation.arn?(t(),s("span",Yk)):(t(),s("span",Wk)),q[64]||(q[64]=K(" Filler Slate Source Location "))]),e("li",null,[c.item.fillerSlateVodSource.arn?(t(),s("span",Kk)):(t(),s("span",Qk)),q[65]||(q[65]=K(" Filler Slate VOD Source "))]),e("li",null,[c.item.outputs.length>0?(t(),s("span",Jk)):(t(),s("span",Xk)),q[67]||(q[67]=K(" Outputs ")),e("ul",null,[e("li",null,[c.item.outputs.some(ie=>ie.playbackConfigurations.length>0)?(t(),s("span",Zk)):(t(),s("span",e0)),q[66]||(q[66]=K(" Ad Insertion setup "))])])]),e("li",null,[c.item.programs.length>0?(t(),s("span",t0)):(t(),s("span",s0)),q[68]||(q[68]=K(" Programs "))])])])],2)])])):H("",!0)]),_:1},8,["errorMessage"]),F(Rw,{ref_key:"modalAddProgram",ref:y,onRefresh:n},null,512),F(mh,{ref_key:"modalAddPlaybackConfiguration",ref:j,onRefresh:n},null,512),F(Lh,{ref_key:"modalAddChannelOutput",ref:f,onRefresh:n},null,512),F(pt,{ref_key:"modalEditProgram",ref:M,onOnClose:n},null,512),F(l_,{ref_key:"modalEditFillerSlate",ref:i,onRefresh:n},null,512)])]),_:1})}}},a0={path:"/",component:xa,props:!1,meta:{requiresAuth:!0},children:[{path:"",component:Qa},{path:"videos",children:[{path:"",component:Wn},{path:"view/:id",component:Or,props:!0},{path:"add",component:Pl},{path:"edit/:id",component:fn,props:!0}]},{path:"source-groups",children:[{path:"add",component:Dr},{path:"edit/:id",component:ai,props:!0},{path:"",component:mi},{path:"view/:id",component:Mi,props:!0}]},{path:"source-locations",children:[{path:"add",component:Ai},{path:"edit/:id",component:Di,props:!0},{path:"",component:Yi},{path:"view/:id",component:pd,props:!0}]},{path:"vod-sources",children:[{path:"add",component:Pu},{path:"edit/:id",component:ac,props:!0},{path:"",component:Lc},{path:"view/:id",component:wf,props:!0}]},{path:"channels",children:[{path:"add",component:y1},{path:"edit/:id",component:h1,props:!0},{path:"",component:P1},{path:"schedule-programs/:id",component:E$,props:!0},{path:"view/:id",component:o0,props:!0}]},{path:"program-templates",children:[{path:"add",component:av},{path:"edit/:id",component:Wv,props:!0},{path:"",component:pg},{path:"view/:id",component:Jg,props:!0}]}]},ot=bt({history:yt("/"),linkActiveClass:"active",routes:[{...fo},{path:"/administrator",redirect:"/"},{...a0}]});ot.beforeEach(async a=>{kt().clear();var I=a.meta;const V=["/accounts/login","/accounts/loginRedirect","/accounts/logout","/accounts/register"],S=I.requiresAuth&&!V.includes(a.path),L=he(),P=L.user;if(S&&!P)return L.returnUrl=a.fullPath,{path:"/accounts/login",query:{returnUrl:encodeURIComponent(a.fullPath)}};var W=a.meta.roles;if(W&&!L.user.roles.some(Y=>W.includes(Y)))return alert("You are not authorized to acccess this page."),{path:"/accounts/login/",query:{returnUrl:encodeURIComponent(a.fullPath)}}});const l0={props:{uid:{type:String,required:!0},urlViewDeposit:{type:String,required:!1},urlViewWithdraw:{type:String,required:!1},urlViewManualModeOfPayment:{type:String,required:!1}},data(){return{messages:[],count:0}},created(){},async mounted(){await this.connectNotificationHub()},methods:{async connectNotificationHub(){const a=this,I=new $t().withUrl("https://sonyfastpoc.azurewebsites.net//notificationHub").withAutomaticReconnect().build();I.on("onNotificationCreated",function(V){let S=V.content;V.notificationEntityClassText==="Deposit"&&(S+="<br/>",S+=`<a href="${a.urlViewDeposit}${V.referenceId}">Click ${V.notificationEntityClassText} here</a>`),V.notificationEntityClassText==="Withdraw"&&(S+="<br/>",S+=`<a href="${a.urlViewWithdraw}${V.referenceId}">Click ${V.notificationEntityClassText} here</a>`),V.notificationEntityClassText==="ManualModeOfPayment"&&(S+="<br/>",S+=`<a href="${a.urlViewManualModeOfPayment}${V.referenceId}">Click ${V.notificationEntityClassText} here</a>`),V.iconClass;let L="secondary";switch(V.notificationType){case 1:L="success";break;case 3:L="info";break;case 3:L="success";break;case 4:L="info";break;case 5:L="warning";break;case 6:L="error";break}a.$toast[L](V.subject,S,{timeOut:1e4});const P=V.subject,D={body:S,icon:"/img/192x102.png"};new Notification(P,D)}),I.on("jobUpdated",function(V){a.$bus.$emit("event:job-updated",V)}),await I.start().then(function(){}).catch(function(V){})}}};function n0(a,g,I,V,S,L){return t(),s("div")}const r0=Ve(l0,[["render",n0],["__scopeId","data-v-5b4a9fa2"]]),i0={class:"navbar bg-dark bg-gradient shadow flex-grow-0","data-bs-theme":"dark"},d0={class:"container"},u0={class:"col-md"},c0={class:"navbar-brand mb-0 ms-1 align-middle"},m0={class:"col-md-auto"},f0={class:"d-flex flex-row align-items-center justify-content-end"},p0={__name:"_pageHeader",props:{pageIcon:{type:String,required:!0},pageTitle:{type:String,required:!0},headerBreak:{type:String,required:!1,default:""}},setup(a){return(g,I)=>(t(),ve($e,null,{default:z(()=>[e("nav",i0,[e("div",d0,[e("div",u0,[qe(g.$slots,"title",{},()=>[e("a",c0,[e("i",{class:le([a.pageIcon,"me-1 me-lg-2"])},null,2),e("span",null,m(a.pageTitle),1)])],!0)]),e("div",m0,[e("div",f0,[qe(g.$slots,"default",{},void 0,!0)])])])])]),_:3}))}},v0=Ve(p0,[["__scopeId","data-v-eb40af38"]]),g0={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},b0=["innerHTML"],y0={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},$0={__name:"_pageMessages",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(a){return(g,I)=>(t(),ve($e,null,{default:z(()=>[qe(g.$slots,"default",{},()=>[a.errorMessage?(t(),s("div",g0,[I[0]||(I[0]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),K("Error ")],-1)),e("div",{innerHTML:a.errorMessage},null,8,b0)])):H("",!0),a.vuelidate&&a.vuelidate.$error?(t(),s("div",y0,[I[1]||(I[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),K("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,N(a.vuelidate.$errors,V=>(t(),s("li",{key:V.$uid},[V.$validator==="$each"?(t(),s(A,{key:0},[K(" Check errors in '"+m(V.$property)+"' ",1)],64)):(t(),s(A,{key:1},[K(m(V.$message),1)],64))]))),128))])])):H("",!0)])]),_:3}))}},w0={class:"py-3 container flex-grow-1 overflow-y-auto"},h0={__name:"_pageBody",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(a){return(g,I)=>{const V=te("PageMessages");return t(),ve($e,null,{default:z(()=>[e("div",w0,[F(V,{errorMessage:a.errorMessage,vuelidate:a.vuelidate},null,8,["errorMessage","vuelidate"]),qe(g.$slots,"default")])]),_:3})}}},_0={props:{filter:Object,search:Function,noRecords:String,showPerPage:Boolean,busy:Boolean},data(){return{}},created(){},methods:{async changePagination(){const a=this;a.busy||(document.activeElement&&document.activeElement.blur(),await a.search(1))},async moveFirst(){const a=this;if(a.busy)return;a.filter.pageIndex!==1&&(document.activeElement&&document.activeElement.blur(),await a.search(1))},async moveLast(){const a=this;if(a.busy)return;const g=a.filter;g.pageIndex!==g.totalPages&&(document.activeElement&&document.activeElement.blur(),await a.search(g.totalPages))},async move(a){const g=this;if(g.busy)return;const I=g.filter,V=I.pageIndex+a;V>=0&&V<=I.totalPages&&(document.activeElement&&document.activeElement.blur(),await g.search(V))}}},k0={class:"mt-2"},S0={key:0,class:"row row-cols-1 row-cols-sm-2 align-items-center w-100 gy-2 gx-0"},T0={key:0,class:"col-sm order-2 order-sm-1"},I0={class:"d-flex align-items-center small justify-content-center justify-content-sm-start"},M0={class:"me-1 fw-bold"},x0={class:"fw-bold"},C0={class:"ms-1"},V0={class:"col-sm-auto ms-auto order-1 order-sm-2"},P0={class:"pagination m-0 ms-1 justify-content-center justify-content-sm-end"},O0={key:0,class:"page-item"},A0={key:1,class:"page-item"},U0={key:2,class:"page-item"},L0={class:"page-item active"},D0={class:"page-link"},H0={key:3,class:"page-item"},E0={key:4,class:"page-item"},q0={key:5,class:"page-item"},B0={key:1,class:"text-info font-weight-bold text-center"},N0={key:0},R0={key:1};function F0(a,g,I,V,S,L){return t(),s("div",k0,[I.filter.items.length?(t(),s("div",S0,[I.showPerPage?(t(),s("div",T0,[e("div",I0,[e("div",null,[e("span",M0,m(I.filter.totalCount),1),g[8]||(g[8]=K("records in ")),e("span",x0,m(I.filter.totalPages),1),g[9]||(g[9]=K(" page(s) "))]),e("div",C0,[R(e("select",{"onUpdate:modelValue":g[0]||(g[0]=P=>I.filter.pageSize=P),onChange:g[1]||(g[1]=(...P)=>L.changePagination&&L.changePagination(...P)),class:"form-select form-select-sm me-1"},g[10]||(g[10]=[Qe('<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="5">5</option><option value="10">10</option><option value="15">15</option><option value="25">25</option><option value="50">50</option><option value="100">100</option>',9)]),544),[[ge,I.filter.pageSize]])]),g[11]||(g[11]=e("div",{class:"ms-1"},"per page",-1))])])):H("",!0),e("div",V0,[e("ul",P0,[I.filter.pageIndex!==1?(t(),s("li",O0,[e("button",{class:"page-link","aria-label":"Previous",onClick:g[2]||(g[2]=(...P)=>L.moveFirst&&L.moveFirst(...P))},g[12]||(g[12]=[e("span",{class:"fas fa-fw fa-backward-step"},null,-1)]))])):H("",!0),I.filter.pageIndex>2?(t(),s("li",A0,[e("button",{class:"page-link",onClick:g[3]||(g[3]=P=>L.move(-2))},m(I.filter.pageIndex-2),1)])):H("",!0),I.filter.pageIndex>1?(t(),s("li",U0,[e("button",{class:"page-link",onClick:g[4]||(g[4]=P=>L.move(-1))},m(I.filter.pageIndex-1),1)])):H("",!0),e("li",L0,[e("span",D0,m(I.filter.pageIndex),1)]),I.filter.pageIndex<I.filter.totalPages?(t(),s("li",H0,[e("button",{class:"page-link",onClick:g[5]||(g[5]=P=>L.move(1))},m(I.filter.pageIndex+1),1)])):H("",!0),I.filter.pageIndex<I.filter.totalPages-1?(t(),s("li",E0,[e("button",{class:"page-link",onClick:g[6]||(g[6]=P=>L.move(2))},m(I.filter.pageIndex+2),1)])):H("",!0),I.filter.pageIndex<I.filter.totalPages?(t(),s("li",q0,[e("button",{class:"page-link","aria-label":"Next",onClick:g[7]||(g[7]=(...P)=>L.moveLast&&L.moveLast(...P))},g[13]||(g[13]=[e("span",{class:"fas fa-fw fa-forward-step"},null,-1)]))])):H("",!0)])])])):(t(),s("div",B0,[I.noRecords?(t(),s("div",N0,m(I.noRecords),1)):(t(),s("div",R0,"No record(s) found."))]))])}const z0=Ve(_0,[["render",F0]]),G0={props:{filter:Object,field:String,showSort:Boolean,enabled:Boolean},data(){return{}},mounted(){},methods:{currentSortField(){return this.filter.sortField===this.field},sortUp(){return this.filter.sortOrder===1},click(){let a=this;if(!a.enabled)return;let g=a.filter;g.sortField===a.field?g.sortOrder===0?g.sortField=null:g.sortOrder=g.sortOrder===0?1:0:(g.sortField=a.field,g.sortOrder=1),a.$emit("search")}}},j0={class:"align-self-center"};function Y0(a,g,I,V,S,L){return t(),s("div",{onClick:g[0]||(g[0]=(...P)=>L.click&&L.click(...P)),class:"d-flex flex-row justify-content-start align-content-center",style:ut({cursor:I.enabled?"pointer":""})},[qe(a.$slots,"default"),e("span",j0,[I.showSort?(t(),s("span",{key:0,class:le([{"fa-sort text-gray-500":!L.currentSortField(),"fa-sort-up":L.currentSortField()&&L.sortUp(),"fa-sort-down":L.currentSortField()&&!L.sortUp()},"fas fa-fw mr-1"])},null,2)):H("",!0)])],4)}const W0=Ve(G0,[["render",Y0]]),K0={props:{items:Array,header:Object,getRowNumber:Function,setSelected:Function,isSelected:Function,tableCss:String,rowCss:String},data(){return{}},mounted(){},methods:{onSelectedRow(a){const g=this;g.setSelected(a),g.$emit("onSelectedRow",a)}}},Q0={class:"table-responsive m-0"},J0=["href"],X0={key:1},Z0=["onClick"],eS={class:"form-group row no-gutters"},tS={class:"col-5 col-form-label"},sS={class:"col align-self-center"},oS=["href"],aS={key:1};function lS(a,g,I,V,S,L){return t(),s("div",null,[e("div",Q0,[e("table",{class:le(["table table-hover d-none d-md-table card",I.tableCss])},[e("thead",null,[qe(a.$slots,"header",{},()=>[g[0]||(g[0]=e("th",null,"#",-1)),(t(!0),s(A,null,N(I.header.columns,P=>(t(),s("th",null,m(P.title),1))),256))],!0)]),e("tbody",null,[(t(!0),s(A,null,N(I.items,(P,W)=>qe(a.$slots,"table-row",{key:`row1-${P[I.header.key]}`,item:P,index:W},()=>[e("td",null,m(I.getRowNumber(W)),1),(t(!0),s(A,null,N(I.header.columns,Y=>(t(),s("td",null,[Y.href?(t(),s("a",{key:0,href:Y.href(P[I.header.key]),class:"font-weight-bold"},m(P[Y.field]),9,J0)):(t(),s("span",X0,m(P[Y.field]),1))]))),256))],!0)),128))])],2)]),e("div",{class:le(["d-block d-md-none",I.rowCss])},[(t(!0),s(A,null,N(I.items,(P,W)=>(t(),s("div",{key:`row2-${P[I.header.key]}`,onClick:Y=>L.onSelectedRow(P),class:"border"},[e("div",{class:le(["p-2",{"b-left":I.isSelected(P)}])},[qe(a.$slots,"table-list",{item:P,index:W},()=>[(t(!0),s(A,null,N(I.header.columns,Y=>(t(),s("div",eS,[e("label",tS,m(Y.title),1),e("div",sS,[Y.href?(t(),s("a",{key:0,href:Y.href(P[I.header.key]),class:"font-weight-bold"},m(P[Y.field]),9,oS)):(t(),s("span",aS,m(P[Y.field]),1))])]))),256))],!0)],2)],8,Z0))),128))],2)])}const nS=Ve(K0,[["render",lS],["__scopeId","data-v-65929213"]]),Pe=wt(_t);Pe.use(ht());Pe.use(ot);Pe.component("m-notification",r0);Pe.component("m-pagination",z0);Pe.component("sort-field",W0);Pe.component("table-list",nS);Pe.component("Toasts",Sa);Pe.component("PageHeader",v0);Pe.component("PageMessages",$0);Pe.component("PageBody",h0);const rS="https://sonyfastpoc.azurewebsites.net/",iS="Arcadian-FAST",dS=void 0,uS={API_URL:rS,appName:iS,tenantId:dS};Pe.provide("$config",uS);Pe.provide("$bus",et);Pe.mount("#app");
